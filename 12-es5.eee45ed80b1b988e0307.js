function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,n=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw n}}}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,i,n,a,s=[],d=!0,l=!1;try{if(n=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;d=!1}else for(;!(d=(o=n.call(r)).done)&&(s.push(o.value),s.length!==t);d=!0);}catch(e){l=!0,i=e}finally{try{if(!d&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{AzMM:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var o=r("PSD3"),i=r.n(o),n=r("AytR"),a=r("5JmO"),s=r("TruH"),d=r("Kj3r"),l=r("pLZG"),c=r("eIep"),u=r("JIr8"),h=r("XNiG"),m=r("LRne"),p=function(){function e(t,r,o,i,a,s,d,l,c,u,m,p,v,f,b,g,S){_classCallCheck(this,e),this._modalService=t,this._adminService=r,this._familyService=o,this._ordenService=i,this._formBuilder=a,this._productService=s,this._tableService=d,this._discountService=l,this._authService=c,this._router=u,this._sweetAlertsService=m,this._paramsService=p,this._taxesService=v,this._billingBoxService=f,this._ngbDropdownConfig=b,this._walletService=g,this.calendar=S,this.seleccionados=[],this.con_sin=!0,this.totalAux=0,this.families=[],this.loading=!0,this.productIdDelete=null,this.table=null,this.idBranch=localStorage.getItem("idBranchFk"),this.modalidad="",this.valorPensable="",this.productos=[],this.orden={},this.list=!1,this.onOps=!1,this.edit=!1,this.urlImgProduct=n.a.apiHost+"/product/",this.urlImgFamily=n.a.apiHost+"/family/",this.band=!1,this.bandPaid=!1,this.productsMitad=[],this.bandCreate=!1,this.productsM={},this.i=1,this.showExtraList=!1,this.realDiscount=!1,this.discounts=[],this.fromWeb=null,this.extraWeb=0,this.extrasValue=0,this.auxTotalPorProducto=0,this.discountFromWeb=0,this.beforeDiscount=0,this.TOTAL=0,this.TOTAL_PRODUCTOS=0,this.TOTAL_SUBTOTAL=0,this.TOTAL_PRODUCTOS_ADICIONALES=0,this.TOTAL_ENVIO=0,this.TOTAL_COMISION=0,this.TOTAL_DESCUENTO=0,this.ngxLoadingConf={backdropBorderRadius:"3px",fullScreenBackdrop:!0},this.taxes=[],this.productsToKitchen=[],this.multiProductsFlag=!1,this.creditNoteArr=[],this.totalSumProducts=0,this.bodyList=[],this.myDate=this.calendar.getToday(),this.producto="",this.kilogramos=0,this.clientSubject=new h.a}return _createClass(e,[{key:"g",get:function(){return this.formUpdate.controls}},{key:"handleKeyboardEvent",value:function(e){switch(e.keyCode){case 4:e.preventDefault(),this.openPaid(this.child,!1);break;case 13:e.preventDefault(),this.orden.facturaAfip&&this.openPaid(this.child,!1);break;case 112:e.preventDefault(),1==this.reprintAuth&&null!=this.orden.countSendPrintH?this.openPassword(this.passwordModaleChild,"",6):this.confirmSendTicketToKitchen(this.orden.idOrderH);break;case 113:e.preventDefault(),this.openPaid(this.child,!0,"FACTURAR",1);break;case 114:e.preventDefault(),this.reprint(this.orden.idOrderH);break;case 115:e.preventDefault(),1==this.waiterCurrentAccount&&"4"==localStorage.getItem("idProfile")?this.openPassword(this.passwordModaleChild,0,7):this.closeOrder();break;case 116:e.preventDefault(),1==this.deleteAuth?this.openPassword(this.passwordModaleChild,0,4):this.anularOrden();break;case 117:e.preventDefault(),this.transferirOrden();break;case 118:e.preventDefault(),this.openPaid(this.child,!1,"CERRAR",2);break;case"+58"==this.phonePrefix?119:"":e.preventDefault(),this.openSeniat(this.seniatModaleChild);break;case"+58"==this.phonePrefix?120:119:e.preventDefault(),1==this.reprintAuth?this.openPassword(this.passwordModaleChild,"",9):this.confirmKitchenAndPrint(this.orden.idOrderH);break;case"+58"==this.phonePrefix?121:120:e.preventDefault(),this.pricePDF()}}},{key:"ngOnInit",value:function(){var e=this;this.getDiscounts(),this.getTaxes(),this.profile=localStorage.getItem("idProfile"),this.modalidades=[{name:"Delivery/Tienda",value:"deliveryEnTienda"},{name:"Take Away",value:"deliveryEnLocal"},{name:"Delivery externo",value:"deliveryExterno"},{name:"Consumo en el local",value:"consumoEnLocal"}],this._ordenService.dicount=0,this._adminService.module="orden",this._ordenService.platesSelected=[],this.getFamilies(),this.getUser(),this.formUpdate=this._formBuilder.group({price:""}),this.formObservation=this._formBuilder.group({observation:""}),this.formPensable=this._formBuilder.group({pensable:[1]}),this.form=this.getFormBuilder(),this.getProducts(),this.getParams(),this._ngbDropdownConfig.placement="top-start",this.form.get("busqueda").valueChanges.pipe(Object(d.a)(180)).subscribe((function(t){e.buscarProductoPorId(t)})),this.debounceClientInformation()}},{key:"ngAfterViewInit",value:function(){this.searchInput.nativeElement.focus()}},{key:"ngOnDestroy",value:function(){localStorage.removeItem("fromAccounts")}},{key:"getParams",value:function(){var e=this;this._paramsService.GetParam().subscribe((function(t){var r=t.response;e.businessName=r[8].param,e.businessAddress=r[57].param,e.businessRif=r[63].param,e.deleteAuth=r[56].param,e.dolarRate=+r[52].param,e.phonePrefix=r[50].param,e.reprintAuth=r[62].param,e.disableUnitsButton=r[64].param,e.waiterAuth=r[65].param,e.waiterCurrentAccount=r[66].param,e.lisSin=r[75].param?r[75].param.split(","):"",e.registerMovementCurrentAccAndAccPayable=r[72].param,e.iva16=r[89].param,e.maxDiscount=r[70].param}),(function(){e._sweetAlertsService.alertoast("Error al obtener par\xe1metros.","error")}))}},{key:"clientInformation",value:function(e){var t=e.target.value;this.clientSubject.next(t)}},{key:"debounceClientInformation",value:function(){var e=this;this.clientSubject.pipe(Object(l.a)((function(e){return e.length>5})),Object(d.a)(700),Object(c.a)((function(t){return e._ordenService.getClientInformation({query:t}).pipe(Object(u.a)((function(t){return e._sweetAlertsService.alertoast("Error al buscar el cliente","error"),Object(m.a)(null)})))}))).subscribe((function(t){t?(e._sweetAlertsService.alertoast("Cliente encontrado","success"),e.changeClientInformation(t.data)):e._sweetAlertsService.alertoast("Cliente no encontrado","error")}))}},{key:"changeClientInformation",value:function(e){var t=this;document.getElementById("fullNameClient").value=e.fullNameClient,document.getElementById("phoneClient").value=e.phoneClient,document.getElementById("address").value=e.address,document.getElementById("comments").value=e.comments,document.getElementById("moso").value=e.moso,document.getElementById("documento").value=e.documento,document.getElementById("referencia").value=e.referencia;var r={fullNameClient:e.fullNameClient,phoneClient:e.phoneClient,address:e.address,nameClient:e.nameClient,comments:e.comments,moso:e.moso,documento:e.documento,referencia:e.referencia};this._ordenService.updateDataClient(this.orden.idOrderH,r).subscribe((function(e){document.getElementById("clientInformation").value="",t.getOrden()}))}},{key:"buscarProductoPorId",value:function(e){if(e){var t=this.productos.find((function(t){return t.barCode==e}));if(!t){var r=this.obtenerProducto(e);r&&(t=this.productos.find((function(e){return e.barCode==r})),this.kilogramos=this.obtenerKilogramos(e))}t?this.addInOrder(t.idProduct):this._sweetAlertsService.alertoast("Producto no encontrado","error")}}},{key:"obtenerProducto",value:function(e){return e.substring(3,6)}},{key:"obtenerKilogramos",value:function(e){var t=e.substring(7,11);return parseInt(t,10)/1e3}},{key:"setNote",value:function(e,t){var r=this,o={observation:e};this._ordenService.updateObservationOrder(t,o).subscribe((function(e){r._sweetAlertsService.alertoast("Observaci\xf3n guardada.","success"),r.recarga()}))}},{key:"getFormBuilder",value:function(){return this._formBuilder.group({busqueda:[""]})}},{key:"getProducts",value:function(){var e=this;this._productService.GetProductsByTypeFilter(1).subscribe((function(t){null!=t&&(e.productos=t.data,e.productsMitad=e.productos.filter((function(e){return"1"===e.is5050})),e.getOrden(!1))}))}},{key:"updateObservationOrder",value:function(e){var t=this,r={observation:this.formObservation.controls.observation.value};this._ordenService.updateObservationOrder(e,r).subscribe((function(e){t._sweetAlertsService.alertoast("Observaci\xf3n guardada.","success")}))}},{key:"calKilogramos",value:function(){var e=this,t={idOrderB:this._ordenService.platesSelected[this._ordenService.platesSelected.length-1].idOrderB,weight:this.kilogramos};this._ordenService.updateWeigthByProduct(t).subscribe((function(t){e.recarga(),e.kilogramos=0}),(function(t){e._sweetAlertsService.alertoast("No se pudo actualizar la unidad.","error")}))}},{key:"calPensable",value:function(e,t){var r=this;if(this.loading=!0,this.formPensable.controls.pensable.value>=0){var o={idOrderB:e.idOrderB,weight:this.formPensable.controls.pensable.value};this._ordenService.updateWeigthByProduct(o).subscribe((function(e){r._sweetAlertsService.alertoast("Unidad de producto actualizada con \xe9xito.","success"),r.recarga()}),(function(e){r._sweetAlertsService.alertoast("No se pudo actualizar la unidad.","error"),r.loading=!1}))}else this._sweetAlertsService.alertoast("El valor no puede ser cero o menor a cero.","Error")}},{key:"selectProducts",value:function(e,t,r,o,i,n){var a=this,s={};1===t&&(s.idProduct1=r),2===t&&(s.idProduct2=r),this._ordenService.updateIdProducts(s,o).subscribe((function(e){a.getOrden(!0)}))}},{key:"isCurrentAccount",value:function(){this._ordenService}},{key:"updateTotal",value:function(){var e=this,t={totalBot:this.g.price.value};this._ordenService.updateTotal(t,this._adminService.orderId).subscribe((function(t){e._sweetAlertsService.alertoast("Precio editado","success")})),this._ordenService.platesSelected.totalAPagar=parseFloat(t.totalBot)}},{key:"changeMethod",value:function(e){for(var t=this,r={deliveryEnTienda:!1,deliveryEnLocal:!1,deliveryExterno:!1,consumoEnLocal:!1,idOrderH:this.orden.idOrderH},o=0,i=Object.entries(r);o<i.length;o++){var n=_slicedToArray(i[o],2),a=n[0],s=n[1];a===e?r[e]=!0:s===Boolean&&(r[a]=!1)}this._ordenService.updateOrder(r).subscribe((function(e){t._sweetAlertsService.alertoast("Modalidad agregada","success")}))}},{key:"getOrden",value:function(e){var t=this;this.loading=!0,this._ordenService.dicount=0,this._ordenService.extraWeb=0,this._adminService.idTable||this._adminService.orderId?(!this.table&&this._adminService.idTable&&(this.table=this._adminService.idTable),this._adminService.idTable=null,(this._adminService.orderId?this._adminService.orderId:this.table.order[0]&&this.table.order[0].idOrderH)?this._ordenService.GetOrder(this._adminService.orderId?this._adminService.orderId:this.table.order[0].idOrderH).subscribe((function(e){t.orden=e.data,t.bodyList=e.data.body?e.data.body:[];var r=0;if(void 0!==t.orden.body&&t.orden.body.length>0&&t.orden.body.forEach((function(e){e.listSinCon.length>0&&e.listSinCon.forEach((function(e){r+=e.priceSale})),r+=e.priceProductOrder})),t.fromWeb=e.data.isFromWeb,t.extraWeb=e.data.totalBot,t._adminService.orderStatus=t.orden.statusOrder,t._ordenService.platesSelected=e.data.body,t._adminService.orderId=t._adminService.orderId?t._adminService.orderId:t.table.order[0].idOrderH,t._adminService.idUserOpenOrder=t.orden.idUserOpenFk,t._ordenService.userId=t.user,t._ordenService.extraWeb=t.orden.extraWeb,t._ordenService.platesSelected&&t._ordenService.platesSelected.length){t._ordenService.platesSelected.totalAPagar=0;for(var o=0;o<e.data.body.length;++o)t.orden.discount&&0==t.orden.discount&&(t.orden.discountTotal=0),t._productService.GetProduct(t._ordenService.platesSelected[o].idProductFk).subscribe((function(e){t._ordenService.platesSelected.find((function(t){return t.idProductFk==e.data.idProduct})).adicionals=e.data.adicionals}))}t.bandCreate&&t.changeMethod("consumoEnLocal"),setTimeout((function(){var e=document.getElementById("selectOrder").getElementsByTagName("option");for(var r in e)for(var o=0,i=Object.entries(t.orden);o<i.length;o++){var n=_slicedToArray(i[o],2),a=n[0],s=n[1],d=e[r].value;d&&a===d&&"1"===s&&e[r].setAttribute("selected","true")}}),1e3),t.loading=!0,setTimeout((function(){t._ordenService.getTotalesByOrden(t._adminService.orderId?t._adminService.orderId:t.table.order[0].idOrderH).subscribe((function(e){t.TOTAL=e.message[0].TOTAL_CONDESCUENTO,t.TOTAL_PRODUCTOS=e.message[0].TOTAL_PRODUCTOS,t.TOTAL_PRODUCTOS_ADICIONALES=e.message[0].TOTAL_PRODUCTOS_ADICIONALES,t.TOTAL_COMISION=e.message[0].TOTAL_COMISION,t.TOTAL_DESCUENTO=e.message[0].TOTAL_DESCUENTO,t.TOTAL_SUBTOTAL=e.message[0].TOTAL_SUBTOTAL,t.loading=!1,null==t.orden.body?r=t.TOTAL:r+=(null!=t.orden.envio?t.orden.envio:0)-(null!=t.orden.discountAmount?t.orden.discountAmount:0),t.totalSumProducts=r}))}),600),t.kilogramos&&t.calKilogramos()}),(function(){t._sweetAlertsService.alertoast("No se puedieron obtener los datos de la orden","error"),t.loading=!0})):this.newOrder(this.table.idTable,this.user,this.idBranch)):null!=this._adminService.idTableX?this.newOrder(this._adminService.idTableX,this.user,this.idBranch):this.newOrderFree()}},{key:"putMethodsOrder",value:function(){}},{key:"newOrderFree",value:function(){this.table=null,this._ordenService.userId=this.user,this.newOrder(this.table,this.user,this.idBranch)}},{key:"newOrder",value:function(e,t,r){var o=this;this._adminService.idUserOpenOrder=t;var i,n=localStorage.getItem("phoneClient"),a=localStorage.getItem("document");i="Generico"===this._adminService.client?this._adminService.client:localStorage.getItem("nameClient"),null==e&&(e=0);var s={idTableFk:e,idUserOpenFk:parseInt(localStorage.getItem("idUser")),fullNameClient:i,phoneClient:n||null,documento:a||("+58"==this.phonePrefix?"V-0000000":""),idBranchFk:r,moso:localStorage.getItem("moso")?localStorage.getItem("moso"):null,deliveryEnTienda:!1,deliveryEnLocal:!1,deliveryExterno:!1,address:0!=e?"MESA: "+(null!=this._adminService.idTableX?this._adminService.numberTable:this.table.numberTable):localStorage.getItem("address"),comments:localStorage.getItem("observation")?localStorage.getItem("observation"):"",idEnvironmentFk:localStorage.getItem("idEnvironmet")};this._ordenService.NewOrder(s).subscribe((function(e){o._sweetAlertsService.alertoast("Orden Creada","success"),o._adminService.orderId=e.data[0],localStorage.removeItem("observation"),localStorage.removeItem("moso"),o._adminService.client="",o.bandCreate=!1,o.getOrden(!1)}),(function(e){o._sweetAlertsService.alertoast("La orden no pudo ser creada","error")}))}},{key:"closeOrder",value:function(){var e=this,t=this.orden,r=t.fullNameClient,o=t.phoneClient;"Generico"!==r&&""!=r&&0!=r.trim().length&&""!=o?i.a.fire({title:"\xbfEnviar a cuenta por cobrar?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#41d29d",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"Confirmar"}).then((function(t){if(e.TOTAL>0){if(t.value){var r=e.orden.mpCash>0?1:e.orden.mpCreditCard>0?2:e.orden.mpDebitCard>0?3:e.orden.mpTranferBack>0?4:e.orden.mpMpago>0?5:e.orden.mpGlovo>0?6:e.orden.mpUber>0?7:e.orden.mpPedidosya>0?8:e.orden.mpJust>0?9:e.orden.wabi>0?10:e.orden.mpUSDT>0?11:e.orden.mpZencillo>0?12:e.orden.mpOtro2>0?13:e.orden.mpPersonal>0?14:e.orden.mpPedidosyacash>0?15:e.orden.mpPresent>0?16:e.orden.mpRappicash>0?17:e.orden.mpPaypal>0?18:e.orden.mpZelle>0?19:e.orden.mpBofa>0?20:e.orden.mpYumi>0?21:e.orden.mpbio>0?23:13;e._ordenService.CloseOrder(e.orden.idOrderH,{isacountCourrient:!0}).subscribe((function(t){e._ordenService.updateTotal({totalBot:+e.TOTAL},e.orden.idOrderH).subscribe((function(t){var o={title:"Deuda pedido: #"+e.orden.idOrderH,amount:e.TOTAL,nameclient:e.orden.fullNameClient,idUserAddFk:parseInt(localStorage.getItem("idUser")),isEntry:0,idClientFk:e.orden.phoneClient,idBranchFk:e.idBranch,idCurrencyFk:99,idPaymentMethodFk:r,idOrder:e.orden.idOrderH};e._walletService.NewWallet(o).subscribe((function(t){e._adminService.orderId=null,e._adminService.idTable=null,i.a.fire("Orden enviada a cuentas por cobrar.","","success").then((function(t){return e._router.navigate(["/admin/mesas/pedidos"])}))}),(function(e){console.log("Error code:",e)}))}))}),(function(t){e._sweetAlertsService.alertoast("No se pudo completar el cierre de la orden.","error")}))}}else e._sweetAlertsService.alertoast("El monto no puede ser 0.","error")})):this._sweetAlertsService.alertoast("Debe ingresar el nombre y/o tel\xe9fono.","error")}},{key:"getUser",value:function(){var e=this;this._authService.getAuthUser().subscribe((function(t){e.user=parseInt(localStorage.getItem("idUser"))}))}},{key:"onEnter",value:function(){}},{key:"getFamilies",value:function(){var e=this;this._familyService.GetFamilies().subscribe((function(t){e.families=t.response,e._router.navigate(["/admin/orden/platos",e.families[0].idProductFamily])}),(function(t){e._sweetAlertsService.alertoast("No se puedieron obtener los datos del menu","error")}))}},{key:"openModal",value:function(e,t,r){this.product=this._ordenService.platesSelected[t],this.con_sin=r,this.modalRef=this._modalService.open(e,{size:"lg",backdrop:"static"})}},{key:"deleteOfOrder",value:function(e){var t=this;if(this.productsToKitchen.length>0&&this.productsToKitchen.find((function(r,o){r==t._ordenService.platesSelected[e].idOrderB&&t.productsToKitchen.splice(o,1)})),this.loading=!0,"Cerrada"!=this.orden.statusOrder){var r={totalBot:parseFloat(this._ordenService.platesSelected.totalAPagar)-this._ordenService.platesSelected[e].totalPrice};this._ordenService.updateTotal(r,this.orden.idOrderH).subscribe((function(r){t._ordenService.DeleteProductOfOrder(t._ordenService.platesSelected[e].idOrderB,t.user).subscribe((function(r){t._ordenService.DeletePlate(e),t.getOrden(!0),t.orden.discountTotal=0==t._ordenService.dicount?t.orden.discountTotal:t._ordenService.dicount}))}))}}},{key:"paidOrder",value:function(e){this._ordenService.platesSelected&&(this.orden.discountTotal?(this._ordenService.platesSelected.totalAPagar-this.orden.discountTotal).toFixed(2):this._ordenService.platesSelected.totalAPagar.toFixed(2))}},{key:"anularOrden",value:function(){var e=this;"Cerrada"!=this.orden.statusOrder&&i.a.fire({title:"\xbfEst\xe1 seguro que quiere anular la orden?",text:"No podr\xe1 revertir esta acci\xf3n.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#459f47",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"S\xed, Anular"}).then((function(t){t.value&&e._ordenService.CancelOrder(e.orden.idOrderH).subscribe((function(t){if("0"==e.registerMovementCurrentAccAndAccPayable&&"1"==e.orden.isacountCourrient){var r={amount:e.orden.totalBot-e.orden.discountAmount+(null!=e.orden.discountAmount?e.orden.discountAmount:0),idBranchFk:e.idBranch,idClientFk:e.orden.phoneClient,idOrder:e.orden.idOrderH+" Anulada.",idPaymentMethodFk:13,idUserAddFk:parseInt(localStorage.getItem("idUser")),isEntry:1,nameClient:e.orden.fullNameClient,title:"Anulaci\xf3n orden:"+e.orden.idOrderH};e._walletService.NewWallet(r).subscribe()}i.a.fire("Anulada!","La orden ha sido anulada.","success").then((function(t){return e._router.navigate(["/admin/mesas/pedidos"])}))}),(function(t){e._sweetAlertsService.alertoast("No se pud\xf3 cancelar la orden","error")}))}))}},{key:"transferirOrden",value:function(){var e=this;if("Cerrada"!=this.orden.statusOrder){var t={idOrderH:this.orden.idOrderH,idOldTableFk:this.orden.idTableFk?this.orden.idTableFk:null,idNewTableFk:null};this._tableService.getTablesByEnvironmentTwo(localStorage.getItem("idBranchFk")).subscribe((function(r){for(var o={},n=0;n<r.data.length;++n)0==r.data[n].order.length&&(o[r.data[n].idTable]=r.data[n].numberTable);i.a.fire({title:"\xbfA cual mesa desea mover esta orden?",input:"select",inputPlaceholder:"Seleccione la mesa",inputAttributes:{autocapitalize:"off"},showLoaderOnConfirm:!0,showCancelButton:!0,confirmButtonColor:"#459f47",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"Mover",inputOptions:o,inputValidator:function(e){if(!e)return"Necesitas escoger una mesa";t.idNewTableFk=parseInt(e)}}).then((function(r){if(r.value){for(var n,a=0,s=Object.entries(o);a<s.length;a++){var d=_slicedToArray(s[a],2),l=d[0],c=d[1];r.value===l&&(n=c)}e._ordenService.TransferOrder(t).subscribe((function(t){i.a.fire("Movido con \xe9xito!","Su orden fue movida a la mesa "+n,"success").then((function(t){return e._router.navigate(["/admin/mesas/tablero"])}))}),(function(t){e._sweetAlertsService.alertoast("No se pud\xf3 trasnferir la orden","error")}))}}))}))}}},{key:"addInOrder",value:function(e){var t=this;this.loading=!0,this.list=!1,this.onOps=!1;for(var r={},o=0;o<this.productos.length;++o)if(this.productos[o].idProduct==e){r=this.productos[o];break}this.form.controls.busqueda.setValue(""),this.formPensable.controls.pensable.setValue("1"),this._ordenService.AddPlate(r),this._sweetAlertsService.alertoast("Agregado producto con \xe9xito.","success"),this._ordenService.GetOrder(this.orden.idOrderH).subscribe((function(e){t.bodyList=e.data.body,t.recarga()}))}},{key:"openDiscounts",value:function(e){this.discountsRef=this._modalService.open(e,{size:"lg",backdrop:"static"})}},{key:"openPaid",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;"4"!=localStorage.getItem("idProfile")||1!=this.waiterAuth?(this.textButton=r,0!==this._ordenService.platesSelected.length?null==this.orden.facturaAfip&&"Cancelado"!=this.orden.statusOrder&&(this.paidRef=this._modalService.open(e,{size:"lg",backdrop:"static"}),this.band=t,null!=o&&(this.typeOperacion=o)):this._sweetAlertsService.alertoast("No tiene ning\xfan monto por pagar","error")):this._sweetAlertsService.alertoast("No est\xe1 autorizado.","error")}},{key:"openClose",value:function(e){this._ordenService.platesSelected?this.paidRef=this._modalService.open(e,{size:"lg",backdrop:"static"}):this._sweetAlertsService.alertoast("No tiene ning\xfan monto por pagar","error")}},{key:"recarga",value:function(e){this.getOrden(!0)}},{key:"reprint",value:function(e){var t=this;null!=this._ordenService.platesSelected&&0!==this._ordenService.platesSelected.length?this._ordenService.reprint(e).subscribe((function(e){e&&"ok"==e.message&&t._sweetAlertsService.alertoast("Impresion enviada espere unos Segundos","success")}),(function(){t._sweetAlertsService.alertoast("Ha ocurrido un error.","error")})):this._sweetAlertsService.alertoast("No tiene productos seleccionados","error")}},{key:"reprintCocina",value:function(e){var t=this;null!=this._ordenService.platesSelected&&0!==this._ordenService.platesSelected.length?this._ordenService.reprintCocina(e).subscribe((function(e){e&&"ok"==e.message&&(t._sweetAlertsService.alertoast("Impresion enviada espere unos segundos.","success"),t.getOrden(!0))}),(function(){t._sweetAlertsService.alertoast("Ha ocurrido un error.","error")})):this._sweetAlertsService.alertoast("No tiene productos seleccionados","error")}},{key:"onKeyUp1",value:function(e,t){var r=this,o=document.getElementById("fullNameClient").value,i={fullNameClient:o,phoneClient:document.getElementById("phoneClient").value,address:document.getElementById("address").value,nameClient:o,comments:document.getElementById("comments").value,moso:document.getElementById("moso").value,documento:document.getElementById("documento").value,referencia:document.getElementById("referencia").value};this._ordenService.updateDataClient(t,i).subscribe((function(e){r._sweetAlertsService.alertoast("Se ha editado los datos exitosamente.","success"),r.getOrden()}))}},{key:"openPassword",value:function(e,t,r,o,i){switch(this.actionValidate=r,r){case 1:this.textValidadion=" eliminar el producto";break;case 2:this.textValidadion=" aplicar descuento";break;case 3:this.textValidadion=" aplicar impuesto";break;case 4:this.textValidadion=" anular el pedido";break;case 5:this.textValidadion=" reimprimir",this.auxIdOrderB=o;break;case 6:this.textValidadion=" enviar a cocina";break;case 7:this.textValidadion=" enviar a cuentas por cobrar.";break;case 8:this.textValidadion=" enviar a imprimir.",this.auxIdOrderB=o,this.checkedMulti=i;break;case 9:this.textValidadion=" enviar a impresi\xf3n a caja y cocina.";break;case 10:this.textValidadion=" emitir nota de credito.";break;case 11:this.textValidadion=" para emitir este tipo de descuento"}this.productIdDelete=t,this.passwordRef=this._modalService.open(e)}},{key:"getValidate",value:function(e){1==this.actionValidate&&0!=e&&this.deleteOfOrder(this.productIdDelete),2!=this.actionValidate&&3!=this.actionValidate||0!=e&&(this.realDiscount=!0),4==this.actionValidate&&0!=e&&this.anularOrden(),5==this.actionValidate&&0!=e&&this.sendPrinter(this.auxIdOrderB,this.orden.idOrderH),6==this.actionValidate&&0!=e&&this.confirmSendTicketToKitchen(this.orden.idOrderH),7==this.actionValidate&&0!=e&&this.closeOrder(),8==this.actionValidate&&0!=e&&this.multiProductsToKitchen(this.auxIdOrderB,this.checkedMulti),9==this.actionValidate&&0!=e&&this.confirmKitchenAndPrint(this.orden.idOrderH),10==this.actionValidate&&0!=e&&this.creditNoteCheck(this.orden.idOrderH),11==this.actionValidate&&0!=e&&this.setDiscount(this.tempDiscount),0==e&&this._sweetAlertsService.alertoast("C\xf3digo de autorizaci\xf3n incorrecto.","error")}},{key:"keyPressNumbers",value:function(e){var t=e.which?e.which:e.keyCode;return!(46!=t&&t>31&&(t<48||t>57)&&(e.preventDefault(),1))}},{key:"sendPrinter",value:function(e,t){var r=this;if(this.multiProductsFlag)this.productsToKitchen.forEach((function(e){var o={idOrderB:e,idOrderH:t};r._ordenService.printerOrder(o).subscribe((function(){r.getOrden(!0)}))})),this._sweetAlertsService.alertoast("Impresiones enviadas espere unos segundos.","success");else{var o={idOrderB:e,idOrderH:t};this._ordenService.printerOrder(o).subscribe((function(e){r._sweetAlertsService.alertoast("Impresi\xf3n enviada espere unos segundos.","success"),r.getOrden(!0)}))}this.productsToKitchen=[],this.multiProductsFlag=!1}},{key:"updateAmountSend",value:function(e,t){var r,o=this;this.loading=!0;var i=document.getElementById("envio").value;""!=i?r={envio:i}:(r={envio:0},document.getElementById("envio").value="0"),this._ordenService.updateAmountSend(e,r).subscribe((function(e){o._sweetAlertsService.alertoast("Envio actualizado","success"),o.recarga()}),(function(){o._sweetAlertsService.alertoast("No se ha podido actualizar el envio","error"),o.loading=!1}))}},{key:"calItems",value:function(e){return e.filter((function(e){return 0!=e.isCon})).length}},{key:"validate",value:function(e){return e.filter((function(e){return 0!=e.isCon}))}},{key:"validateInZero",value:function(e){return e.filter((function(e){return 0==e.isCon}))}},{key:"showExtras",value:function(e){var t=this;this.extrasValue=0,this.seleccionados=this.con_sin?e.listSinCon?this.validate(e.listSinCon):[]:e.recipe?this.validateInZero(e.recipe):[],this.seleccionados.totalAdicional=0;for(var r=0;r<this.seleccionados.length;++r){var o=this.seleccionados[r].priceSale*this.seleccionados[r].quantity;this.seleccionados.totalAdicional+=o}this.totalAux=this.seleccionados.totalAdicional,e.listSinCon.forEach((function(e){t.extrasValue+=e.priceSale})),this.showExtra=e.idProductFk,this.showExtraList=!this.showExtraList}},{key:"addAdditional",value:function(e,t){var r=this;this.loading=!0;var o=e.adicionals.find((function(e){return e.idProductAdicionals==+t})),i={idOrderBFk:e.idOrderB,idProductFk:o.idProductFk,idProductSinConFk:o.idProduct,quantity:1,isCon:!0,price:o.priceSale,idOrderHFk:e.idOrderHFk};this._ordenService.AddAditionalsToTheOrder(i).subscribe((function(e){r.loading=!0,r.seleccionados?(o.idProductRecipeOrder=e.data[0],r.seleccionados.splice(r.seleccionados.length,0,o)):(r.seleccionados=[],o.idProductRecipeOrder=e.data[0],r.seleccionados[0]=o),r.seleccionados.totalAdicional+=o.priceSale,r.recarga()}),(function(e){r._sweetAlertsService.alertoast("Error al agregar el extra.","error")}))}},{key:"deleteProducts",value:function(e,t,r){var o,i=this;o=this.con_sin?e.idProductRecipeOrder:e.idProductRecipeFk,this._ordenService.DeleteAditionalsToTheOrder(o).subscribe((function(r){i.seleccionados.totalAdicional-=e.priceSale,i.seleccionados.splice(t,1),i._sweetAlertsService.alertoast("Eliminado con exito","success"),i.recarga()}))}},{key:"getDiscounts",value:function(){var e=this;this._discountService.GetDiscounts().subscribe((function(t){for(var r=0;r<t.response.length;++r)"1"==t.response[r].idStatusFk&&e.discounts.splice(e.discounts.length,0,t.response[r])}))}},{key:"handleDiscount",value:function(e){this.maxDiscount>0&&e>this.maxDiscount?(this.tempDiscount=e,this.openPassword(this.passwordModaleChild,"",11)):this.setDiscount(e)}},{key:"setDiscount",value:function(e){var t=this;(+e||0==+e)&&this._ordenService.AddDiscountToTheOrder(this.orden.idOrderH,0==+e?0:+e).subscribe((function(r){t._ordenService.GetOrder(t.orden.idOrderH).subscribe((function(r){t.recarga(),0==+e?t._sweetAlertsService.alertoast("Descuento eliminado","success"):t._sweetAlertsService.alertoast("Descuento agregado","success")}))}))}},{key:"getExtras",value:function(e){var t=this;this.loading=!0,this.allExtras=[],e.adicionals,this._productService.GetProduct(e.idProduct).subscribe((function(r){var o=r.data;t.allExtras=o.adicionals,e.adicionals=o.adicionals,t.loading=!1}),(function(e){t._sweetAlertsService.alertoast("Error al obtener extras.","error"),t.loading=!0}))}},{key:"getTaxes",value:function(){var e=this;this._taxesService.GetTaxes().subscribe((function(t){var r=t.response;e.taxes=r}),(function(){e._sweetAlertsService.alertoast("Error al obtener impuestos.","error")}))}},{key:"handleTaxes",value:function(e){var t=this,r={globaltax:e};this._ordenService.addTaxToOrder(this.orden.idOrderH,r).subscribe((function(){t._ordenService.GetOrder(t.orden.idOrderH).subscribe((function(){t.recarga(),0==e?t._sweetAlertsService.alertoast("Impuesto eliminado","success"):t._sweetAlertsService.alertoast("Impuesto agregado","success")}),(function(){t._sweetAlertsService.alertoast("Error al obtener datos.","error")}))}),(function(){t._sweetAlertsService.alertoast("Error al agregar impuesto.","error")}))}},{key:"confirmSendTicketToKitchen",value:function(e){var t=this;i.a.fire({title:"Realmente quiere enviar la comanda a cocina?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#41d29d",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"Confirmar"}).then((function(r){r.isConfirmed&&t.reprintCocina(e)}))}},{key:"multiProductsToKitchen",value:function(e,t){var r=this;t?this.productsToKitchen.push(e):this.productsToKitchen.find((function(t,o){t==e&&r.productsToKitchen.splice(o,1)})),this.productsToKitchen.length>1?this.multiProductsFlag=!0:this.multiProductsFlag=!1}},{key:"disableUnits",value:function(e){if(1==this.disableUnitsButton&&e>1)return"noClick"}},{key:"creditNoteCheck",value:function(e){var t=this;"4"!=localStorage.getItem("idProfile")?2==this.orden.idStatusOrder?this.orden.documento.length<1?this._sweetAlertsService.alertoast("No se pueden emitir notas de creditos con facturas sin documento.","error",6e3):i.a.fire({title:"\xbfEst\xe1 seguro que quiere generar una nota de cr\xe9dito?",text:"No podr\xe1 revertir esta acci\xf3n.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#459f47",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"S\xed, Generar."}).then((function(r){if(r.value){t.creditNoteArr=t.fillCreditNoteArr();var o,i=_createForOfIteratorHelper(t.creditNoteArr);try{for(i.s();!(o=i.n()).done;){var n=o.value,a=n.methodsPay,s=n.amount,d={title:"N. CR\xc9DITO PEDIDO N# ".concat(t.orden.idOrderH," (").concat(t.getTypePayment(a),": ").concat(s,")"),amount:s,idUserAddFk:parseInt(localStorage.getItem("idUser")),isEntry:0,spending:0,idBranchFk:parseInt(localStorage.getItem("idBranchFk")),idCurrencyFk:1,mpCash:"mpCash"==a?s:0,mpCreditCard:"mpCreditCard"==a?s:0,mpDebitCard:"mpDebitCard"==a?s:0,mpTranferBack:"mpTranferBack"==a?s:0,mpMpago:"mpMpago"==a?s:0,mpRappi:"mpRappi"==a?s:0,mpGlovo:"mpGlovo"==a?s:0,mpUber:"mpUber"==a?s:0,mpPedidosya:"mpPedidosya"==a?s:0,mpJust:"mpJust"==a?s:0,mpWabi:"mpWabi"==a?s:0,mpOtro2:"mpOtro2"==a?s:0,mpPedidosyacash:"mpPedidosyacash"==a?s:0,mpPersonal:"mpPersonal"==a?s:0,mpRapicash:"mpRapicash"==a?s:0,mpPresent:"mpPresent"==a?s:0,mpPaypal:"mpPaypal"==a?s:0,mpZelle:"mpZelle"==a?s:0,mpBofa:"mpBofa"==a?s:0,mpYumi:"mpYumi"==a?s:0,mpbio:"mpbio"==a?s:0,idBoxFk:1,isCloseBox:!1};t._billingBoxService.register(d).subscribe((function(){}),(function(e){t._sweetAlertsService.alertoast("No se pud\xf3 registrar la operaci\xf3n.","error"),console.log("err n.cr\xe9dito billingBoxServ.register",e)}))}}catch(l){i.e(l)}finally{i.f()}t._ordenService.seniatCreditNote(e).subscribe((function(){t._ordenService.CancelOrder(e).subscribe((function(){t._sweetAlertsService.alertoast("Nota de cr\xe9dito solicitada correctamente.","success"),t._router.navigate(["/admin/mesas/pedidos"])}),(function(e){t._sweetAlertsService.alertoast("Ha ocurrido un error.","error"),console.log("err cancelOrder",e)}))}),(function(e){t._sweetAlertsService.alertoast("Ha ocurrido un error.","error"),console.log("err seniatCreditNote",e)}))}})):this._sweetAlertsService.alertoast("El pedido debe estar cerrado o facturado.","error"):this._sweetAlertsService.alertoast("No est\xe1 autorizado.","error")}},{key:"fillCreditNoteArr",value:function(){var e=this.orden,t=e.mpCash,r=e.mpCreditCard,o=e.mpDebitCard,i=e.mpTranferBack,n=e.mpMpago,a=e.mpRappi,s=e.mpGlovo,d=e.mpRapicash,l=e.mpUber,c=e.mpBofa,u=e.mpPaypal,h=e.mpPedidosya,m=e.mpPedidosyacash,p=e.mpPersonal,v=e.mpPresent,f=e.mpYumi,b=e.mpZelle,g=e.mpOtro2,S=e.mpJust,F=e.mpWabi,y=e.mpbio;return t>0&&this.creditNoteArr.push({amount:t,methodsPay:"mpCash"}),r>0&&this.creditNoteArr.push({amount:r,methodsPay:"mpCreditCard"}),o>0&&this.creditNoteArr.push({amount:o,methodsPay:"mpDebitCard"}),i>0&&this.creditNoteArr.push({amount:i,methodsPay:"mpTranferBack"}),n>0&&this.creditNoteArr.push({amount:n,methodsPay:"mpMpago"}),a>0&&this.creditNoteArr.push({amount:a,methodsPay:"mpRappi"}),s>0&&this.creditNoteArr.push({amount:s,methodsPay:"mpGlovo"}),d>0&&this.creditNoteArr.push({amount:d,methodsPay:"mpRapicash"}),l>0&&this.creditNoteArr.push({amount:l,methodsPay:"mpUber"}),c>0&&this.creditNoteArr.push({amount:c,methodsPay:"mpBofa"}),u>0&&this.creditNoteArr.push({amount:u,methodsPay:"mpPaypal"}),h>0&&this.creditNoteArr.push({amount:h,methodsPay:"mpPedidosya"}),m>0&&this.creditNoteArr.push({amount:m,methodsPay:"mpPedidosyacash"}),p>0&&this.creditNoteArr.push({amount:p,methodsPay:"mpPersonal"}),v>0&&this.creditNoteArr.push({amount:v,methodsPay:"mpPresent"}),f>0&&this.creditNoteArr.push({amount:f,methodsPay:"mpYumi"}),b>0&&this.creditNoteArr.push({amount:b,methodsPay:"mpZelle"}),g>0&&this.creditNoteArr.push({amount:g,methodsPay:"mpOtro2"}),S>0&&this.creditNoteArr.push({amount:S,methodsPay:"mpJust"}),F>0&&this.creditNoteArr.push({amount:F,methodsPay:"mpWabi"}),F>0&&this.creditNoteArr.push({amount:y,methodsPay:"mpbio"}),this.creditNoteArr}},{key:"getTypePayment",value:function(e){var t;switch(e){case"mpCash":t="E";break;case"mpCreditCard":t="C";break;case"mpDebitCard":t="D";break;case"mpTranferBack":t="T";break;case"mpMpago":t="MP";break;case"mpRappi":t="RA";break;case"mpGlovo":t="G";break;case"mpUber":t="UB";break;case"mpPedidosya":t="PEDYA";break;case"mpJust":t="EFEBOL";break;case"mpWabi":t="PMOV";break;case"mpRappi":t="RA";break;case"mpOtro2":t="OT";break;case"mpPedidosyacash":t="PEDYAE";break;case"mpPersonal":t="CPER";break;case"mpRapicash":t="RAE";break;case"mpPresent":t="R";break;case"mpPaypal":t="PAY";break;case"mpZelle":t="ZL";break;case"mpBofa":t="BO";break;case"mpYumi":t="YU";break;case"mpbio":t="BIO"}return t}},{key:"confirmKitchenAndPrint",value:function(e){var t=this;null!=this._ordenService.platesSelected&&0!==this._ordenService.platesSelected.length?i.a.fire({title:"Realmente quiere enviar la comanda a caja y cocina?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#41d29d",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"Confirmar"}).then((function(r){r.isConfirmed&&t.kitchenAndPrint(e)})):this._sweetAlertsService.alertoast("No tiene productos seleccionados","error")}},{key:"kitchenAndPrint",value:function(e){var t=this;this._sweetAlertsService.alertoast("Enviando impresi\xf3n, por favor espere.","success"),this.loading=!0,this._ordenService.reprint(e).subscribe((function(){setTimeout((function(){t._ordenService.reprintCocina(e).subscribe((function(){t._sweetAlertsService.alertoast("Impresi\xf3n enviada a caja y cocina, espere unos segundos.","success"),t.loading=!1}),(function(){t._sweetAlertsService.alertoast("Error al enviar impresi\xf3n a caja y cocina.","error")}))}),7e3)}),(function(){t._sweetAlertsService.alertoast("Error al enviar impresi\xf3n a caja y cocina.","error")}))}},{key:"openSeniat",value:function(e){}},{key:"nonTaxDoc",value:function(){var e=this;this.loading=!0,this._ordenService.GetOrder(this._adminService.orderId?this._adminService.orderId:this.table.order[0].idOrderH).subscribe((function(t){if(e.orden=t.data,null==e.orden.body||e.orden.body.length<1)return e._sweetAlertsService.alertoast("El pedido est\xe1 vacio.","error"),void(e.loading=!1);var r={};r.header="ORDEN #".concat(e.orden.idOrderH,", CLIENTE: ").concat(e.orden.fullNameClient);var o="";e.orden.body.forEach((function(t){var r=t.weight,i=t.nameProduct,n=t.priceSale;o+="".concat(r,"X ").concat(i," Bs").concat((+n*+e.dolarRate).toFixed(2),"                           \n")})),r.content=o,r.footer="TOTAL: Bs".concat((+e.TOTAL*+e.dolarRate).toFixed(2),", ENVIO: Bs").concat(null==e.orden.envio?0:(+e.orden.envio*+e.dolarRate).toFixed(2)),r.idDocument=0,r.isPrintFiscal=1,console.log(r),e._ordenService.printNonTaxDoc(r).subscribe((function(t){console.log("resp printnontaxdoc",t),e._sweetAlertsService.alertoast("Impresi\xf3n enviada","success"),e.loading=!1}),(function(t){console.log("err printnontaxdoc",t),e._sweetAlertsService.alertoast("Ha ocurrido un error. Code: printnon","error"),e.loading=!1}))}),(function(t){e._sweetAlertsService.alertoast("Error al obtener datos de la orden. Code: nontax","error"),console.log("codenontax ",t)}))}},{key:"reprintSeniat",value:function(e){var t=this;this._ordenService.ReprintSeniat(e).subscribe((function(e){console.log(e),t._sweetAlertsService.alertoast("Reimpresi\xf3n enviada.","success")}),(function(e){t._sweetAlertsService.alertoast("Ha ocurrido un error al enviar impresi\xf3n Code: printCopySeniat.","error"),console.log("err printCopySeniat",e)}))}},{key:"printCopySeniat",value:function(e){var t=this;this._ordenService.PrintCopySeniat(e).subscribe((function(e){console.log(e),t._sweetAlertsService.alertoast("Reimpresi\xf3n enviada.","success")}),(function(e){t._sweetAlertsService.alertoast("Ha ocurrido un error al enviar impresi\xf3n Code: printCopySeniat.","error"),console.log("err printCopySeniat",e)}))}},{key:"pricePDF",value:function(){if(this.bodyList.length<1)this._sweetAlertsService.alertoast("Debe agregar productos.","error");else{var e="".concat(this.myDate.day,"/").concat(this.myDate.month,"/").concat(this.myDate.year);a.vfs=s.pdfMake.vfs;var t={content:[{columns:[{table:{widths:["*"],body:[[{text:"N\xfamero de orden: "+this.orden.idOrderH,alignment:"left",bold:!0,border:[!1,!1,!0,!1],color:"#010C3A"}],[{text:"Fecha: "+e,alignment:"left",bold:!0,border:[!1,!1,!0,!1],color:"#010C3A"}],[{text:"Tasa del d\xeda: "+this.dolarRate,alignment:"left",bold:!0,border:[!1,!1,!0,!1],color:"#010C3A"}],[{text:"  ",alignment:"left",bold:!0,border:[!1,!1,!0,!1],color:"#010C3A"}],[{text:"  ",alignment:"left",bold:!0,border:[!1,!1,!0,!1],color:"#010C3A"}],[{text:"  ",alignment:"left",bold:!0,border:[!1,!1,!0,!1],color:"#010C3A"}]]}},{table:{body:[[{text:"Cliente: "+this.orden.fullNameClient,alignment:"left",bold:!0,border:[!1,!1,!1,!1],margin:[10,0,0,5],color:"#010C3A"}],[{text:"Documento: "+(null!=this.orden.documento?this.orden.documento:"N/A"),alignment:"left",bold:!0,border:[!1,!1,!1,!1],margin:[10,5],color:"#010C3A"}],[{text:"Direcci\xf3n: "+(null!=this.orden.address?this.orden.address:"N/A"),alignment:"left",bold:!0,border:[!1,!1,!1,!1],margin:[10,5],color:"#010C3A"}],[{text:"Tel\xe9fono: "+(null!=this.orden.phoneClient?this.orden.phoneClient:"N/A"),alignment:"left",bold:!0,border:[!1,!1,!1,!1],margin:[10,5,0,15],color:"#010C3A"}]]}}]},{table:{headerRows:1,widths:[250,"*","*","*"],body:[[{text:"Producto",border:[!1,!1,!1,!1],margin:[30,8,0,8],fillColor:"#010C3A",color:"#FFFFFF"},{text:"Precio unitario",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!1],margin:[0,8,0,8],fillColor:"#010C3A",color:"#FFFFFF"},{text:"Cantidad",border:[!1,!1,!1,!1],margin:[0,8,0,8],fillColor:"#010C3A",color:"#FFFFFF",alignment:"center"},{text:"Total",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!1],margin:[0,8,0,8],fillColor:"#010C3A",color:"#FFFFFF"}]].concat(_toConsumableArray(this.bodyList.map((function(e){return[{text:e.nameProduct,margin:[30,8,0,8],border:[!1,!1,!0,!1]},{text:"$"+e.priceSale,style:"tableHeader",alignment:"center",margin:[0,8,0,8],border:[!1,!1,!0,!1]},{text:e.weight,alignment:"center",margin:[0,8,0,8],border:[!1,!1,!0,!1]},{text:"$"+e.priceProductOrder,style:"tableHeader",alignment:"center",margin:[0,8,0,8],border:[!1,!1,!1,!1]}]}))),[[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"Total:",border:[!1,!1,!1,!1],fillColor:"#FFFFFF",alignment:"right",margin:[0,8,0,8]},{text:"$ "+this.TOTAL,border:[!1,!1,!1,!1],fillColor:"#FFFFFF",alignment:"right",margin:[0,8,0,8],style:"tableHeader"}],[{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"",border:[!1,!1,!1,!1],fillColor:"#FFFFFF"},{text:"Total BS:",alignment:"right",border:[!1,!1,!1,!1],fillColor:"#FFFFFF",margin:[0,8,0,8]},{text:"BS "+(this.TOTAL*this.dolarRate).toFixed(2),style:"tableHeader",alignment:"right",border:[!1,!1,!1,!1],fillColor:"#FFFFFF",margin:[0,8,0,8]}]])},layout:{vLineColor:function(e,t){return"#010C3A"},fillColor:function(e,t,r){return e%2==0?"#F2F2F2":null}},fontSize:10}],footer:function(){return{table:{widths:["*"],body:[[{text:"www.menusoftware.info",alignment:"center",fontSize:16,color:"#FFFFFF",fillColor:"#010C3A"}]]},layout:"noBorders",margin:[30,0],fontSize:10}}};a.createPdf(t).open()}}},{key:"calBsPrice",value:function(e){return(Number(e)*Number(this.dolarRate)).toFixed(2)}},{key:"nonTaxDocProduct",value:function(e){var t=this;this.loading=!0,this._ordenService.GetOrder(this._adminService.orderId?this._adminService.orderId:this.table.order[0].idOrderH).subscribe((function(r){if(t.orden=r.data,null==t.orden.body||t.orden.body.length<1)return t._sweetAlertsService.alertoast("El pedido est\xe1 vacio.","error"),void(t.loading=!1);var o={};o.header="Cliente: "+t.orden.fullNameClient;var i="",n=t.orden.body.filter((function(t){return t.idOrderB==e}));i+="".concat(n[0].quantityProduct,"X ").concat(n[0].nameProduct,"                           \n"),o.content=i,o.footer="Orden: "+t.orden.idOrderH,o.idDocument=0,o.isPrintFiscal=1,t._ordenService.printNonTaxDoc(o).subscribe((function(e){console.log("resp printnontaxdoc",e),t._sweetAlertsService.alertoast("Impresi\xf3n enviada","success"),t.loading=!1}),(function(e){console.log("err printnontaxdoc",e),t._sweetAlertsService.alertoast("Ha ocurrido un error. Code: printnon","error"),t.loading=!1}))}),(function(e){t._sweetAlertsService.alertoast("Error al obtener datos de la orden. Code: nontax","error"),console.log("codenontax ",e)}))}},{key:"filterProducts",value:function(e){if(!e)return this.productos;var t=e.toLowerCase();return this.productos.filter((function(e){return e.nameProduct.toLowerCase().includes(t)||e.barCode&&e.barCode.toLowerCase().includes(t)}))}},{key:"alert",value:function(){this._sweetAlertsService.alertoast("Debe colocar documento o n\xfamero de tel\xe9fono para enviar a cuenta","error")}}]),e}()}}]);