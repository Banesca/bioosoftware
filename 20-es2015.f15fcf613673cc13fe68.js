/*! For license information please see 20-es2015.f15fcf613673cc13fe68.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"+Cn7":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("IheW"),r=n("AytR"),o=n("8Y7J");class a{constructor(t){this.http=t,this.token=localStorage.getItem("access_token")}get headers(){return{headers:new i.g({"Access-Control-Allow-Origin":"*",Authorization:"Bearer "+localStorage.getItem("access_token")})}}NewSucursal(t){return this.http.post(r.a.production?r.a.apiHost+"/api/v2/mapas/add":"/api/v2/mapas/add",t,this.headers)}putSucursal(t){return this.http.put(r.a.production?r.a.apiHost+"/api/v2/mapas/update":"/api/v2/mapas/update",t,this.headers)}getSucursales(){return this.http.get(r.a.production?r.a.apiHost+"/api/v2/mapas/list/all":"/api/v2/mapas/list/all",this.headers)}getBackups(){return this.http.get(r.a.production?r.a.apiHost+"/api/v2/mapasGlobales/backup":"/api/v2/mapasGlobales/backup",this.headers)}getSucursalesById(t){return this.http.get(r.a.production?`${r.a.apiHost}/api/v2/mapas/list/${t}`:"/api/v2/mapas/list"+t,this.headers)}importFile(t,e){return this.http.post(r.a.production?`${r.a.apiHost}/api/v2/mapas/importmap/${e}`:"/api/v2/mapas/importmap/"+e,t,this.headers)}getStatus(t,e){return this.http.get(r.a.production?`${r.a.apiHost}/api/v2/mapasGlobales/change/status/${t}/${e}`:`/api/v2/mapasGlobales/change/status/${t}/${e}`,this.headers)}changeStatus(t,e){return this.http.get(r.a.production?`${r.a.apiHost}/api/v2/mapas/status/${t}/${e}`:`/api/v2/mapas/status/${t}/${e}`,this.headers)}getDeliveries(t){return this.http.get(r.a.production?`${r.a.apiHost}/api/v2/mapas/rappy/byidbranch/${t}`:"/api/v2/mapas/rappy/byidbranch/"+t,this.headers)}addRappi(t){return this.http.post(r.a.production?r.a.apiHost+"/api/v2/mapas/add/rappy":"/api/v2/mapas/add/rappy",t,this.headers)}updateRappi(t,e){return this.http.put(r.a.production?`${r.a.apiHost}/api/v2/mapas/change/rappy/${e}`:"/api/v2/mapas/change/rappy/"+e,t,this.headers)}}a.ngInjectableDef=o["\u0275\u0275defineInjectable"]({factory:function(){return new a(o["\u0275\u0275inject"](i.c))},token:a,providedIn:"root"})},"+qE3":function(t,e,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,o=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function l(){l.init.call(this)}t.exports=l,t.exports.once=function(t,e){return new Promise((function(n,i){function r(n){t.removeListener(e,o),i(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",r),n([].slice.call(arguments))}v(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&v(t,"error",e,n)}(t,r,{once:!0})}))},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var s=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?l.defaultMaxListeners:t._maxListeners}function p(t,e,n,i){var r,o,a,l;if(u(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]),void 0===a)a=o[e]=n,++t._eventsCount;else if("function"==typeof a?a=o[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),(r=c(t))>0&&a.length>r&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,l=s,console&&console.warn&&console.warn(l)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=h.bind(i);return r.listener=n,i.wrapFn=r,r}function f(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):g(r,r.length)}function m(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function v(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(o){i.once&&t.removeEventListener(e,r),n(o)}))}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),l.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},l.prototype.getMaxListeners=function(){return c(this)},l.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var l=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw l.context=a,l}var s=r[t];if(void 0===s)return!1;if("function"==typeof s)o(s,this,e);else{var u=s.length,c=g(s,u);for(n=0;n<u;++n)o(c[n],this,e)}return!0},l.prototype.addListener=function(t,e){return p(this,t,e,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(t,e){return p(this,t,e,!0)},l.prototype.once=function(t,e){return u(e),this.on(t,d(this,t,e)),this},l.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,d(this,t,e)),this},l.prototype.removeListener=function(t,e){var n,i,r,o,a;if(u(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,a||e)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},l.prototype.listeners=function(t){return f(this,t,!0)},l.prototype.rawListeners=function(t){return f(this,t,!1)},l.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},l.prototype.listenerCount=m,l.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},"/5w7":function(t,e,n){"use strict";t.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a"}}},"/Jvy":function(t,e,n){const i=n("hyT3"),r=n("dLdS"),o=n("GHAK");t.exports=function t(e,n={},a=null){const{type:l,coordinates:s}=e.geometry,u=e.properties&&e.properties.id;let c=[];function p(t,e){let o="",a=null;t.forEach((t,l)=>{const s=null!=e?`${e}.${l}`:String(l),p=i(u,t,s,h(s));if(n.midpoints&&a){const t=r(u,a,p,n.map);t&&c.push(t)}a=p;const d=JSON.stringify(t);o!==d&&c.push(p),0===l&&(o=d)})}function h(t){return!!n.selectedPaths&&-1!==n.selectedPaths.indexOf(t)}return l===o.geojsonTypes.POINT?c.push(i(u,s,a,h(a))):l===o.geojsonTypes.POLYGON?s.forEach((t,e)=>{p(t,null!==a?`${a}.${e}`:String(e))}):l===o.geojsonTypes.LINE_STRING?p(s,a):0===l.indexOf(o.geojsonTypes.MULTI_PREFIX)&&function(){const i=l.replace(o.geojsonTypes.MULTI_PREFIX,"");s.forEach((r,a)=>{const l={type:o.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:i,coordinates:r}};c=c.concat(t(l,n,a))})}(),c}},"0KjW":function(t,e,n){"use strict";var i=n("KXza");t.exports=i},"0wsv":function(t,e,n){"use strict";n.r(e),n.d(e,"earthRadius",(function(){return i})),n.d(e,"factors",(function(){return r})),n.d(e,"unitsFactors",(function(){return o})),n.d(e,"areaFactors",(function(){return a})),n.d(e,"feature",(function(){return l})),n.d(e,"geometry",(function(){return s})),n.d(e,"point",(function(){return u})),n.d(e,"points",(function(){return c})),n.d(e,"polygon",(function(){return p})),n.d(e,"polygons",(function(){return h})),n.d(e,"lineString",(function(){return d})),n.d(e,"lineStrings",(function(){return f})),n.d(e,"featureCollection",(function(){return m})),n.d(e,"multiLineString",(function(){return g})),n.d(e,"multiPoint",(function(){return v})),n.d(e,"multiPolygon",(function(){return y})),n.d(e,"geometryCollection",(function(){return _})),n.d(e,"round",(function(){return b})),n.d(e,"radiansToLength",(function(){return x})),n.d(e,"lengthToRadians",(function(){return w})),n.d(e,"lengthToDegrees",(function(){return C})),n.d(e,"bearingToAzimuth",(function(){return E})),n.d(e,"radiansToDegrees",(function(){return S})),n.d(e,"degreesToRadians",(function(){return T})),n.d(e,"convertLength",(function(){return I})),n.d(e,"convertArea",(function(){return P})),n.d(e,"isNumber",(function(){return A})),n.d(e,"isObject",(function(){return M})),n.d(e,"validateBBox",(function(){return k})),n.d(e,"validateId",(function(){return D}));var i=6371008.8,r={centimeters:100*i,centimetres:100*i,degrees:i/111325,feet:3.28084*i,inches:39.37*i,kilometers:i/1e3,kilometres:i/1e3,meters:i,metres:i,miles:i/1609.344,millimeters:1e3*i,millimetres:1e3*i,nauticalmiles:i/1852,radians:1,yards:1.0936*i},o={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/i,yards:1.0936133},a={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function l(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function s(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return u(e).geometry;case"LineString":return d(e).geometry;case"Polygon":return p(e).geometry;case"MultiPoint":return v(e).geometry;case"MultiLineString":return g(e).geometry;case"MultiPolygon":return y(e).geometry;default:throw new Error(t+" is invalid")}}function u(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!A(t[0])||!A(t[1]))throw new Error("coordinates must contain numbers");return l({type:"Point",coordinates:t},e,n)}function c(t,e,n){return void 0===n&&(n={}),m(t.map((function(t){return u(t,e)})),n)}function p(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return l({type:"Polygon",coordinates:t},e,n)}function h(t,e,n){return void 0===n&&(n={}),m(t.map((function(t){return p(t,e)})),n)}function d(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return l({type:"LineString",coordinates:t},e,n)}function f(t,e,n){return void 0===n&&(n={}),m(t.map((function(t){return d(t,e)})),n)}function m(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function g(t,e,n){return void 0===n&&(n={}),l({type:"MultiLineString",coordinates:t},e,n)}function v(t,e,n){return void 0===n&&(n={}),l({type:"MultiPoint",coordinates:t},e,n)}function y(t,e,n){return void 0===n&&(n={}),l({type:"MultiPolygon",coordinates:t},e,n)}function _(t,e,n){return void 0===n&&(n={}),l({type:"GeometryCollection",geometries:t},e,n)}function b(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function x(t,e){void 0===e&&(e="kilometers");var n=r[e];if(!n)throw new Error(e+" units is invalid");return t*n}function w(t,e){void 0===e&&(e="kilometers");var n=r[e];if(!n)throw new Error(e+" units is invalid");return t/n}function C(t,e){return S(w(t,e))}function E(t){var e=t%360;return e<0&&(e+=360),e}function S(t){return 180*(t%(2*Math.PI))/Math.PI}function T(t){return t%360*Math.PI/180}function I(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return x(w(t,e),n)}function P(t,e,n){if(void 0===e&&(e="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=a[e];if(!i)throw new Error("invalid original units");var r=a[n];if(!r)throw new Error("invalid final units");return t/i*r}function A(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function M(t){return!!t&&t.constructor===Object}function k(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!A(t))throw new Error("bbox must only contain numbers")}))}function D(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},"1+09":function(t,e,n){const i=t.exports=n("rGXs");i.prototype.onSetup=function(){},i.prototype.onDrag=function(){},i.prototype.onClick=function(){},i.prototype.onMouseMove=function(){},i.prototype.onMouseDown=function(){},i.prototype.onMouseUp=function(){},i.prototype.onMouseOut=function(){},i.prototype.onKeyUp=function(){},i.prototype.onKeyDown=function(){},i.prototype.onTouchStart=function(){},i.prototype.onTouchMove=function(){},i.prototype.onTouchEnd=function(){},i.prototype.onTap=function(){},i.prototype.onStop=function(){},i.prototype.onTrash=function(){},i.prototype.onCombineFeature=function(){},i.prototype.onUncombineFeature=function(){},i.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")}},"1gqn":function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"2+Hy":function(t,e,n){"use strict";var i=n("YI60"),r=n("U6jy"),o=n("uhBA"),a=n("d0rS"),l=n("jLWS"),s=1;function u(t,e){if(!t)throw new Error("MapiRequest requires a client");if(!e||!e.path||!e.method)throw new Error("MapiRequest requires an options object with path and method properties");var n={};e.body&&(n["content-type"]="application/json");var i=r(n,e.headers),a=Object.keys(i).reduce((function(t,e){return t[e.toLowerCase()]=i[e],t}),{});this.id=s++,this._options=e,this.emitter=new o,this.client=t,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=e.path,this.method=e.method,this.origin=e.origin||t.origin,this.query=e.query||{},this.params=e.params||{},this.body=e.body||null,this.file=e.file||null,this.encoding=e.encoding||"utf8",this.sendFileAs=e.sendFileAs||null,this.headers=a}u.prototype.url=function(t){var e=a.prependOrigin(this.path,this.origin);e=a.appendQueryObject(e,this.query);var n=this.params,o=null==t?this.client.accessToken:t;if(o){e=a.appendQueryParam(e,"access_token",o);var l=i(o).user;n=r({ownerId:l},n)}return e=a.interpolateRouteParams(e,n),e},u.prototype.send=function(){var t=this;if(t.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return t.sent=!0,t.client.sendRequest(t).then((function(e){return t.response=e,t.emitter.emit(l.EVENT_RESPONSE,e),e}),(function(e){throw t.error=e,t.emitter.emit(l.EVENT_ERROR,e),e}))},u.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),this.response||this.error||this.aborted||(this.aborted=!0,this.client.abortRequest(this))},u.prototype.eachPage=function(t){var e=this;function n(n){t(null,n,(function(){delete e._nextPageRequest;var t=n.nextPage();t&&(e._nextPageRequest=t,r(t))}))}function i(e){t(e,null,(function(){}))}function r(t){t.send().then(n,i)}r(this)},u.prototype.clone=function(){return this._extend()},u.prototype._extend=function(t){var e=r(this._options,t);return new u(this.client,e)},t.exports=u},"2PSg":function(t,e,n){const i=n("f4Td"),r=function(t,e){i.call(this,t,e)};r.prototype=Object.create(i.prototype),r.prototype.isValid=function(){return this.coordinates.length>1},r.prototype.addCoordinate=function(t,e,n){this.changed();const i=parseInt(t,10);this.coordinates.splice(i,0,[e,n])},r.prototype.getCoordinate=function(t){const e=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[e]))},r.prototype.removeCoordinate=function(t){this.changed(),this.coordinates.splice(parseInt(t,10),1)},r.prototype.updateCoordinate=function(t,e,n){const i=parseInt(t,10);this.coordinates[i]=[e,n],this.changed()},t.exports=r},"2U8Y":function(t,e,n){"use strict";var i="win32"===process.platform,r=n("MCLT");function o(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i];r&&"."!==r&&(".."===r?n.length&&".."!==n[n.length-1]?n.pop():e&&n.push(".."):n.push(r))}return n}function a(t){for(var e=t.length-1,n=0;n<=e&&!t[n];n++);for(var i=e;i>=0&&!t[i];i--);return 0===n&&i===e?t:n>i?[]:t.slice(n,i+1)}var l=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,s=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function c(t){var e=l.exec(t),n=(e[1]||"")+(e[2]||""),i=e[3]||"",r=s.exec(i);return[n,r[1],r[2],r[3]]}function p(t){var e=l.exec(t),n=e[1]||"",i=!!n&&":"!==n[1];return{device:n,isUnc:i,isAbsolute:i||!!e[2],tail:e[3]}}function h(t){return"\\\\"+t.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var t="",e="",n=!1,i=arguments.length-1;i>=-1;i--){var a;if(i>=0?a=arguments[i]:t?(a=process.env["="+t])&&a.substr(0,3).toLowerCase()===t.toLowerCase()+"\\"||(a=t+"\\"):a=process.cwd(),!r.isString(a))throw new TypeError("Arguments to path.resolve must be strings");if(a){var l=p(a),s=l.device,u=l.isUnc,c=l.isAbsolute,d=l.tail;if((!s||!t||s.toLowerCase()===t.toLowerCase())&&(t||(t=s),n||(e=d+"\\"+e,n=c),t&&n))break}}return u&&(t=h(t)),t+(n?"\\":"")+(e=o(e.split(/[\\\/]+/),!n).join("\\"))||"."},u.normalize=function(t){var e=p(t),n=e.device,i=e.isUnc,r=e.isAbsolute,a=e.tail,l=/[\\\/]$/.test(a);return(a=o(a.split(/[\\\/]+/),!r).join("\\"))||r||(a="."),a&&l&&(a+="\\"),i&&(n=h(n)),n+(r?"\\":"")+a},u.isAbsolute=function(t){return p(t).isAbsolute},u.join=function(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(!r.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&t.push(n)}var i=t.join("\\");return/^[\\\/]{2}[^\\\/]/.test(t[0])||(i=i.replace(/^[\\\/]{2,}/,"\\")),u.normalize(i)},u.relative=function(t,e){t=u.resolve(t),e=u.resolve(e);for(var n=t.toLowerCase(),i=e.toLowerCase(),r=a(e.split("\\")),o=a(n.split("\\")),l=a(i.split("\\")),s=Math.min(o.length,l.length),c=s,p=0;p<s;p++)if(o[p]!==l[p]){c=p;break}if(0==c)return e;var h=[];for(p=c;p<o.length;p++)h.push("..");return(h=h.concat(r.slice(c))).join("\\")},u._makeLong=function(t){if(!r.isString(t))return t;if(!t)return"";var e=u.resolve(t);return/^[a-zA-Z]\:\\/.test(e)?"\\\\?\\"+e:/^\\\\[^?.]/.test(e)?"\\\\?\\UNC\\"+e.substring(2):t},u.dirname=function(t){var e=c(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},u.basename=function(t,e){var n=c(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},u.extname=function(t){return c(t)[3]},u.format=function(t){if(!r.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!r.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);var n=t.dir,i=t.base||"";return n?n[n.length-1]===u.sep?n+i:n+u.sep+i:i},u.parse=function(t){if(!r.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=c(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},u.sep="\\",u.delimiter=";";var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f={};function m(t){return d.exec(t).slice(1)}f.resolve=function(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var i=n>=0?arguments[n]:process.cwd();if(!r.isString(i))throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,e="/"===i[0])}return(e?"/":"")+(t=o(t.split("/"),!e).join("/"))||"."},f.normalize=function(t){var e=f.isAbsolute(t),n=t&&"/"===t[t.length-1];return(t=o(t.split("/"),!e).join("/"))||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},f.isAbsolute=function(t){return"/"===t.charAt(0)},f.join=function(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];if(!r.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(t+=t?"/"+n:n)}return f.normalize(t)},f.relative=function(t,e){t=f.resolve(t).substr(1),e=f.resolve(e).substr(1);for(var n=a(t.split("/")),i=a(e.split("/")),r=Math.min(n.length,i.length),o=r,l=0;l<r;l++)if(n[l]!==i[l]){o=l;break}var s=[];for(l=o;l<n.length;l++)s.push("..");return(s=s.concat(i.slice(o))).join("/")},f._makeLong=function(t){return t},f.dirname=function(t){var e=m(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},f.basename=function(t,e){var n=m(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},f.extname=function(t){return m(t)[3]},f.format=function(t){if(!r.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!r.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);return(t.dir?t.dir+f.sep:"")+(t.base||"")},f.parse=function(t){if(!r.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=m(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return e[1]=e[1]||"",e[2]=e[2]||"",e[3]=e[3]||"",{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},f.sep="/",f.delimiter=":",t.exports=i?u:f,t.exports.posix=f,t.exports.win32=u},"2j5T":function(t,e,n){const i=n("fytV"),r=n("GHAK"),{LAT_MIN:o,LAT_MAX:a,LAT_RENDERED_MIN:l,LAT_RENDERED_MAX:s,LNG_MIN:u,LNG_MAX:c}=r;t.exports=function(t,e){let n=o,r=a,p=o,h=a,d=c,f=u;t.forEach(t=>{const e=i(t),o=e[1],a=e[3],l=e[0],s=e[2];o>n&&(n=o),a<r&&(r=a),a>p&&(p=a),o<h&&(h=o),l<d&&(d=l),s>f&&(f=s)});const m=e;return n+m.lat>s&&(m.lat=s-n),p+m.lat>a&&(m.lat=a-p),r+m.lat<l&&(m.lat=l-r),h+m.lat<o&&(m.lat=o-h),d+m.lng<=u&&(m.lng+=360*Math.ceil(Math.abs(m.lng)/360)),f+m.lng>=c&&(m.lng-=360*Math.ceil(Math.abs(m.lng)/360)),m}},"3zpe":function(t,e,n){const i=n("EX2/"),r=n("/Jvy"),o=n("n8Y1"),a=n("GHAK"),l=n("rtvZ"),s=i.modes.simple_select;s.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();const n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};o(this.getSelected(),n),this.getSelected().filter(t=>t.properties.isCircle).map(t=>t.properties.center).forEach(t=>{t[0]+=n.lng,t[1]+=n.lat}),t.dragMoveLocation=e.lngLat},s.toDisplayFeatures=function(t,e,n){if(e.properties.active=this.isSelected(e.properties.id)?a.activeStates.ACTIVE:a.activeStates.INACTIVE,n(e),this.fireActionable(),e.properties.active!==a.activeStates.ACTIVE||e.geometry.type===a.geojsonTypes.POINT)return;(e.properties.user_isCircle?l(e):r(e)).forEach(n)},t.exports=s},"4Qsb":function(t,e,n){const i=n("f4Td"),r=function(t,e){i.call(this,t,e),this.coordinates=this.coordinates.map(t=>t.slice(0,-1))};r.prototype=Object.create(i.prototype),r.prototype.isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every(t=>t.length>2)},r.prototype.incomingCoords=function(t){this.coordinates=t.map(t=>t.slice(0,-1)),this.changed()},r.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},r.prototype.addCoordinate=function(t,e,n){this.changed();const i=t.split(".").map(t=>parseInt(t,10));this.coordinates[i[0]].splice(i[1],0,[e,n])},r.prototype.removeCoordinate=function(t){this.changed();const e=t.split(".").map(t=>parseInt(t,10)),n=this.coordinates[e[0]];n&&(n.splice(e[1],1),n.length<3&&this.coordinates.splice(e[0],1))},r.prototype.getCoordinate=function(t){const e=t.split(".").map(t=>parseInt(t,10)),n=this.coordinates[e[0]];return JSON.parse(JSON.stringify(n[e[1]]))},r.prototype.getCoordinates=function(){return this.coordinates.map(t=>t.concat([t[0]]))},r.prototype.updateCoordinate=function(t,e,n){this.changed();const i=t.split("."),r=parseInt(i[0],10),o=parseInt(i[1],10);void 0===this.coordinates[r]&&(this.coordinates[r]=[]),this.coordinates[r][o]=[e,n]},t.exports=r},"4ZJM":function(t,e,n){t.exports=function(){"use strict";var t,e,n;function i(i,r){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),n=r(a),"undefined"!=typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=r;else t=r}return i(0,(function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=i;function i(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){var n,i,r,o,a;for(void 0===e&&(e=1e-6),r=t,a=0;a<8;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var l=this.sampleCurveDerivativeX(r);if(Math.abs(l)<1e-6)break;r-=o/l}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var r=o;function o(t,e){this.x=t,this.y=e}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var a="undefined"!=typeof self?self:{},l=Math.pow(2,53)-1;function s(t,e,i,r){var o=new n(t,e,i,r);return function(t){return o.solve(t)}}var u=s(.25,.1,.25,1);function c(t,e,n){return Math.min(n,Math.max(e,t))}function p(t,e,n){var i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r}function h(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}var d=1;function f(){return d++}function m(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function g(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function v(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function y(t,e){return-1!==t.indexOf(e,t.length-e.length)}function _(t,e,n){var i={};for(var r in t)i[r]=e.call(n||this,t[r],r,t);return i}function b(t,e,n){var i={};for(var r in t)e.call(n||this,t[r],r,t)&&(i[r]=t[r]);return i}function x(t){return Array.isArray(t)?t.map(x):"object"==typeof t&&t?_(t,x):t}var w={};function C(t){w[t]||("undefined"!=typeof console&&console.warn(t),w[t]=!0)}function E(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function S(t){for(var e=0,n=0,i=t.length,r=i-1,o=void 0,a=void 0;n<i;r=n++)e+=((a=t[r]).x-(o=t[n]).x)*(o.y+a.y);return e}function T(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function I(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,n,i,r){var o=i||r;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}var P=null;function A(t){if(null==P){var e=t.navigator?t.navigator.userAgent:null;P=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return P}function M(t){try{var e=a[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var k,D,L,O,R=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now.bind(Date),z=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,F=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame,B={now:R,frame:function(t){var e=z(t);return{cancel:function(){return F(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var n=a.document.createElement("canvas"),i=n.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,i.drawImage(t,0,0,t.width,t.height),i.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return k||(k=a.document.createElement("a")),k.href=t,k.href},hardwareConcurrency:a.navigator&&a.navigator.hardwareConcurrency||4,get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return!!a.matchMedia&&(null==D&&(D=a.matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}},N={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},U={supported:!1,testSupport:function(t){!j&&O&&(V?q(t):L=t)}},j=!1,V=!1;function q(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,O),t.isContextLost())return;U.supported=!0}catch(t){}t.deleteTexture(e),j=!0}a.document&&((O=a.document.createElement("img")).onload=function(){L&&q(L),L=null,V=!0},O.onerror=function(){j=!0,L=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var G="01",Z=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function H(t){return 0===t.indexOf("mapbox:")}Z.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",G,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},Z.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Z.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},Z.prototype.normalizeStyleURL=function(t,e){if(!H(t))return t;var n=K(t);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},Z.prototype.normalizeGlyphsURL=function(t,e){if(!H(t))return t;var n=K(t);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},Z.prototype.normalizeSourceURL=function(t,e){if(!H(t))return t;var n=K(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)},Z.prototype.normalizeSpriteURL=function(t,e,n,i){var r=K(t);return H(t)?(r.path="/styles/v1"+r.path+"/sprite"+e+n,this._makeAPIURL(r,this._customAccessToken||i)):(r.path+=""+e+n,J(r))},Z.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!H(t))return t;var n=K(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,(B.devicePixelRatio>=2||512===e?"@2x":"")+(U.supported?".webp":"$1")),n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/v4"+n.path;var i=this._customAccessToken||function(t){for(var e=0,n=t;e<n.length;e+=1){var i=n[e].match(/^access_token=(.*)$/);if(i)return i[1]}return null}(n.params)||N.ACCESS_TOKEN;return N.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&n.params.push("sku="+this._skuToken),this._makeAPIURL(n,i)},Z.prototype.canonicalizeTileURL=function(t,e){var n=K(t);if(!n.path.match(/(^\/v4\/)/)||!n.path.match(/\.[\w]+$/))return t;var i="mapbox://tiles/";i+=n.path.replace("/v4/","");var r=n.params;return e&&(r=r.filter((function(t){return!t.match(/^access_token=/)}))),r.length&&(i+="?"+r.join("&")),i},Z.prototype.canonicalizeTileset=function(t,e){for(var n=!!e&&H(e),i=[],r=0,o=t.tiles||[];r<o.length;r+=1){var a=o[r];X(a)?i.push(this.canonicalizeTileURL(a,n)):i.push(a)}return i},Z.prototype._makeAPIURL=function(t,e){var n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",i=K(N.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"http"===t.protocol){var r=t.params.indexOf("secure");r>=0&&t.params.splice(r,1)}if("/"!==i.path&&(t.path=""+i.path+t.path),!N.REQUIRE_ACCESS_TOKEN)return J(t);if(!(e=e||N.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n);return t.params=t.params.filter((function(t){return-1===t.indexOf("access_token")})),t.params.push("access_token="+e),J(t)};var Y=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function X(t){return Y.test(t)}var W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function K(t){var e=t.match(W);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function J(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function $(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(e[1]).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(t){return null}}var Q=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Q.prototype.getStorageKey=function(t){var e,n=$(N.ACCESS_TOKEN);return e=n&&n.u?a.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))}))):N.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},Q.prototype.fetchEventData=function(){var t=M("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{var i=a.localStorage.getItem(e);i&&(this.eventData=JSON.parse(i));var r=a.localStorage.getItem(n);r&&(this.anonId=r)}catch(t){C("Unable to read from LocalStorage")}},Q.prototype.saveEventData=function(){var t=M("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{a.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&a.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){C("Unable to write to LocalStorage")}},Q.prototype.processRequests=function(t){},Q.prototype.postEvent=function(t,e,n,i){var r=this;if(N.EVENTS_URL){var o=K(N.EVENTS_URL);o.params.push("access_token="+(i||N.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:G,userId:this.anonId},l=e?h(a,e):a,s={url:J(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([l])};this.pendingRequest=xt(s,(function(t){r.pendingRequest=null,n(t),r.saveEventData(),r.processRequests(i)}))}},Q.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var tt,et,nt=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(t,e,n,i){this.skuToken=n;var r=!(!i&&!N.ACCESS_TOKEN),o=Array.isArray(t)&&t.some((function(t){return H(t)||X(t)}));N.EVENTS_URL&&r&&o&&this.queueRequest({id:e,timestamp:Date.now()},i)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),i=n.id,r=n.timestamp;i&&this.success[i]||(this.anonId||this.fetchEventData(),g(this.anonId)||(this.anonId=m()),this.postEvent(r,{skuToken:this.skuToken},(function(t){t||i&&(e.success[i]=!0)}),t))}},e}(Q),it=new(function(t){function e(e){t.call(this,"appUserTurnstile"),this._customAccessToken=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(t,e){N.EVENTS_URL&&N.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return H(t)||X(t)}))&&this.queueRequest(Date.now(),e)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var n=$(N.ACCESS_TOKEN),i=n?n.u:N.ACCESS_TOKEN,r=i!==this.eventData.tokenU;g(this.anonId)||(this.anonId=m(),r=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),l=new Date(o),s=(o-this.eventData.lastSuccess)/864e5;r=r||s>=1||s<-1||a.getDate()!==l.getDate()}else r=!0;if(!r)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},(function(t){t||(e.eventData.lastSuccess=o,e.eventData.tokenU=i)}),t)}},e}(Q)),rt=it.postTurnstileEvent.bind(it),ot=new nt,at=ot.postMapLoadEvent.bind(ot),lt=500,st=50;function ut(){a.caches&&!tt&&(tt=a.caches.open("mapbox-tiles"))}function ct(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var pt,ht=1/0;function dt(){return null==pt&&(pt=a.OffscreenCanvas&&new a.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.createImageBitmap),pt}var ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ft);var mt,gt,vt=function(t){function e(e,n,i){401===n&&X(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,e),this.status=n,this.url=i,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),yt=T()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===a.location.protocol?a.parent:a).location.href},_t=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(yt())&&!/^\w+:/.test(n))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(t,e){var n,i=new a.AbortController,r=new a.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:yt(),signal:i.signal}),o=!1,l=!1,s=(n=r.url).indexOf("sku=")>0&&X(n);"json"===t.type&&r.headers.set("Accept","application/json");var u=function(n,i,o){if(!l){if(n&&"SecurityError"!==n.message&&C(n),i&&o)return c(i);var u=Date.now();a.fetch(r).then((function(n){if(n.ok){var i=s?n.clone():null;return c(n,i,u)}return e(new vt(n.statusText,n.status,t.url))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}},c=function(n,i,s){("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((function(t){l||(i&&s&&function(t,e,n){if(ut(),tt){var i={status:e.status,statusText:e.statusText,headers:new a.Headers};e.headers.forEach((function(t,e){return i.headers.set(e,t)}));var r=I(e.headers.get("Cache-Control")||"");r["no-store"]||(r["max-age"]&&i.headers.set("Expires",new Date(n+1e3*r["max-age"]).toUTCString()),new Date(i.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===et)try{new Response(new ReadableStream),et=!0}catch(t){et=!1}et?e(t.body):t.blob().then(e)}(e,(function(e){var n=new a.Response(e,i);ut(),tt&&tt.then((function(e){return e.put(ct(t.url),n)})).catch((function(t){return C(t.message)}))})))}}(r,i,s),o=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(t){l||e(new Error(t.message))}))};return s?function(t,e){if(ut(),!tt)return e(null);var n=ct(t.url);tt.then((function(t){t.match(n).then((function(i){var r=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),n=I(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(i);t.delete(n),r&&t.put(n,i.clone()),e(null,i,r)})).catch(e)})).catch(e)}(r,u):u(null,null),{cancel:function(){l=!0,o||i.abort()}}}(t,e);if(T()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){var n=new a.XMLHttpRequest;for(var i in n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)n.setRequestHeader(i,t.headers[i]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var i=n.response;if("json"===t.type)try{i=JSON.parse(n.response)}catch(t){return e(t)}e(null,i,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new vt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:function(){return n.abort()}}}(t,e)},bt=function(t,e){return _t(h(t,{type:"arrayBuffer"}),e)},xt=function(t,e){return _t(h(t,{method:"POST"}),e)},wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";mt=[],gt=0;var Ct=function(t,e){if(U.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),gt>=N.MAX_PARALLEL_IMAGE_REQUESTS){var n={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return mt.push(n),n}gt++;var i=!1,r=function(){if(!i)for(i=!0,gt--;mt.length&&gt<N.MAX_PARALLEL_IMAGE_REQUESTS;){var t=mt.shift();t.cancelled||(t.cancel=Ct(t.requestParameters,t.callback).cancel)}},o=bt(t,(function(t,n,i,o){r(),t?e(t):n&&(dt()?function(t,e){var n=new a.Blob([new Uint8Array(t)],{type:"image/png"});a.createImageBitmap(n).then((function(t){e(null,t)})).catch((function(t){e(new Error("Could not load image because of "+t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(n,e):function(t,e,n,i){var r=new a.Image,o=a.URL;r.onload=function(){e(null,r),o.revokeObjectURL(r.src),r.onload=null,a.requestAnimationFrame((function(){r.src=wt}))},r.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var l=new a.Blob([new Uint8Array(t)],{type:"image/png"});r.cacheControl=n,r.expires=i,r.src=t.byteLength?o.createObjectURL(l):wt}(n,e,i,o))}));return{cancel:function(){o.cancel(),r()}}};function Et(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function St(t,e,n){if(n&&n[t]){var i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}var Tt=function(t,e){void 0===e&&(e={}),h(this,e),this.type=t},It=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",h({error:e},n))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Tt),Pt=function(){};Pt.prototype.on=function(t,e){return this._listeners=this._listeners||{},Et(t,e,this._listeners),this},Pt.prototype.off=function(t,e){return St(t,e,this._listeners),St(t,e,this._oneTimeListeners),this},Pt.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},Et(t,e,this._oneTimeListeners),this},Pt.prototype.fire=function(t,e){"string"==typeof t&&(t=new Tt(t,e||{}));var n=t.type;if(this.listens(n)){t.target=this;for(var i=0,r=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];i<r.length;i+=1)r[i].call(this,t);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];o<a.length;o+=1){var l=a[o];St(n,l,this._oneTimeListeners),l.call(this,t)}var s=this._eventedParent;s&&(h(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else t instanceof It&&console.error(t.error);return this},Pt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Pt.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var At={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Mt=function(t,e,n,i){this.message=(t?t+": ":"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)};function kt(t){var e=t.value;return e?[new Mt(t.key,e,"constants have been deprecated as of v8")]:[]}function Dt(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}function Lt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ot(t){if(Array.isArray(t))return t.map(Ot);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var n in t)e[n]=Ot(t[n]);return e}return Lt(t)}var Rt=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),zt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,i=e;n<i.length;n+=1){var r=i[n];this.bindings[r[0]]=r[1]}};zt.prototype.concat=function(t){return new zt(this,t)},zt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},zt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Ft={kind:"null"},Bt={kind:"number"},Nt={kind:"string"},Ut={kind:"boolean"},jt={kind:"color"},Vt={kind:"object"},qt={kind:"value"},Gt={kind:"collator"},Zt={kind:"formatted"},Ht={kind:"resolvedImage"};function Yt(t,e){return{kind:"array",itemType:t,N:e}}function Xt(t){if("array"===t.kind){var e=Xt(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Wt=[Ft,Bt,Nt,Ut,jt,Zt,Vt,Yt(qt),Ht];function Kt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Kt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,i=Wt;n<i.length;n+=1)if(!Kt(i[n],e))return null}return"Expected "+Xt(t)+" but found "+Xt(e)+" instead."}function Jt(t,e){return e.some((function(e){return e.kind===t.kind}))}function $t(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var Qt=e((function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(t){return(t=Math.round(t))<0?0:t>255?255:t}function r(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function a(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,l=t.replace(/ /g,"").toLowerCase();if(l in n)return n[l].slice();if("#"===l[0])return 4===l.length?(e=parseInt(l.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===l.length&&(e=parseInt(l.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=l.indexOf("("),u=l.indexOf(")");if(-1!==s&&u+1===l.length){var c=l.substr(0,s),p=l.substr(s+1,u-(s+1)).split(","),h=1;switch(c){case"rgba":if(4!==p.length)return null;h=o(p.pop());case"rgb":return 3!==p.length?null:[r(p[0]),r(p[1]),r(p[2]),h];case"hsla":if(4!==p.length)return null;h=o(p.pop());case"hsl":if(3!==p.length)return null;var d=(parseFloat(p[0])%360+360)%360/360,f=o(p[1]),m=o(p[2]),g=m<=.5?m*(f+1):m+f-m*f,v=2*m-g;return[i(255*a(v,g,d+1/3)),i(255*a(v,g,d)),i(255*a(v,g,d-1/3)),h];default:return null}}return null}}catch(t){}})).parseCSSColor,te=function(t,e,n,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=n,this.a=i};te.parse=function(t){if(t){if(t instanceof te)return t;if("string"==typeof t){var e=Qt(t);if(e)return new te(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},te.prototype.toString=function(){var t=this.toArray(),e=t[1],n=t[2],i=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(n)+","+i+")"},te.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},te.black=new te(0,0,0,1),te.white=new te(1,1,1,1),te.transparent=new te(0,0,0,0),te.red=new te(1,0,0,1);var ee=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ee.prototype.compare=function(t,e){return this.collator.compare(t,e)},ee.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ne=function(t,e,n,i,r){this.text=t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r},ie=function(t){this.sections=t};ie.fromString=function(t){return new ie([new ne(t,null,null,null,null)])},ie.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},ie.factory=function(t){return t instanceof ie?t:ie.fromString(t)},ie.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},ie.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];if(i.image)t.push(["image",i.image.name]);else{t.push(i.text);var r={};i.fontStack&&(r["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(r["font-scale"]=i.scale),i.textColor&&(r["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(r)}}return t};var re=function(t){this.name=t.name,this.available=t.available};function oe(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value ["+[t,e,n,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ae(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof te)return!0;if(t instanceof ee)return!0;if(t instanceof ie)return!0;if(t instanceof re)return!0;if(Array.isArray(t)){for(var e=0,n=t;e<n.length;e+=1)if(!ae(n[e]))return!1;return!0}if("object"==typeof t){for(var i in t)if(!ae(t[i]))return!1;return!0}return!1}function le(t){if(null===t)return Ft;if("string"==typeof t)return Nt;if("boolean"==typeof t)return Ut;if("number"==typeof t)return Bt;if(t instanceof te)return jt;if(t instanceof ee)return Gt;if(t instanceof ie)return Zt;if(t instanceof re)return Ht;if(Array.isArray(t)){for(var e,n=t.length,i=0,r=t;i<r.length;i+=1){var o=le(r[i]);if(e){if(e===o)continue;e=qt;break}e=o}return Yt(e||qt,n)}return Vt}function se(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof te||t instanceof ie||t instanceof re?t.toString():JSON.stringify(t)}re.prototype.toString=function(){return this.name},re.fromString=function(t){return t?new re({name:t,available:!1}):null},re.prototype.serialize=function(){return["image",this.name]};var ue=function(t,e){this.type=t,this.value=e};ue.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!ae(t[1]))return e.error("invalid value");var n=t[1],i=le(n),r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new ue(i,n)},ue.prototype.evaluate=function(){return this.value},ue.prototype.eachChild=function(){},ue.prototype.outputDefined=function(){return!0},ue.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof te?["rgba"].concat(this.value.toArray()):this.value instanceof ie?this.value.serialize():this.value};var ce=function(t){this.name="ExpressionEvaluationError",this.message=t};ce.prototype.toJSON=function(){return this.message};var pe={string:Nt,number:Bt,boolean:Ut,object:Vt},he=function(t,e){this.type=t,this.args=e};he.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,i=1,r=t[0];if("array"===r){var o,a;if(t.length>2){var l=t[1];if("string"!=typeof l||!(l in pe)||"object"===l)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=pe[l],i++}else o=qt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],i++}n=Yt(o,a)}else n=pe[r];for(var s=[];i<t.length;i++){var u=e.parse(t[i],i,qt);if(!u)return null;s.push(u)}return new he(n,s)},he.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Kt(this.type,le(n)))return n;if(e===this.args.length-1)throw new ce("Expected value to be of type "+Xt(this.type)+", but found "+Xt(le(n))+" instead.")}return null},he.prototype.eachChild=function(t){this.args.forEach(t)},he.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},he.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var de=function(t){this.type=Zt,this.sections=t};de.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");for(var i=[],r=!1,o=1;o<=t.length-1;++o){var a=t[o];if(r&&"object"==typeof a&&!Array.isArray(a)){r=!1;var l=null;if(a["font-scale"]&&!(l=e.parse(a["font-scale"],1,Bt)))return null;var s=null;if(a["text-font"]&&!(s=e.parse(a["text-font"],1,Yt(Nt))))return null;var u=null;if(a["text-color"]&&!(u=e.parse(a["text-color"],1,jt)))return null;var c=i[i.length-1];c.scale=l,c.font=s,c.textColor=u}else{var p=e.parse(t[o],1,qt);if(!p)return null;var h=p.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:p,scale:null,font:null,textColor:null})}}return new de(i)},de.prototype.evaluate=function(t){return new ie(this.sections.map((function(e){var n=e.content.evaluate(t);return le(n)===Ht?new ne("",n,null,null,null):new ne(se(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},de.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}},de.prototype.outputDefined=function(){return!1},de.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t.push(i.content.serialize());var r={};i.scale&&(r["font-scale"]=i.scale.serialize()),i.font&&(r["text-font"]=i.font.serialize()),i.textColor&&(r["text-color"]=i.textColor.serialize()),t.push(r)}return t};var fe=function(t){this.type=Ht,this.input=t};fe.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Nt);return n?new fe(n):e.error("No image name provided.")},fe.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=re.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n},fe.prototype.eachChild=function(t){t(this.input)},fe.prototype.outputDefined=function(){return!1},fe.prototype.serialize=function(){return["image",this.input.serialize()]};var me={"to-boolean":Ut,"to-color":jt,"to-number":Bt,"to-string":Nt},ge=function(t,e){this.type=t,this.args=e};ge.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var i=me[n],r=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,qt);if(!a)return null;r.push(a)}return new ge(i,r)},ge.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,i=0,r=this.args;i<r.length;i+=1){if(n=null,(e=r[i].evaluate(t))instanceof te)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":oe(e[0],e[1],e[2],e[3])))return new te(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ce(n||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,l=0,s=this.args;l<s.length;l+=1){if(null===(a=s[l].evaluate(t)))return 0;var u=Number(a);if(!isNaN(u))return u}throw new ce("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?ie.fromString(se(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?re.fromString(se(this.args[0].evaluate(t))):se(this.args[0].evaluate(t))},ge.prototype.eachChild=function(t){this.args.forEach(t)},ge.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},ge.prototype.serialize=function(){if("formatted"===this.type.kind)return new de([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new fe(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var ve=["Unknown","Point","LineString","Polygon"],ye=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ye.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ye.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ve[this.feature.type]:this.feature.type:null},ye.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ye.prototype.canonicalID=function(){return this.canonical},ye.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ye.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=te.parse(t)),e};var _e=function(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i};_e.prototype.evaluate=function(t){return this._evaluate(t,this.args)},_e.prototype.eachChild=function(t){this.args.forEach(t)},_e.prototype.outputDefined=function(){return!1},_e.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},_e.parse=function(t,e){var n,i=t[0],r=_e.definitions[i];if(!r)return e.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(r)?r[0]:r.type,a=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,l=a.filter((function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1})),s=null,u=0,c=l;u<c.length;u+=1){var p=c[u],h=p[0],d=p[1];s=new je(e.registry,e.path,null,e.scope);for(var f=[],m=!1,g=1;g<t.length;g++){var v=t[g],y=Array.isArray(h)?h[g-1]:h.type,_=s.parse(v,1+f.length,y);if(!_){m=!0;break}f.push(_)}if(!m)if(Array.isArray(h)&&h.length!==f.length)s.error("Expected "+h.length+" arguments, but found "+f.length+" instead.");else{for(var b=0;b<f.length;b++){var x=Array.isArray(h)?h[b]:h.type,w=f[b];s.concat(b+1).checkSubtype(x,w.type)}if(0===s.errors.length)return new _e(i,o,d,f)}}if(1===l.length)(n=e.errors).push.apply(n,s.errors);else{for(var C=(l.length?l:a).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(Xt).join(", ")+")":"("+Xt(e.type)+"...)"})).join(" | "),E=[],S=1;S<t.length;S++){var T=e.parse(t[S],1+E.length);if(!T)return null;E.push(Xt(T.type))}e.error("Expected arguments of type "+C+", but found ("+E.join(", ")+") instead.")}return null},_e.register=function(t,e){for(var n in _e.definitions=e,e)t[n]=_e};var be=function(t,e,n){this.type=Gt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function xe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function we(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ce(t,e){var n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(n*r*8192),Math.round(i*r*8192)]}function Ee(t,e,n){return e[1]>t[1]!=n[1]>t[1]&&t[0]<(n[0]-e[0])*(t[1]-e[1])/(n[1]-e[1])+e[0]}function Se(t,e){for(var n,i,r,o,a,l,s,u=!1,c=0,p=e.length;c<p;c++)for(var h=e[c],d=0,f=h.length;d<f-1;d++){if((o=(n=t)[0]-(i=h[d])[0])*(s=n[1]-(r=h[d+1])[1])-(l=n[0]-r[0])*(a=n[1]-i[1])==0&&o*l<=0&&a*s<=0)return!1;Ee(t,h[d],h[d+1])&&(u=!u)}return u}function Te(t,e){for(var n=0;n<e.length;n++)if(Se(t,e[n]))return!0;return!1}function Ie(t,e,n,i){var r=i[0]-n[0],o=i[1]-n[1],a=(t[0]-n[0])*o-r*(t[1]-n[1]),l=(e[0]-n[0])*o-r*(e[1]-n[1]);return a>0&&l<0||a<0&&l>0}function Pe(t,e,n){for(var i=0,r=n;i<r.length;i+=1)for(var o=r[i],a=0;a<o.length-1;++a)if(0!=(p=[(c=o[a+1])[0]-(u=o[a])[0],c[1]-u[1]])[0]*(h=[(s=e)[0]-(l=t)[0],s[1]-l[1]])[1]-p[1]*h[0]&&Ie(l,s,u,c)&&Ie(u,c,l,s))return!0;var l,s,u,c,p,h;return!1}function Ae(t,e){for(var n=0;n<t.length;++n)if(!Se(t[n],e))return!1;for(var i=0;i<t.length-1;++i)if(Pe(t[i],t[i+1],e))return!1;return!0}function Me(t,e){for(var n=0;n<e.length;n++)if(Ae(t,e[n]))return!0;return!1}function ke(t,e,n){for(var i=[],r=0;r<t.length;r++){for(var o=[],a=0;a<t[r].length;a++){var l=Ce(t[r][a],n);xe(e,l),o.push(l)}i.push(o)}return i}function De(t,e,n){for(var i=[],r=0;r<t.length;r++){var o=ke(t[r],e,n);i.push(o)}return i}function Le(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){var r=.5*i,o=t[0]-n[0]>r?-i:n[0]-t[0]>r?i:0;0===o&&(o=t[0]-n[2]>r?-i:n[2]-t[0]>r?i:0),t[0]+=o}xe(e,t)}function Oe(t,e,n,i){for(var r=8192*Math.pow(2,i.z),o=[8192*i.x,8192*i.y],a=[],l=0,s=t;l<s.length;l+=1)for(var u=0,c=s[l];u<c.length;u+=1){var p=c[u],h=[p.x+o[0],p.y+o[1]];Le(h,e,n,r),a.push(h)}return a}function Re(t,e,n,i){for(var r,o=8192*Math.pow(2,i.z),a=[8192*i.x,8192*i.y],l=[],s=0,u=t;s<u.length;s+=1){for(var c=[],p=0,h=u[s];p<h.length;p+=1){var d=h[p],f=[d.x+a[0],d.y+a[1]];xe(e,f),c.push(f)}l.push(c)}if(e[2]-e[0]<=o/2){(r=e)[0]=r[1]=1/0,r[2]=r[3]=-1/0;for(var m=0,g=l;m<g.length;m+=1)for(var v=0,y=g[m];v<y.length;v+=1)Le(y[v],e,n,o)}return l}be.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Ut);if(!i)return null;var r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Ut);if(!r)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,Nt))?null:new be(i,r,o)},be.prototype.evaluate=function(t){return new ee(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},be.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},be.prototype.outputDefined=function(){return!1},be.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var ze=function(t,e){this.type=Ut,this.geojson=t,this.geometries=e};function Fe(t){if(t instanceof _e){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof ze)return!1;var e=!0;return t.eachChild((function(t){e&&!Fe(t)&&(e=!1)})),e}function Be(t){if(t instanceof _e&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Be(t)&&(e=!1)})),e}function Ne(t,e){if(t instanceof _e&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!Ne(t,e)&&(n=!1)})),n}ze.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(ae(t[1])){var n=t[1];if("FeatureCollection"===n.type)for(var i=0;i<n.features.length;++i){var r=n.features[i].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new ze(n,n.features[i].geometry)}else if("Feature"===n.type){var o=n.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new ze(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new ze(n,n)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ze.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){var o=ke(e.coordinates,i,r),a=Oe(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var l=0,s=a;l<s.length;l+=1)if(!Se(s[l],o))return!1}if("MultiPolygon"===e.type){var u=De(e.coordinates,i,r),c=Oe(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var p=0,h=c;p<h.length;p+=1)if(!Te(h[p],u))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){var o=ke(e.coordinates,i,r),a=Re(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var l=0,s=a;l<s.length;l+=1)if(!Ae(s[l],o))return!1}if("MultiPolygon"===e.type){var u=De(e.coordinates,i,r),c=Re(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var p=0,h=c;p<h.length;p+=1)if(!Me(h[p],u))return!1}return!0}(t,this.geometries)}return!1},ze.prototype.eachChild=function(){},ze.prototype.outputDefined=function(){return!0},ze.prototype.serialize=function(){return["within",this.geojson]};var Ue=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Ue.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Ue(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Ue.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Ue.prototype.eachChild=function(){},Ue.prototype.outputDefined=function(){return!1},Ue.prototype.serialize=function(){return["var",this.name]};var je=function(t,e,n,i,r){void 0===e&&(e=[]),void 0===i&&(i=new zt),void 0===r&&(r=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=i,this.errors=r,this.expectedType=n};function Ve(t,e){for(var n,i=t.length-1,r=0,o=i,a=0;r<=o;)if((n=t[a=Math.floor((r+o)/2)])<=e){if(a===i||e<t[a+1])return a;r=a+1}else{if(!(n>e))throw new ce("Input is not a number.");o=a-1}return 0}je.prototype.parse=function(t,e,n,i,r){return void 0===r&&(r={}),e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)},je.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new he(e,[t]):"coerce"===n?new ge(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=t[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var r=this.registry[i];if(r){var o=r.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,l=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==l.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==l.kind&&"string"!==l.kind){if(this.checkSubtype(a,l))return null}else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"assert")}if(!(o instanceof ue)&&"resolvedImage"!==o.type.kind&&function t(e){if(e instanceof Ue)return t(e.boundExpression);if(e instanceof _e&&"error"===e.name)return!1;if(e instanceof be)return!1;if(e instanceof ze)return!1;var n=e instanceof ge||e instanceof he,i=!0;return e.eachChild((function(e){i=n?i&&t(e):i&&e instanceof ue})),!!i&&Fe(e)&&Ne(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var s=new ye;try{o=new ue(o.type,o.evaluate(s))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},je.prototype.concat=function(t,e,n){var i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new je(this.registry,i,e||null,r,this.errors)},je.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new Rt(i,t))},je.prototype.checkSubtype=function(t,e){var n=Kt(t,e);return n&&this.error(n),n};var qe=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,r=n;i<r.length;i+=1){var o=r[i],a=o[1];this.labels.push(o[0]),this.outputs.push(a)}};function Ge(t,e,n){return t*(1-n)+e*n}qe.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var n=e.parse(t[1],1,Bt);if(!n)return null;var i=[],r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],l=t[o+1],s=o,u=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(i.length&&i[i.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);var c=e.parse(l,u,r);if(!c)return null;r=r||c.type,i.push([a,c])}return new qe(r,n,i)},qe.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[Ve(e,i)].evaluate(t)},qe.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},qe.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},qe.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Ze=Object.freeze({__proto__:null,number:Ge,color:function(t,e,n){return new te(Ge(t.r,e.r,n),Ge(t.g,e.g,n),Ge(t.b,e.b,n),Ge(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,i){return Ge(t,e[i],n)}))}}),He=6/29*3*(6/29),Ye=Math.PI/180,Xe=180/Math.PI;function We(t){return t>.008856451679035631?Math.pow(t,1/3):t/He+4/29}function Ke(t){return t>6/29?t*t*t:He*(t-4/29)}function Je(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function $e(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Qe(t){var e=$e(t.r),n=$e(t.g),i=$e(t.b),r=We((.4124564*e+.3575761*n+.1804375*i)/.95047),o=We((.2126729*e+.7151522*n+.072175*i)/1);return{l:116*o-16,a:500*(r-o),b:200*(o-We((.0193339*e+.119192*n+.9503041*i)/1.08883)),alpha:t.a}}function tn(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*Ke(e),n=.95047*Ke(n),i=1.08883*Ke(i),new te(Je(3.2404542*n-1.5371385*e-.4985314*i),Je(-.969266*n+1.8760108*e+.041556*i),Je(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function en(t,e,n){var i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}var nn={forward:Qe,reverse:tn,interpolate:function(t,e,n){return{l:Ge(t.l,e.l,n),a:Ge(t.a,e.a,n),b:Ge(t.b,e.b,n),alpha:Ge(t.alpha,e.alpha,n)}}},rn={forward:function(t){var e=Qe(t),n=e.l,i=e.a,r=e.b,o=Math.atan2(r,i)*Xe;return{h:o<0?o+360:o,c:Math.sqrt(i*i+r*r),l:n,alpha:t.a}},reverse:function(t){var e=t.h*Ye,n=t.c;return tn({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:en(t.h,e.h,n),c:Ge(t.c,e.c,n),l:Ge(t.l,e.l,n),alpha:Ge(t.alpha,e.alpha,n)}}},on=Object.freeze({__proto__:null,lab:nn,hcl:rn}),an=function(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(var o=0,a=r;o<a.length;o+=1){var l=a[o],s=l[1];this.labels.push(l[0]),this.outputs.push(s)}};function ln(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}an.interpolationFactor=function(t,e,i,r){var o=0;if("exponential"===t.name)o=ln(e,t.base,i,r);else if("linear"===t.name)o=ln(e,1,i,r);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new n(a[0],a[1],a[2],a[3]).solve(ln(e,1,i,r))}return o},an.parse=function(t,e){var n=t[0],i=t[1],r=t[2],o=t.slice(3);if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var a=i[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:a}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type "+String(i[0]),1,0);var l=i.slice(1);if(4!==l.length||l.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:l}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,2,Bt)))return null;var s=[],u=null;"interpolate-hcl"===n||"interpolate-lab"===n?u=jt:e.expectedType&&"value"!==e.expectedType.kind&&(u=e.expectedType);for(var c=0;c<o.length;c+=2){var p=o[c],h=o[c+1],d=c+3,f=c+4;if("number"!=typeof p)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(s.length&&s[s.length-1][0]>=p)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var m=e.parse(h,f,u);if(!m)return null;u=u||m.type,s.push([p,m])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new an(u,n,i,r,s):e.error("Type "+Xt(u)+" is not interpolatable.")},an.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);var o=Ve(e,i),a=an.interpolationFactor(this.interpolation,i,e[o],e[o+1]),l=n[o].evaluate(t),s=n[o+1].evaluate(t);return"interpolate"===this.operator?Ze[this.type.kind.toLowerCase()](l,s,a):"interpolate-hcl"===this.operator?rn.reverse(rn.interpolate(rn.forward(l),rn.forward(s),a)):nn.reverse(nn.interpolate(nn.forward(l),nn.forward(s),a))},an.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},an.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},an.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var sn=function(t,e){this.type=t,this.args=e};sn.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,i=e.expectedType;i&&"value"!==i.kind&&(n=i);for(var r=[],o=0,a=t.slice(1);o<a.length;o+=1){var l=e.parse(a[o],1+r.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,r.push(l)}var s=i&&r.some((function(t){return Kt(i,t.type)}));return new sn(s?qt:n,r)},sn.prototype.evaluate=function(t){for(var e,n=null,i=0,r=0,o=this.args;r<o.length&&(i++,(n=o[r].evaluate(t))&&n instanceof re&&!n.available&&(e||(e=n.name),n=null,i===this.args.length&&(n=e)),null===n);r+=1);return n},sn.prototype.eachChild=function(t){this.args.forEach(t)},sn.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},sn.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var un=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};un.prototype.evaluate=function(t){return this.result.evaluate(t)},un.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},un.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],i=1;i<t.length-1;i+=2){var r=t[i];if("string"!=typeof r)return e.error("Expected string, but found "+typeof r+" instead.",i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=e.parse(t[i+1],i+1);if(!o)return null;n.push([r,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return a?new un(n,a):null},un.prototype.outputDefined=function(){return this.result.outputDefined()},un.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var i=n[e];t.push(i[0],i[1].serialize())}return t.push(this.result.serialize()),t};var cn=function(t,e,n){this.type=t,this.index=e,this.input=n};cn.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Bt),i=e.parse(t[2],2,Yt(e.expectedType||qt));return n&&i?new cn(i.type.itemType,n,i):null},cn.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new ce("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new ce("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new ce("Array index must be an integer, but found "+e+" instead.");return n[e]},cn.prototype.eachChild=function(t){t(this.index),t(this.input)},cn.prototype.outputDefined=function(){return!1},cn.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var pn=function(t,e){this.type=Ut,this.needle=t,this.haystack=e};pn.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,qt),i=e.parse(t[2],2,qt);return n&&i?Jt(n.type,[Ut,Nt,Bt,Ft,qt])?new pn(n,i):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(n.type)+" instead"):null},pn.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!$t(e,["boolean","string","number","null"]))throw new ce("Expected first argument to be of type boolean, string, number or null, but found "+Xt(le(e))+" instead.");if(!$t(n,["string","array"]))throw new ce("Expected second argument to be of type array or string, but found "+Xt(le(n))+" instead.");return n.indexOf(e)>=0},pn.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},pn.prototype.outputDefined=function(){return!0},pn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var hn=function(t,e,n){this.type=Bt,this.needle=t,this.haystack=e,this.fromIndex=n};hn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,qt),i=e.parse(t[2],2,qt);if(!n||!i)return null;if(!Jt(n.type,[Ut,Nt,Bt,Ft,qt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(n.type)+" instead");if(4===t.length){var r=e.parse(t[3],3,Bt);return r?new hn(n,i,r):null}return new hn(n,i)},hn.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!$t(e,["boolean","string","number","null"]))throw new ce("Expected first argument to be of type boolean, string, number or null, but found "+Xt(le(e))+" instead.");if(!$t(n,["string","array"]))throw new ce("Expected second argument to be of type array or string, but found "+Xt(le(n))+" instead.");if(this.fromIndex){var i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)},hn.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},hn.prototype.outputDefined=function(){return!1},hn.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var dn=function(t,e,n,i,r,o){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o};dn.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var r={},o=[],a=2;a<t.length-1;a+=2){var l=t[a],s=t[a+1];Array.isArray(l)||(l=[l]);var u=e.concat(a);if(0===l.length)return u.error("Expected at least one branch label.");for(var c=0,p=l;c<p.length;c+=1){var h=p[c];if("number"!=typeof h&&"string"!=typeof h)return u.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,le(h)))return null}else n=le(h);if(void 0!==r[String(h)])return u.error("Branch labels must be unique.");r[String(h)]=o.length}var d=e.parse(s,a,i);if(!d)return null;i=i||d.type,o.push(d)}var f=e.parse(t[1],1,qt);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,i);return m?"value"!==f.type.kind&&e.concat(1).checkSubtype(n,f.type)?null:new dn(n,i,f,r,o,m):null},dn.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(le(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},dn.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},dn.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},dn.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],i={},r=0,o=Object.keys(this.cases).sort();r<o.length;r+=1){var a=o[r];void 0===(p=i[this.cases[a]])?(i[this.cases[a]]=n.length,n.push([this.cases[a],[a]])):n[p][1].push(a)}for(var l=function(e){return"number"===t.inputType.kind?Number(e):e},s=0,u=n;s<u.length;s+=1){var c=u[s],p=c[0],h=c[1];e.push(1===h.length?l(h[0]):h.map(l)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var fn=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};fn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i=[],r=1;r<t.length-1;r+=2){var o=e.parse(t[r],r,Ut);if(!o)return null;var a=e.parse(t[r+1],r+1,n);if(!a)return null;i.push([o,a]),n=n||a.type}var l=e.parse(t[t.length-1],t.length-1,n);return l?new fn(n,i,l):null},fn.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[1];if(i[0].evaluate(t))return r.evaluate(t)}return this.otherwise.evaluate(t)},fn.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[1];t(i[0]),t(r)}t(this.otherwise)},fn.prototype.outputDefined=function(){return this.branches.every((function(t){return t[1].outputDefined()}))&&this.otherwise.outputDefined()},fn.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var mn=function(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i};function gn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function vn(t,e,n,i){return 0===i.compare(e,n)}function yn(t,e,n){var i="=="!==t&&"!="!==t;return function(){function r(t,e,n){this.type=Ut,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return r.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],o=e.parse(t[1],1,qt);if(!o)return null;if(!gn(n,o.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+Xt(o.type)+"'.");var a=e.parse(t[2],2,qt);if(!a)return null;if(!gn(n,a.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+Xt(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+Xt(o.type)+"' and '"+Xt(a.type)+"'.");i&&("value"===o.type.kind&&"value"!==a.type.kind?o=new he(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new he(o.type,[a])));var l=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(l=e.parse(t[3],3,Gt)))return null}return new r(o,a,l)},r.prototype.evaluate=function(r){var o=this.lhs.evaluate(r),a=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){var l=le(o),s=le(a);if(l.kind!==s.kind||"string"!==l.kind&&"number"!==l.kind)throw new ce('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+l.kind+", "+s.kind+") instead.")}if(this.collator&&!i&&this.hasUntypedArgument){var u=le(o),c=le(a);if("string"!==u.kind||"string"!==c.kind)return e(r,o,a)}return this.collator?n(r,o,a,this.collator.evaluate(r)):e(r,o,a)},r.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},r.prototype.outputDefined=function(){return!0},r.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},r}()}mn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,qt),i=e.parse(t[2],2,Bt);if(!n||!i)return null;if(!Jt(n.type,[Yt(qt),Nt,qt]))return e.error("Expected first argument to be of type array or string, but found "+Xt(n.type)+" instead");if(4===t.length){var r=e.parse(t[3],3,Bt);return r?new mn(n.type,n,i,r):null}return new mn(n.type,n,i)},mn.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!$t(e,["string","array"]))throw new ce("Expected first argument to be of type array or string, but found "+Xt(le(e))+" instead.");if(this.endIndex){var i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)},mn.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},mn.prototype.outputDefined=function(){return!1},mn.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var _n=yn("==",(function(t,e,n){return e===n}),vn),bn=yn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,i){return!vn(0,e,n,i)})),xn=yn("<",(function(t,e,n){return e<n}),(function(t,e,n,i){return i.compare(e,n)<0})),wn=yn(">",(function(t,e,n){return e>n}),(function(t,e,n,i){return i.compare(e,n)>0})),Cn=yn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,i){return i.compare(e,n)<=0})),En=yn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,i){return i.compare(e,n)>=0})),Sn=function(t,e,n,i,r){this.type=Nt,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r};Sn.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Bt);if(!n)return null;var i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");var r=null;if(i.locale&&!(r=e.parse(i.locale,1,Nt)))return null;var o=null;if(i.currency&&!(o=e.parse(i.currency,1,Nt)))return null;var a=null;if(i["min-fraction-digits"]&&!(a=e.parse(i["min-fraction-digits"],1,Bt)))return null;var l=null;return i["max-fraction-digits"]&&!(l=e.parse(i["max-fraction-digits"],1,Bt))?null:new Sn(n,r,o,a,l)},Sn.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Sn.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Sn.prototype.outputDefined=function(){return!1},Sn.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Tn=function(t){this.type=Bt,this.input=t};Tn.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+Xt(n.type)+" instead."):new Tn(n):null},Tn.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ce("Expected value to be of type string or array, but found "+Xt(le(e))+" instead.")},Tn.prototype.eachChild=function(t){t(this.input)},Tn.prototype.outputDefined=function(){return!1},Tn.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var In={"==":_n,"!=":bn,">":wn,"<":xn,">=":En,"<=":Cn,array:he,at:cn,boolean:he,case:fn,coalesce:sn,collator:be,format:de,image:fe,in:pn,"index-of":hn,interpolate:an,"interpolate-hcl":an,"interpolate-lab":an,length:Tn,let:un,literal:ue,match:dn,number:he,"number-format":Sn,object:he,slice:mn,step:qe,string:he,"to-boolean":ge,"to-color":ge,"to-number":ge,"to-string":ge,var:Ue,within:ze};function Pn(t,e){var n=e[0],i=e[1],r=e[2],o=e[3];n=n.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);var a=o?o.evaluate(t):1,l=oe(n,i,r,a);if(l)throw new ce(l);return new te(n/255*a,i/255*a,r/255*a,a)}function An(t,e){return t in e}function Mn(t,e){var n=e[t];return void 0===n?null:n}function kn(t){return{type:t}}function Dn(t){return{result:"success",value:t}}function Ln(t){return{result:"error",value:t}}function On(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Rn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function zn(t){return!!t.expression&&t.expression.interpolated}function Fn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Bn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Nn(t){return t}function Un(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function jn(t,e,n,i,r){return Un(typeof n===r?i[n]:void 0,t.default,e.default)}function Vn(t,e,n){if("number"!==Fn(n))return Un(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var r=Ve(t.stops.map((function(t){return t[0]})),n);return t.stops[r][1]}function qn(t,e,n){var i=void 0!==t.base?t.base:1;if("number"!==Fn(n))return Un(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var o=Ve(t.stops.map((function(t){return t[0]})),n),a=function(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}(n,i,t.stops[o][0],t.stops[o+1][0]),l=t.stops[o][1],s=t.stops[o+1][1],u=Ze[e.type]||Nn;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=on[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),a))}}return"function"==typeof l.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=l.evaluate.apply(void 0,t),i=s.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==i)return u(n,i,a)}}:u(l,s,a)}function Gn(t,e,n){return"color"===e.type?n=te.parse(n):"formatted"===e.type?n=ie.fromString(n.toString()):"resolvedImage"===e.type?n=re.fromString(n.toString()):Fn(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Un(n,t.default,e.default)}_e.register(In,{error:[{kind:"error"},[Nt],function(t,e){throw new ce(e[0].evaluate(t))}],typeof:[Nt,[qt],function(t,e){return Xt(le(e[0].evaluate(t)))}],"to-rgba":[Yt(Bt,4),[jt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[jt,[Bt,Bt,Bt],Pn],rgba:[jt,[Bt,Bt,Bt,Bt],Pn],has:{type:Ut,overloads:[[[Nt],function(t,e){return An(e[0].evaluate(t),t.properties())}],[[Nt,Vt],function(t,e){var n=e[1];return An(e[0].evaluate(t),n.evaluate(t))}]]},get:{type:qt,overloads:[[[Nt],function(t,e){return Mn(e[0].evaluate(t),t.properties())}],[[Nt,Vt],function(t,e){var n=e[1];return Mn(e[0].evaluate(t),n.evaluate(t))}]]},"feature-state":[qt,[Nt],function(t,e){return Mn(e[0].evaluate(t),t.featureState||{})}],properties:[Vt,[],function(t){return t.properties()}],"geometry-type":[Nt,[],function(t){return t.geometryType()}],id:[qt,[],function(t){return t.id()}],zoom:[Bt,[],function(t){return t.globals.zoom}],"heatmap-density":[Bt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Bt,[],function(t){return t.globals.lineProgress||0}],accumulated:[qt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Bt,kn(Bt),function(t,e){for(var n=0,i=0,r=e;i<r.length;i+=1)n+=r[i].evaluate(t);return n}],"*":[Bt,kn(Bt),function(t,e){for(var n=1,i=0,r=e;i<r.length;i+=1)n*=r[i].evaluate(t);return n}],"-":{type:Bt,overloads:[[[Bt,Bt],function(t,e){var n=e[1];return e[0].evaluate(t)-n.evaluate(t)}],[[Bt],function(t,e){return-e[0].evaluate(t)}]]},"/":[Bt,[Bt,Bt],function(t,e){var n=e[1];return e[0].evaluate(t)/n.evaluate(t)}],"%":[Bt,[Bt,Bt],function(t,e){var n=e[1];return e[0].evaluate(t)%n.evaluate(t)}],ln2:[Bt,[],function(){return Math.LN2}],pi:[Bt,[],function(){return Math.PI}],e:[Bt,[],function(){return Math.E}],"^":[Bt,[Bt,Bt],function(t,e){var n=e[1];return Math.pow(e[0].evaluate(t),n.evaluate(t))}],sqrt:[Bt,[Bt],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Bt,[Bt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Bt,[Bt],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Bt,[Bt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Bt,[Bt],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Bt,[Bt],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Bt,[Bt],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Bt,[Bt],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Bt,[Bt],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Bt,[Bt],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Bt,kn(Bt),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[Bt,kn(Bt),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[Bt,[Bt],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Bt,[Bt],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Bt,[Bt],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Bt,[Bt],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Ut,[Nt,qt],function(t,e){var n=e[0],i=e[1];return t.properties()[n.value]===i.value}],"filter-id-==":[Ut,[qt],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[Ut,[Nt],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[Ut,[Nt,qt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<o}],"filter-id-<":[Ut,[qt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[Ut,[Nt,qt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>o}],"filter-id->":[Ut,[qt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[Ut,[Nt,qt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<=o}],"filter-id-<=":[Ut,[qt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[Ut,[Nt,qt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>=o}],"filter-id->=":[Ut,[qt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[Ut,[qt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Ut,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Ut,[Yt(Nt)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Ut,[Yt(qt)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Ut,[Nt,Yt(qt)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[Ut,[Nt,Yt(qt)],function(t,e){var n=e[0],i=e[1];return function(t,e,n,i){for(;n<=i;){var r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[n.value],i.value,0,i.value.length-1)}],all:{type:Ut,overloads:[[[Ut,Ut],function(t,e){var n=e[1];return e[0].evaluate(t)&&n.evaluate(t)}],[kn(Ut),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(!i[n].evaluate(t))return!1;return!0}]]},any:{type:Ut,overloads:[[[Ut,Ut],function(t,e){var n=e[1];return e[0].evaluate(t)||n.evaluate(t)}],[kn(Ut),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(i[n].evaluate(t))return!0;return!1}]]},"!":[Ut,[Ut],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Ut,[Nt],function(t,e){var n=t.globals&&t.globals.isSupportedScript;return!n||n(e[0].evaluate(t))}],upcase:[Nt,[Nt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Nt,[Nt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Nt,kn(qt),function(t,e){return e.map((function(e){return se(e.evaluate(t))})).join("")}],"resolved-locale":[Nt,[Gt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Zn=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new ye,this._defaultValue=e?function(t){return"color"===t.type&&Bn(t.default)?new te(0,0,0,0):"color"===t.type?te.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null};function Hn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in In}function Yn(t,e){var n=new je(In,[],e?function(t){var e={color:jt,string:Nt,number:Bt,enum:Nt,boolean:Ut,formatted:Zt,resolvedImage:Ht};return"array"===t.type?Yt(e[t.value]||qt,t.length):e[t.type]}(e):void 0),i=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return i?Dn(new Zn(i,e)):Ln(n.errors)}Zn.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},Zn.prototype.evaluate=function(t,e,n,i,r,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ce("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Xn=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Be(e.expression)};Xn.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)},Xn.prototype.evaluate=function(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)};var Wn=function(t,e,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Be(e.expression),this.interpolationType=i};function Kn(t,e){if("error"===(t=Yn(t,e)).result)return t;var n=t.value.expression,i=Fe(n);if(!i&&!On(e))return Ln([new Rt("","data expressions not supported")]);var r=Ne(n,["zoom"]);if(!r&&!Rn(e))return Ln([new Rt("","zoom expressions not supported")]);var o=function t(e){var n=null;if(e instanceof un)n=t(e.result);else if(e instanceof sn)for(var i=0,r=e.args;i<r.length&&!(n=t(r[i]));i+=1);else(e instanceof qe||e instanceof an)&&e.input instanceof _e&&"zoom"===e.input.name&&(n=e);return n instanceof Rt||e.eachChild((function(e){var i=t(e);i instanceof Rt?n=i:!n&&i?n=new Rt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&i&&n!==i&&(n=new Rt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}(n);return o||r?o instanceof Rt?Ln([o]):o instanceof an&&!zn(e)?Ln([new Rt("",'"interpolate" expressions cannot be used with this property')]):Dn(o?new Wn(i?"camera":"composite",t.value,o.labels,o instanceof an?o.interpolation:void 0):new Xn(i?"constant":"source",t.value)):Ln([new Rt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Wn.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)},Wn.prototype.evaluate=function(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)},Wn.prototype.interpolationFactor=function(t,e,n){return this.interpolationType?an.interpolationFactor(this.interpolationType,t,e,n):0};var Jn=function(t,e){this._parameters=t,this._specification=e,Dt(this,function t(e,n){var i,r,o,a="color"===n.type,l=e.stops&&"object"==typeof e.stops[0][0],s=l||!(l||void 0!==e.property),u=e.type||(zn(n)?"exponential":"interval");if(a&&((e=Dt({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],te.parse(t[1])]}))),e.default=te.parse(e.default?e.default:n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!on[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===u)i=qn;else if("interval"===u)i=Vn;else if("categorical"===u){i=jn,r=Object.create(null);for(var c=0,p=e.stops;c<p.length;c+=1){var h=p[c];r[h[0]]=h[1]}o=typeof e.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'+u+'"');i=Gn}if(l){for(var d={},f=[],m=0;m<e.stops.length;m++){var g=e.stops[m],v=g[0].zoom;void 0===d[v]&&(d[v]={zoom:v,type:e.type,property:e.property,default:e.default,stops:[]},f.push(v)),d[v].stops.push([g[0].value,g[1]])}for(var y=[],_=0,b=f;_<b.length;_+=1){var x=b[_];y.push([d[x].zoom,t(d[x],n)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:an.interpolationFactor.bind(void 0,w),zoomStops:y.map((function(t){return t[0]})),evaluate:function(t,i){var r=t.zoom;return qn({stops:y,base:e.base},n,r).evaluate(r,i)}}}if(s){var C="exponential"===u?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:an.interpolationFactor.bind(void 0,C),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){return i(e,n,t.zoom,r,o)}}}return{kind:"source",evaluate:function(t,a){var l=a&&a.properties?a.properties[e.property]:void 0;return void 0===l?Un(e.default,n.default):i(e,n,l,r,o)}}}(this._parameters,this._specification))};function $n(t){var e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},o=t.style,a=t.styleSpec,l=[],s=Fn(n);if("object"!==s)return[new Mt(e,n,"object expected, "+s+" found")];for(var u in n){var c=u.split(".")[0],p=i[c]||i["*"],h=void 0;if(r[c])h=r[c];else if(i[c])h=Ci;else if(r["*"])h=r["*"];else{if(!i["*"]){l.push(new Mt(e,n[u],'unknown property "'+u+'"'));continue}h=Ci}l=l.concat(h({key:(e?e+".":e)+u,value:n[u],valueSpec:p,style:o,styleSpec:a,object:n,objectKey:u},n))}for(var d in i)r[d]||i[d].required&&void 0===i[d].default&&void 0===n[d]&&l.push(new Mt(e,n,'missing required property "'+d+'"'));return l}function Qn(t){var e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,o=t.key,a=t.arrayElementValidator||Ci;if("array"!==Fn(e))return[new Mt(o,e,"array expected, "+Fn(e)+" found")];if(n.length&&e.length!==n.length)return[new Mt(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new Mt(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var l={type:n.value,values:n.values};r.$version<7&&(l.function=n.function),"object"===Fn(n.value)&&(l=n.value);for(var s=[],u=0;u<e.length;u++)s=s.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:l,style:i,styleSpec:r,key:o+"["+u+"]"}));return s}function ti(t){var e=t.key,n=t.value,i=t.valueSpec,r=Fn(n);return"number"===r&&n!=n&&(r="NaN"),"number"!==r?[new Mt(e,n,"number expected, "+r+" found")]:"minimum"in i&&n<i.minimum?[new Mt(e,n,n+" is less than the minimum value "+i.minimum)]:"maximum"in i&&n>i.maximum?[new Mt(e,n,n+" is greater than the maximum value "+i.maximum)]:[]}function ei(t){var e,n,i,r=t.valueSpec,o=Lt(t.value.type),a={},l="categorical"!==o&&void 0===t.value.property,s=!l,u="array"===Fn(t.value.stops)&&"array"===Fn(t.value.stops[0])&&"object"===Fn(t.value.stops[0][0]),c=$n({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new Mt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(Qn({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:p})),"array"===Fn(n)&&0===n.length&&e.push(new Mt(t.key,n,"array must have at least one stop")),e},default:function(t){return Ci({key:t.key,value:t.value,valueSpec:r,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&l&&c.push(new Mt(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||c.push(new Mt(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!zn(t.valueSpec)&&c.push(new Mt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(s&&!On(t.valueSpec)?c.push(new Mt(t.key,t.value,"property functions not supported")):l&&!Rn(t.valueSpec)&&c.push(new Mt(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!u||void 0!==t.value.property||c.push(new Mt(t.key,t.value,'"property" property is required')),c;function p(t){var e=[],o=t.value,l=t.key;if("array"!==Fn(o))return[new Mt(l,o,"array expected, "+Fn(o)+" found")];if(2!==o.length)return[new Mt(l,o,"array length 2 expected, length "+o.length+" found")];if(u){if("object"!==Fn(o[0]))return[new Mt(l,o,"object expected, "+Fn(o[0])+" found")];if(void 0===o[0].zoom)return[new Mt(l,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new Mt(l,o,"object stop key must have value")];if(i&&i>Lt(o[0].zoom))return[new Mt(l,o[0].zoom,"stop zoom values must appear in ascending order")];Lt(o[0].zoom)!==i&&(i=Lt(o[0].zoom),n=void 0,a={}),e=e.concat($n({key:l+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:ti,value:h}}))}else e=e.concat(h({key:l+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return Hn(Ot(o[1]))?e.concat([new Mt(l+"[1]",o[1],"expressions are not allowed in function stops.")]):e.concat(Ci({key:l+"[1]",value:o[1],valueSpec:r,style:t.style,styleSpec:t.styleSpec}))}function h(t,i){var l=Fn(t.value),s=Lt(t.value),u=null!==t.value?t.value:i;if(e){if(l!==e)return[new Mt(t.key,u,l+" stop domain type must match previous stop domain type "+e)]}else e=l;if("number"!==l&&"string"!==l&&"boolean"!==l)return[new Mt(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==o){var c="number expected, "+l+" found";return On(r)&&void 0===o&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Mt(t.key,u,c)]}return"categorical"!==o||"number"!==l||isFinite(s)&&Math.floor(s)===s?"categorical"!==o&&"number"===l&&void 0!==n&&s<n?[new Mt(t.key,u,"stop domain values must appear in ascending order")]:(n=s,"categorical"===o&&s in a?[new Mt(t.key,u,"stop domain values must be unique")]:(a[s]=!0,[])):[new Mt(t.key,u,"integer expected, found "+s)]}}function ni(t){var e=("property"===t.expressionContext?Kn:Yn)(Ot(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new Mt(""+t.key+e.key,t.value,e.message)}));var n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new Mt(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Be(n))return[new Mt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Be(n))return[new Mt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ne(n,["zoom","feature-state"]))return[new Mt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Fe(n))return[new Mt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ii(t){var e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(Lt(n))&&r.push(new Mt(e,n,"expected one of ["+i.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(i.values).indexOf(Lt(n))&&r.push(new Mt(e,n,"expected one of ["+Object.keys(i.values).join(", ")+"], "+JSON.stringify(n)+" found")),r}function ri(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var i=n[e];if(!ri(i)&&"boolean"!=typeof i)return!1}return!0;default:return!0}}Jn.deserialize=function(t){return new Jn(t._parameters,t._specification)},Jn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var oi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ai(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};ri(t)||(t=si(t));var e=Yn(t,oi);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return{filter:function(t,n,i){return e.value.evaluate(t,n,{},i)},needGeometry:function t(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var n=1;n<e.length;n++)if(t(e[n]))return!0;return!1}(t)}}function li(t,e){return t<e?-1:t>e?1:0}function si(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?ui(t[1],t[2],"=="):"!="===n?hi(ui(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?ui(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(si))):"all"===n?["all"].concat(t.slice(1).map(si)):"none"===n?["all"].concat(t.slice(1).map(si).map(hi)):"in"===n?ci(t[1],t.slice(2)):"!in"===n?hi(ci(t[1],t.slice(2))):"has"===n?pi(t[1]):"!has"===n?hi(pi(t[1])):"within"!==n||t}function ui(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function ci(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(li)]]:["filter-in-small",t,["literal",e]]}}function pi(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function hi(t){return["!",t]}function di(t){return ri(Ot(t.value))?ni(Dt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,i=e.key;if("array"!==Fn(n))return[new Mt(i,n,"array expected, "+Fn(n)+" found")];var r,o=e.styleSpec,a=[];if(n.length<1)return[new Mt(i,n,"filter array must have at least 1 element")];switch(a=a.concat(ii({key:i+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),Lt(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===Lt(n[1])&&a.push(new Mt(i,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new Mt(i,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(r=Fn(n[1]))&&a.push(new Mt(i+"[1]",n[1],"string expected, "+r+" found"));for(var l=2;l<n.length;l++)r=Fn(n[l]),"$type"===Lt(n[1])?a=a.concat(ii({key:i+"["+l+"]",value:n[l],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new Mt(i+"["+l+"]",n[l],"string, number, or boolean expected, "+r+" found"));break;case"any":case"all":case"none":for(var s=1;s<n.length;s++)a=a.concat(t({key:i+"["+s+"]",value:n[s],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=Fn(n[1]),2!==n.length?a.push(new Mt(i,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==r&&a.push(new Mt(i+"[1]",n[1],"string expected, "+r+" found"));break;case"within":r=Fn(n[1]),2!==n.length?a.push(new Mt(i,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"object"!==r&&a.push(new Mt(i+"[1]",n[1],"object expected, "+r+" found"))}return a}(t)}function fi(t,e){var n=t.key,i=t.style,r=t.styleSpec,o=t.value,a=t.objectKey,l=r[e+"_"+t.layerType];if(!l)return[];var s=a.match(/^(.*)-transition$/);if("paint"===e&&s&&l[s[1]]&&l[s[1]].transition)return Ci({key:n,value:o,valueSpec:r.transition,style:i,styleSpec:r});var u,c=t.valueSpec||l[a];if(!c)return[new Mt(n,o,'unknown property "'+a+'"')];if("string"===Fn(o)&&On(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new Mt(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var p=[];return"symbol"===t.layerType&&("text-field"===a&&i&&!i.glyphs&&p.push(new Mt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Bn(Ot(o))&&"identity"===Lt(o.type)&&p.push(new Mt(n,o,'"text-font" does not support identity functions'))),p.concat(Ci({key:t.key,value:o,valueSpec:c,style:i,styleSpec:r,expressionContext:"property",propertyType:e,propertyKey:a}))}function mi(t){return fi(t,"paint")}function gi(t){return fi(t,"layout")}function vi(t){var e=[],n=t.value,i=t.key,r=t.style,o=t.styleSpec;n.type||n.ref||e.push(new Mt(i,n,'either "type" or "ref" is required'));var a,l=Lt(n.type),s=Lt(n.ref);if(n.id)for(var u=Lt(n.id),c=0;c<t.arrayIndex;c++){var p=r.layers[c];Lt(p.id)===u&&e.push(new Mt(i,n.id,'duplicate layer id "'+n.id+'", previously used at line '+p.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(t){t in n&&e.push(new Mt(i,n[t],'"'+t+'" is prohibited for ref layers'))})),r.layers.forEach((function(t){Lt(t.id)===s&&(a=t)})),a?a.ref?e.push(new Mt(i,n.ref,"ref cannot reference another ref layer")):l=Lt(a.type):e.push(new Mt(i,n.ref,'ref layer "'+s+'" not found'));else if("background"!==l)if(n.source){var h=r.sources&&r.sources[n.source],d=h&&Lt(h.type);h?"vector"===d&&"raster"===l?e.push(new Mt(i,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===d&&"raster"!==l?e.push(new Mt(i,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==d||n["source-layer"]?"raster-dem"===d&&"hillshade"!==l?e.push(new Mt(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==l||!n.paint||!n.paint["line-gradient"]||"geojson"===d&&h.lineMetrics||e.push(new Mt(i,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new Mt(i,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new Mt(i,n.source,'source "'+n.source+'" not found'))}else e.push(new Mt(i,n,'missing required property "source"'));return e=e.concat($n({key:i,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ci({key:i+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:di,layout:function(t){return $n({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return gi(Dt({layerType:l},t))}}})},paint:function(t){return $n({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return mi(Dt({layerType:l},t))}}})}}}))}function yi(t){var e=t.value,n=t.key,i=Fn(e);return"string"!==i?[new Mt(n,e,"string expected, "+i+" found")]:[]}var _i={promoteId:function(t){var e=t.key,n=t.value;if("string"===Fn(n))return yi({key:e,value:n});var i=[];for(var r in n)i.push.apply(i,yi({key:e+"."+r,value:n[r]}));return i}};function bi(t){var e=t.value,n=t.key,i=t.styleSpec,r=t.style;if(!e.type)return[new Mt(n,e,'"type" is required')];var o,a=Lt(e.type);switch(a){case"vector":case"raster":case"raster-dem":return $n({key:n,value:e,valueSpec:i["source_"+a.replace("-","_")],style:t.style,styleSpec:i,objectElementValidators:_i});case"geojson":if(o=$n({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i,objectElementValidators:_i}),e.cluster)for(var l in e.clusterProperties){var s=e.clusterProperties[l],u=s[0],c="string"==typeof u?[u,["accumulated"],["get",l]]:u;o.push.apply(o,ni({key:n+"."+l+".map",value:s[1],expressionContext:"cluster-map"})),o.push.apply(o,ni({key:n+"."+l+".reduce",value:c,expressionContext:"cluster-reduce"}))}return o;case"video":return $n({key:n,value:e,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return $n({key:n,value:e,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return[new Mt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ii({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:i})}}function xi(t){var e=t.value,n=t.styleSpec,i=n.light,r=t.style,o=[],a=Fn(e);if(void 0===e)return o;if("object"!==a)return o.concat([new Mt("light",e,"object expected, "+a+" found")]);for(var l in e){var s=l.match(/^(.*)-transition$/);o=o.concat(s&&i[s[1]]&&i[s[1]].transition?Ci({key:l,value:e[l],valueSpec:n.transition,style:r,styleSpec:n}):i[l]?Ci({key:l,value:e[l],valueSpec:i[l],style:r,styleSpec:n}):[new Mt(l,e[l],'unknown property "'+l+'"')])}return o}var wi={"*":function(){return[]},array:Qn,boolean:function(t){var e=t.value,n=t.key,i=Fn(e);return"boolean"!==i?[new Mt(n,e,"boolean expected, "+i+" found")]:[]},number:ti,color:function(t){var e=t.key,n=t.value,i=Fn(n);return"string"!==i?[new Mt(e,n,"color expected, "+i+" found")]:null===Qt(n)?[new Mt(e,n,'color expected, "'+n+'" found')]:[]},constants:kt,enum:ii,filter:di,function:ei,layer:vi,object:$n,source:bi,light:xi,string:yi,formatted:function(t){return 0===yi(t).length?[]:ni(t)},resolvedImage:function(t){return 0===yi(t).length?[]:ni(t)}};function Ci(t){var e=t.value,n=t.valueSpec,i=t.styleSpec;return n.expression&&Bn(Lt(e))?ei(t):n.expression&&Hn(Ot(e))?ni(t):n.type&&wi[n.type]?wi[n.type](t):$n(Dt({},t,{valueSpec:n.type?i[n.type]:n}))}function Ei(t){var e=t.value,n=t.key,i=yi(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new Mt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new Mt(n,e,'"glyphs" url must include a "{range}" token'))),i}function Si(t,e){void 0===e&&(e=At);var n=[];return n=n.concat(Ci({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Ei,"*":function(){return[]}}})),t.constants&&(n=n.concat(kt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Ti(n)}function Ti(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function Ii(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return Ti(t.apply(this,e))}}Si.source=Ii(bi),Si.light=Ii(xi),Si.layer=Ii(vi),Si.filter=Ii(di),Si.paintProperty=Ii(mi),Si.layoutProperty=Ii(gi);var Pi=Si,Ai=Pi.light,Mi=Pi.paintProperty,ki=Pi.layoutProperty;function Di(t,e){var n=!1;if(e&&e.length)for(var i=0,r=e;i<r.length;i+=1)t.fire(new It(new Error(r[i].message))),n=!0;return n}var Li=Oi;function Oi(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(n=r[2]);for(var o=0;o<this.d*this.d;o++){var a=r[3+o],l=r[3+o+1];i.push(a===l?null:r.subarray(a,l))}var s=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],s),this.bboxes=r.subarray(s),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var u=0;u<this.d*this.d;u++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var c=n/e*t;this.min=-c,this.max=t+c}Oi.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},Oi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Oi.prototype._insertCell=function(t,e,n,i,r,o){this.cells[r].push(o)},Oi.prototype.query=function(t,e,n,i,r){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=n&&a<=i&&!r)return Array.prototype.slice.call(this.keys);var l=[];return this._forEachCell(t,e,n,i,this._queryCell,l,{},r),l},Oi.prototype._queryCell=function(t,e,n,i,r,o,a,l){var s=this.cells[r];if(null!==s)for(var u=this.keys,c=this.bboxes,p=0;p<s.length;p++){var h=s[p];if(void 0===a[h]){var d=4*h;(l?l(c[d+0],c[d+1],c[d+2],c[d+3]):t<=c[d+2]&&e<=c[d+3]&&n>=c[d+0]&&i>=c[d+1])?(a[h]=!0,o.push(u[h])):a[h]=!1}}},Oi.prototype._forEachCell=function(t,e,n,i,r,o,a,l){for(var s=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),p=this._convertToCellCoord(i),h=s;h<=c;h++)for(var d=u;d<=p;d++){var f=this.d*d+h;if((!l||l(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&r.call(this,t,e,n,i,f,o,a,l))return}},Oi.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Oi.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Oi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var l=t[a];r[3+a]=o,r.set(l,o),o+=l.length}return r[3+t.length]=o,r.set(this.keys,o),r[3+t.length+1]=o+=this.keys.length,r.set(this.bboxes,o),o+=this.bboxes.length,r.buffer};var Ri=a.ImageData,zi=a.ImageBitmap,Fi={};function Bi(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Fi[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var Ni in Bi("Object",Object),Li.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Li.deserialize=function(t){return new Li(t.buffer)},Bi("Grid",Li),Bi("Color",te),Bi("Error",Error),Bi("ResolvedImage",re),Bi("StylePropertyFunction",Jn),Bi("StyleExpression",Zn,{omit:["_evaluator"]}),Bi("ZoomDependentExpression",Wn),Bi("ZoomConstantExpression",Xn),Bi("CompoundExpression",_e,{omit:["_evaluate"]}),In)In[Ni]._classRegistryKey||Bi("Expression_"+Ni,In[Ni]);function Ui(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function ji(t){return zi&&t instanceof zi}function Vi(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ui(t)||ji(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof Ri)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var i=[],r=0,o=t;r<o.length;r+=1)i.push(Vi(o[r],e));return i}if("object"==typeof t){var a=t.constructor,l=a._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var s=a.serialize?a.serialize(t,e):{};if(!a.serialize){for(var u in t)if(t.hasOwnProperty(u)&&!(Fi[l].omit.indexOf(u)>=0)){var c=t[u];s[u]=Fi[l].shallow.indexOf(u)>=0?c:Vi(c,e)}t instanceof Error&&(s.message=t.message)}if(s.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(s.$name=l),s}throw new Error("can't serialize object of type "+typeof t)}function qi(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ui(t)||ji(t)||ArrayBuffer.isView(t)||t instanceof Ri)return t;if(Array.isArray(t))return t.map(qi);if("object"==typeof t){var e=t.$name||"Object",n=Fi[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var i=Object.create(n.prototype),r=0,o=Object.keys(t);r<o.length;r+=1){var a=o[r];if("$name"!==a){var l=t[a];i[a]=Fi[e].shallow.indexOf(a)>=0?l:qi(l)}}return i}throw new Error("can't deserialize object of type "+typeof t)}var Gi=function(){this.first=!0};Gi.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var Zi={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Hi(t){for(var e=0,n=t;e<n.length;e+=1)if(Yi(n[e].charCodeAt(0)))return!0;return!1}function Yi(t){return!(746!==t&&747!==t&&(t<4352||!(Zi["Bopomofo Extended"](t)||Zi.Bopomofo(t)||Zi["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Zi["CJK Compatibility Ideographs"](t)||Zi["CJK Compatibility"](t)||Zi["CJK Radicals Supplement"](t)||Zi["CJK Strokes"](t)||!(!Zi["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Zi["CJK Unified Ideographs Extension A"](t)||Zi["CJK Unified Ideographs"](t)||Zi["Enclosed CJK Letters and Months"](t)||Zi["Hangul Compatibility Jamo"](t)||Zi["Hangul Jamo Extended-A"](t)||Zi["Hangul Jamo Extended-B"](t)||Zi["Hangul Jamo"](t)||Zi["Hangul Syllables"](t)||Zi.Hiragana(t)||Zi["Ideographic Description Characters"](t)||Zi.Kanbun(t)||Zi["Kangxi Radicals"](t)||Zi["Katakana Phonetic Extensions"](t)||Zi.Katakana(t)&&12540!==t||!(!Zi["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Zi["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Zi["Unified Canadian Aboriginal Syllabics"](t)||Zi["Unified Canadian Aboriginal Syllabics Extended"](t)||Zi["Vertical Forms"](t)||Zi["Yijing Hexagram Symbols"](t)||Zi["Yi Syllables"](t)||Zi["Yi Radicals"](t))))}function Xi(t){return!(Yi(t)||function(t){return!!(Zi["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Zi["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Zi["Letterlike Symbols"](t)||Zi["Number Forms"](t)||Zi["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Zi["Control Pictures"](t)&&9251!==t||Zi["Optical Character Recognition"](t)||Zi["Enclosed Alphanumerics"](t)||Zi["Geometric Shapes"](t)||Zi["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Zi["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Zi["CJK Symbols and Punctuation"](t)||Zi.Katakana(t)||Zi["Private Use Area"](t)||Zi["CJK Compatibility Forms"](t)||Zi["Small Form Variants"](t)||Zi["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Wi(t){return t>=1424&&t<=2303||Zi["Arabic Presentation Forms-A"](t)||Zi["Arabic Presentation Forms-B"](t)}function Ki(t,e){return!(!e&&Wi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Zi.Khmer(t))}function Ji(t){for(var e=0,n=t;e<n.length;e+=1)if(Wi(n[e].charCodeAt(0)))return!0;return!1}var $i=null,Qi="unavailable",tr=null,er=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Qi="error"),$i&&$i(t)};function nr(){ir.fire(new Tt("pluginStateChange",{pluginStatus:Qi,pluginURL:tr}))}var ir=new Pt,rr=function(){return Qi},or=function(){if("deferred"!==Qi||!tr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Qi="loading",nr(),tr&&bt({url:tr},(function(t){t?er(t):(Qi="loaded",nr())}))},ar={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Qi||null!=ar.applyArabicShaping},isLoading:function(){return"loading"===Qi},setState:function(t){Qi=t.pluginStatus,tr=t.pluginURL},isParsed:function(){return null!=ar.applyArabicShaping&&null!=ar.processBidirectionalText&&null!=ar.processStyledBidirectionalText},getPluginURL:function(){return tr}},lr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gi,this.transition={})};lr.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,i=t;n<i.length;n+=1)if(!Ki(i[n].charCodeAt(0),e))return!1;return!0}(t,ar.isLoaded())},lr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},lr.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}};var sr=function(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Bn(t))return new Jn(t,e);if(Hn(t)){var n=Kn(t,e);if("error"===n.result)throw new Error(n.value.map((function(t){return t.key+": "+t.message})).join(", "));return n.value}var i=t;return"string"==typeof t&&"color"===e.type&&(i=te.parse(t)),{kind:"constant",evaluate:function(){return i}}}(void 0===e?t.specification.default:e,t.specification)};sr.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},sr.prototype.possiblyEvaluate=function(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)};var ur=function(t){this.property=t,this.value=new sr(t,void 0)};ur.prototype.transitioned=function(t,e){return new pr(this.property,this.value,e,h({},t.transition,this.transition),t.now)},ur.prototype.untransitioned=function(){return new pr(this.property,this.value,null,{},0)};var cr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};cr.prototype.getValue=function(t){return x(this._values[t].value.value)},cr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ur(this._values[t].property)),this._values[t].value=new sr(this._values[t].property,null===e?void 0:x(e))},cr.prototype.getTransition=function(t){return x(this._values[t].transition)},cr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ur(this._values[t].property)),this._values[t].transition=x(e)||void 0},cr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r);var o=this.getTransition(i);void 0!==o&&(t[i+"-transition"]=o)}return t},cr.prototype.transitioned=function(t,e){for(var n=new hr(this._properties),i=0,r=Object.keys(this._values);i<r.length;i+=1){var o=r[i];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},cr.prototype.untransitioned=function(){for(var t=new hr(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e];t._values[i]=this._values[i].untransitioned()}return t};var pr=function(t,e,n,i,r){this.property=t,this.value=e,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)};pr.prototype.possiblyEvaluate=function(t,e,n){var i=t.now||0,r=this.value.possiblyEvaluate(t,e,n),o=this.prior;if(o){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return o.possiblyEvaluate(t,e,n);var a=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,n),r,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(a))}return r};var hr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};hr.prototype.possiblyEvaluate=function(t,e,n){for(var i=new mr(this._properties),r=0,o=Object.keys(this._values);r<o.length;r+=1){var a=o[r];i._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return i},hr.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var dr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};dr.prototype.getValue=function(t){return x(this._values[t].value)},dr.prototype.setValue=function(t,e){this._values[t]=new sr(this._values[t].property,null===e?void 0:x(e))},dr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r)}return t},dr.prototype.possiblyEvaluate=function(t,e,n){for(var i=new mr(this._properties),r=0,o=Object.keys(this._values);r<o.length;r+=1){var a=o[r];i._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return i};var fr=function(t,e,n){this.property=t,this.value=e,this.parameters=n};fr.prototype.isConstant=function(){return"constant"===this.value.kind},fr.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},fr.prototype.evaluate=function(t,e,n,i){return this.property.evaluate(this.value,this.parameters,t,e,n,i)};var mr=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};mr.prototype.get=function(t){return this._values[t]};var gr=function(t){this.specification=t};gr.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},gr.prototype.interpolate=function(t,e,n){var i=Ze[this.specification.type];return i?i(t,e,n):t};var vr=function(t,e){this.specification=t,this.overrides=e};vr.prototype.possiblyEvaluate=function(t,e,n,i){return new fr(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,i)}:t.expression,e)},vr.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new fr(this,{kind:"constant",value:void 0},t.parameters);var i=Ze[this.specification.type];return i?new fr(this,{kind:"constant",value:i(t.value.value,e.value.value,n)},t.parameters):t},vr.prototype.evaluate=function(t,e,n,i,r,o){return"constant"===t.kind?t.value:t.evaluate(e,n,i,r,o)};var yr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(t,e,n,i){if(void 0===t.value)return new fr(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var r=t.expression.evaluate(e,null,{},n,i),o="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,a=this._calculate(o,o,o,e);return new fr(this,{kind:"constant",value:a},e)}if("camera"===t.expression.kind){var l=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new fr(this,{kind:"constant",value:l},e)}return new fr(this,t.expression,e)},e.prototype.evaluate=function(t,e,n,i,r,o){if("source"===t.kind){var a=t.evaluate(e,n,i,r,o);return this._calculate(a,a,a,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,i),t.evaluate({zoom:Math.floor(e.zoom)},n,i),t.evaluate({zoom:Math.floor(e.zoom)+1},n,i),e):t.value},e.prototype._calculate=function(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},e.prototype.interpolate=function(t){return t},e}(vr),_r=function(t){this.specification=t};_r.prototype.possiblyEvaluate=function(t,e,n,i){if(void 0!==t.value){if("constant"===t.expression.kind){var r=t.expression.evaluate(e,null,{},n,i);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new lr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new lr(Math.floor(e.zoom),e)),t.expression.evaluate(new lr(Math.floor(e.zoom+1),e)),e)}},_r.prototype._calculate=function(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},_r.prototype.interpolate=function(t){return t};var br=function(t){this.specification=t};br.prototype.possiblyEvaluate=function(t,e,n,i){return!!t.expression.evaluate(e,null,{},n,i)},br.prototype.interpolate=function(){return!1};var xr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var n=t[e];n.specification.overridable&&this.overridableProperties.push(e);var i=this.defaultPropertyValues[e]=new sr(n,void 0),r=this.defaultTransitionablePropertyValues[e]=new ur(n);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}};Bi("DataDrivenProperty",vr),Bi("DataConstantProperty",gr),Bi("CrossFadedDataDrivenProperty",yr),Bi("CrossFadedProperty",_r),Bi("ColorRampProperty",br);var wr=function(t){function e(e,n){if(t.call(this),this.id=e.id,this.type=e.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new dr(n.layout)),n.paint)){for(var i in this._transitionablePaint=new cr(n.paint),e.paint)this.setPaintProperty(i,e.paint[i],{validate:!1});for(var r in e.layout)this.setLayoutProperty(r,e.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new mr(n.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){void 0===n&&(n={}),null!=e&&this._validate(ki,"layers."+this.id+".layout."+t,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)},e.prototype.getPaintProperty=function(t){return y(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(void 0===n&&(n={}),null!=e&&this._validate(Mi,"layers."+this.id+".paint."+t,t,e,n))return!1;if(y(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],r="cross-faded-data-driven"===i.property.specification["property-type"],o=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var l=this._transitionablePaint._values[t].value;return l.isDataDriven()||o||r||this._handleOverridablePaintPropertyUpdate(t,a,l)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype._handleOverridablePaintPropertyUpdate=function(t,e,n){return!1},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),b(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},e.prototype._validate=function(t,e,n,i,r){return void 0===r&&(r={}),(!r||!1!==r.validate)&&Di(this,t.call(Pi,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:At,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof fr&&On(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(Pt),Cr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Er=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Sr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Tr(t,e){void 0===e&&(e=1);var n=0,i=0;return{members:t.map((function(t){var r=Cr[t.type].BYTES_PER_ELEMENT,o=n=Ir(n,Math.max(e,r)),a=t.components||1;return i=Math.max(i,r),n+=r*a,{name:t.name,type:t.type,components:a,offset:o}})),size:Ir(n,Math.max(i,e)),alignment:e}}function Ir(t,e){return Math.ceil(t/e)*e}Sr.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Sr.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Sr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Sr.prototype.clear=function(){this.length=0},Sr.prototype.resize=function(t){this.reserve(t),this.length=t},Sr.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Sr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Pr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t},e}(Sr);Pr.prototype.bytesPerElement=4,Bi("StructArrayLayout2i4",Pr);var Ar=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)},e.prototype.emplace=function(t,e,n,i,r){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=r,t},e}(Sr);Ar.prototype.bytesPerElement=8,Bi("StructArrayLayout4i8",Ar);var Mr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,o)},e.prototype.emplace=function(t,e,n,i,r,o,a){var l=6*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=r,this.int16[l+4]=o,this.int16[l+5]=a,t},e}(Sr);Mr.prototype.bytesPerElement=12,Bi("StructArrayLayout2i4i12",Mr);var kr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,o)},e.prototype.emplace=function(t,e,n,i,r,o,a){var l=4*t,s=8*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.uint8[s+4]=i,this.uint8[s+5]=r,this.uint8[s+6]=o,this.uint8[s+7]=a,t},e}(Sr);kr.prototype.bytesPerElement=8,Bi("StructArrayLayout2i4ub8",kr);var Dr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t},e}(Sr);Dr.prototype.bytesPerElement=8,Bi("StructArrayLayout2f8",Dr);var Lr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,l,s,u){var c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,i,r,o,a,l,s,u)},e.prototype.emplace=function(t,e,n,i,r,o,a,l,s,u,c){var p=10*t;return this.uint16[p+0]=e,this.uint16[p+1]=n,this.uint16[p+2]=i,this.uint16[p+3]=r,this.uint16[p+4]=o,this.uint16[p+5]=a,this.uint16[p+6]=l,this.uint16[p+7]=s,this.uint16[p+8]=u,this.uint16[p+9]=c,t},e}(Sr);Lr.prototype.bytesPerElement=20,Bi("StructArrayLayout10ui20",Lr);var Or=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,l,s,u,c,p){var h=this.length;return this.resize(h+1),this.emplace(h,t,e,n,i,r,o,a,l,s,u,c,p)},e.prototype.emplace=function(t,e,n,i,r,o,a,l,s,u,c,p,h){var d=12*t;return this.int16[d+0]=e,this.int16[d+1]=n,this.int16[d+2]=i,this.int16[d+3]=r,this.uint16[d+4]=o,this.uint16[d+5]=a,this.uint16[d+6]=l,this.uint16[d+7]=s,this.int16[d+8]=u,this.int16[d+9]=c,this.int16[d+10]=p,this.int16[d+11]=h,t},e}(Sr);Or.prototype.bytesPerElement=24,Bi("StructArrayLayout4i4ui4i24",Or);var Rr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t},e}(Sr);Rr.prototype.bytesPerElement=12,Bi("StructArrayLayout3f12",Rr);var zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint32[1*t+0]=e,t},e}(Sr);zr.prototype.bytesPerElement=4,Bi("StructArrayLayout1ul4",zr);var Fr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,l,s){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,o,a,l,s)},e.prototype.emplace=function(t,e,n,i,r,o,a,l,s,u){var c=10*t,p=5*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=i,this.int16[c+3]=r,this.int16[c+4]=o,this.int16[c+5]=a,this.uint32[p+3]=l,this.uint16[c+8]=s,this.uint16[c+9]=u,t},e}(Sr);Fr.prototype.bytesPerElement=20,Bi("StructArrayLayout6i1ul2ui20",Fr);var Br=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,o)},e.prototype.emplace=function(t,e,n,i,r,o,a){var l=6*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=r,this.int16[l+4]=o,this.int16[l+5]=a,t},e}(Sr);Br.prototype.bytesPerElement=12,Bi("StructArrayLayout2i2i2i12",Br);var Nr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r)},e.prototype.emplace=function(t,e,n,i,r,o){var a=4*t,l=8*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=i,this.int16[l+6]=r,this.int16[l+7]=o,t},e}(Sr);Nr.prototype.bytesPerElement=16,Bi("StructArrayLayout2f1f2i16",Nr);var Ur=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)},e.prototype.emplace=function(t,e,n,i,r){var o=12*t,a=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[a+1]=i,this.float32[a+2]=r,t},e}(Sr);Ur.prototype.bytesPerElement=12,Bi("StructArrayLayout2ub2f12",Ur);var jr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,t},e}(Sr);jr.prototype.bytesPerElement=6,Bi("StructArrayLayout3ui6",jr);var Vr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m,g){var v=this.length;return this.resize(v+1),this.emplace(v,t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m,g)},e.prototype.emplace=function(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m,g,v){var y=24*t,_=12*t,b=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=i,this.uint16[y+3]=r,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=l,this.uint16[y+10]=s,this.uint16[y+11]=u,this.uint16[y+12]=c,this.float32[_+7]=p,this.float32[_+8]=h,this.uint8[b+36]=d,this.uint8[b+37]=f,this.uint8[b+38]=m,this.uint32[_+10]=g,this.int16[y+22]=v,t},e}(Sr);Vr.prototype.bytesPerElement=48,Bi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vr);var qr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m,g,v,y,_,b,x,w,C,E,S,T,I){var P=this.length;return this.resize(P+1),this.emplace(P,t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m,g,v,y,_,b,x,w,C,E,S,T,I)},e.prototype.emplace=function(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m,g,v,y,_,b,x,w,C,E,S,T,I,P){var A=34*t,M=17*t;return this.int16[A+0]=e,this.int16[A+1]=n,this.int16[A+2]=i,this.int16[A+3]=r,this.int16[A+4]=o,this.int16[A+5]=a,this.int16[A+6]=l,this.int16[A+7]=s,this.uint16[A+8]=u,this.uint16[A+9]=c,this.uint16[A+10]=p,this.uint16[A+11]=h,this.uint16[A+12]=d,this.uint16[A+13]=f,this.uint16[A+14]=m,this.uint16[A+15]=g,this.uint16[A+16]=v,this.uint16[A+17]=y,this.uint16[A+18]=_,this.uint16[A+19]=b,this.uint16[A+20]=x,this.uint16[A+21]=w,this.uint16[A+22]=C,this.uint32[M+12]=E,this.float32[M+13]=S,this.float32[M+14]=T,this.float32[M+15]=I,this.float32[M+16]=P,t},e}(Sr);qr.prototype.bytesPerElement=68,Bi("StructArrayLayout8i15ui1ul4f68",qr);var Gr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.float32[1*t+0]=e,t},e}(Sr);Gr.prototype.bytesPerElement=4,Bi("StructArrayLayout1f4",Gr);var Zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,t},e}(Sr);Zr.prototype.bytesPerElement=6,Bi("StructArrayLayout3i6",Zr);var Hr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=4*t;return this.uint32[2*t+0]=e,this.uint16[r+2]=n,this.uint16[r+3]=i,t},e}(Sr);Hr.prototype.bytesPerElement=8,Bi("StructArrayLayout1ul2ui8",Hr);var Yr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t},e}(Sr);Yr.prototype.bytesPerElement=4,Bi("StructArrayLayout2ui4",Yr);var Xr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint16[1*t+0]=e,t},e}(Sr);Xr.prototype.bytesPerElement=2,Bi("StructArrayLayout1ui2",Xr);var Wr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)},e.prototype.emplace=function(t,e,n,i,r){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=r,t},e}(Sr);Wr.prototype.bytesPerElement=16,Bi("StructArrayLayout4f16",Wr);var Kr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.anchorPoint.get=function(){return new r(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(Er);Kr.prototype.size=20;var Jr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Kr(this,t)},e}(Fr);Bi("CollisionBoxArray",Jr);var $r=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},n.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},n.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,n),e}(Er);$r.prototype.size=48;var Qr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new $r(this,t)},e}(Vr);Bi("PlacedSymbolArray",Qr);var to=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},n.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},n.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},n.key.get=function(){return this._structArray.uint16[this._pos2+8]},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},n.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},n.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},n.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},n.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},n.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},n.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},n.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+12]=t},n.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},n.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},n.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},n.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,n),e}(Er);to.prototype.size=68;var eo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new to(this,t)},e}(qr);Bi("SymbolInstanceArray",eo);var no=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e}(Gr);Bi("GlyphOffsetArray",no);var io=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e}(Zr);Bi("SymbolLineVertexArray",io);var ro=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,n),e}(Er);ro.prototype.size=8;var oo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new ro(this,t)},e}(Hr);Bi("FeatureIndexArray",oo);var ao=Tr([{name:"a_pos",components:2,type:"Int16"}],4).members,lo=function(t){void 0===t&&(t=[]),this.segments=t};function so(t,e){return 256*(t=c(Math.floor(t),0,255))+c(Math.floor(e),0,255)}lo.prototype.prepareSegment=function(t,e,n,i){var r=this.segments[this.segments.length-1];return t>lo.MAX_VERTEX_ARRAY_LENGTH&&C("Max vertices per segment is "+lo.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!r||r.vertexLength+t>lo.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(r.sortKey=i),this.segments.push(r)),r},lo.prototype.get=function(){return this.segments},lo.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var i in n.vaos)n.vaos[i].destroy()}},lo.simpleSegment=function(t,e,n,i){return new lo([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])},lo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bi("SegmentVector",lo);var uo=Tr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),co=e((function(t){t.exports=function(t,e){var n,i,r,o,a,l,s,u;for(i=t.length-(n=3&t.length),r=e,a=3432918353,l=461845907,u=0;u<i;)s=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,r=27492+(65535&(o=5*(65535&(r=(r^=s=(65535&(s=(s=(65535&s)*a+(((s>>>16)*a&65535)<<16)&4294967295)<<15|s>>>17))*l+(((s>>>16)*l&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(s=0,n){case 3:s^=(255&t.charCodeAt(u+2))<<16;case 2:s^=(255&t.charCodeAt(u+1))<<8;case 1:r^=s=(65535&(s=(s=(65535&(s^=255&t.charCodeAt(u)))*a+(((s>>>16)*a&65535)<<16)&4294967295)<<15|s>>>17))*l+(((s>>>16)*l&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}})),po=e((function(t){t.exports=function(t,e){for(var n,i=t.length,r=e^i,o=0;i>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:r^=(255&t.charCodeAt(o+2))<<16;case 2:r^=(255&t.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}})),ho=co,fo=po;ho.murmur3=co,ho.murmur2=fo;var mo=function(){this.ids=[],this.positions=[],this.indexed=!1};mo.prototype.add=function(t,e,n,i){this.ids.push(vo(t)),this.positions.push(e,n,i)},mo.prototype.getPositions=function(t){for(var e=vo(t),n=0,i=this.ids.length-1;n<i;){var r=n+i>>1;this.ids[r]>=e?i=r:n=r+1}for(var o=[];this.ids[n]===e;)o.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return o},mo.serialize=function(t,e){var n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return function t(e,n,i,r){for(;i<r;){for(var o=e[i+r>>1],a=i-1,l=r+1;;){do{a++}while(e[a]<o);do{l--}while(e[l]>o);if(a>=l)break;yo(e,a,l),yo(n,3*a,3*l),yo(n,3*a+1,3*l+1),yo(n,3*a+2,3*l+2)}l-i<r-l?(t(e,n,i,l),i=l+1):(t(e,n,l+1,r),r=l)}}(n,i,0,n.length-1),e&&e.push(n.buffer,i.buffer),{ids:n,positions:i}},mo.deserialize=function(t){var e=new mo;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var go=Math.pow(2,53)-1;function vo(t){var e=+t;return!isNaN(e)&&e<=go?e:ho(String(t))}function yo(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}Bi("FeaturePositionMap",mo);var _o=function(t,e){this.gl=t.gl,this.location=e},bo=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(_o),xo=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(_o),wo=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(_o),Co=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(_o),Eo=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(_o),So=function(t){function e(e,n){t.call(this,e,n),this.current=te.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(_o),To=new Float32Array(16),Io=function(t){function e(e,n){t.call(this,e,n),this.current=To}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(_o);function Po(t){return[so(255*t.r,255*t.g),so(255*t.b,255*t.a)]}var Ao=function(t,e,n){this.value=t,this.uniformNames=e.map((function(t){return"u_"+t})),this.type=n};Ao.prototype.setUniform=function(t,e,n){t.set(n.constantOr(this.value))},Ao.prototype.getBinding=function(t,e,n){return"color"===this.type?new So(t,e):new xo(t,e)};var Mo=function(t,e){this.uniformNames=e.map((function(t){return"u_"+t})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Mo.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},Mo.prototype.setUniform=function(t,e,n,i){var r="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;r&&t.set(r)},Mo.prototype.getBinding=function(t,e,n){return"u_pattern"===n.substr(0,9)?new Eo(t,e):new xo(t,e)};var ko=function(t,e,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new i};ko.prototype.populatePaintArray=function(t,e,n,i,r){var o=this.paintVertexArray.length,a=this.expression.evaluate(new lr(0),e,{},i,[],r);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)},ko.prototype.updatePaintArray=function(t,e,n,i){var r=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(t,e,r)},ko.prototype._setPaintValue=function(t,e,n){if("color"===this.type)for(var i=Po(n),r=t;r<e;r++)this.paintVertexArray.emplace(r,i[0],i[1]);else{for(var o=t;o<e;o++)this.paintVertexArray.emplace(o,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}},ko.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ko.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Do=function(t,e,n,i,r,o){this.expression=t,this.uniformNames=e.map((function(t){return"u_"+t+"_t"})),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new o};Do.prototype.populatePaintArray=function(t,e,n,i,r){var o=this.expression.evaluate(new lr(this.zoom),e,{},i,[],r),a=this.expression.evaluate(new lr(this.zoom+1),e,{},i,[],r),l=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(l,t,o,a)},Do.prototype.updatePaintArray=function(t,e,n,i){var r=this.expression.evaluate({zoom:this.zoom},n,i),o=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(t,e,r,o)},Do.prototype._setPaintValue=function(t,e,n,i){if("color"===this.type)for(var r=Po(n),o=Po(i),a=t;a<e;a++)this.paintVertexArray.emplace(a,r[0],r[1],o[0],o[1]);else{for(var l=t;l<e;l++)this.paintVertexArray.emplace(l,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}},Do.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Do.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Do.prototype.setUniform=function(t,e){var n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,i=c(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)},Do.prototype.getBinding=function(t,e,n){return new xo(t,e)};var Lo=function(t,e,n,i,r,o){this.expression=t,this.type=e,this.useIntegerZoom=n,this.zoom=i,this.layerId=o,this.zoomInPaintVertexArray=new r,this.zoomOutPaintVertexArray=new r};Lo.prototype.populatePaintArray=function(t,e,n){var i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,e.patterns&&e.patterns[this.layerId],n)},Lo.prototype.updatePaintArray=function(t,e,n,i,r){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],r)},Lo.prototype._setPaintValues=function(t,e,n,i){if(i&&n){var r=i[n.min],o=i[n.mid],a=i[n.max];if(r&&o&&a)for(var l=t;l<e;l++)this.zoomInPaintVertexArray.emplace(l,o.tl[0],o.tl[1],o.br[0],o.br[1],r.tl[0],r.tl[1],r.br[0],r.br[1],o.pixelRatio,r.pixelRatio),this.zoomOutPaintVertexArray.emplace(l,o.tl[0],o.tl[1],o.br[0],o.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],o.pixelRatio,a.pixelRatio)}},Lo.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,uo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,uo.members,this.expression.isStateDependent))},Lo.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Oo=function(t,e,n){this.binders={},this._buffers=[];var i=[];for(var r in t.paint._values)if(n(r)){var o=t.paint.get(r);if(o instanceof fr&&On(o.property.specification)){var a=zo(r,t.type),l=o.value,s=o.property.specification.type,u=o.property.useIntegerZoom,c=o.property.specification["property-type"],p="cross-faded"===c||"cross-faded-data-driven"===c;if("constant"===l.kind)this.binders[r]=p?new Mo(l.value,a):new Ao(l.value,a,s),i.push("/u_"+r);else if("source"===l.kind||p){var h=Fo(r,s,"source");this.binders[r]=p?new Lo(l,s,u,e,h,t.id):new ko(l,a,s,h),i.push("/a_"+r)}else{var d=Fo(r,s,"composite");this.binders[r]=new Do(l,a,s,u,e,d),i.push("/z_"+r)}}}this.cacheKey=i.sort().join("")};Oo.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof ko||e instanceof Do?e.maxValue:0},Oo.prototype.populatePaintArrays=function(t,e,n,i,r){for(var o in this.binders){var a=this.binders[o];(a instanceof ko||a instanceof Do||a instanceof Lo)&&a.populatePaintArray(t,e,n,i,r)}},Oo.prototype.setConstantPatternPositions=function(t,e){for(var n in this.binders){var i=this.binders[n];i instanceof Mo&&i.setConstantPatternPositions(t,e)}},Oo.prototype.updatePaintArrays=function(t,e,n,i,r){var o=!1;for(var a in t)for(var l=0,s=e.getPositions(a);l<s.length;l+=1){var u=s[l],c=n.feature(u.index);for(var p in this.binders){var h=this.binders[p];if((h instanceof ko||h instanceof Do||h instanceof Lo)&&!0===h.expression.isStateDependent){var d=i.paint.get(p);h.expression=d.value,h.updatePaintArray(u.start,u.end,c,t[a],r),o=!0}}}return o},Oo.prototype.defines=function(){var t=[];for(var e in this.binders){var n=this.binders[e];(n instanceof Ao||n instanceof Mo)&&t.push.apply(t,n.uniformNames.map((function(t){return"#define HAS_UNIFORM_"+t})))}return t},Oo.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof ko||n instanceof Do)for(var i=0;i<n.paintVertexAttributes.length;i++)t.push(n.paintVertexAttributes[i].name);else if(n instanceof Lo)for(var r=0;r<uo.members.length;r++)t.push(uo.members[r].name)}return t},Oo.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof Ao||n instanceof Mo||n instanceof Do)for(var i=0,r=n.uniformNames;i<r.length;i+=1)t.push(r[i])}return t},Oo.prototype.getPaintVertexBuffers=function(){return this._buffers},Oo.prototype.getUniforms=function(t,e){var n=[];for(var i in this.binders){var r=this.binders[i];if(r instanceof Ao||r instanceof Mo||r instanceof Do)for(var o=0,a=r.uniformNames;o<a.length;o+=1){var l=a[o];if(e[l]){var s=r.getBinding(t,e[l],l);n.push({name:l,property:i,binding:s})}}}return n},Oo.prototype.setUniforms=function(t,e,n,i){for(var r=0,o=e;r<o.length;r+=1){var a=o[r],l=a.name,s=a.property;this.binders[s].setUniform(a.binding,i,n.get(s),l)}},Oo.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var n=this.binders[e];if(t&&n instanceof Lo){var i=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof ko||n instanceof Do)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}},Oo.prototype.upload=function(t){for(var e in this.binders){var n=this.binders[e];(n instanceof ko||n instanceof Do||n instanceof Lo)&&n.upload(t)}this.updatePaintBuffers()},Oo.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof ko||e instanceof Do||e instanceof Lo)&&e.destroy()}};var Ro=function(t,e,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var i=0,r=t;i<r.length;i+=1){var o=r[i];this.programConfigurations[o.id]=new Oo(o,e,n)}this.needsUpload=!1,this._featureMap=new mo,this._bufferOffset=0};function zo(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Fo(t,e,n){var i={color:{source:Dr,composite:Wr},number:{source:Gr,composite:Dr}},r=function(t){return{"line-pattern":{source:Lr,composite:Lr},"fill-pattern":{source:Lr,composite:Lr},"fill-extrusion-pattern":{source:Lr,composite:Lr}}[t]}(t);return r&&r[n]||i[e][n]}Ro.prototype.populatePaintArrays=function(t,e,n,i,r,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,i,r,o);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Ro.prototype.updatePaintArrays=function(t,e,n,i){for(var r=0,o=n;r<o.length;r+=1){var a=o[r];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,i)||this.needsUpload}},Ro.prototype.get=function(t){return this.programConfigurations[t]},Ro.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Ro.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Bi("ConstantBinder",Ao),Bi("CrossFadedConstantBinder",Mo),Bi("SourceExpressionBinder",ko),Bi("CrossFadedCompositeBinder",Lo),Bi("CompositeExpressionBinder",Do),Bi("ProgramConfiguration",Oo,{omit:["_buffers"]}),Bi("ProgramConfigurationSet",Ro);var Bo=Math.pow(2,14)-1,No=-Bo-1;function Uo(t){for(var e=8192/t.extent,n=t.loadGeometry(),i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.length;o++){var a=r[o],l=Math.round(a.x*e),s=Math.round(a.y*e);a.x=c(l,No,Bo),a.y=c(s,No,Bo),(l<a.x||l>a.x+1||s<a.y||s>a.y+1)&&C("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function jo(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Uo(t):[]}}function Vo(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}var qo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Pr,this.indexArray=new jr,this.segments=new lo,this.programConfigurations=new Ro(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function Go(t,e){for(var n=0;n<t.length;n++)if(Qo(e,t[n]))return!0;for(var i=0;i<e.length;i++)if(Qo(t,e[i]))return!0;return!!Xo(t,e)}function Zo(t,e,n){return!!Qo(t,e)||!!Ko(e,t,n)}function Ho(t,e){if(1===t.length)return $o(e,t[0]);for(var n=0;n<e.length;n++)for(var i=e[n],r=0;r<i.length;r++)if(Qo(t,i[r]))return!0;for(var o=0;o<t.length;o++)if($o(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(Xo(t,e[a]))return!0;return!1}function Yo(t,e,n){if(t.length>1){if(Xo(t,e))return!0;for(var i=0;i<e.length;i++)if(Ko(e[i],t,n))return!0}for(var r=0;r<t.length;r++)if(Ko(t[r],e,n))return!0;return!1}function Xo(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var i=t[n],r=t[n+1],o=0;o<e.length-1;o++)if(Wo(i,r,e[o],e[o+1]))return!0;return!1}function Wo(t,e,n,i){return E(t,n,i)!==E(e,n,i)&&E(t,e,n)!==E(t,e,i)}function Ko(t,e,n){var i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(var r=1;r<e.length;r++)if(Jo(t,e[r-1],e[r])<i)return!0;return!1}function Jo(t,e,n){var i=e.distSqr(n);if(0===i)return t.distSqr(e);var r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(r<0?e:r>1?n:n.sub(e)._mult(r)._add(e))}function $o(t,e){for(var n,i,r,o=!1,a=0;a<t.length;a++)for(var l=0,s=(n=t[a]).length-1;l<n.length;s=l++)(i=n[l]).y>e.y!=(r=n[s]).y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o);return o}function Qo(t,e){for(var n=!1,i=0,r=t.length-1;i<t.length;r=i++){var o=t[i],a=t[r];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function ta(t,e,n){var i=n[0],r=n[2];if(t.x<i.x&&e.x<i.x||t.x>r.x&&e.x>r.x||t.y<i.y&&e.y<i.y||t.y>r.y&&e.y>r.y)return!1;var o=E(t,e,n[0]);return o!==E(t,e,n[1])||o!==E(t,e,n[2])||o!==E(t,e,n[3])}function ea(t,e,n){var i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function na(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ia(t,e,n,i,o){if(!e[0]&&!e[1])return t;var a=r.convert(e)._mult(o);"viewport"===n&&a._rotate(-i);for(var l=[],s=0;s<t.length;s++)l.push(t[s].sub(a));return l}qo.prototype.populate=function(t,e,n){var i=this.layers[0],r=[],o=null;"circle"===i.type&&(o=i.layout.get("circle-sort-key"));for(var a=0,l=t;a<l.length;a+=1){var s=l[a],u=s.feature,c=s.id,p=s.index,h=s.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,f=jo(u,d);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),f,n)){var m=o?o.evaluate(f,{},n):void 0,g={id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:p,geometry:d?f.geometry:Uo(u),patterns:{},sortKey:m};r.push(g)}}o&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var v=0,y=r;v<y.length;v+=1){var _=y[v],b=_.geometry,x=_.index,w=_.sourceLayerIndex,C=t[x].feature;this.addFeature(_,b,x,n),e.featureIndex.insert(C,b,x,w,this.index)}},qo.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},qo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ao),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qo.prototype.addFeature=function(t,e,n,i){for(var r=0,o=e;r<o.length;r+=1)for(var a=0,l=o[r];a<l.length;a+=1){var s=l[a],u=s.x,c=s.y;if(!(u<0||u>=8192||c<0||c>=8192)){var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),h=p.vertexLength;Vo(this.layoutVertexArray,u,c,-1,-1),Vo(this.layoutVertexArray,u,c,1,-1),Vo(this.layoutVertexArray,u,c,1,1),Vo(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),p.vertexLength+=4,p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i)},Bi("CircleBucket",qo,{omit:["layers"]});var ra=new xr({"circle-sort-key":new vr(At.layout_circle["circle-sort-key"])}),oa={paint:new xr({"circle-radius":new vr(At.paint_circle["circle-radius"]),"circle-color":new vr(At.paint_circle["circle-color"]),"circle-blur":new vr(At.paint_circle["circle-blur"]),"circle-opacity":new vr(At.paint_circle["circle-opacity"]),"circle-translate":new gr(At.paint_circle["circle-translate"]),"circle-translate-anchor":new gr(At.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gr(At.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gr(At.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new vr(At.paint_circle["circle-stroke-width"]),"circle-stroke-color":new vr(At.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new vr(At.paint_circle["circle-stroke-opacity"])}),layout:ra},aa="undefined"!=typeof Float32Array?Float32Array:Array;function la(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sa(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],l=e[4],s=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*i+b*l+x*p+w*m,t[1]=_*r+b*s+x*h+w*g,t[2]=_*o+b*u+x*d+w*v,t[3]=_*a+b*c+x*f+w*y,t[4]=(_=n[4])*i+(b=n[5])*l+(x=n[6])*p+(w=n[7])*m,t[5]=_*r+b*s+x*h+w*g,t[6]=_*o+b*u+x*d+w*v,t[7]=_*a+b*c+x*f+w*y,t[8]=(_=n[8])*i+(b=n[9])*l+(x=n[10])*p+(w=n[11])*m,t[9]=_*r+b*s+x*h+w*g,t[10]=_*o+b*u+x*d+w*v,t[11]=_*a+b*c+x*f+w*y,t[12]=(_=n[12])*i+(b=n[13])*l+(x=n[14])*p+(w=n[15])*m,t[13]=_*r+b*s+x*h+w*g,t[14]=_*o+b*u+x*d+w*v,t[15]=_*a+b*c+x*f+w*y,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,n=arguments.length;n--;)e+=t[n]*t[n];return Math.sqrt(e)});var ua,ca=sa;function pa(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}ua=new aa(3),aa!=Float32Array&&(ua[0]=0,ua[1]=0,ua[2]=0),function(){var t=new aa(4);aa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var ha=(function(){var t=new aa(2);aa!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(e){t.call(this,e,oa)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new qo(t)},e.prototype.queryRadius=function(t){var e=t;return ea("circle-radius",this,e)+ea("circle-stroke-width",this,e)+na(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a,l){for(var s=ia(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),c="map"===this.paint.get("circle-pitch-alignment"),p=c?s:function(t,e){return t.map((function(t){return da(t,e)}))}(s,l),h=c?u*a:u,d=0,f=i;d<f.length;d+=1)for(var m=0,g=f[d];m<g.length;m+=1){var v=g[m],y=c?v:da(v,l),_=h,b=pa([],[v.x,v.y,0,1],l);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),Zo(p,y,_))return!0}return!1},e}(wr));function da(t,e){var n=pa([],[t.x,t.y,0,1],e);return new r(n[0]/n[3],n[1]/n[3])}var fa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(qo);function ma(t,e,n,i){var r=e.width,o=e.height;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==r*o*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(r*o*n);return t.width=r,t.height=o,t.data=i,t}function ga(t,e,n){var i=e.width,r=e.height;if(i!==t.width||r!==t.height){var o=ma({},{width:i,height:r},n);va(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,r)},n),t.width=i,t.height=r,t.data=o.data}}function va(t,e,n,i,r,o){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,l=e.data,s=0;s<r.height;s++)for(var u=((n.y+s)*t.width+n.x)*o,c=((i.y+s)*e.width+i.x)*o,p=0;p<r.width*o;p++)l[c+p]=a[u+p];return e}Bi("HeatmapBucket",fa,{omit:["layers"]});var ya=function(t,e){ma(this,t,1,e)};ya.prototype.resize=function(t){ga(this,t,1)},ya.prototype.clone=function(){return new ya({width:this.width,height:this.height},new Uint8Array(this.data))},ya.copy=function(t,e,n,i,r){va(t,e,n,i,r,1)};var _a=function(t,e){ma(this,t,4,e)};_a.prototype.resize=function(t){ga(this,t,4)},_a.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},_a.prototype.clone=function(){return new _a({width:this.width,height:this.height},new Uint8Array(this.data))},_a.copy=function(t,e,n,i,r){va(t,e,n,i,r,4)},Bi("AlphaImage",ya),Bi("RGBAImage",_a);var ba={paint:new xr({"heatmap-radius":new vr(At.paint_heatmap["heatmap-radius"]),"heatmap-weight":new vr(At.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gr(At.paint_heatmap["heatmap-intensity"]),"heatmap-color":new br(At.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gr(At.paint_heatmap["heatmap-opacity"])})};function xa(t){var e={},n=t.resolution||256,i=t.clips?t.clips.length:1,r=t.image||new _a({width:n,height:i}),o=function(n,i,o){e[t.evaluationKey]=o;var a=t.expression.evaluate(e);r.data[n+i+0]=Math.floor(255*a.r/a.a),r.data[n+i+1]=Math.floor(255*a.g/a.a),r.data[n+i+2]=Math.floor(255*a.b/a.a),r.data[n+i+3]=Math.floor(255*a.a)};if(t.clips)for(var a=0,l=0;a<i;++a,l+=4*n)for(var s=0,u=0;s<n;s++,u+=4){var c=s/(n-1),p=t.clips[a];o(l,u,p.start*(1-c)+p.end*c)}else for(var h=0,d=0;h<n;h++,d+=4)o(0,d,h/(n-1));return r}var wa=function(t){function e(e){t.call(this,e,ba),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new fa(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=xa({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(wr),Ca={paint:new xr({"hillshade-illumination-direction":new gr(At.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gr(At.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gr(At.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gr(At.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gr(At.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gr(At.paint_hillshade["hillshade-accent-color"])})},Ea=function(t){function e(e){t.call(this,e,Ca)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(wr),Sa=Tr([{name:"a_pos",components:2,type:"Int16"}],4).members,Ta=Pa,Ia=Pa;function Pa(t,e,n){n=n||2;var i,r,o,a,l,s,u,c=e&&e.length,p=c?e[0]*n:t.length,h=Aa(t,0,p,n,!0),d=[];if(!h||h.next===h.prev)return d;if(c&&(h=function(t,e,n,i){var r,o,a,l=[];for(r=0,o=e.length;r<o;r++)(a=Aa(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),l.push(Ua(a));for(l.sort(za),r=0;r<l.length;r++)Fa(l[r],n),n=Ma(n,n.next);return n}(t,e,h,n)),t.length>80*n){i=o=t[0],r=a=t[1];for(var f=n;f<p;f+=n)(l=t[f])<i&&(i=l),(s=t[f+1])<r&&(r=s),l>o&&(o=l),s>a&&(a=s);u=0!==(u=Math.max(o-i,a-r))?1/u:0}return ka(h,d,n,i,r,u),d}function Aa(t,e,n,i,r){var o,a;if(r===Qa(t,e,n,i)>0)for(o=e;o<n;o+=i)a=Ka(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=Ka(o,t[o],t[o+1],a);return a&&Ga(a,a.next)&&(Ja(a),a=a.next),a}function Ma(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Ga(i,i.next)&&0!==qa(i.prev,i,i.next))i=i.next;else{if(Ja(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function ka(t,e,n,i,r,o,a){if(t){!a&&o&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=Na(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,l,s,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,l=0,e=0;e<u&&(l++,i=i.nextZ);e++);for(s=u;l>0||s>0&&i;)0!==l&&(0===s||!i||n.z<=i.z)?(r=n,n=n.nextZ,l--):(r=i,i=i.nextZ,s--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(a>1)}(r)}(t,i,r,o);for(var l,s,u=t;t.prev!==t.next;)if(l=t.prev,s=t.next,o?La(t,i,r,o):Da(t))e.push(l.i/n),e.push(t.i/n),e.push(s.i/n),Ja(t),t=s.next,u=s.next;else if((t=s)===u){a?1===a?ka(t=Oa(Ma(t),e,n),e,n,i,r,o,2):2===a&&Ra(t,e,n,i,r,o):ka(Ma(t),e,n,i,r,o,1);break}}}function Da(t){var e=t.prev,n=t,i=t.next;if(qa(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(ja(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&qa(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function La(t,e,n,i){var r=t.prev,o=t,a=t.next;if(qa(r,o,a)>=0)return!1;for(var l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,s=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,u=Na(r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,e,n,i),c=Na(l,s,e,n,i),p=t.prevZ,h=t.nextZ;p&&p.z>=u&&h&&h.z<=c;){if(p!==t.prev&&p!==t.next&&ja(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&qa(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,h!==t.prev&&h!==t.next&&ja(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&qa(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&ja(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&qa(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;h&&h.z<=c;){if(h!==t.prev&&h!==t.next&&ja(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&qa(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function Oa(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Ga(r,o)&&Za(r,i,i.next,o)&&Xa(r,o)&&Xa(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Ja(i),Ja(i.next),i=t=o),i=i.next}while(i!==t);return Ma(i)}function Ra(t,e,n,i,r,o){var a=t;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&Va(a,l)){var s=Wa(a,l);return a=Ma(a,a.next),s=Ma(s,s.next),ka(a,e,n,i,r,o),void ka(s,e,n,i,r,o)}l=l.next}a=a.next}while(a!==t)}function za(t,e){return t.x-e.x}function Fa(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var l=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(l<=r&&l>a){if(a=l,l===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n;var s,u=n,c=n.x,p=n.y,h=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&ja(o<p?r:a,o,c,p,o<p?a:r,o,i.x,i.y)&&(s=Math.abs(o-i.y)/(r-i.x),Xa(i,t)&&(s<h||s===h&&(i.x>n.x||i.x===n.x&&Ba(n,i)))&&(n=i,h=s)),i=i.next}while(i!==u);return n}(t,e)){var n=Wa(e,t);Ma(e,e.next),Ma(n,n.next)}}function Ba(t,e){return qa(t.prev,t,e.prev)<0&&qa(e.next,t,t.next)<0}function Na(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ua(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ja(t,e,n,i,r,o,a,l){return(r-a)*(e-l)-(t-a)*(o-l)>=0&&(t-a)*(i-l)-(n-a)*(e-l)>=0&&(n-a)*(o-l)-(r-a)*(i-l)>=0}function Va(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Za(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Xa(t,e)&&Xa(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(qa(t.prev,t,e.prev)||qa(t,e.prev,e))||Ga(t,e)&&qa(t.prev,t,t.next)>0&&qa(e.prev,e,e.next)>0)}function qa(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ga(t,e){return t.x===e.x&&t.y===e.y}function Za(t,e,n,i){var r=Ya(qa(t,e,n)),o=Ya(qa(t,e,i)),a=Ya(qa(n,i,t)),l=Ya(qa(n,i,e));return r!==o&&a!==l||!(0!==r||!Ha(t,n,e))||!(0!==o||!Ha(t,i,e))||!(0!==a||!Ha(n,t,i))||!(0!==l||!Ha(n,e,i))}function Ha(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ya(t){return t>0?1:t<0?-1:0}function Xa(t,e){return qa(t.prev,t,t.next)<0?qa(t,e,t.next)>=0&&qa(t,t.prev,e)>=0:qa(t,e,t.prev)<0||qa(t,t.next,e)<0}function Wa(t,e){var n=new $a(t.i,t.x,t.y),i=new $a(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Ka(t,e,n,i){var r=new $a(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ja(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $a(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qa(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}function tl(t,e,n,i,r){!function t(e,n,i,r,o){for(;r>i;){if(r-i>600){var a=r-i+1,l=n-i+1,s=Math.log(a),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(a-u)/a)*(l-a/2<0?-1:1);t(e,n,Math.max(i,Math.floor(n-l*u/a+c)),Math.min(r,Math.floor(n+(a-l)*u/a+c)),o)}var p=e[n],h=i,d=r;for(el(e,i,n),o(e[r],p)>0&&el(e,i,r);h<d;){for(el(e,h,d),h++,d--;o(e[h],p)<0;)h++;for(;o(e[d],p)>0;)d--}0===o(e[i],p)?el(e,i,d):el(e,++d,r),d<=n&&(i=d+1),n<=d&&(r=d-1)}}(t,e,n||0,i||t.length-1,r||nl)}function el(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function nl(t,e){return t<e?-1:t>e?1:0}function il(t,e){var n=t.length;if(n<=1)return[t];for(var i,r,o=[],a=0;a<n;a++){var l=S(t[a]);0!==l&&(t[a].area=Math.abs(l),void 0===r&&(r=l<0),r===l<0?(i&&o.push(i),i=[t[a]]):i.push(t[a]))}if(i&&o.push(i),e>1)for(var s=0;s<o.length;s++)o[s].length<=e||(tl(o[s],e,1,o[s].length-1,rl),o[s]=o[s].slice(0,e));return o}function rl(t,e){return e.area-t.area}function ol(t,e,n){for(var i=n.patternDependencies,r=!1,o=0,a=e;o<a.length;o+=1){var l=a[o].paint.get(t+"-pattern");l.isConstant()||(r=!0);var s=l.constantOr(null);s&&(r=!0,i[s.to]=!0,i[s.from]=!0)}return r}function al(t,e,n,i,r){for(var o=r.patternDependencies,a=0,l=e;a<l.length;a+=1){var s=l[a],u=s.paint.get(t+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:i-1},n,{},r.availableImages),p=u.evaluate({zoom:i},n,{},r.availableImages),h=u.evaluate({zoom:i+1},n,{},r.availableImages);p=p&&p.name?p.name:p,h=h&&h.name?h.name:h,o[c=c&&c.name?c.name:c]=!0,o[p]=!0,o[h]=!0,n.patterns[s.id]={min:c,mid:p,max:h}}}return n}Pa.deviation=function(t,e,n,i){var r=e&&e.length,o=Math.abs(Qa(t,0,r?e[0]*n:t.length,n));if(r)for(var a=0,l=e.length;a<l;a++)o-=Math.abs(Qa(t,e[a]*n,a<l-1?e[a+1]*n:t.length,n));var s=0;for(a=0;a<i.length;a+=3){var u=i[a]*n,c=i[a+1]*n,p=i[a+2]*n;s+=Math.abs((t[u]-t[p])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[p+1]-t[u+1]))}return 0===o&&0===s?0:Math.abs((s-o)/o)},Pa.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&n.holes.push(i+=t[r-1].length)}return n},Ta.default=Ia;var ll=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Pr,this.indexArray=new jr,this.indexArray2=new Yr,this.programConfigurations=new Ro(t.layers,t.zoom),this.segments=new lo,this.segments2=new lo,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};ll.prototype.populate=function(t,e,n){this.hasPattern=ol("fill",this.layers,e);for(var i=this.layers[0].layout.get("fill-sort-key"),r=[],o=0,a=t;o<a.length;o+=1){var l=a[o],s=l.feature,u=l.id,c=l.index,p=l.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d=jo(s,h);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),d,n)){var f=i?i.evaluate(d,{},n,e.availableImages):void 0,m={id:u,properties:s.properties,type:s.type,sourceLayerIndex:p,index:c,geometry:h?d.geometry:Uo(s),patterns:{},sortKey:f};r.push(m)}}i&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var g=0,v=r;g<v.length;g+=1){var y=v[g],_=y.geometry,b=y.index,x=y.sourceLayerIndex;if(this.hasPattern){var w=al("fill",this.layers,y,this.zoom,e);this.patternFeatures.push(w)}else this.addFeature(y,_,b,n,{});e.featureIndex.insert(t[b].feature,_,b,x,this.index)}},ll.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},ll.prototype.addFeatures=function(t,e,n){for(var i=0,r=this.patternFeatures;i<r.length;i+=1){var o=r[i];this.addFeature(o,o.geometry,o.index,e,n)}},ll.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ll.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ll.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Sa),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},ll.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ll.prototype.addFeature=function(t,e,n,i,r){for(var o=0,a=il(e,500);o<a.length;o+=1){for(var l=a[o],s=0,u=0,c=l;u<c.length;u+=1)s+=c[u].length;for(var p=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),h=p.vertexLength,d=[],f=[],m=0,g=l;m<g.length;m+=1){var v=g[m];if(0!==v.length){v!==l[0]&&f.push(d.length/2);var y=this.segments2.prepareSegment(v.length,this.layoutVertexArray,this.indexArray2),_=y.vertexLength;this.layoutVertexArray.emplaceBack(v[0].x,v[0].y),this.indexArray2.emplaceBack(_+v.length-1,_),d.push(v[0].x),d.push(v[0].y);for(var b=1;b<v.length;b++)this.layoutVertexArray.emplaceBack(v[b].x,v[b].y),this.indexArray2.emplaceBack(_+b-1,_+b),d.push(v[b].x),d.push(v[b].y);y.vertexLength+=v.length,y.primitiveLength+=v.length}}for(var x=Ta(d,f),w=0;w<x.length;w+=3)this.indexArray.emplaceBack(h+x[w],h+x[w+1],h+x[w+2]);p.vertexLength+=s,p.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)},Bi("FillBucket",ll,{omit:["layers","patternFeatures"]});var sl=new xr({"fill-sort-key":new vr(At.layout_fill["fill-sort-key"])}),ul={paint:new xr({"fill-antialias":new gr(At.paint_fill["fill-antialias"]),"fill-opacity":new vr(At.paint_fill["fill-opacity"]),"fill-color":new vr(At.paint_fill["fill-color"]),"fill-outline-color":new vr(At.paint_fill["fill-outline-color"]),"fill-translate":new gr(At.paint_fill["fill-translate"]),"fill-translate-anchor":new gr(At.paint_fill["fill-translate-anchor"]),"fill-pattern":new yr(At.paint_fill["fill-pattern"])}),layout:sl},cl=function(t){function e(e){t.call(this,e,ul)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n);var i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new ll(t)},e.prototype.queryRadius=function(){return na(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a){return Ho(ia(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),i)},e.prototype.isTileClipped=function(){return!0},e}(wr),pl=Tr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,hl=dl;function dl(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(fl,this,e)}function fl(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function ml(t){for(var e,n,i=0,r=0,o=t.length,a=o-1;r<o;a=r++)i+=((n=t[a]).x-(e=t[r]).x)*(e.y+n.y);return i}dl.types=["Unknown","Point","LineString","Polygon"],dl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,o=0,a=0,l=0,s=[];t.pos<n;){if(o<=0){var u=t.readVarint();i=7&u,o=u>>3}if(o--,1===i||2===i)a+=t.readSVarint(),l+=t.readSVarint(),1===i&&(e&&s.push(e),e=[]),e.push(new r(a,l));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&s.push(e),s},dl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,o=0,a=1/0,l=-1/0,s=1/0,u=-1/0;t.pos<e;){if(i<=0){var c=t.readVarint();n=7&c,i=c>>3}if(i--,1===n||2===n)(r+=t.readSVarint())<a&&(a=r),r>l&&(l=r),(o+=t.readSVarint())<s&&(s=o),o>u&&(u=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,s,l,u]},dl.prototype.toGeoJSON=function(t,e,n){var i,r,o=this.extent*Math.pow(2,n),a=this.extent*t,l=this.extent*e,s=this.loadGeometry(),u=dl.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+l)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(i=0;i<s.length;i++)p[i]=s[i][0];c(s=p);break;case 2:for(i=0;i<s.length;i++)c(s[i]);break;case 3:for(s=function(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],o=0;o<e;o++){var a=ml(t[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}(s),i=0;i<s.length;i++)for(r=0;r<s[i].length;r++)c(s[i][r])}1===s.length?s=s[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:s},properties:this.properties};return"id"in this&&(h.id=this.id),h};var gl=vl;function vl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(yl,this,e),this.length=this._features.length}function yl(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}function _l(t,e,n){if(3===t){var i=new gl(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}vl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new hl(this._pbf,e,this.extent,this._keys,this._values)};var bl={VectorTile:function(t,e){this.layers=t.readFields(_l,{},e)},VectorTileFeature:hl,VectorTileLayer:gl},xl=bl.VectorTileFeature.types,wl=Math.pow(2,13);function Cl(t,e,n,i,r,o,a,l){t.emplaceBack(e,n,2*Math.floor(i*wl)+a,r*wl*2,o*wl*2,Math.round(l))}var El=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Mr,this.indexArray=new jr,this.programConfigurations=new Ro(t.layers,t.zoom),this.segments=new lo,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function Sl(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}El.prototype.populate=function(t,e,n){this.features=[],this.hasPattern=ol("fill-extrusion",this.layers,e);for(var i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.feature,l=o.id,s=o.index,u=o.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,p=jo(a,c);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),p,n)){var h={id:l,sourceLayerIndex:u,index:s,geometry:c?p.geometry:Uo(a),properties:a.properties,type:a.type,patterns:{}};this.hasPattern?this.features.push(al("fill-extrusion",this.layers,h,this.zoom,e)):this.addFeature(h,h.geometry,s,n,{}),e.featureIndex.insert(a,h.geometry,s,u,this.index,!0)}}},El.prototype.addFeatures=function(t,e,n){for(var i=0,r=this.features;i<r.length;i+=1){var o=r[i];this.addFeature(o,o.geometry,o.index,e,n)}},El.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},El.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},El.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},El.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,pl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},El.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},El.prototype.addFeature=function(t,e,n,i,r){for(var o=0,a=il(e,500);o<a.length;o+=1){for(var l=a[o],s=0,u=0,c=l;u<c.length;u+=1)s+=c[u].length;for(var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,d=l;h<d.length;h+=1){var f=d[h];if(0!==f.length&&!((D=f).every((function(t){return t.x<0}))||D.every((function(t){return t.x>8192}))||D.every((function(t){return t.y<0}))||D.every((function(t){return t.y>8192}))))for(var m=0,g=0;g<f.length;g++){var v=f[g];if(g>=1){var y=f[g-1];if(!Sl(v,y)){p.vertexLength+4>lo.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=v.sub(y)._perp()._unit(),b=y.dist(v);m+b>32768&&(m=0),Cl(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,m),Cl(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,m),Cl(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,0,m+=b),Cl(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,1,m);var x=p.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),p.vertexLength+=4,p.primitiveLength+=2}}}}if(p.vertexLength+s>lo.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray)),"Polygon"===xl[t.type]){for(var w=[],C=[],E=p.vertexLength,S=0,T=l;S<T.length;S+=1){var I=T[S];if(0!==I.length){I!==l[0]&&C.push(w.length/2);for(var P=0;P<I.length;P++){var A=I[P];Cl(this.layoutVertexArray,A.x,A.y,0,0,1,1,0),w.push(A.x),w.push(A.y)}}}for(var M=Ta(w,C),k=0;k<M.length;k+=3)this.indexArray.emplaceBack(E+M[k],E+M[k+2],E+M[k+1]);p.primitiveLength+=M.length/3,p.vertexLength+=s}}var D;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)},Bi("FillExtrusionBucket",El,{omit:["layers","features"]});var Tl={paint:new xr({"fill-extrusion-opacity":new gr(At["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new vr(At["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gr(At["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gr(At["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yr(At["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new vr(At["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new vr(At["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gr(At["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Il=function(t){function e(e){t.call(this,e,Tl)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new El(t)},e.prototype.queryRadius=function(){return na(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(t,e,n,i,o,a,l,s){var u=ia(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,l),c=this.paint.get("fill-extrusion-height").evaluate(e,n),p=this.paint.get("fill-extrusion-base").evaluate(e,n),h=function(t,e,n,i){for(var o=[],a=0,l=t;a<l.length;a+=1){var s=l[a],u=[s.x,s.y,0,1];pa(u,u,e),o.push(new r(u[0]/u[3],u[1]/u[3]))}return o}(u,s),d=function(t,e,n,i){for(var o=[],a=[],l=i[8]*e,s=i[9]*e,u=i[10]*e,c=i[11]*e,p=i[8]*n,h=i[9]*n,d=i[10]*n,f=i[11]*n,m=0,g=t;m<g.length;m+=1){for(var v=[],y=[],_=0,b=g[m];_<b.length;_+=1){var x=b[_],w=x.x,C=x.y,E=i[0]*w+i[4]*C+i[12],S=i[1]*w+i[5]*C+i[13],T=i[2]*w+i[6]*C+i[14],I=i[3]*w+i[7]*C+i[15],P=T+u,A=I+c,M=E+p,k=S+h,D=T+d,L=I+f,O=new r((E+l)/A,(S+s)/A);O.z=P/A,v.push(O);var R=new r(M/L,k/L);R.z=D/L,y.push(R)}o.push(v),a.push(y)}return[o,a]}(i,p,c,s);return function(t,e,n){var i=1/0;Ho(n,e)&&(i=Al(n,e[0]));for(var r=0;r<e.length;r++)for(var o=e[r],a=t[r],l=0;l<o.length-1;l++){var s=o[l],u=[s,o[l+1],a[l+1],a[l],s];Go(n,u)&&(i=Math.min(i,Al(n,u)))}return i!==1/0&&i}(d[0],d[1],h)},e}(wr);function Pl(t,e){return t.x*e.x+t.y*e.y}function Al(t,e){if(1===t.length){for(var n,i=0,r=e[i++];!n||r.equals(n);)if(!(n=e[i++]))return 1/0;for(;i<e.length;i++){var o=e[i],a=t[0],l=n.sub(r),s=o.sub(r),u=a.sub(r),c=Pl(l,l),p=Pl(l,s),h=Pl(s,s),d=Pl(u,l),f=Pl(u,s),m=c*h-p*p,g=(h*d-p*f)/m,v=(c*f-p*d)/m,y=r.z*(1-g-v)+n.z*g+o.z*v;if(isFinite(y))return y}return 1/0}for(var _=1/0,b=0,x=e;b<x.length;b+=1)_=Math.min(_,x[b].z);return _}var Ml=Tr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,kl=Tr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Dl=bl.VectorTileFeature.types,Ll=Math.cos(Math.PI/180*37.5),Ol=Math.pow(2,14)/.5,Rl=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((function(t){e.gradients[t.id]={}})),this.layoutVertexArray=new kr,this.layoutVertexArray2=new Dr,this.indexArray=new jr,this.programConfigurations=new Ro(t.layers,t.zoom),this.segments=new lo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};Rl.prototype.populate=function(t,e,n){this.hasPattern=ol("line",this.layers,e);for(var i=this.layers[0].layout.get("line-sort-key"),r=[],o=0,a=t;o<a.length;o+=1){var l=a[o],s=l.feature,u=l.id,c=l.index,p=l.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d=jo(s,h);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),d,n)){var f=i?i.evaluate(d,{},n):void 0,m={id:u,properties:s.properties,type:s.type,sourceLayerIndex:p,index:c,geometry:h?d.geometry:Uo(s),patterns:{},sortKey:f};r.push(m)}}i&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var g=0,v=r;g<v.length;g+=1){var y=v[g],_=y.geometry,b=y.index,x=y.sourceLayerIndex;if(this.hasPattern){var w=al("line",this.layers,y,this.zoom,e);this.patternFeatures.push(w)}else this.addFeature(y,_,b,n,{});e.featureIndex.insert(t[b].feature,_,b,x,this.index)}},Rl.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Rl.prototype.addFeatures=function(t,e,n){for(var i=0,r=this.patternFeatures;i<r.length;i+=1){var o=r[i];this.addFeature(o,o.geometry,o.index,e,n)}},Rl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Rl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Rl.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,kl)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ml),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Rl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Rl.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},Rl.prototype.addFeature=function(t,e,n,i,r){var o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),l=o.get("line-cap"),s=o.get("line-miter-limit"),u=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var c=0,p=e;c<p.length;c+=1)this.addLine(p[c],t,a,l,s,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)},Rl.prototype.addLine=function(t,e,n,i,r,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var a=0;a<t.length-1;a++)this.totalDistance+=t[a].dist(t[a+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var l="Polygon"===Dl[e.type],s=t.length;s>=2&&t[s-1].equals(t[s-2]);)s--;for(var u=0;u<s-1&&t[u].equals(t[u+1]);)u++;if(!(s<(l?3:2))){"bevel"===n&&(r=1.05);var c,p=this.overscaling<=16?122880/(512*this.overscaling):0,h=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray),d=void 0,f=void 0,m=void 0,g=void 0;this.e1=this.e2=-1,l&&(g=t[u].sub(c=t[s-2])._unit()._perp());for(var v=u;v<s;v++)if(!(f=v===s-1?l?t[u+1]:void 0:t[v+1])||!t[v].equals(f)){g&&(m=g),c&&(d=c),c=t[v],g=f?f.sub(c)._unit()._perp():m;var y=(m=m||g).add(g);0===y.x&&0===y.y||y._unit();var _=m.x*g.x+m.y*g.y,b=y.x*g.x+y.y*g.y,x=0!==b?1/b:1/0,w=2*Math.sqrt(2-2*b),C=b<Ll&&d&&f,E=m.x*g.y-m.y*g.x>0;if(C&&v>u){var S=c.dist(d);if(S>2*p){var T=c.sub(c.sub(d)._mult(p/S)._round());this.updateDistance(d,T),this.addCurrentVertex(T,m,0,0,h),d=T}}var I=d&&f,P=I?n:l?"butt":i;if(I&&"round"===P&&(x<o?P="miter":x<=2&&(P="fakeround")),"miter"===P&&x>r&&(P="bevel"),"bevel"===P&&(x>2&&(P="flipbevel"),x<r&&(P="miter")),d&&this.updateDistance(d,c),"miter"===P)y._mult(x),this.addCurrentVertex(c,y,0,0,h);else if("flipbevel"===P){if(x>100)y=g.mult(-1);else{var A=x*m.add(g).mag()/m.sub(g).mag();y._perp()._mult(A*(E?-1:1))}this.addCurrentVertex(c,y,0,0,h),this.addCurrentVertex(c,y.mult(-1),0,0,h)}else if("bevel"===P||"fakeround"===P){var M=-Math.sqrt(x*x-1),k=E?M:0,D=E?0:M;if(d&&this.addCurrentVertex(c,m,k,D,h),"fakeround"===P)for(var L=Math.round(180*w/Math.PI/20),O=1;O<L;O++){var R=O/L;if(.5!==R){var z=R-.5;R+=R*z*(R-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*z*z+(.848013+_*(.215638*_-1.06021)))}var F=g.sub(m)._mult(R)._add(m)._unit()._mult(E?-1:1);this.addHalfVertex(c,F.x,F.y,!1,E,0,h)}f&&this.addCurrentVertex(c,g,-k,-D,h)}else if("butt"===P)this.addCurrentVertex(c,y,0,0,h);else if("square"===P){var B=d?1:-1;this.addCurrentVertex(c,y,B,B,h)}else"round"===P&&(d&&(this.addCurrentVertex(c,m,0,0,h),this.addCurrentVertex(c,m,1,1,h,!0)),f&&(this.addCurrentVertex(c,g,-1,-1,h,!0),this.addCurrentVertex(c,g,0,0,h)));if(C&&v<s-1){var N=c.dist(f);if(N>2*p){var U=c.add(f.sub(c)._mult(p/N)._round());this.updateDistance(c,U),this.addCurrentVertex(U,g,0,0,h),c=U}}}}},Rl.prototype.addCurrentVertex=function(t,e,n,i,r,o){void 0===o&&(o=!1);var a=e.y*i-e.x,l=-e.y-e.x*i;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,o,!1,n,r),this.addHalfVertex(t,a,l,o,!0,-i,r),this.distance>Ol/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,n,i,r,o))},Rl.prototype.addHalfVertex=function(t,e,n,i,r,o,a){var l=.5*(this.lineClips?this.scaledDistance*(Ol-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(i?1:0),(t.y<<1)+(r?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var s=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,s),a.primitiveLength++),r?this.e2=s:this.e1=s},Rl.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Rl.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},Bi("LineBucket",Rl,{omit:["layers","patternFeatures"]});var zl=new xr({"line-cap":new gr(At.layout_line["line-cap"]),"line-join":new vr(At.layout_line["line-join"]),"line-miter-limit":new gr(At.layout_line["line-miter-limit"]),"line-round-limit":new gr(At.layout_line["line-round-limit"]),"line-sort-key":new vr(At.layout_line["line-sort-key"])}),Fl={paint:new xr({"line-opacity":new vr(At.paint_line["line-opacity"]),"line-color":new vr(At.paint_line["line-color"]),"line-translate":new gr(At.paint_line["line-translate"]),"line-translate-anchor":new gr(At.paint_line["line-translate-anchor"]),"line-width":new vr(At.paint_line["line-width"]),"line-gap-width":new vr(At.paint_line["line-gap-width"]),"line-offset":new vr(At.paint_line["line-offset"]),"line-blur":new vr(At.paint_line["line-blur"]),"line-dasharray":new _r(At.paint_line["line-dasharray"]),"line-pattern":new yr(At.paint_line["line-pattern"]),"line-gradient":new br(At.paint_line["line-gradient"])}),layout:zl},Bl=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new lr(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,i,r){return n=h({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,i,r)},e}(vr))(Fl.paint.properties["line-width"].specification);Bl.useIntegerZoom=!0;var Nl=function(t){function e(e){t.call(this,e,Fl),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof qe,this.gradientVersion=(this.gradientVersion+1)%l)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n),this.paint._values["line-floorwidth"]=Bl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new Rl(t)},e.prototype.queryRadius=function(t){var e=t,n=Ul(ea("line-width",this,e),ea("line-gap-width",this,e)),i=ea("line-offset",this,e);return n/2+Math.abs(i)+na(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,o,a,l){var s=ia(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,l),u=l/2*Ul(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),c=this.paint.get("line-offset").evaluate(e,n);return c&&(i=function(t,e){for(var n=[],i=new r(0,0),o=0;o<t.length;o++){for(var a=t[o],l=[],s=0;s<a.length;s++){var u=a[s],c=a[s+1],p=0===s?i:u.sub(a[s-1])._unit()._perp(),h=s===a.length-1?i:c.sub(u)._unit()._perp(),d=p._add(h)._unit();d._mult(1/(d.x*h.x+d.y*h.y)),l.push(d._mult(e)._add(u))}n.push(l)}return n}(i,c*l)),function(t,e,n){for(var i=0;i<e.length;i++){var r=e[i];if(t.length>=3)for(var o=0;o<r.length;o++)if(Qo(t,r[o]))return!0;if(Yo(t,r,n))return!0}return!1}(s,i,u)},e.prototype.isTileClipped=function(){return!0},e}(wr);function Ul(t,e){return e>0?e+2*t:t}var jl=Tr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Vl=Tr([{name:"a_projected_pos",components:3,type:"Float32"}],4),ql=(Tr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Tr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Gl=(Tr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Tr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Zl=Tr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Hl(t,e,n){return t.sections.forEach((function(t){t.text=function(t,e,n){var i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),ar.applyArabicShaping&&(t=ar.applyArabicShaping(t)),t}(t.text,e,n)})),t}Tr([{name:"triangle",components:3,type:"Uint16"}]),Tr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Tr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Tr([{type:"Float32",name:"offsetX"}]),Tr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Yl={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Xl=function(t,e,n,i,r){var o,a,l=8*r-i-1,s=(1<<l)-1,u=s>>1,c=-7,p=n?r-1:0,h=n?-1:1,d=t[e+p];for(p+=h,o=d&(1<<-c)-1,d>>=-c,c+=l;c>0;o=256*o+t[e+p],p+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;c>0;a=256*a+t[e+p],p+=h,c-=8);if(0===o)o=1-u;else{if(o===s)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),o-=u}return(d?-1:1)*a*Math.pow(2,o-i)},Wl=function(t,e,n,i,r,o){var a,l,s,u=8*o-r-1,c=(1<<u)-1,p=c>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-a))<1&&(a--,s*=2),(e+=a+p>=1?h/s:h*Math.pow(2,1-p))*s>=2&&(a++,s/=2),a+p>=c?(l=0,a=c):a+p>=1?(l=(e*s-1)*Math.pow(2,r),a+=p):(l=e*Math.pow(2,p-1)*Math.pow(2,r),a=0));r>=8;t[n+d]=255&l,d+=f,l/=256,r-=8);for(a=a<<r|l,u+=r;u>0;t[n+d]=255&a,d+=f,a/=256,u-=8);t[n+d-f]|=128*m},Kl=Jl;function Jl(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Jl.Varint=0,Jl.Fixed64=1,Jl.Bytes=2,Jl.Fixed32=5;var $l="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ql(t){return t.type===Jl.Bytes?t.readVarint()+t.pos:t.pos+1}function ts(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function es(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function ns(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function is(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function rs(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function os(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function as(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function ls(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function ss(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function us(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function cs(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function ps(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function hs(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function ds(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function fs(t,e,n){1===t&&n.readMessage(ms,e)}function ms(t,e,n){if(3===t){var i=n.readMessage(gs,{}),r=i.width,o=i.height,a=i.left,l=i.top,s=i.advance;e.push({id:i.id,bitmap:new ya({width:r+6,height:o+6},i.bitmap),metrics:{width:r,height:o,left:a,top:l,advance:s}})}}function gs(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function vs(t){for(var e=0,n=0,i=0,r=t;i<r.length;i+=1){var o=r[i];e+=o.w*o.h,n=Math.max(n,o.w)}t.sort((function(t,e){return e.h-t.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],l=0,s=0,u=0,c=t;u<c.length;u+=1)for(var p=c[u],h=a.length-1;h>=0;h--){var d=a[h];if(!(p.w>d.w||p.h>d.h)){if(p.x=d.x,p.y=d.y,s=Math.max(s,p.y+p.h),l=Math.max(l,p.x+p.w),p.w===d.w&&p.h===d.h){var f=a.pop();h<a.length&&(a[h]=f)}else p.h===d.h?(d.x+=p.w,d.w-=p.w):p.w===d.w?(d.y+=p.h,d.h-=p.h):(a.push({x:d.x+p.w,y:d.y,w:d.w-p.w,h:p.h}),d.y+=p.h,d.h-=p.h);break}}return{w:l,h:s,fill:e/(l*s)||0}}Jl.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ps(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=ds(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ps(this.buf,this.pos)+4294967296*ps(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=ps(this.buf,this.pos)+4294967296*ds(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Xl(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Xl(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,o=n.buf;if(i=(112&(r=o[n.pos++]))>>4,r<128)return ts(t,i,e);if(i|=(127&(r=o[n.pos++]))<<3,r<128)return ts(t,i,e);if(i|=(127&(r=o[n.pos++]))<<10,r<128)return ts(t,i,e);if(i|=(127&(r=o[n.pos++]))<<17,r<128)return ts(t,i,e);if(i|=(127&(r=o[n.pos++]))<<24,r<128)return ts(t,i,e);if(i|=(1&(r=o[n.pos++]))<<31,r<128)return ts(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&$l?function(t,e,n){return $l.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",r=e;r<n;){var o,a,l,s=t[r],u=null,c=s>239?4:s>223?3:s>191?2:1;if(r+c>n)break;1===c?s<128&&(u=s):2===c?128==(192&(o=t[r+1]))&&(u=(31&s)<<6|63&o)<=127&&(u=null):3===c?(a=t[r+2],128==(192&(o=t[r+1]))&&128==(192&a)&&((u=(15&s)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(a=t[r+2],l=t[r+3],128==(192&(o=t[r+1]))&&128==(192&a)&&128==(192&l)&&((u=(15&s)<<18|(63&o)<<12|(63&a)<<6|63&l)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),r+=c}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Jl.Bytes)return t.push(this.readVarint(e));var n=Ql(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Jl.Bytes)return t.push(this.readSVarint());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Jl.Bytes)return t.push(this.readBoolean());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Jl.Bytes)return t.push(this.readFloat());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Jl.Bytes)return t.push(this.readDouble());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Jl.Bytes)return t.push(this.readFixed32());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Jl.Bytes)return t.push(this.readSFixed32());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Jl.Bytes)return t.push(this.readFixed64());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Jl.Bytes)return t.push(this.readSFixed64());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Jl.Varint)for(;this.buf[this.pos++]>127;);else if(e===Jl.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Jl.Fixed32)this.pos+=4;else{if(e!==Jl.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),hs(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),hs(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),hs(this.buf,-1&t,this.pos),hs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),hs(this.buf,-1&t,this.pos),hs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&es(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Wl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Wl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&es(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,Jl.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,ns,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,is,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,as,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,rs,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,os,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,ls,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ss,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,us,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,cs,e)},writeBytesField:function(t,e){this.writeTag(t,Jl.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Jl.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Jl.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Jl.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Jl.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Jl.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Jl.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Jl.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Jl.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Jl.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var ys=function(t,e){var n=e.pixelRatio,i=e.version,r=e.stretchX,o=e.stretchY,a=e.content;this.paddedRect=t,this.pixelRatio=n,this.stretchX=r,this.stretchY=o,this.content=a,this.version=i},_s={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};_s.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},_s.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},_s.tlbr.get=function(){return this.tl.concat(this.br)},_s.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(ys.prototype,_s);var bs=function(t,e){var n={},i={};this.haveRenderCallbacks=[];var r=[];this.addImages(t,n,r),this.addImages(e,i,r);var o=vs(r),a=new _a({width:o.w||1,height:o.h||1});for(var l in t){var s=t[l],u=n[l].paddedRect;_a.copy(s.data,a,{x:0,y:0},{x:u.x+1,y:u.y+1},s.data)}for(var c in e){var p=e[c],h=i[c].paddedRect,d=h.x+1,f=h.y+1,m=p.data.width,g=p.data.height;_a.copy(p.data,a,{x:0,y:0},{x:d,y:f},p.data),_a.copy(p.data,a,{x:0,y:g-1},{x:d,y:f-1},{width:m,height:1}),_a.copy(p.data,a,{x:0,y:0},{x:d,y:f+g},{width:m,height:1}),_a.copy(p.data,a,{x:m-1,y:0},{x:d-1,y:f},{width:1,height:g}),_a.copy(p.data,a,{x:0,y:0},{x:d+m,y:f},{width:1,height:g})}this.image=a,this.iconPositions=n,this.patternPositions=i};bs.prototype.addImages=function(t,e,n){for(var i in t){var r=t[i],o={x:0,y:0,w:r.data.width+2,h:r.data.height+2};n.push(o),e[i]=new ys(o,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}},bs.prototype.patchUpdatedImages=function(t,e){for(var n in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)},bs.prototype.patchUpdatedImage=function(t,e,n){if(t&&e&&t.version!==e.version){t.version=e.version;var i=t.tl;n.update(e.data,void 0,{x:i[0],y:i[1]})}},Bi("ImagePosition",ys),Bi("ImageAtlas",bs);var xs={horizontal:1,vertical:2,horizontalOnly:3},ws=function(){this.scale=1,this.fontStack="",this.imageName=null};ws.forText=function(t,e){var n=new ws;return n.scale=t||1,n.fontStack=e,n},ws.forImage=function(t){var e=new ws;return e.imageName=t,e};var Cs=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Es(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m){var g,v=Cs.fromFeature(t,r);p===xs.vertical&&v.verticalizePunctuation();var y=ar.processBidirectionalText,_=ar.processStyledBidirectionalText;if(y&&1===v.sections.length){g=[];for(var b=0,x=y(v.toString(),ks(v,u,o,e,i,d,f));b<x.length;b+=1){var w=x[b],C=new Cs;C.text=w,C.sections=v.sections;for(var E=0;E<w.length;E++)C.sectionIndex.push(0);g.push(C)}}else if(_){g=[];for(var S=0,T=_(v.text,v.sectionIndex,ks(v,u,o,e,i,d,f));S<T.length;S+=1){var I=T[S],P=new Cs;P.text=I[0],P.sectionIndex=I[1],P.sections=v.sections,g.push(P)}}else g=function(t,e){for(var n=[],i=t.text,r=0,o=0,a=e;o<a.length;o+=1){var l=a[o];n.push(t.substring(r,l)),r=l}return r<i.length&&n.push(t.substring(r,i.length)),n}(v,ks(v,u,o,e,i,d,f));var A=[],M={positionedLines:A,text:v.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(t,e,n,i,r,o,a,l,s,u,c,p){for(var h=0,d=-17,f=0,m=0,g="right"===l?1:"left"===l?0:.5,v=0,y=0,_=r;y<_.length;y+=1){var b=_[y];b.trim();var x=b.getMaxScale(),w=24*(x-1),C={positionedGlyphs:[],lineOffset:0};t.positionedLines[v]=C;var E=C.positionedGlyphs,S=0;if(b.length()){for(var T=0;T<b.length();T++){var I=b.getSection(T),P=b.getSectionIndex(T),A=b.getCharCode(T),M=0,k=null,D=null,L=null,O=24,R=!(s===xs.horizontal||!c&&!Yi(A)||c&&(Ss[A]||(G=A,Zi.Arabic(G)||Zi["Arabic Supplement"](G)||Zi["Arabic Extended-A"](G)||Zi["Arabic Presentation Forms-A"](G)||Zi["Arabic Presentation Forms-B"](G))));if(I.imageName){var z=i[I.imageName];if(!z)continue;L=I.imageName,t.iconsInText=t.iconsInText||!0,D=z.paddedRect;var F=z.displaySize;I.scale=24*I.scale/p,M=w+(24-F[1]*I.scale),O=(k={width:F[0],height:F[1],left:1,top:-3,advance:R?F[1]:F[0]}).advance;var B=R?F[0]*I.scale-24*x:F[1]*I.scale-24*x;B>0&&B>S&&(S=B)}else{var N=n[I.fontStack],U=N&&N[A];if(U&&U.rect)D=U.rect,k=U.metrics;else{var j=e[I.fontStack],V=j&&j[A];if(!V)continue;k=V.metrics}M=24*(x-I.scale)}R?(t.verticalizable=!0,E.push({glyph:A,imageName:L,x:h,y:d+M,vertical:R,scale:I.scale,fontStack:I.fontStack,sectionIndex:P,metrics:k,rect:D}),h+=O*I.scale+u):(E.push({glyph:A,imageName:L,x:h,y:d+M,vertical:R,scale:I.scale,fontStack:I.fontStack,sectionIndex:P,metrics:k,rect:D}),h+=k.advance*I.scale+u)}0!==E.length&&(f=Math.max(h-u,f),Ls(E,0,E.length-1,g,S)),h=0;var q=o*x+S;C.lineOffset=Math.max(S,w),d+=q,m=Math.max(q,m),++v}else d+=o,++v}var G,Z=d- -17,H=Ds(a),Y=H.horizontalAlign,X=H.verticalAlign;(function(t,e,n,i,r,o,a,l,s){var u,c=(e-n)*r;u=o!==a?-l*i- -17:(-i*s+.5)*a;for(var p=0,h=t;p<h.length;p+=1)for(var d=0,f=h[p].positionedGlyphs;d<f.length;d+=1){var m=f[d];m.x+=c,m.y+=u}})(t.positionedLines,g,Y,X,f,m,o,Z,r.length),t.top+=-X*Z,t.bottom=t.top+Z,t.left+=-Y*f,t.right=t.left+f}(M,e,n,i,g,a,l,s,p,u,h,m),!function(t){for(var e=0,n=t;e<n.length;e+=1)if(0!==n[e].positionedGlyphs.length)return!1;return!0}(A)&&M}Cs.fromFeature=function(t,e){for(var n=new Cs,i=0;i<t.sections.length;i++){var r=t.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,e)}return n},Cs.prototype.length=function(){return this.text.length},Cs.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Cs.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},Cs.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Cs.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;e+=i&&Xi(i)&&!Yl[t[n+1]]||r&&Xi(r)&&!Yl[t[n-1]]||!Yl[t[n]]?t[n]:Yl[t[n]]}return e}(this.text)},Cs.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Ss[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,i=this.text.length-1;i>=0&&i>=t&&Ss[this.text.charCodeAt(i)];i--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)},Cs.prototype.substring=function(t,e){var n=new Cs;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n},Cs.prototype.toString=function(){return this.text},Cs.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce((function(e,n){return Math.max(e,t.sections[n].scale)}),0)},Cs.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(ws.forText(t.scale,t.fontStack||e));for(var n=this.sections.length-1,i=0;i<t.text.length;++i)this.sectionIndex.push(n)},Cs.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(ws.forImage(e)),this.sectionIndex.push(this.sections.length-1)):C("Reached maximum number of images 6401")}else C("Can't add FormattedSection with an empty image.")},Cs.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Ss={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ts={};function Is(t,e,n,i,r,o){if(e.imageName){var a=i[e.imageName];return a?a.displaySize[0]*e.scale*24/o+r:0}var l=n[e.fontStack],s=l&&l[t];return s?s.metrics.advance*e.scale+r:0}function Ps(t,e,n,i){var r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function As(t,e,n){var i=0;return 10===t&&(i-=1e4),n&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function Ms(t,e,n,i,r,o){for(var a=null,l=Ps(e,n,r,o),s=0,u=i;s<u.length;s+=1){var c=u[s],p=Ps(e-c.x,n,r,o)+c.badness;p<=l&&(a=c,l=p)}return{index:t,x:e,priorBreak:a,badness:l}}function ks(t,e,n,i,r,o,a){if("point"!==o)return[];if(!t)return[];for(var l,s=[],u=function(t,e,n,i,r,o){for(var a=0,l=0;l<t.length();l++){var s=t.getSection(l);a+=Is(t.getCharCode(l),s,i,r,e,o)}return a/Math.max(1,Math.ceil(a/n))}(t,e,n,i,r,a),c=t.text.indexOf("\u200b")>=0,p=0,h=0;h<t.length();h++){var d=t.getSection(h),f=t.getCharCode(h);if(Ss[f]||(p+=Is(f,d,i,r,e,a)),h<t.length()-1){var m=!((l=f)<11904||!(Zi["Bopomofo Extended"](l)||Zi.Bopomofo(l)||Zi["CJK Compatibility Forms"](l)||Zi["CJK Compatibility Ideographs"](l)||Zi["CJK Compatibility"](l)||Zi["CJK Radicals Supplement"](l)||Zi["CJK Strokes"](l)||Zi["CJK Symbols and Punctuation"](l)||Zi["CJK Unified Ideographs Extension A"](l)||Zi["CJK Unified Ideographs"](l)||Zi["Enclosed CJK Letters and Months"](l)||Zi["Halfwidth and Fullwidth Forms"](l)||Zi.Hiragana(l)||Zi["Ideographic Description Characters"](l)||Zi["Kangxi Radicals"](l)||Zi["Katakana Phonetic Extensions"](l)||Zi.Katakana(l)||Zi["Vertical Forms"](l)||Zi["Yi Radicals"](l)||Zi["Yi Syllables"](l)));(Ts[f]||m||d.imageName)&&s.push(Ms(h+1,p,u,s,As(f,t.getCharCode(h+1),m&&c),!1))}}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Ms(t.length(),p,u,s,0,!0))}function Ds(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Ls(t,e,n,i,r){if(i||r)for(var o=t[n],a=(t[n].x+o.metrics.advance*o.scale)*i,l=e;l<=n;l++)t[l].x-=a,t[l].y+=r}function Os(t,e,n,i,r,o){var a,l=t.image;if(l.content){var s=l.content,u=l.pixelRatio||1;a=[s[0]/u,s[1]/u,l.displaySize[0]-s[2]/u,l.displaySize[1]-s[3]/u]}var c,p,h,d,f=e.left*o,m=e.right*o;"width"===n||"both"===n?(d=r[0]+f-i[3],p=r[0]+m+i[1]):p=(d=r[0]+(f+m-l.displaySize[0])/2)+l.displaySize[0];var g=e.top*o,v=e.bottom*o;return"height"===n||"both"===n?(c=r[1]+g-i[0],h=r[1]+v+i[2]):h=(c=r[1]+(g+v-l.displaySize[1])/2)+l.displaySize[1],{image:l,top:c,right:p,bottom:h,left:d,collisionPadding:a}}Ts[10]=!0,Ts[32]=!0,Ts[38]=!0,Ts[40]=!0,Ts[41]=!0,Ts[43]=!0,Ts[45]=!0,Ts[47]=!0,Ts[173]=!0,Ts[183]=!0,Ts[8203]=!0,Ts[8208]=!0,Ts[8211]=!0,Ts[8231]=!0;var Rs=function(t){function e(e,n,i,r){t.call(this,e,n),this.angle=i,void 0!==r&&(this.segment=r)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(r);function zs(t,e){var n=e.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new lr(t+1))};if("source"===n.kind)return{kind:"source"};for(var i=n.zoomStops,r=n.interpolationType,o=0;o<i.length&&i[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<i.length&&i[a]<t+1;)a++;a=Math.min(i.length-1,a);var l=i[o],s=i[a];return"composite"===n.kind?{kind:"composite",minZoom:l,maxZoom:s,interpolationType:r}:{kind:"camera",minZoom:l,maxZoom:s,minSize:n.evaluate(new lr(l)),maxSize:n.evaluate(new lr(s)),interpolationType:r}}function Fs(t,e,n){var i=e.uSize,r=n.lowerSize;return"source"===t.kind?r/128:"composite"===t.kind?Ge(r/128,n.upperSize/128,e.uSizeT):i}function Bs(t,e){var n=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){var r=t.interpolationType,o=r?c(an.interpolationFactor(r,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?i=Ge(t.minSize,t.maxSize,o):n=o}return{uSizeT:n,uSize:i}}Bi("Anchor",Rs);var Ns=Object.freeze({__proto__:null,getSizeData:zs,evaluateSizeForFeature:Fs,evaluateSizeForZoom:Bs,SIZE_PACK_FACTOR:128});function Us(t,e,n,i,r){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,l=0;l>-n/2;){if(--a<0)return!1;l-=t[a].dist(o),o=t[a]}l+=t[a].dist(t[a+1]),a++;for(var s=[],u=0;l<n/2;){var c=t[a],p=t[a+1];if(!p)return!1;var h=t[a-1].angleTo(c)-c.angleTo(p);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),s.push({distance:l,angleDelta:h}),u+=h;l-s[0].distance>i;)u-=s.shift().angleDelta;if(u>r)return!1;a++,l+=c.dist(p)}return!0}function js(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Vs(t,e,n){return t?.6*e*n:0}function qs(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Gs(t,e,n,i,r,o){for(var a=Vs(n,r,o),l=qs(n,i)*o,s=0,u=js(t)/2,c=0;c<t.length-1;c++){var p=t[c],h=t[c+1],d=p.dist(h);if(s+d>u){var f=(u-s)/d,m=Ge(p.x,h.x,f),g=Ge(p.y,h.y,f),v=new Rs(m,g,h.angleTo(p),c);return v._round(),!a||Us(t,v,l,a,e)?v:void 0}s+=d}}function Zs(t,e,n,i,r,o,a,l,s){var u=Vs(i,o,a),c=qs(i,r),p=c*a,h=0===t[0].x||t[0].x===s||0===t[0].y||t[0].y===s;return e-p<e/4&&(e=p+e/4),function t(e,n,i,r,o,a,l,s,u){for(var c=a/2,p=js(e),h=0,d=n-i,f=[],m=0;m<e.length-1;m++){for(var g=e[m],v=e[m+1],y=g.dist(v),_=v.angleTo(g);d+i<h+y;){var b=((d+=i)-h)/y,x=Ge(g.x,v.x,b),w=Ge(g.y,v.y,b);if(x>=0&&x<u&&w>=0&&w<u&&d-c>=0&&d+c<=p){var C=new Rs(x,w,_,m);C._round(),r&&!Us(e,C,a,r,o)||f.push(C)}}h+=y}return s||f.length||l||(f=t(e,h/2,i,r,o,a,l,!0,u)),f}(t,h?e/2*l%e:(c/2+2*o)*a*l%e,e,u,n,p,h,!1,s)}function Hs(t,e,n,i,o){for(var a=[],l=0;l<t.length;l++)for(var s=t[l],u=void 0,c=0;c<s.length-1;c++){var p=s[c],h=s[c+1];p.x<e&&h.x<e||(p.x<e?p=new r(e,p.y+(e-p.x)/(h.x-p.x)*(h.y-p.y))._round():h.x<e&&(h=new r(e,p.y+(e-p.x)/(h.x-p.x)*(h.y-p.y))._round()),p.y<n&&h.y<n||(p.y<n?p=new r(p.x+(n-p.y)/(h.y-p.y)*(h.x-p.x),n)._round():h.y<n&&(h=new r(p.x+(n-p.y)/(h.y-p.y)*(h.x-p.x),n)._round()),p.x>=i&&h.x>=i||(p.x>=i?p=new r(i,p.y+(i-p.x)/(h.x-p.x)*(h.y-p.y))._round():h.x>=i&&(h=new r(i,p.y+(i-p.x)/(h.x-p.x)*(h.y-p.y))._round()),p.y>=o&&h.y>=o||(p.y>=o?p=new r(p.x+(o-p.y)/(h.y-p.y)*(h.x-p.x),o)._round():h.y>=o&&(h=new r(p.x+(o-p.y)/(h.y-p.y)*(h.x-p.x),o)._round()),u&&p.equals(u[u.length-1])||a.push(u=[p]),u.push(h)))))}return a}function Ys(t,e,n,i){var o=[],a=t.image,l=a.pixelRatio,s=a.paddedRect.w-2,u=a.paddedRect.h-2,c=t.right-t.left,p=t.bottom-t.top,h=a.stretchX||[[0,s]],d=a.stretchY||[[0,u]],f=function(t,e){return t+e[1]-e[0]},m=h.reduce(f,0),g=d.reduce(f,0),v=s-m,y=u-g,_=0,b=m,x=0,w=g,C=0,E=v,S=0,T=y;if(a.content&&i){var I=a.content;_=Xs(h,0,I[0]),x=Xs(d,0,I[1]),b=Xs(h,I[0],I[2]),w=Xs(d,I[1],I[3]),C=I[0]-_,S=I[1]-x,E=I[2]-I[0]-b,T=I[3]-I[1]-w}var P=function(i,o,s,u){var h=Ks(i.stretch-_,b,c,t.left),d=Js(i.fixed-C,E,i.stretch,m),f=Ks(o.stretch-x,w,p,t.top),v=Js(o.fixed-S,T,o.stretch,g),y=Ks(s.stretch-_,b,c,t.left),I=Js(s.fixed-C,E,s.stretch,m),P=Ks(u.stretch-x,w,p,t.top),A=Js(u.fixed-S,T,u.stretch,g),M=new r(h,f),k=new r(y,f),D=new r(y,P),L=new r(h,P),O=new r(d/l,v/l),R=new r(I/l,A/l),z=e*Math.PI/180;if(z){var F=Math.sin(z),B=Math.cos(z),N=[B,-F,F,B];M._matMult(N),k._matMult(N),L._matMult(N),D._matMult(N)}var U=i.stretch+i.fixed,j=o.stretch+o.fixed;return{tl:M,tr:k,bl:L,br:D,tex:{x:a.paddedRect.x+1+U,y:a.paddedRect.y+1+j,w:s.stretch+s.fixed-U,h:u.stretch+u.fixed-j},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:O,pixelOffsetBR:R,minFontScaleX:E/l/c,minFontScaleY:T/l/p,isSDF:n}};if(i&&(a.stretchX||a.stretchY))for(var A=Ws(h,v,m),M=Ws(d,y,g),k=0;k<A.length-1;k++)for(var D=A[k],L=A[k+1],O=0;O<M.length-1;O++)o.push(P(D,M[O],L,M[O+1]));else o.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:u+1}));return o}function Xs(t,e,n){for(var i=0,r=0,o=t;r<o.length;r+=1){var a=o[r];i+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]))}return i}function Ws(t,e,n){for(var i=[{fixed:-1,stretch:0}],r=0,o=t;r<o.length;r+=1){var a=o[r],l=a[0],s=a[1],u=i[i.length-1];i.push({fixed:l-u.stretch,stretch:u.stretch}),i.push({fixed:l-u.stretch,stretch:u.stretch+(s-l)})}return i.push({fixed:e+1,stretch:n}),i}function Ks(t,e,n,i){return t/e*n+i}function Js(t,e,n,i){return t-e*n/i}var $s=function(t,e,n,i,o,a,l,s,u,c){if(this.boxStartIndex=t.length,u){var p=a.top,h=a.bottom,d=a.collisionPadding;d&&(p-=d[1],h+=d[3]);var f=h-p;f>0&&(f=Math.max(10,f),this.circleDiameter=f)}else{var m=a.top*l-s,g=a.bottom*l+s,v=a.left*l-s,y=a.right*l+s,_=a.collisionPadding;if(_&&(v-=_[0]*l,m-=_[1]*l,y+=_[2]*l,g+=_[3]*l),c){var b=new r(v,m),x=new r(y,m),w=new r(v,g),C=new r(y,g),E=c*Math.PI/180;b._rotate(E),x._rotate(E),w._rotate(E),C._rotate(E),v=Math.min(b.x,x.x,w.x,C.x),y=Math.max(b.x,x.x,w.x,C.x),m=Math.min(b.y,x.y,w.y,C.y),g=Math.max(b.y,x.y,w.y,C.y)}t.emplaceBack(e.x,e.y,v,m,y,g,n,i,o)}this.boxEndIndex=t.length},Qs=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=tu),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};function tu(t,e){return t<e?-1:t>e?1:0}function eu(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);for(var i=1/0,o=1/0,a=-1/0,l=-1/0,s=t[0],u=0;u<s.length;u++){var c=s[u];(!u||c.x<i)&&(i=c.x),(!u||c.y<o)&&(o=c.y),(!u||c.x>a)&&(a=c.x),(!u||c.y>l)&&(l=c.y)}var p=Math.min(a-i,l-o),h=p/2,d=new Qs([],nu);if(0===p)return new r(i,o);for(var f=i;f<a;f+=p)for(var m=o;m<l;m+=p)d.push(new iu(f+h,m+h,h,t));for(var g=function(t){for(var e=0,n=0,i=0,r=t[0],o=0,a=r.length,l=a-1;o<a;l=o++){var s=r[o],u=r[l],c=s.x*u.y-u.x*s.y;n+=(s.x+u.x)*c,i+=(s.y+u.y)*c,e+=3*c}return new iu(n/e,i/e,0,t)}(t),v=d.length;d.length;){var y=d.pop();(y.d>g.d||!g.d)&&(g=y,n&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,v)),y.max-g.d<=e||(d.push(new iu(y.p.x-(h=y.h/2),y.p.y-h,h,t)),d.push(new iu(y.p.x+h,y.p.y-h,h,t)),d.push(new iu(y.p.x-h,y.p.y+h,h,t)),d.push(new iu(y.p.x+h,y.p.y+h,h,t)),v+=4)}return n&&(console.log("num probes: "+v),console.log("best distance: "+g.d)),g.p}function nu(t,e){return e.max-t.max}function iu(t,e,n,i){this.p=new r(t,e),this.h=n,this.d=function(t,e){for(var n=!1,i=1/0,r=0;r<e.length;r++)for(var o=e[r],a=0,l=o.length,s=l-1;a<l;s=a++){var u=o[a],c=o[s];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(n=!n),i=Math.min(i,Jo(t,u,c))}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}Qs.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Qs.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},Qs.prototype.peek=function(){return this.data[0]},Qs.prototype._up=function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i},Qs.prototype._down=function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),a=e[o],l=o+1;if(l<this.length&&n(e[l],a)<0&&(o=l,a=e[l]),n(a,r)>=0)break;e[t]=a,t=o}e[t]=r};var ru=Number.POSITIVE_INFINITY;function ou(t,e){return e[1]!==ru?function(t,e,n){var i=0,r=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":r=n-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-n}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,r]}(t,e[0],e[1]):function(t,e){var n=0,i=0;e<0&&(e=0);var r=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":i=r-7;break;case"bottom-right":case"bottom-left":i=7-r;break;case"bottom":i=7-e;break;case"top":i=e-7}switch(t){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=e;break;case"right":n=-e}return[n,i]}(t,e[0])}function au(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lu(t,e,n,i,o,a,l,s,u,c,p,h,d,f,m){var g=function(t,e,n,i,o,a,l,s){for(var u=i.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,c=[],p=0,h=e.positionedLines;p<h.length;p+=1)for(var d=h[p],f=0,m=d.positionedGlyphs;f<m.length;f+=1){var g=m[f];if(g.rect){var v=g.rect||{},y=4,_=!0,b=1,x=0,w=(o||s)&&g.vertical,C=g.metrics.advance*g.scale/2;if(s&&e.verticalizable&&(x=d.lineOffset/2-(g.imageName?-(24-g.metrics.width*g.scale)/2:24*(g.scale-1))),g.imageName){var E=l[g.imageName];_=E.sdf,y=1/(b=E.pixelRatio)}var S=o?[g.x+C,g.y]:[0,0],T=o?[0,0]:[g.x+C+n[0],g.y+n[1]-x],I=[0,0];w&&(I=T,T=[0,0]);var P=(g.metrics.left-y)*g.scale-C+T[0],A=(-g.metrics.top-y)*g.scale+T[1],M=P+v.w*g.scale/b,k=A+v.h*g.scale/b,D=new r(P,A),L=new r(M,A),O=new r(P,k),R=new r(M,k);if(w){var z=new r(-C,C- -17),F=-Math.PI/2,B=12-C,N=new r(22-B,-(g.imageName?B:0)),U=new(Function.prototype.bind.apply(r,[null].concat(I)));D._rotateAround(F,z)._add(N)._add(U),L._rotateAround(F,z)._add(N)._add(U),O._rotateAround(F,z)._add(N)._add(U),R._rotateAround(F,z)._add(N)._add(U)}if(u){var j=Math.sin(u),V=Math.cos(u),q=[V,-j,j,V];D._matMult(q),L._matMult(q),O._matMult(q),R._matMult(q)}var G=new r(0,0),Z=new r(0,0);c.push({tl:D,tr:L,bl:O,br:R,tex:v,writingMode:e.writingMode,glyphOffset:S,sectionIndex:g.sectionIndex,isSDF:_,pixelOffsetTL:G,pixelOffsetBR:Z,minFontScaleX:0,minFontScaleY:0})}}return c}(0,n,s,o,a,l,i,t.allowVerticalPlacement),v=t.textSizeData,y=null;"source"===v.kind?(y=[128*o.layout.get("text-size").evaluate(l,{})])[0]>32640&&C(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===v.kind&&((y=[128*f.compositeTextSizes[0].evaluate(l,{},m),128*f.compositeTextSizes[1].evaluate(l,{},m)])[0]>32640||y[1]>32640)&&C(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,g,y,s,a,l,c,e,u.lineStartIndex,u.lineLength,d,m);for(var _=0,b=p;_<b.length;_+=1)h[b[_]]=t.text.placedSymbolArray.length-1;return 4*g.length}function su(t){for(var e in t)return t[e];return null}function uu(t,e,n,i){var r=t.compareText;if(e in r){for(var o=r[e],a=o.length-1;a>=0;a--)if(i.dist(o[a])<n)return!0}else r[e]=[];return r[e].push(i),!1}var cu=bl.VectorTileFeature.types,pu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hu(t,e,n,i,r,o,a,l,s,u,c,p,h){var d=l?Math.min(32640,Math.round(l[0])):0,f=l?Math.min(32640,Math.round(l[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),o,a,(d<<1)+(s?1:0),f,16*u,16*c,256*p,256*h)}function du(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function fu(t){for(var e=0,n=t.sections;e<n.length;e+=1)if(Ji(n[e].text))return!0;return!1}var mu=function(t){this.layoutVertexArray=new Or,this.indexArray=new jr,this.programConfigurations=t,this.segments=new lo,this.dynamicLayoutVertexArray=new Rr,this.opacityVertexArray=new zr,this.placedSymbolArray=new Qr};mu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},mu.prototype.upload=function(t,e,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Vl.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,pu,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))},mu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Bi("SymbolBuffers",mu);var gu=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new lo,this.collisionVertexArray=new Ur};gu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,ql.members,!0)},gu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Bi("CollisionBuffers",gu);var vu=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=la([]),this.placementViewportMatrix=la([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zs(this.zoom,e["text-size"]),this.iconSizeData=zs(this.zoom,e["icon-size"]);var n=this.layers[0].layout,i=n.get("symbol-sort-key"),r=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((function(t){return xs[t]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=t.sourceID};vu.prototype.createArrays=function(){this.text=new mu(new Ro(this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new mu(new Ro(this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.glyphOffsetArray=new no,this.lineVertexArray=new io,this.symbolInstances=new eo},vu.prototype.calculateGlyphDependencies=function(t,e,n,i,r){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(n||i)&&r){var a=Yl[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},vu.prototype.populate=function(t,e,n){var i=this.layers[0],r=i.layout,o=r.get("text-font"),a=r.get("text-field"),l=r.get("icon-image"),s=("constant"!==a.value.kind||a.value.value instanceof ie&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,c=r.get("symbol-sort-key");if(this.features=[],s||u){for(var p=e.iconDependencies,h=e.glyphDependencies,d=e.availableImages,f=new lr(this.zoom),m=0,g=t;m<g.length;m+=1){var v=g[m],y=v.feature,_=v.id,b=v.index,x=v.sourceLayerIndex,w=i._featureFilter.needGeometry,C=jo(y,w);if(i._featureFilter.filter(f,C,n)){w||(C.geometry=Uo(y));var E=void 0;if(s){var S=i.getValueAndResolveTokens("text-field",C,n,d),T=ie.factory(S);fu(T)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===rr()||this.hasRTLText&&ar.isParsed())&&(E=Hl(T,i,C))}var I=void 0;if(u){var P=i.getValueAndResolveTokens("icon-image",C,n,d);I=P instanceof re?P:re.fromString(P)}if(E||I){var A=this.sortFeaturesByKey?c.evaluate(C,{},n):void 0;if(this.features.push({id:_,text:E,icon:I,index:b,sourceLayerIndex:x,geometry:C.geometry,properties:y.properties,type:cu[y.type],sortKey:A}),I&&(p[I.name]=!0),E){var M=o.evaluate(C,{},n).join(","),k="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(xs.vertical)>=0;for(var D=0,L=E.sections;D<L.length;D+=1){var O=L[D];if(O.image)p[O.image.name]=!0;else{var R=Hi(E.toString()),z=O.fontStack||M,F=h[z]=h[z]||{};this.calculateGlyphDependencies(O.text,F,k,this.allowVerticalPlacement,R)}}}}}}"line"===r.get("symbol-placement")&&(this.features=function(t){var e={},n={},i=[],r=0;function o(e){i.push(t[e]),r++}function a(t,e,r){var o=n[t];return delete n[t],n[e]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(r[0]),o}function l(t,n,r){var o=e[n];return delete e[n],e[t]=o,i[o].geometry[0].shift(),i[o].geometry[0]=r[0].concat(i[o].geometry[0]),o}function s(t,e,n){var i=n?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}for(var u=0;u<t.length;u++){var c=t[u],p=c.geometry,h=c.text?c.text.toString():null;if(h){var d=s(h,p),f=s(h,p,!0);if(d in n&&f in e&&n[d]!==e[f]){var m=l(d,f,p),g=a(d,f,i[m].geometry);delete e[d],delete n[f],n[s(h,i[g].geometry,!0)]=g,i[m].geometry=null}else d in n?a(d,f,p):f in e?l(d,f,p):(o(u),e[d]=r-1,n[f]=r-1)}else o(u)}return i.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}},vu.prototype.update=function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))},vu.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},vu.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},vu.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},vu.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},vu.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},vu.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var i=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:i},a<e.length-1&&(i+=e[a+1].dist(e[a]));for(var l=t.segment||0;l>=0;l--)o[l]={x:e[l].x,y:e[l].y,tileUnitDistanceFromAnchor:r},l>0&&(r+=e[l-1].dist(e[l]));for(var s=0;s<e.length;s++){var u=o[s];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},vu.prototype.addSymbols=function(t,e,n,i,r,o,a,l,s,u,c,p){for(var h=t.indexArray,d=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,d,h,this.canOverlap?o.sortKey:void 0),m=this.glyphOffsetArray.length,g=f.vertexLength,v=this.allowVerticalPlacement&&a===xs.vertical?Math.PI/2:0,y=o.text&&o.text.sections,_=0;_<e.length;_++){var b=e[_],x=b.tl,w=b.tr,C=b.bl,E=b.br,S=b.tex,T=b.pixelOffsetTL,I=b.pixelOffsetBR,P=b.minFontScaleX,A=b.minFontScaleY,M=b.glyphOffset,k=b.isSDF,D=b.sectionIndex,L=f.vertexLength,O=M[1];hu(d,l.x,l.y,x.x,O+x.y,S.x,S.y,n,k,T.x,T.y,P,A),hu(d,l.x,l.y,w.x,O+w.y,S.x+S.w,S.y,n,k,I.x,T.y,P,A),hu(d,l.x,l.y,C.x,O+C.y,S.x,S.y+S.h,n,k,T.x,I.y,P,A),hu(d,l.x,l.y,E.x,O+E.y,S.x+S.w,S.y+S.h,n,k,I.x,I.y,P,A),du(t.dynamicLayoutVertexArray,l,v),h.emplaceBack(L,L+1,L+2),h.emplaceBack(L+1,L+2,L+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(M[0]),_!==e.length-1&&D===e[_+1].sectionIndex||t.programConfigurations.populatePaintArrays(d.length,o,o.index,{},p,y&&y[D])}t.placedSymbolArray.emplaceBack(l.x,l.y,m,this.glyphOffsetArray.length-m,g,s,u,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],a,0,!1,0,c)},vu.prototype._addCollisionDebugVertex=function(t,e,n,i,r,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i,r,Math.round(o.x),Math.round(o.y))},vu.prototype.addCollisionDebugVertices=function(t,e,n,i,o,a,l){var s=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=s.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,h=l.anchorX,d=l.anchorY;this._addCollisionDebugVertex(c,p,a,h,d,new r(t,e)),this._addCollisionDebugVertex(c,p,a,h,d,new r(n,e)),this._addCollisionDebugVertex(c,p,a,h,d,new r(n,i)),this._addCollisionDebugVertex(c,p,a,h,d,new r(t,i)),s.vertexLength+=4;var f=o.indexArray;f.emplaceBack(u,u+1),f.emplaceBack(u+1,u+2),f.emplaceBack(u+2,u+3),f.emplaceBack(u+3,u),s.primitiveLength+=4},vu.prototype.addDebugCollisionBoxes=function(t,e,n,i){for(var r=t;r<e;r++){var o=this.collisionBoxArray.get(r);this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,i?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n)}},vu.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new gu(Br,Gl.members,Yr),this.iconCollisionBox=new gu(Br,Gl.members,Yr);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},vu.prototype._deserializeCollisionBoxesForSymbol=function(t,e,n,i,r,o,a,l,s){for(var u={},c=e;c<n;c++){var p=t.get(c);u.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},u.textFeatureIndex=p.featureIndex;break}for(var h=i;h<r;h++){var d=t.get(h);u.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},u.verticalTextFeatureIndex=d.featureIndex;break}for(var f=o;f<a;f++){var m=t.get(f);u.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},u.iconFeatureIndex=m.featureIndex;break}for(var g=l;g<s;g++){var v=t.get(g);u.verticalIconBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY},u.verticalIconFeatureIndex=v.featureIndex;break}return u},vu.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}},vu.prototype.hasTextData=function(){return this.text.segments.get().length>0},vu.prototype.hasIconData=function(){return this.icon.segments.get().length>0},vu.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},vu.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},vu.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},vu.prototype.addIndicesForPlacedSymbol=function(t,e){for(var n=t.placedSymbolArray.get(e),i=n.vertexStartIndex+4*n.numGlyphs,r=n.vertexStartIndex;r<i;r+=4)t.indexArray.emplaceBack(r,r+1,r+2),t.indexArray.emplaceBack(r+1,r+2,r+3)},vu.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),n=Math.cos(t),i=[],r=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var l=this.symbolInstances.get(a);i.push(0|Math.round(e*l.anchorX+n*l.anchorY)),r.push(l.featureIndex)}return o.sort((function(t,e){return i[t]-i[e]||r[e]-r[t]})),o},vu.prototype.addToSortKeyRanges=function(t,e){var n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},vu.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var n=0,i=this.symbolInstanceIndexes;n<i.length;n+=1){var r=this.symbolInstances.get(i[n]);this.featureSortOrder.push(r.featureIndex),[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((function(t,n,i){t>=0&&i.indexOf(t)===n&&e.addIndicesForPlacedSymbol(e.text,t)})),r.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,r.verticalPlacedTextSymbolIndex),r.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.placedIconSymbolIndex),r.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Bi("SymbolBucket",vu,{omit:["layers","collisionBoxArray","features","compareText"]}),vu.MAX_GLYPHS=65535,vu.addDynamicAttributes=du;var yu=new xr({"symbol-placement":new gr(At.layout_symbol["symbol-placement"]),"symbol-spacing":new gr(At.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gr(At.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new vr(At.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gr(At.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gr(At.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new gr(At.layout_symbol["icon-ignore-placement"]),"icon-optional":new gr(At.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gr(At.layout_symbol["icon-rotation-alignment"]),"icon-size":new vr(At.layout_symbol["icon-size"]),"icon-text-fit":new gr(At.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gr(At.layout_symbol["icon-text-fit-padding"]),"icon-image":new vr(At.layout_symbol["icon-image"]),"icon-rotate":new vr(At.layout_symbol["icon-rotate"]),"icon-padding":new gr(At.layout_symbol["icon-padding"]),"icon-keep-upright":new gr(At.layout_symbol["icon-keep-upright"]),"icon-offset":new vr(At.layout_symbol["icon-offset"]),"icon-anchor":new vr(At.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gr(At.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gr(At.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gr(At.layout_symbol["text-rotation-alignment"]),"text-field":new vr(At.layout_symbol["text-field"]),"text-font":new vr(At.layout_symbol["text-font"]),"text-size":new vr(At.layout_symbol["text-size"]),"text-max-width":new vr(At.layout_symbol["text-max-width"]),"text-line-height":new gr(At.layout_symbol["text-line-height"]),"text-letter-spacing":new vr(At.layout_symbol["text-letter-spacing"]),"text-justify":new vr(At.layout_symbol["text-justify"]),"text-radial-offset":new vr(At.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gr(At.layout_symbol["text-variable-anchor"]),"text-anchor":new vr(At.layout_symbol["text-anchor"]),"text-max-angle":new gr(At.layout_symbol["text-max-angle"]),"text-writing-mode":new gr(At.layout_symbol["text-writing-mode"]),"text-rotate":new vr(At.layout_symbol["text-rotate"]),"text-padding":new gr(At.layout_symbol["text-padding"]),"text-keep-upright":new gr(At.layout_symbol["text-keep-upright"]),"text-transform":new vr(At.layout_symbol["text-transform"]),"text-offset":new vr(At.layout_symbol["text-offset"]),"text-allow-overlap":new gr(At.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new gr(At.layout_symbol["text-ignore-placement"]),"text-optional":new gr(At.layout_symbol["text-optional"])}),_u={paint:new xr({"icon-opacity":new vr(At.paint_symbol["icon-opacity"]),"icon-color":new vr(At.paint_symbol["icon-color"]),"icon-halo-color":new vr(At.paint_symbol["icon-halo-color"]),"icon-halo-width":new vr(At.paint_symbol["icon-halo-width"]),"icon-halo-blur":new vr(At.paint_symbol["icon-halo-blur"]),"icon-translate":new gr(At.paint_symbol["icon-translate"]),"icon-translate-anchor":new gr(At.paint_symbol["icon-translate-anchor"]),"text-opacity":new vr(At.paint_symbol["text-opacity"]),"text-color":new vr(At.paint_symbol["text-color"],{runtimeType:jt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new vr(At.paint_symbol["text-halo-color"]),"text-halo-width":new vr(At.paint_symbol["text-halo-width"]),"text-halo-blur":new vr(At.paint_symbol["text-halo-blur"]),"text-translate":new gr(At.paint_symbol["text-translate"]),"text-translate-anchor":new gr(At.paint_symbol["text-translate-anchor"])}),layout:yu},bu=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ft,this.defaultValue=t};bu.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},bu.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},bu.prototype.outputDefined=function(){return!1},bu.prototype.serialize=function(){return null},Bi("FormatSectionOverride",bu,{omit:["defaultValue"]});var xu=function(t){function e(e){t.call(this,e,_u)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){if(t.prototype.recalculate.call(this,e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var i=this.layout.get("text-writing-mode");if(i){for(var r=[],o=0,a=i;o<a.length;o+=1){var l=a[o];r.indexOf(l)<0&&r.push(l)}this.layout._values["text-writing-mode"]=r}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(t,e,n,i){var r=this.layout.get(t).evaluate(e,{},n,i),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||Hn(o.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,(function(e,n){return n in t?String(t[n]):""}))}(e.properties,r)},e.prototype.createBucket=function(t){return new vu(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var t=0,n=_u.paint.overridableProperties;t<n.length;t+=1){var i=n[t];if(e.hasPaintOverride(this.layout,i)){var r,o=this.paint.get(i),a=new bu(o),l=new Zn(a,o.property.specification);r="constant"===o.value.kind||"source"===o.value.kind?new Xn("source",l):new Wn("composite",l,o.value.zoomStops,o.value._interpolationType),this.paint._values[i]=new fr(o.property,r,o.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(t,n,i){return!(!this.layout||n.isDataDriven()||i.isDataDriven())&&e.hasPaintOverride(this.layout,t)},e.hasPaintOverride=function(t,e){var n=t.get("text-field"),i=_u.paint.properties[e],r=!1,o=function(t){for(var e=0,n=t;e<n.length;e+=1)if(i.overrides&&i.overrides.hasOverride(n[e]))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof ie)o(n.value.value.sections);else if("source"===n.value.kind){var a=function(t){r||(t instanceof ue&&le(t.value)===Zt?o(t.value.sections):t instanceof de?o(t.sections):t.eachChild(a))},l=n.value;l._styleExpression&&a(l._styleExpression.expression)}return r},e}(wr),wu={paint:new xr({"background-color":new gr(At.paint_background["background-color"]),"background-pattern":new _r(At.paint_background["background-pattern"]),"background-opacity":new gr(At.paint_background["background-opacity"])})},Cu=function(t){function e(e){t.call(this,e,wu)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(wr),Eu={paint:new xr({"raster-opacity":new gr(At.paint_raster["raster-opacity"]),"raster-hue-rotate":new gr(At.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gr(At.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gr(At.paint_raster["raster-brightness-max"]),"raster-saturation":new gr(At.paint_raster["raster-saturation"]),"raster-contrast":new gr(At.paint_raster["raster-contrast"]),"raster-resampling":new gr(At.paint_raster["raster-resampling"]),"raster-fade-duration":new gr(At.paint_raster["raster-fade-duration"])})},Su=function(t){function e(e){t.call(this,e,Eu)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(wr),Tu=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},e}(wr),Iu={circle:ha,heatmap:wa,hillshade:Ea,fill:cl,"fill-extrusion":Il,line:Nl,symbol:xu,background:Cu,raster:Su},Pu=a.HTMLImageElement,Au=a.HTMLCanvasElement,Mu=a.HTMLVideoElement,ku=a.ImageData,Du=a.ImageBitmap,Lu=function(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)};Lu.prototype.update=function(t,e,n){var i=t.width,r=t.height,o=!(this.size&&this.size[0]===i&&this.size[1]===r||n),a=this.context,l=a.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[i,r],t instanceof Pu||t instanceof Au||t instanceof Mu||t instanceof ku||Du&&t instanceof Du?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,t):l.texImage2D(l.TEXTURE_2D,0,this.format,i,r,0,this.format,l.UNSIGNED_BYTE,t.data);else{var s=n||{x:0,y:0},u=s.x,c=s.y;t instanceof Pu||t instanceof Au||t instanceof Mu||t instanceof ku||Du&&t instanceof Du?l.texSubImage2D(l.TEXTURE_2D,0,u,c,l.RGBA,l.UNSIGNED_BYTE,t):l.texSubImage2D(l.TEXTURE_2D,0,u,c,i,r,l.RGBA,l.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)},Lu.prototype.bind=function(t,e,n){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),n!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)},Lu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Lu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ou=function(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Ou.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))},Ou.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ru=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},v(["receive","process"],this),this.invoker=new Ou(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=T()?t:a};function zu(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}Ru.prototype.send=function(t,e,n,i,r){var o=this;void 0===r&&(r=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[a]=n);var l=A(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!n,targetMapId:i,mustQueue:r,sourceMapId:this.mapId,data:Vi(e,l)},l),{cancel:function(){n&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:i,sourceMapId:o.mapId})}}},Ru.prototype.receive=function(t){var e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[n];var i=this.cancelCallbacks[n];delete this.cancelCallbacks[n],i&&i()}else T()||e.mustQueue?(this.tasks[n]=e,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,e)},Ru.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Ru.prototype.processTask=function(t,e){var n=this;if("<response>"===e.type){var i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(qi(e.error)):i(null,qi(e.data)))}else{var r=!1,o=A(this.globalScope)?void 0:[],a=e.hasCallback?function(e,i){r=!0,delete n.cancelCallbacks[t],n.target.postMessage({id:t,type:"<response>",sourceMapId:n.mapId,error:e?Vi(e):null,data:Vi(i,o)},o)}:function(t){r=!0},l=null,s=qi(e.data);if(this.parent[e.type])l=this.parent[e.type](e.sourceMapId,s,a);else if(this.parent.getWorkerSource){var u=e.type.split(".");l=this.parent.getWorkerSource(e.sourceMapId,u[0],s.source)[u[1]](s,a)}else a(new Error("Could not find function "+e.type));!r&&l&&l.cancel&&(this.cancelCallbacks[t]=l.cancel)}},Ru.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Fu=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Fu.prototype.setNorthEast=function(t){return this._ne=t instanceof Bu?new Bu(t.lng,t.lat):Bu.convert(t),this},Fu.prototype.setSouthWest=function(t){return this._sw=t instanceof Bu?new Bu(t.lng,t.lat):Bu.convert(t),this},Fu.prototype.extend=function(t){var e,n,i=this._sw,r=this._ne;if(t instanceof Bu)e=t,n=t;else{if(!(t instanceof Fu))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Fu.convert(t)):this.extend(Bu.convert(t)):this;if(n=t._ne,!(e=t._sw)||!n)return this}return i||r?(i.lng=Math.min(e.lng,i.lng),i.lat=Math.min(e.lat,i.lat),r.lng=Math.max(n.lng,r.lng),r.lat=Math.max(n.lat,r.lat)):(this._sw=new Bu(e.lng,e.lat),this._ne=new Bu(n.lng,n.lat)),this},Fu.prototype.getCenter=function(){return new Bu((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Fu.prototype.getSouthWest=function(){return this._sw},Fu.prototype.getNorthEast=function(){return this._ne},Fu.prototype.getNorthWest=function(){return new Bu(this.getWest(),this.getNorth())},Fu.prototype.getSouthEast=function(){return new Bu(this.getEast(),this.getSouth())},Fu.prototype.getWest=function(){return this._sw.lng},Fu.prototype.getSouth=function(){return this._sw.lat},Fu.prototype.getEast=function(){return this._ne.lng},Fu.prototype.getNorth=function(){return this._ne.lat},Fu.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Fu.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Fu.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Fu.prototype.contains=function(t){var e=Bu.convert(t),n=e.lng,i=e.lat,r=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r},Fu.convert=function(t){return!t||t instanceof Fu?t:new Fu(t)};var Bu=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Bu.prototype.wrap=function(){return new Bu(p(this.lng,-180,180),this.lat)},Bu.prototype.toArray=function(){return[this.lng,this.lat]},Bu.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Bu.prototype.distanceTo=function(t){var e=Math.PI/180,n=this.lat*e,i=t.lat*e,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(r,1))},Bu.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Fu(new Bu(this.lng-n,this.lat-e),new Bu(this.lng+n,this.lat+e))},Bu.convert=function(t){if(t instanceof Bu)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Bu(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Bu(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Nu=2*Math.PI*6371008.8;function Uu(t){return Nu*Math.cos(t*Math.PI/180)}function ju(t){return(180+t)/360}function Vu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function qu(t,e){return t/Uu(e)}function Gu(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var Zu=function(t,e,n){void 0===n&&(n=0),this.x=+t,this.y=+e,this.z=+n};Zu.fromLngLat=function(t,e){void 0===e&&(e=0);var n=Bu.convert(t);return new Zu(ju(n.lng),Vu(n.lat),qu(e,n.lat))},Zu.prototype.toLngLat=function(){return new Bu(360*this.x-180,Gu(this.y))},Zu.prototype.toAltitude=function(){return this.z*Uu(Gu(this.y))},Zu.prototype.meterInMercatorCoordinateUnits=function(){return 1/Nu*(t=Gu(this.y),1/Math.cos(t*Math.PI/180));var t};var Hu=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Wu(0,t,t,e,n)};Hu.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Hu.prototype.url=function(t,e){var n,i,r,o,a,l=(i=this.y,r=this.z,o=zu(256*(n=this.x),256*(i=Math.pow(2,r)-i-1),r),a=zu(256*(n+1),256*(i+1),r),o[0]+","+o[1]+","+a[0]+","+a[1]),s=function(t,e,n){for(var i,r="",o=t;o>0;o--)r+=(e&(i=1<<o-1)?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",s).replace("{bbox-epsg-3857}",l)},Hu.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new r(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Hu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Yu=function(t,e){this.wrap=t,this.canonical=e,this.key=Wu(t,e.z,e.z,e.x,e.y)},Xu=function(t,e,n,i,r){this.overscaledZ=t,this.wrap=e,this.canonical=new Hu(n,+i,+r),this.key=Wu(e,t,n,i,r)};function Wu(t,e,n,i,r){(t*=2)<0&&(t=-1*t-1);var o=1<<n;return(o*o*t+o*r+i).toString(36)+n.toString(36)+e.toString(36)}Xu.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Xu.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Xu(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xu(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Xu.prototype.calculateScaledKey=function(t,e){var n=this.canonical.z-t;return t>this.canonical.z?Wu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Wu(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)},Xu.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Xu.prototype.children=function(t){if(this.overscaledZ>=t)return[new Xu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new Xu(e,this.wrap,e,n,i),new Xu(e,this.wrap,e,n+1,i),new Xu(e,this.wrap,e,n,i+1),new Xu(e,this.wrap,e,n+1,i+1)]},Xu.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Xu.prototype.wrapped=function(){return new Xu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Xu.prototype.unwrapTo=function(t){return new Xu(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Xu.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Xu.prototype.toUnwrapped=function(){return new Yu(this.wrap,this.canonical)},Xu.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Xu.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Zu(t.x-this.wrap,t.y))},Bi("CanonicalTileID",Hu),Bi("OverscaledTileID",Xu,{omit:["posMatrix"]});var Ku=function(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return C('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var i=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox";for(var r=0;r<i;r++)this.data[this._idx(-1,r)]=this.data[this._idx(0,r)],this.data[this._idx(i,r)]=this.data[this._idx(i-1,r)],this.data[this._idx(r,-1)]=this.data[this._idx(r,0)],this.data[this._idx(r,i)]=this.data[this._idx(r,i-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(i,-1)]=this.data[this._idx(i-1,0)],this.data[this._idx(-1,i)]=this.data[this._idx(0,i-1)],this.data[this._idx(i,i)]=this.data[this._idx(i-1,i-1)]};Ku.prototype.get=function(t,e){var n=new Uint8Array(this.data.buffer),i=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[i],n[i+1],n[i+2])},Ku.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ku.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Ku.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},Ku.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},Ku.prototype.getPixels=function(){return new _a({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ku.prototype.backfillBorder=function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var i=e*this.dim,r=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var l=-e*this.dim,s=-n*this.dim,u=o;u<a;u++)for(var c=i;c<r;c++)this.data[this._idx(c,u)]=t.data[this._idx(c+l,u+s)]},Bi("DEMData",Ku);var Ju=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};Ju.prototype.encode=function(t){return this._stringToNumber[t]},Ju.prototype.decode=function(t){return this._numberToString[t]};var $u=function(t,e,n,i,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,this.id=r},Qu={geometry:{configurable:!0}};Qu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Qu.geometry.set=function(t){this._geometry=t},$u.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties($u.prototype,Qu);var tc=function(){this.state={},this.stateChanges={},this.deletedStates={}};tc.prototype.updateState=function(t,e,n){var i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},h(this.stateChanges[t][i],n),null===this.deletedStates[t])for(var r in this.deletedStates[t]={},this.state[t])r!==i&&(this.deletedStates[t][r]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][i])for(var o in this.deletedStates[t][i]={},this.state[t][i])n[o]||(this.deletedStates[t][i][o]=null);else for(var a in n)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][a]&&delete this.deletedStates[t][i][a]},tc.prototype.removeFeatureState=function(t,e,n){if(null!==this.deletedStates[t]){var i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(n in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][n]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}},tc.prototype.getState=function(t,e){var n=String(e),i=h({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var r=this.deletedStates[t][e];if(null===r)return{};for(var o in r)delete i[o]}return i},tc.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},tc.prototype.coalesceChanges=function(t,e){var n={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var r={};for(var o in this.stateChanges[i])this.state[i][o]||(this.state[i][o]={}),h(this.state[i][o],this.stateChanges[i][o]),r[o]=this.state[i][o];n[i]=r}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var l={};if(null===this.deletedStates[a])for(var s in this.state[a])l[s]={},this.state[a][s]={};else for(var u in this.deletedStates[a]){if(null===this.deletedStates[a][u])this.state[a][u]={};else for(var c=0,p=Object.keys(this.deletedStates[a][u]);c<p.length;c+=1)delete this.state[a][u][p[c]];l[u]=this.state[a][u]}n[a]=n[a]||{},h(n[a],l)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(var d in t)t[d].setFeatureState(n,e)};var ec=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Li(8192,16,0),this.grid3D=new Li(8192,16,0),this.featureIndexArray=new oo,this.promoteId=e};function nc(t,e,n,i,r){return _(t,(function(t,o){var a=e instanceof mr?e.get(o):null;return a&&a.evaluate?a.evaluate(n,i,r):a}))}function ic(t){for(var e=1/0,n=1/0,i=-1/0,r=-1/0,o=0,a=t;o<a.length;o+=1){var l=a[o];e=Math.min(e,l.x),n=Math.min(n,l.y),i=Math.max(i,l.x),r=Math.max(r,l.y)}return{minX:e,minY:n,maxX:i,maxY:r}}function rc(t,e){return e-t}ec.prototype.insert=function(t,e,n,i,r,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);for(var l=o?this.grid3D:this.grid,s=0;s<e.length;s++){for(var u=e[s],c=[1/0,1/0,-1/0,-1/0],p=0;p<u.length;p++){var h=u[p];c[0]=Math.min(c[0],h.x),c[1]=Math.min(c[1],h.y),c[2]=Math.max(c[2],h.x),c[3]=Math.max(c[3],h.y)}c[0]<8192&&c[1]<8192&&c[2]>=0&&c[3]>=0&&l.insert(a,c[0],c[1],c[2],c[3])}},ec.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new bl.VectorTile(new Kl(this.rawTileData)).layers,this.sourceLayerCoder=new Ju(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},ec.prototype.query=function(t,e,n,i){var o=this;this.loadVTLayers();for(var a=t.params||{},l=8192/t.tileSize/t.scale,s=ai(a.filter),u=t.queryGeometry,c=t.queryPadding*l,p=ic(u),h=this.grid.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c),d=ic(t.cameraQueryGeometry),f=0,m=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,(function(e,n,i,o){return function(t,e,n,i,o){for(var a=0,l=t;a<l.length;a+=1){var s=l[a];if(e<=s.x&&n<=s.y&&i>=s.x&&o>=s.y)return!0}var u=[new r(e,n),new r(e,o),new r(i,o),new r(i,n)];if(t.length>2)for(var c=0,p=u;c<p.length;c+=1)if(Qo(t,p[c]))return!0;for(var h=0;h<t.length-1;h++)if(ta(t[h],t[h+1],u))return!0;return!1}(t.cameraQueryGeometry,e-c,n-c,i+c,o+c)}));f<m.length;f+=1)h.push(m[f]);h.sort(rc);for(var g,v={},y=function(r){var c=h[r];if(c!==g){g=c;var p=o.featureIndexArray.get(c),d=null;o.loadMatchingFeature(v,p.bucketIndex,p.sourceLayerIndex,p.featureIndex,s,a.layers,a.availableImages,e,n,i,(function(e,n,i){return d||(d=Uo(e)),n.queryIntersectsFeature(u,e,i,d,o.z,t.transform,l,t.pixelPosMatrix)}))}},_=0;_<h.length;_++)y(_);return v},ec.prototype.loadMatchingFeature=function(t,e,n,i,r,o,a,l,s,u,c){var p=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,p)){var d=this.sourceLayerCoder.decode(n),f=this.vtLayers[d].feature(i);if(r.needGeometry){var m=jo(f,!0);if(!r.filter(new lr(this.tileID.overscaledZ),m,this.tileID.canonical))return}else if(!r.filter(new lr(this.tileID.overscaledZ),f))return;for(var g=this.getId(f,d),v=0;v<p.length;v++){var y=p[v];if(!(o&&o.indexOf(y)<0)){var _=l[y];if(_){var b={};void 0!==g&&u&&(b=u.getState(_.sourceLayer||"_geojsonTileLayer",g));var x=h({},s[y]);x.paint=nc(x.paint,_.paint,f,b,a),x.layout=nc(x.layout,_.layout,f,b,a);var w=!c||c(f,_,b);if(w){var C=new $u(f,this.z,this.x,this.y,g);C.layer=x;var E=t[y];void 0===E&&(E=t[y]=[]),E.push({featureIndex:i,feature:C,intersectionZ:w})}}}}}},ec.prototype.lookupSymbolFeatures=function(t,e,n,i,r,o,a,l){var s={};this.loadVTLayers();for(var u=ai(r),c=0,p=t;c<p.length;c+=1)this.loadMatchingFeature(s,n,i,p[c],u,o,a,l,e);return s},ec.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var i=0,r=n[e];i<r.length;i+=1)if(t===r[i])return!0;return!1},ec.prototype.getId=function(t,e){var n=t.id;return this.promoteId&&"boolean"==typeof(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(n=Number(n)),n},Bi("FeatureIndex",ec,{omit:["rawTileData","sourceLayerCoder"]});var oc=function(t,e){this.tileID=t,this.uid=f(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};oc.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<B.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},oc.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},oc.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var i in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var i=function(){var t=o[r],i=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==i.length){t.layers=i,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return i.filter((function(e){return e.id===t}))[0]})));for(var a=0,l=i;a<l.length;a+=1)n[l[a].id]=t}},r=0,o=t;r<o.length;r+=1)i();return n}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var r=this.buckets[i];if(r instanceof vu){if(this.hasSymbolBuckets=!0,!n)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof vu&&a.hasRTLText){this.hasRTLText=!0,ar.isLoading()||ar.isLoaded()||"deferred"!==rr()||or();break}}for(var l in this.queryPadding=0,this.buckets){var s=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(l).queryRadius(s))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Jr},oc.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},oc.prototype.getBucket=function(t){return this.buckets[t.id]},oc.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Lu(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Lu(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)},oc.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},oc.prototype.queryRenderedFeatures=function(t,e,n,i,r,o,a,l,s,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:r,scale:o,tileSize:this.tileSize,pixelPosMatrix:u,transform:l,params:a,queryPadding:this.queryPadding*s},t,e,n):{}},oc.prototype.querySourceFeatures=function(t,e){var n=this.latestFeatureIndex;if(n&&n.rawTileData){var i=n.loadVTLayers(),r=e?e.sourceLayer:"",o=i._geojsonTileLayer||i[r];if(o)for(var a=ai(e&&e.filter),l=this.tileID.canonical,s=l.z,u=l.x,c=l.y,p={z:s,x:u,y:c},h=0;h<o.length;h++){var d=o.feature(h);if(a.needGeometry){var f=jo(d,!0);if(!a.filter(new lr(this.tileID.overscaledZ),f,this.tileID.canonical))continue}else if(!a.filter(new lr(this.tileID.overscaledZ),d))continue;var m=n.getId(d,r),g=new $u(d,s,u,c,m);g.tile=p,t.push(g)}}},oc.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},oc.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},oc.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=I(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var i=Date.now(),r=!1;if(this.expirationTime>i)r=!1;else if(e)if(this.expirationTime<e)r=!0;else{var o=this.expirationTime-e;o?this.expirationTime=i+Math.max(o,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},oc.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},oc.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var i in this.buckets)if(e.style.hasLayer(i)){var r=this.buckets[i],o=r.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],l=t[o];if(a&&l&&0!==Object.keys(l).length){r.update(l,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var s=e&&e.style&&e.style.getLayer(i);s&&(this.queryPadding=Math.max(this.queryPadding,s.queryRadius(r)))}}}},oc.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},oc.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()},oc.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},oc.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=B.now()+t},oc.prototype.setDependencies=function(t,e){for(var n={},i=0,r=e;i<r.length;i+=1)n[r[i]]=!0;this.dependencies[t]=n},oc.prototype.hasDependency=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=this.dependencies[i[n]];if(r)for(var o=0,a=e;o<a.length;o+=1)if(r[a[o]])return!0}return!1};var ac=a.performance,lc=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},ac.mark(this._marks.start)};lc.prototype.finish=function(){ac.mark(this._marks.end);var t=ac.getEntriesByName(this._marks.measure);return 0===t.length&&(ac.measure(this._marks.measure,this._marks.start,this._marks.end),t=ac.getEntriesByName(this._marks.measure),ac.clearMarks(this._marks.start),ac.clearMarks(this._marks.end),ac.clearMeasures(this._marks.measure)),t},t.Actor=Ru,t.AlphaImage=ya,t.CanonicalTileID=Hu,t.CollisionBoxArray=Jr,t.Color=te,t.DEMData=Ku,t.DataConstantProperty=gr,t.DictionaryCoder=Ju,t.EXTENT=8192,t.ErrorEvent=It,t.EvaluationParameters=lr,t.Event=Tt,t.Evented=Pt,t.FeatureIndex=ec,t.FillBucket=ll,t.FillExtrusionBucket=El,t.ImageAtlas=bs,t.ImagePosition=ys,t.LineBucket=Rl,t.LngLat=Bu,t.LngLatBounds=Fu,t.MercatorCoordinate=Zu,t.ONE_EM=24,t.OverscaledTileID=Xu,t.Point=r,t.Point$1=r,t.Properties=xr,t.Protobuf=Kl,t.RGBAImage=_a,t.RequestManager=Z,t.RequestPerformance=lc,t.ResourceType=ft,t.SegmentVector=lo,t.SourceFeatureState=tc,t.StructArrayLayout1ui2=Xr,t.StructArrayLayout2f1f2i16=Nr,t.StructArrayLayout2i4=Pr,t.StructArrayLayout3ui6=jr,t.StructArrayLayout4i8=Ar,t.SymbolBucket=vu,t.Texture=Lu,t.Tile=oc,t.Transitionable=cr,t.Uniform1f=xo,t.Uniform1i=bo,t.Uniform2f=wo,t.Uniform3f=Co,t.Uniform4f=Eo,t.UniformColor=So,t.UniformMatrix4f=Io,t.UnwrappedTileID=Yu,t.ValidationError=Mt,t.WritingMode=xs,t.ZoomHistory=Gi,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=du,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var i=t.length,r=new Array(t.length),o=null;t.forEach((function(t,a){e(t,(function(t,e){t&&(o=t),r[a]=e,0==--i&&n(o,r)}))}))},t.bezier=s,t.bindAll=v,t.browser=B,t.cacheEntryPossiblyAdded=function(t){++ht>st&&(t.getActor().send("enforceCacheSizeLimit",lt),ht=0)},t.clamp=c,t.clearTileCache=function(t){var e=a.caches.delete("mapbox-tiles");t&&e.catch(t).then((function(){return t()}))},t.clipLine=Hs,t.clone=function(t){var e=new aa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=x,t.clone$2=function(t){var e=new aa(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=Zl,t.config=N,t.create=function(){var t=new aa(16);return aa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new aa(9);return aa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new aa(4);return aa!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Yn,t.createLayout=Tr,t.createStyleLayer=function(t){return"custom"===t.type?new Tu(t):new Iu[t.type](t)},t.cross=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],l=n[1],s=n[2];return t[0]=r*s-o*l,t[1]=o*a-i*s,t[2]=i*l-r*a,t},t.deepEqual=function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var r in e)if(!t(e[r],n[r]))return!1;return!0}return e===n},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=u,t.emitValidationErrors=Di,t.endsWith=y,t.enforceCacheSizeLimit=function(t){ut(),tt&&tt.then((function(e){e.keys().then((function(n){for(var i=0;i<n.length-t;i++)e.delete(n[i])}))}))},t.evaluateSizeForFeature=Fs,t.evaluateSizeForZoom=Bs,t.evaluateVariableOffset=ou,t.evented=ir,t.extend=h,t.featureFilter=ai,t.filterObject=b,t.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=Ds,t.getAnchorJustification=au,t.getArrayBuffer=bt,t.getImage=Ct,t.getJSON=function(t,e){return _t(h(t,{type:"json"}),e)},t.getRTLTextPluginStatus=rr,t.getReferrer=yt,t.getVideo=function(t,e){var n,i,r=a.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(var o=0;o<t.length;o++){var l=a.document.createElement("source");n=t[o],i=void 0,(i=a.document.createElement("a")).href=n,(i.protocol!==a.document.location.protocol||i.host!==a.document.location.host)&&(r.crossOrigin="Anonymous"),l.src=t[o],r.appendChild(l)}return{cancel:function(){}}},t.identity=la,t.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],l=e[5],s=e[6],u=e[7],c=e[8],p=e[9],h=e[10],d=e[11],f=e[12],m=e[13],g=e[14],v=e[15],y=n*l-i*a,_=n*s-r*a,b=n*u-o*a,x=i*s-r*l,w=i*u-o*l,C=r*u-o*s,E=c*m-p*f,S=c*g-h*f,T=c*v-d*f,I=p*g-h*m,P=p*v-d*m,A=h*v-d*g,M=y*A-_*P+b*I+x*T-w*S+C*E;return M?(t[0]=(l*A-s*P+u*I)*(M=1/M),t[1]=(r*P-i*A-o*I)*M,t[2]=(m*C-g*w+v*x)*M,t[3]=(h*w-p*C-d*x)*M,t[4]=(s*T-a*A-u*S)*M,t[5]=(n*A-r*T+o*S)*M,t[6]=(g*b-f*C-v*_)*M,t[7]=(c*C-h*b+d*_)*M,t[8]=(a*P-l*T+u*E)*M,t[9]=(i*T-n*P-o*E)*M,t[10]=(f*w-m*b+v*y)*M,t[11]=(p*b-c*w-d*y)*M,t[12]=(l*S-a*I-s*E)*M,t[13]=(n*I-i*S+r*E)*M,t[14]=(m*_-f*x-g*y)*M,t[15]=(c*x-p*_+h*y)*M,t):null},t.isChar=Zi,t.isMapboxURL=H,t.keysDifference=function(t,e){var n=[];for(var i in t)i in e||n.push(i);return n},t.makeRequest=_t,t.mapObject=_,t.mercatorXfromLng=ju,t.mercatorYfromLat=Vu,t.mercatorZfromAltitude=qu,t.mul=ca,t.multiply=sa,t.mvt=bl,t.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},t.number=Ge,t.offscreenCanvasSupported=dt,t.ortho=function(t,e,n,i,r,o,a){var l=1/(e-n),s=1/(i-r),u=1/(o-a);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*l,t[13]=(r+i)*s,t[14]=(a+o)*u,t[15]=1,t},t.parseGlyphPBF=function(t){return new Kl(t).readFields(fs,[])},t.pbf=Kl,t.performSymbolLayout=function(t,e,n,i,r,o,a){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var l=t.layers[0].layout,s=t.layers[0]._unevaluatedLayout._values,u={};if("composite"===t.textSizeData.kind){var c=t.textSizeData,p=c.maxZoom;u.compositeTextSizes=[s["text-size"].possiblyEvaluate(new lr(c.minZoom),a),s["text-size"].possiblyEvaluate(new lr(p),a)]}if("composite"===t.iconSizeData.kind){var h=t.iconSizeData,d=h.maxZoom;u.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new lr(h.minZoom),a),s["icon-size"].possiblyEvaluate(new lr(d),a)]}u.layoutTextSize=s["text-size"].possiblyEvaluate(new lr(t.zoom+1),a),u.layoutIconSize=s["icon-size"].possiblyEvaluate(new lr(t.zoom+1),a),u.textMaxSize=s["text-size"].possiblyEvaluate(new lr(18));for(var f=24*l.get("text-line-height"),m="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),g=l.get("text-keep-upright"),v=l.get("text-size"),y=function(){var o=b[_],s=l.get("text-font").evaluate(o,{},a).join(","),c=v.evaluate(o,{},a),p=u.layoutTextSize.evaluate(o,{},a),h=u.layoutIconSize.evaluate(o,{},a),d={horizontal:{},vertical:void 0},y=o.text,x=[0,0];if(y){var w=y.toString(),E=24*l.get("text-letter-spacing").evaluate(o,{},a),S=function(t){for(var e=0,n=t;e<n.length;e+=1)if(i=n[e].charCodeAt(0),Zi.Arabic(i)||Zi["Arabic Supplement"](i)||Zi["Arabic Extended-A"](i)||Zi["Arabic Presentation Forms-A"](i)||Zi["Arabic Presentation Forms-B"](i))return!1;var i;return!0}(w)?E:0,T=l.get("text-anchor").evaluate(o,{},a),I=l.get("text-variable-anchor");if(!I){var P=l.get("text-radial-offset").evaluate(o,{},a);x=P?ou(T,[24*P,ru]):l.get("text-offset").evaluate(o,{},a).map((function(t){return 24*t}))}var A=m?"center":l.get("text-justify").evaluate(o,{},a),M=l.get("symbol-placement"),k="point"===M?24*l.get("text-max-width").evaluate(o,{},a):0,D=function(){t.allowVerticalPlacement&&Hi(w)&&(d.vertical=Es(y,e,n,r,s,k,f,T,"left",S,x,xs.vertical,!0,M,p,c))};if(!m&&I){for(var L="auto"===A?I.map((function(t){return au(t)})):[A],O=!1,R=0;R<L.length;R++){var z=L[R];if(!d.horizontal[z])if(O)d.horizontal[z]=d.horizontal[0];else{var F=Es(y,e,n,r,s,k,f,"center",z,S,x,xs.horizontal,!1,M,p,c);F&&(d.horizontal[z]=F,O=1===F.positionedLines.length)}}D()}else{"auto"===A&&(A=au(T));var B=Es(y,e,n,r,s,k,f,T,A,S,x,xs.horizontal,!1,M,p,c);B&&(d.horizontal[A]=B),D(),Hi(w)&&m&&g&&(d.vertical=Es(y,e,n,r,s,k,f,T,A,S,x,xs.vertical,!1,M,p,c))}}var N=void 0,U=!1;if(o.icon&&o.icon.name){var j=i[o.icon.name];j&&(N=function(t,e,n){var i=Ds(n),r=e[0]-t.displaySize[0]*i.horizontalAlign,o=e[1]-t.displaySize[1]*i.verticalAlign;return{image:t,top:o,bottom:o+t.displaySize[1],left:r,right:r+t.displaySize[0]}}(r[o.icon.name],l.get("icon-offset").evaluate(o,{},a),l.get("icon-anchor").evaluate(o,{},a)),U=j.sdf,void 0===t.sdfIcons?t.sdfIcons=j.sdf:t.sdfIcons!==j.sdf&&C("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(j.pixelRatio!==t.pixelRatio||0!==l.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var V=su(d.horizontal)||d.vertical;t.iconsInText=!!V&&V.iconsInText,(V||N)&&function(t,e,n,i,r,o,a,l,s,u,c){var p=o.textMaxSize.evaluate(e,{});void 0===p&&(p=a);var h,d=t.layers[0].layout,f=d.get("icon-offset").evaluate(e,{},c),m=su(n.horizontal),g=a/24,v=t.tilePixelRatio*g,y=t.tilePixelRatio*p/24,_=t.tilePixelRatio*l,b=t.tilePixelRatio*d.get("symbol-spacing"),x=d.get("text-padding")*t.tilePixelRatio,w=d.get("icon-padding")*t.tilePixelRatio,E=d.get("text-max-angle")/180*Math.PI,S="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),T="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),I=d.get("symbol-placement"),P=b/2,A=d.get("icon-text-fit");i&&"none"!==A&&(t.allowVerticalPlacement&&n.vertical&&(h=Os(i,n.vertical,A,d.get("icon-text-fit-padding"),f,g)),m&&(i=Os(i,m,A,d.get("icon-text-fit-padding"),f,g)));var M=function(l,p){p.x<0||p.x>=8192||p.y<0||p.y>=8192||function(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m,g,v,y,_,b,x,w,E,S){var T,I,P,A,M,k=t.addToLineVertexArray(e,n),D=0,L=0,O=0,R=0,z=-1,F=-1,B={},N=ho(""),U=0,j=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?(U=(T=l.layout.get("text-offset").evaluate(b,{},E).map((function(t){return 24*t})))[0],j=T[1]):(U=24*l.layout.get("text-radial-offset").evaluate(b,{},E),j=ru),t.allowVerticalPlacement&&i.vertical){var V=l.layout.get("text-rotate").evaluate(b,{},E)+90;A=new $s(s,e,u,c,p,i.vertical,h,d,f,V),a&&(M=new $s(s,e,u,c,p,a,g,v,f,V))}if(r){var q=l.layout.get("icon-rotate").evaluate(b,{}),G="none"!==l.layout.get("icon-text-fit"),Z=Ys(r,q,w,G),H=a?Ys(a,q,w,G):void 0;P=new $s(s,e,u,c,p,r,g,v,!1,q),D=4*Z.length;var Y=t.iconSizeData,X=null;"source"===Y.kind?(X=[128*l.layout.get("icon-size").evaluate(b,{})])[0]>32640&&C(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Y.kind&&((X=[128*x.compositeIconSizes[0].evaluate(b,{},E),128*x.compositeIconSizes[1].evaluate(b,{},E)])[0]>32640||X[1]>32640)&&C(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),t.addSymbols(t.icon,Z,X,_,y,b,!1,e,k.lineStartIndex,k.lineLength,-1,E),z=t.icon.placedSymbolArray.length-1,H&&(L=4*H.length,t.addSymbols(t.icon,H,X,_,y,b,xs.vertical,e,k.lineStartIndex,k.lineLength,-1,E),F=t.icon.placedSymbolArray.length-1)}for(var W in i.horizontal){var K=i.horizontal[W];if(!I){N=ho(K.text);var J=l.layout.get("text-rotate").evaluate(b,{},E);I=new $s(s,e,u,c,p,K,h,d,f,J)}var $=1===K.positionedLines.length;if(O+=lu(t,e,K,o,l,f,b,m,k,i.vertical?xs.horizontal:xs.horizontalOnly,$?Object.keys(i.horizontal):[W],B,z,x,E),$)break}i.vertical&&(R+=lu(t,e,i.vertical,o,l,f,b,m,k,xs.vertical,["vertical"],B,F,x,E));var Q=I?I.boxStartIndex:t.collisionBoxArray.length,tt=I?I.boxEndIndex:t.collisionBoxArray.length,et=A?A.boxStartIndex:t.collisionBoxArray.length,nt=A?A.boxEndIndex:t.collisionBoxArray.length,it=P?P.boxStartIndex:t.collisionBoxArray.length,rt=P?P.boxEndIndex:t.collisionBoxArray.length,ot=M?M.boxStartIndex:t.collisionBoxArray.length,at=M?M.boxEndIndex:t.collisionBoxArray.length,lt=-1,st=function(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e};lt=st(I,lt),lt=st(A,lt),lt=st(P,lt);var ut=(lt=st(M,lt))>-1?1:0;ut&&(lt*=S/24),t.glyphOffsetArray.length>=vu.MAX_GLYPHS&&C("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,B.right>=0?B.right:-1,B.center>=0?B.center:-1,B.left>=0?B.left:-1,B.vertical||-1,z,F,N,Q,tt,et,nt,it,rt,ot,at,u,O,R,D,L,ut,0,h,U,j,lt)}(t,p,l,n,i,r,h,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,v,x,S,s,_,w,T,f,e,o,u,c,a)};if("line"===I)for(var k=0,D=Hs(e.geometry,0,0,8192,8192);k<D.length;k+=1)for(var L=D[k],O=0,R=Zs(L,b,E,n.vertical||m,i,24,y,t.overscaling,8192);O<R.length;O+=1){var z=R[O];m&&uu(t,m.text,P,z)||M(L,z)}else if("line-center"===I)for(var F=0,B=e.geometry;F<B.length;F+=1){var N=B[F];if(N.length>1){var U=Gs(N,E,n.vertical||m,i,24,y);U&&M(N,U)}}else if("Polygon"===e.type)for(var j=0,V=il(e.geometry,0);j<V.length;j+=1){var q=V[j],G=eu(q,16);M(q[0],new Rs(G.x,G.y,0))}else if("LineString"===e.type)for(var Z=0,H=e.geometry;Z<H.length;Z+=1){var Y=H[Z];M(Y,new Rs(Y[0].x,Y[0].y,0))}else if("Point"===e.type)for(var X=0,W=e.geometry;X<W.length;X+=1)for(var K=0,J=W[X];K<J.length;K+=1){var $=J[K];M([$],new Rs($.x,$.y,0))}}(t,o,d,N,i,u,p,h,x,U,a)},_=0,b=t.features;_<b.length;_+=1)y();o&&t.generateCollisionDebugBuffers()},t.perspective=function(t,e,n,i,r){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+i)*(o=1/(i-r)),t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t},t.pick=function(t,e){for(var n={},i=0;i<e.length;i++){var r=e[i];r in t&&(n[r]=t[r])}return n},t.plugin=ar,t.polygonIntersectsPolygon=Go,t.postMapLoadEvent=at,t.postTurnstileEvent=rt,t.potpack=vs,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=Bi,t.registerForPluginStateChange=function(t){return t({pluginStatus:Qi,pluginURL:tr}),ir.on("pluginStateChange",t),t},t.renderColorRamp=xa,t.rotate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],l=Math.sin(n),s=Math.cos(n);return t[0]=i*s+o*l,t[1]=r*s+a*l,t[2]=i*-l+o*s,t[3]=r*-l+a*s,t},t.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],l=e[6],s=e[7],u=e[8],c=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=a*r+c*i,t[6]=l*r+p*i,t[7]=s*r+h*i,t[8]=u*r-o*i,t[9]=c*r-a*i,t[10]=p*r-l*i,t[11]=h*r-s*i,t},t.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],l=e[2],s=e[3],u=e[4],c=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=a*r+c*i,t[2]=l*r+p*i,t[3]=s*r+h*i,t[4]=u*r-o*i,t[5]=c*r-a*i,t[6]=p*r-l*i,t[7]=h*r-s*i,t},t.scale=function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.scale$2=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.setCacheLimits=function(t,e){lt=t,st=e},t.setRTLTextPlugin=function(t,e,n){if(void 0===n&&(n=!1),"deferred"===Qi||"loading"===Qi||"loaded"===Qi)throw new Error("setRTLTextPlugin cannot be called multiple times.");tr=B.resolveURL(t),Qi="deferred",$i=e,nr(),n||or()},t.sphericalToCartesian=function(t){var e=t[0],n=t[1],i=t[2];return n+=90,n*=Math.PI/180,i*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(i),y:e*Math.sin(n)*Math.sin(i),z:e*Math.cos(i)}},t.sqrLen=function(t){var e=t[0],n=t[1];return e*e+n*n},t.styleSpec=At,t.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},t.symbolSize=Ns,t.transformMat3=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t},t.transformMat4=pa,t.translate=function(t,e,n){var i,r,o,a,l,s,u,c,p,h,d,f,m=n[0],g=n[1],v=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*v+e[12],t[13]=e[1]*m+e[5]*g+e[9]*v+e[13],t[14]=e[2]*m+e[6]*g+e[10]*v+e[14],t[15]=e[3]*m+e[7]*g+e[11]*v+e[15]):(r=e[1],o=e[2],a=e[3],l=e[4],s=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=i=e[0],t[1]=r,t[2]=o,t[3]=a,t[4]=l,t[5]=s,t[6]=u,t[7]=c,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=i*m+l*g+p*v+e[12],t[13]=r*m+s*g+h*v+e[13],t[14]=o*m+u*g+d*v+e[14],t[15]=a*m+c*g+f*v+e[15]),t},t.triggerPluginCompletionEvent=er,t.uniqueId=f,t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers."+n+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+n+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=Ai,t.validateStyle=Pi,t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.vectorTile=bl,t.version="1.13.3",t.warnOnce=C,t.webpSupported=U,t.window=a,t.wrap=p})),i(0,(function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",r=0,o=t;r<o.length;r+=1)i+=e(o[r])+",";return i+"]"}for(var a=Object.keys(t).sort(),l="{",s=0;s<a.length;s++)l+=JSON.stringify(a[s])+":"+e(t[a[s]])+",";return l+"}"}function n(n){for(var i="",r=0,o=t.refProperties;r<o.length;r+=1)i+="/"+e(n[o[r]]);return i}var i=function(t){this.keyCache={},t&&this.replace(t)};i.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},i.prototype.update=function(e,i){for(var r=this,o=0,a=e;o<a.length;o+=1){var l=a[o];this._layerConfigs[l.id]=l;var s=this._layers[l.id]=t.createStyleLayer(l);s._featureFilter=t.featureFilter(s.filter),this.keyCache[l.id]&&delete this.keyCache[l.id]}for(var u=0,c=i;u<c.length;u+=1){var p=c[u];delete this.keyCache[p],delete this._layerConfigs[p],delete this._layers[p]}this.familiesBySource={};for(var h=0,d=function(t,e){for(var i={},r=0;r<t.length;r++){var o=e&&e[t[r].id]||n(t[r]);e&&(e[t[r].id]=o);var a=i[o];a||(a=i[o]=[]),a.push(t[r])}var l=[];for(var s in i)l.push(i[s]);return l}(t.values(this._layerConfigs),this.keyCache);h<d.length;h+=1){var f=d[h].map((function(t){return r._layers[t.id]})),m=f[0];if("none"!==m.visibility){var g=m.source||"",v=this.familiesBySource[g];v||(v=this.familiesBySource[g]={});var y=m.sourceLayer||"_geojsonTileLayer",_=v[y];_||(_=v[y]=[]),_.push(f)}}};var r=function(e){var n={},i=[];for(var r in e){var o=e[r],a=n[r]={};for(var l in o){var s=o[+l];if(s&&0!==s.bitmap.width&&0!==s.bitmap.height){var u={x:0,y:0,w:s.bitmap.width+2,h:s.bitmap.height+2};i.push(u),a[l]={rect:u,metrics:s.metrics}}}}var c=t.potpack(i),p=new t.AlphaImage({width:c.w||1,height:c.h||1});for(var h in e){var d=e[h];for(var f in d){var m=d[+f];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var g=n[h][f].rect;t.AlphaImage.copy(m.bitmap,p,{x:0,y:0},{x:g.x+1,y:g.y+1},m.bitmap)}}}this.image=p,this.positions=n};t.register("GlyphAtlas",r);var o=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId};function a(e,n,i){for(var r=new t.EvaluationParameters(n),o=0,a=e;o<a.length;o+=1)a[o].recalculate(r,i)}function l(e,n){var i=t.getArrayBuffer(e.request,(function(e,i,r,o){e?n(e):i&&n(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(i)),rawData:i,cacheControl:r,expires:o})}));return function(){i.cancel(),n()}}o.prototype.parse=function(e,n,i,o,l){var s=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var u=new t.DictionaryCoder(Object.keys(e.layers).sort()),c=new t.FeatureIndex(this.tileID,this.promoteId);c.bucketLayerIDs=[];var p,h,d,f,m={},g={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:i},v=n.familiesBySource[this.source];for(var y in v){var _=e.layers[y];if(_){1===_.version&&t.warnOnce('Vector tile source "'+this.source+'" layer "'+y+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var b=u.encode(y),x=[],w=0;w<_.length;w++){var C=_.feature(w),E=c.getId(C,y);x.push({feature:C,id:E,index:w,sourceLayerIndex:b})}for(var S=0,T=v[y];S<T.length;S+=1){var I=T[S],P=I[0];P.minzoom&&this.zoom<Math.floor(P.minzoom)||P.maxzoom&&this.zoom>=P.maxzoom||"none"!==P.visibility&&(a(I,this.zoom,i),(m[P.id]=P.createBucket({index:c.bucketLayerIDs.length,layers:I,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(x,g,this.tileID.canonical),c.bucketLayerIDs.push(I.map((function(t){return t.id}))))}}}var A=t.mapObject(g.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(A).length?o.send("getGlyphs",{uid:this.uid,stacks:A},(function(t,e){p||(p=t,h=e,D.call(s))})):h={};var M=Object.keys(g.iconDependencies);M.length?o.send("getImages",{icons:M,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){p||(p=t,d=e,D.call(s))})):d={};var k=Object.keys(g.patternDependencies);function D(){if(p)return l(p);if(h&&d&&f){var e=new r(h),n=new t.ImageAtlas(d,f);for(var o in m){var s=m[o];s instanceof t.SymbolBucket?(a(s.layers,this.zoom,i),t.performSymbolLayout(s,h,e.positions,d,n.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):s.hasPattern&&(s instanceof t.LineBucket||s instanceof t.FillBucket||s instanceof t.FillExtrusionBucket)&&(a(s.layers,this.zoom,i),s.addFeatures(g,this.tileID.canonical,n.patternPositions))}this.status="done",l(null,{buckets:t.values(m).filter((function(t){return!t.isEmpty()})),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?e.positions:null})}}k.length?o.send("getImages",{icons:k,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){p||(p=t,f=e,D.call(s))})):f={},D.call(this)};var s=function(t,e,n,i){this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=i||l,this.loading={},this.loaded={}};s.prototype.loadTile=function(e,n){var i=this,r=e.uid;this.loading||(this.loading={});var a=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),l=this.loading[r]=new o(e);l.abort=this.loadVectorData(e,(function(e,o){if(delete i.loading[r],e||!o)return l.status="done",i.loaded[r]=l,n(e);var s=o.rawData,u={};o.expires&&(u.expires=o.expires),o.cacheControl&&(u.cacheControl=o.cacheControl);var c={};if(a){var p=a.finish();p&&(c.resourceTiming=JSON.parse(JSON.stringify(p)))}l.vectorTile=o.vectorTile,l.parse(o.vectorTile,i.layerIndex,i.availableImages,i.actor,(function(e,i){if(e||!i)return n(e);n(null,t.extend({rawTileData:s.slice(0)},i,u,c))})),i.loaded=i.loaded||{},i.loaded[r]=l}))},s.prototype.reloadTile=function(t,e){var n=this,i=this.loaded,r=t.uid,o=this;if(i&&i[r]){var a=i[r];a.showCollisionBoxes=t.showCollisionBoxes;var l=function(t,i){var r=a.reloadCallback;r&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,r)),e(t,i)};"parsing"===a.status?a.reloadCallback=l:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,l):l())}},s.prototype.abortTile=function(t,e){var n=this.loading,i=t.uid;n&&n[i]&&n[i].abort&&(n[i].abort(),delete n[i]),e()},s.prototype.removeTile=function(t,e){var n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()};var u=t.window.ImageBitmap,c=function(){this.loaded={}};function p(t,e){if(0!==t.length){h(t[0],e);for(var n=1;n<t.length;n++)h(t[n],!e)}}function h(t,e){for(var n=0,i=0,r=0,o=t.length,a=o-1;r<o;a=r++){var l=(t[r][0]-t[a][0])*(t[a][1]+t[r][1]),s=n+l;i+=Math.abs(n)>=Math.abs(l)?n-s+l:l-s+n,n=s}n+i>=0!=!!e&&t.reverse()}c.prototype.loadTile=function(e,n){var i=e.uid,r=e.encoding,o=e.rawImageData,a=u&&o instanceof u?this.getImageData(o):o,l=new t.DEMData(i,a,r);this.loaded=this.loaded||{},this.loaded[i]=l,n(null,l)},c.prototype.getImageData=function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var n=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:n.width,height:n.height},n.data)},c.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var d=t.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};f.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,i=this._feature.geometry;n<i.length;n+=1){var r=i[n];e.push([new t.Point$1(r[0],r[1])])}return e}for(var o=[],a=0,l=this._feature.geometry;a<l.length;a+=1){for(var s=[],u=0,c=l[a];u<c.length;u+=1){var p=c[u];s.push(new t.Point$1(p[0],p[1]))}o.push(s)}return o},f.prototype.toGeoJSON=function(t,e,n){return d.call(this,t,e,n)};var m=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};m.prototype.feature=function(t){return new f(this._features[t])};var g=t.vectorTile.VectorTileFeature,v=y;function y(t,e){this.options=e||{},this.features=t,this.length=t.length}function _(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}y.prototype.feature=function(t){return new _(this.features[t],this.options.extent)},_.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var i=e[n],r=[],o=0;o<i.length;o++)r.push(new t.Point$1(i[o][0],i[o][1]));this.geometry.push(r)}return this.geometry},_.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<t.length;o++)for(var a=t[o],l=0;l<a.length;l++){var s=a[l];e=Math.min(e,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),r=Math.max(r,s.y)}return[e,i,n,r]},_.prototype.toGeoJSON=g.prototype.toGeoJSON;var b=w,x=v;function w(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,C,t.layers[n])}(e,n),n.finish()}function C(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,E,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var o=i.values;for(n=0;n<o.length;n++)e.writeMessage(4,A,o[n])}function E(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,S,t),e.writeVarintField(3,n.type),e.writeMessage(4,P,n)}function S(t,e){var n=t.feature,i=t.keys,r=t.values,o=t.keycache,a=t.valuecache;for(var l in n.properties){var s=o[l];void 0===s&&(i.push(l),o[l]=s=i.length-1),e.writeVarint(s);var u=n.properties[l],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var p=c+":"+u,h=a[p];void 0===h&&(r.push(u),a[p]=h=r.length-1),e.writeVarint(h)}}function T(t,e){return(e<<3)+(7&t)}function I(t){return t<<1^t>>31}function P(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,o=0,a=n.length,l=0;l<a;l++){var s=n[l],u=1;1===i&&(u=s.length),e.writeVarint(T(1,u));for(var c=3===i?s.length-1:s.length,p=0;p<c;p++){1===p&&1!==i&&e.writeVarint(T(2,c-1));var h=s[p].x-r,d=s[p].y-o;e.writeVarint(I(h)),e.writeVarint(I(d)),r+=h,o+=d}3===i&&e.writeVarint(T(7,1))}}function A(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function M(t,e,n,i){k(t,n,i),k(e,2*n,2*i),k(e,2*n+1,2*i+1)}function k(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function D(t,e,n,i){var r=t-n,o=e-i;return r*r+o*o}b.fromVectorTileJs=w,b.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new v(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return w({layers:n})},b.GeoJSONWrapper=x;var L=function(t){return t[0]},O=function(t){return t[1]},R=function(t,e,n,i,r){void 0===e&&(e=L),void 0===n&&(n=O),void 0===i&&(i=64),void 0===r&&(r=Float64Array),this.nodeSize=i,this.points=t;for(var o=t.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),l=this.coords=new r(2*t.length),s=0;s<t.length;s++)a[s]=s,l[2*s]=e(t[s]),l[2*s+1]=n(t[s]);!function t(e,n,i,r,o,a){if(!(o-r<=i)){var l=r+o>>1;!function t(e,n,i,r,o,a){for(;o>r;){if(o-r>600){var l=o-r+1,s=i-r+1,u=Math.log(l),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(l-c)/l)*(s-l/2<0?-1:1);t(e,n,i,Math.max(r,Math.floor(i-s*c/l+p)),Math.min(o,Math.floor(i+(l-s)*c/l+p)),a)}var h=n[2*i+a],d=r,f=o;for(M(e,n,r,i),n[2*o+a]>h&&M(e,n,r,o);d<f;){for(M(e,n,d,f),d++,f--;n[2*d+a]<h;)d++;for(;n[2*f+a]>h;)f--}n[2*r+a]===h?M(e,n,r,f):M(e,n,++f,o),f<=i&&(r=f+1),i<=f&&(o=f-1)}}(e,n,l,r,o,a%2),t(e,n,i,r,l-1,a+1),t(e,n,i,l+1,o,a+1)}}(a,l,i,0,a.length-1,0)};R.prototype.range=function(t,e,n,i){return function(t,e,n,i,r,o,a){for(var l,s,u=[0,t.length-1,0],c=[];u.length;){var p=u.pop(),h=u.pop(),d=u.pop();if(h-d<=a)for(var f=d;f<=h;f++)s=e[2*f+1],(l=e[2*f])>=n&&l<=r&&s>=i&&s<=o&&c.push(t[f]);else{var m=Math.floor((d+h)/2);s=e[2*m+1],(l=e[2*m])>=n&&l<=r&&s>=i&&s<=o&&c.push(t[m]);var g=(p+1)%2;(0===p?n<=l:i<=s)&&(u.push(d),u.push(m-1),u.push(g)),(0===p?r>=l:o>=s)&&(u.push(m+1),u.push(h),u.push(g))}}return c}(this.ids,this.coords,t,e,n,i,this.nodeSize)},R.prototype.within=function(t,e,n){return function(t,e,n,i,r,o){for(var a=[0,t.length-1,0],l=[],s=r*r;a.length;){var u=a.pop(),c=a.pop(),p=a.pop();if(c-p<=o)for(var h=p;h<=c;h++)D(e[2*h],e[2*h+1],n,i)<=s&&l.push(t[h]);else{var d=Math.floor((p+c)/2),f=e[2*d],m=e[2*d+1];D(f,m,n,i)<=s&&l.push(t[d]);var g=(u+1)%2;(0===u?n-r<=f:i-r<=m)&&(a.push(p),a.push(d-1),a.push(g)),(0===u?n+r>=f:i+r>=m)&&(a.push(d+1),a.push(c),a.push(g))}}return l}(this.ids,this.coords,t,e,n,this.nodeSize)};var z={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},F=function(t){this.options=G(Object.create(z),t),this.trees=new Array(this.options.maxZoom+1)};function B(t,e,n,i,r){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:i,properties:r}}function N(t,e){var n=t.geometry.coordinates,i=n[1];return{x:V(n[0]),y:q(i),zoom:1/0,index:e,parentId:-1}}function U(t){return{type:"Feature",id:t.id,properties:j(t),geometry:{type:"Point",coordinates:[(i=t.x,360*(i-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,i}function j(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return G(G({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function V(t){return t/360+.5}function q(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function G(t,e){for(var n in e)t[n]=e[n];return t}function Z(t){return t.x}function H(t){return t.y}function Y(t,e,n,i,r,o){var a=r-n,l=o-i;if(0!==a||0!==l){var s=((t-n)*a+(e-i)*l)/(a*a+l*l);s>1?(n=r,i=o):s>0&&(n+=a*s,i+=l*s)}return(a=t-n)*a+(l=e-i)*l}function X(t,e,n,i){var r={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)W(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)W(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)W(t,e[i][r])}(r),r}function W(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function K(t,e,n,i){if(e.geometry){var r=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),l=[],s=e.id;if(n.promoteId?s=e.properties[n.promoteId]:n.generateId&&(s=i||0),"Point"===o)J(r,l);else if("MultiPoint"===o)for(var u=0;u<r.length;u++)J(r[u],l);else if("LineString"===o)$(r,l,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(u=0;u<r.length;u++)$(r[u],l=[],a,!1),t.push(X(s,"LineString",l,e.properties));return}Q(r,l,a,!1)}else if("Polygon"===o)Q(r,l,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(u=0;u<e.geometry.geometries.length;u++)K(t,{id:s,geometry:e.geometry.geometries[u],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<r.length;u++){var c=[];Q(r[u],c,a,!0),l.push(c)}}t.push(X(s,o,l,e.properties))}}function J(t,e){e.push(tt(t[0])),e.push(et(t[1])),e.push(0)}function $(t,e,n,i){for(var r,o,a=0,l=0;l<t.length;l++){var s=tt(t[l][0]),u=et(t[l][1]);e.push(s),e.push(u),e.push(0),l>0&&(a+=i?(r*u-s*o)/2:Math.sqrt(Math.pow(s-r,2)+Math.pow(u-o,2))),r=s,o=u}var c=e.length-3;e[2]=1,function t(e,n,i,r){for(var o,a=r,l=i-n>>1,s=i-n,u=e[n],c=e[n+1],p=e[i],h=e[i+1],d=n+3;d<i;d+=3){var f=Y(e[d],e[d+1],u,c,p,h);if(f>a)o=d,a=f;else if(f===a){var m=Math.abs(d-l);m<s&&(o=d,s=m)}}a>r&&(o-n>3&&t(e,n,o,r),e[o+2]=a,i-o>3&&t(e,o,i,r))}(e,0,c,n),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Q(t,e,n,i){for(var r=0;r<t.length;r++){var o=[];$(t[r],o,n,i),e.push(o)}}function tt(t){return t/360+.5}function et(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function nt(t,e,n,i,r,o,a,l){if(i/=e,o>=(n/=e)&&a<i)return t;if(a<n||o>=i)return null;for(var s=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,h=c.type,d=0===r?c.minX:c.minY,f=0===r?c.maxX:c.maxY;if(d>=n&&f<i)s.push(c);else if(!(f<n||d>=i)){var m=[];if("Point"===h||"MultiPoint"===h)it(p,m,n,i,r);else if("LineString"===h)rt(p,m,n,i,r,!1,l.lineMetrics);else if("MultiLineString"===h)at(p,m,n,i,r,!1);else if("Polygon"===h)at(p,m,n,i,r,!0);else if("MultiPolygon"===h)for(var g=0;g<p.length;g++){var v=[];at(p[g],v,n,i,r,!0),v.length&&m.push(v)}if(m.length){if(l.lineMetrics&&"LineString"===h){for(g=0;g<m.length;g++)s.push(X(c.id,h,m[g],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===m.length?(h="LineString",m=m[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===m.length?"Point":"MultiPoint"),s.push(X(c.id,h,m,c.tags))}}}return s.length?s:null}function it(t,e,n,i,r){for(var o=0;o<t.length;o+=3){var a=t[o+r];a>=n&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function rt(t,e,n,i,r,o,a){for(var l,s,u=ot(t),c=0===r?st:ut,p=t.start,h=0;h<t.length-3;h+=3){var d=t[h],f=t[h+1],m=t[h+2],g=t[h+3],v=t[h+4],y=0===r?d:f,_=0===r?g:v,b=!1;a&&(l=Math.sqrt(Math.pow(d-g,2)+Math.pow(f-v,2))),y<n?_>n&&(s=c(u,d,f,g,v,n),a&&(u.start=p+l*s)):y>i?_<i&&(s=c(u,d,f,g,v,i),a&&(u.start=p+l*s)):lt(u,d,f,m),_<n&&y>=n&&(s=c(u,d,f,g,v,n),b=!0),_>i&&y<=i&&(s=c(u,d,f,g,v,i),b=!0),!o&&b&&(a&&(u.end=p+l*s),e.push(u),u=ot(t)),a&&(p+=l)}var x=t.length-3;d=t[x],f=t[x+1],m=t[x+2],(y=0===r?d:f)>=n&&y<=i&&lt(u,d,f,m),x=u.length-3,o&&x>=3&&(u[x]!==u[0]||u[x+1]!==u[1])&&lt(u,u[0],u[1],u[2]),u.length&&e.push(u)}function ot(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function at(t,e,n,i,r,o){for(var a=0;a<t.length;a++)rt(t[a],e,n,i,r,o,!1)}function lt(t,e,n,i){t.push(e),t.push(n),t.push(i)}function st(t,e,n,i,r,o){var a=(o-e)/(i-e);return t.push(o),t.push(n+(r-n)*a),t.push(1),a}function ut(t,e,n,i,r,o){var a=(o-n)/(r-n);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function ct(t,e){for(var n=[],i=0;i<t.length;i++){var r,o=t[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)r=pt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){r=[];for(var l=0;l<o.geometry.length;l++)r.push(pt(o.geometry[l],e))}else if("MultiPolygon"===a)for(r=[],l=0;l<o.geometry.length;l++){for(var s=[],u=0;u<o.geometry[l].length;u++)s.push(pt(o.geometry[l][u],e));r.push(s)}n.push(X(o.id,a,r,o.tags))}return n}function pt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function ht(t,e){if(t.transformed)return t;var n,i,r,o=1<<t.z,a=t.x,l=t.y;for(n=0;n<t.features.length;n++){var s=t.features[n],u=s.geometry,c=s.type;if(s.geometry=[],1===c)for(i=0;i<u.length;i+=2)s.geometry.push(dt(u[i],u[i+1],e,o,a,l));else for(i=0;i<u.length;i++){var p=[];for(r=0;r<u[i].length;r+=2)p.push(dt(u[i][r],u[i][r+1],e,o,a,l));s.geometry.push(p)}}return t.transformed=!0,t}function dt(t,e,n,i,r,o){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-o))]}function ft(t,e,n,i,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},l=0;l<t.length;l++){a.numFeatures++,mt(a,t[l],o,r);var s=t[l].minX,u=t[l].minY,c=t[l].maxX,p=t[l].maxY;s<a.minX&&(a.minX=s),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function mt(t,e,n,i){var r=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var l=0;l<r.length;l+=3)a.push(r[l]),a.push(r[l+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)gt(a,r,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(l=0;l<r.length;l++)gt(a,r[l],t,n,"Polygon"===o,0===l);else if("MultiPolygon"===o)for(var s=0;s<r.length;s++){var u=r[s];for(l=0;l<u.length;l++)gt(a,u[l],t,n,!0,0===l)}if(a.length){var c=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var p in c={},e.tags)c[p]=e.tags[p];c.mapbox_clip_start=r.start/r.size,c.mapbox_clip_end=r.end/r.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(h.id=e.id),t.features.push(h)}}function gt(t,e,n,i,r,o){var a=i*i;if(i>0&&e.size<(r?a:i))n.numPoints+=e.length/3;else{for(var l=[],s=0;s<e.length;s+=3)(0===i||e[s+2]>a)&&(n.numSimplified++,l.push(e[s]),l.push(e[s+1])),n.numPoints++;r&&function(t,e){for(var n=0,i=0,r=t.length,o=r-2;i<r;o=i,i+=2)n+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var a=t[i],l=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=a,t[r-1-i]=l}}(l,o),t.push(l)}}function vt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)K(n,t.features[i],e,i);else K(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,r=nt(t,1,-1-n,n,0,-1,2,e),o=nt(t,1,1-n,2+n,0,-1,2,e);return(r||o)&&(i=nt(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=ct(r,1).concat(i)),o&&(i=i.concat(ct(o,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function yt(t,e,n){return 32*((1<<t)*n+e)+t}function _t(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return e(null,null);var r=new m(i.features),o=b(r);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:r,rawData:o.buffer})}F.prototype.load=function(t){var e=this.options,n=e.log,i=e.minZoom,r=e.maxZoom,o=e.nodeSize;n&&console.time("total time");var a="prepare "+t.length+" points";n&&console.time(a),this.points=t;for(var l=[],s=0;s<t.length;s++)t[s].geometry&&l.push(N(t[s],s));this.trees[r+1]=new R(l,Z,H,o,Float32Array),n&&console.timeEnd(a);for(var u=r;u>=i;u--){var c=+Date.now();l=this._cluster(l,u),this.trees[u]=new R(l,Z,H,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",u,l.length,+Date.now()-c)}return n&&console.timeEnd("total time"),this},F.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),r=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){var a=this.getClusters([n,i,180,o],e),l=this.getClusters([-180,i,r,o],e);return a.concat(l)}for(var s=this.trees[this._limitZoom(e)],u=[],c=0,p=s.range(V(n),q(o),V(r),q(i));c<p.length;c+=1){var h=s.points[p[c]];u.push(h.numPoints?U(h):this.points[h.index])}return u},F.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);var o=r.points[e];if(!o)throw new Error(i);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=[],s=0,u=r.within(o.x,o.y,a);s<u.length;s+=1){var c=r.points[u[s]];c.parentId===t&&l.push(c.numPoints?U(c):this.points[c.index])}if(0===l.length)throw new Error(i);return l},F.prototype.getLeaves=function(t,e,n){var i=[];return this._appendLeaves(i,t,e=e||10,n=n||0,0),i},F.prototype.getTile=function(t,e,n){var i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),o=this.options,a=o.radius/o.extent,l=(n-a)/r,s=(n+1+a)/r,u={features:[]};return this._addTileFeatures(i.range((e-a)/r,l,(e+1+a)/r,s),i.points,e,n,r,u),0===e&&this._addTileFeatures(i.range(1-a/r,l,1,s),i.points,r,n,r,u),e===r-1&&this._addTileFeatures(i.range(0,l,a/r,s),i.points,-1,n,r,u),u.features.length?u:null},F.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},F.prototype._appendLeaves=function(t,e,n,i,r){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var l=a[o],s=l.properties;if(s&&s.cluster?r+s.point_count<=i?r+=s.point_count:r=this._appendLeaves(t,s.cluster_id,n,i,r):r<i?r++:t.push(l),t.length===n)break}return r},F.prototype._addTileFeatures=function(t,e,n,i,r,o){for(var a=0,l=t;a<l.length;a+=1){var s=e[l[a]],u=s.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(s.x*r-n)),Math.round(this.options.extent*(s.y*r-i))]],tags:u?j(s):this.points[s.index].properties},p=void 0;u?p=s.id:this.options.generateId?p=s.index:this.points[s.index].id&&(p=this.points[s.index].id),void 0!==p&&(c.id=p),o.features.push(c)}},F.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},F.prototype._cluster=function(t,e){for(var n=[],i=this.options,r=i.reduce,o=i.minPoints,a=i.radius/(i.extent*Math.pow(2,e)),l=0;l<t.length;l++){var s=t[l];if(!(s.zoom<=e)){s.zoom=e;for(var u=this.trees[e+1],c=u.within(s.x,s.y,a),p=s.numPoints||1,h=p,d=0,f=c;d<f.length;d+=1){var m=u.points[f[d]];m.zoom>e&&(h+=m.numPoints||1)}if(h>=o){for(var g=s.x*p,v=s.y*p,y=r&&p>1?this._map(s,!0):null,_=(l<<5)+(e+1)+this.points.length,b=0,x=c;b<x.length;b+=1){var w=u.points[x[b]];if(!(w.zoom<=e)){w.zoom=e;var C=w.numPoints||1;g+=w.x*C,v+=w.y*C,w.parentId=_,r&&(y||(y=this._map(s,!0)),r(y,this._map(w)))}}s.parentId=_,n.push(B(g/h,v/h,_,h,y))}else if(n.push(s),h>1)for(var E=0,S=c;E<S.length;E+=1){var T=u.points[S[E]];T.zoom<=e||(T.zoom=e,n.push(T))}}}return n},F.prototype._getOriginId=function(t){return t-this.points.length>>5},F.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},F.prototype._map=function(t,e){if(t.numPoints)return e?G({},t.properties):t.properties;var n=this.points[t.index].properties,i=this.options.map(n);return e&&i===n?G({},i):i},vt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},vt.prototype.splitTile=function(t,e,n,i,r,o,a){for(var l=[t,e,n,i],s=this.options,u=s.debug;l.length;){i=l.pop(),n=l.pop(),e=l.pop(),t=l.pop();var c=1<<e,p=yt(e,n,i),h=this.tiles[p];if(!h&&(u>1&&console.time("creation"),h=this.tiles[p]=ft(t,e,n,i,s),this.tileCoords.push({z:e,x:n,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=t,r){if(e===s.maxZoom||e===r)continue;var f=1<<r-e;if(n!==Math.floor(o/f)||i!==Math.floor(a/f))continue}else if(e===s.indexMaxZoom||h.numPoints<=s.indexMaxPoints)continue;if(h.source=null,0!==t.length){u>1&&console.time("clipping");var m,g,v,y,_,b,x=.5*s.buffer/s.extent,w=.5-x,C=.5+x,E=1+x;m=g=v=y=null,_=nt(t,c,n-x,n+C,0,h.minX,h.maxX,s),b=nt(t,c,n+w,n+E,0,h.minX,h.maxX,s),t=null,_&&(m=nt(_,c,i-x,i+C,1,h.minY,h.maxY,s),g=nt(_,c,i+w,i+E,1,h.minY,h.maxY,s),_=null),b&&(v=nt(b,c,i-x,i+C,1,h.minY,h.maxY,s),y=nt(b,c,i+w,i+E,1,h.minY,h.maxY,s),b=null),u>1&&console.timeEnd("clipping"),l.push(m||[],e+1,2*n,2*i),l.push(g||[],e+1,2*n,2*i+1),l.push(v||[],e+1,2*n+1,2*i),l.push(y||[],e+1,2*n+1,2*i+1)}}},vt.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,o=i.debug;if(t<0||t>24)return null;var a=1<<t,l=yt(t,e=(e%a+a)%a,n);if(this.tiles[l])return ht(this.tiles[l],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var s,u=t,c=e,p=n;!s&&u>0;)u--,c=Math.floor(c/2),p=Math.floor(p/2),s=this.tiles[yt(u,c,p)];return s&&s.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,p),o>1&&console.time("drilling down"),this.splitTile(s.source,u,c,p,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[l]?ht(this.tiles[l],r):null):null};var bt=function(e){function n(t,n,i,r){e.call(this,t,n,i,_t),r&&(this.loadGeoJSON=r)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var n=this._pendingCallback,i=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var r=!!(i&&i.request&&i.request.collectResourceTiming)&&new t.RequestPerformance(i.request);this.loadGeoJSON(i,(function(o,a){if(o||!a)return n(o);if("object"!=typeof a)return n(new Error("Input data given to '"+i.source+"' is not a valid GeoJSON object."));!function t(e,n){var i,r=e&&e.type;if("FeatureCollection"===r)for(i=0;i<e.features.length;i++)t(e.features[i],n);else if("GeometryCollection"===r)for(i=0;i<e.geometries.length;i++)t(e.geometries[i],n);else if("Feature"===r)t(e.geometry,n);else if("Polygon"===r)p(e.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<e.coordinates.length;i++)p(e.coordinates[i],n);return e}(a,!0);try{if(i.filter){var l=t.createExpression(i.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===l.result)throw new Error(l.value.map((function(t){return t.key+": "+t.message})).join(", "));var s=a.features.filter((function(t){return l.value.evaluate({zoom:0},t)}));a={type:"FeatureCollection",features:s}}e._geoJSONIndex=i.cluster?new F(function(e){var n=e.superclusterOptions,i=e.clusterProperties;if(!i||!n)return n;for(var r={},o={},a={accumulated:null,zoom:0},l={properties:null},s=Object.keys(i),u=0,c=s;u<c.length;u+=1){var p=c[u],h=i[p],d=h[0],f=t.createExpression(h[1]),m=t.createExpression("string"==typeof d?[d,["accumulated"],["get",p]]:d);r[p]=f.value,o[p]=m.value}return n.map=function(t){l.properties=t;for(var e={},n=0,i=s;n<i.length;n+=1){var o=i[n];e[o]=r[o].evaluate(a,l)}return e},n.reduce=function(t,e){l.properties=e;for(var n=0,i=s;n<i.length;n+=1){var r=i[n];a.accumulated=t[r],t[r]=o[r].evaluate(a,l)}},n}(i)).load(a.features):function(t,e){return new vt(t,e)}(a,i.geojsonVtOptions)}catch(o){return n(o)}e.loaded={};var u={};if(r){var c=r.finish();c&&(u.resourceTiming={},u.resourceTiming[i.source]=JSON.parse(JSON.stringify(c)))}n(null,u)}))}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var i=this.loaded;return i&&i[t.uid]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n.prototype.getClusterExpansionZoom=function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterChildren=function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterLeaves=function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}},n}(s),xt=function(e){var n=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:s,geojson:bt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return xt.prototype.setReferrer=function(t,e){this.referrer=e},xt.prototype.setImages=function(t,e,n){for(var i in this.availableImages[t]=e,this.workerSources[t]){var r=this.workerSources[t][i];for(var o in r)r[o].availableImages=e}n()},xt.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},xt.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},xt.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},xt.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},xt.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},xt.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},xt.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},xt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},xt.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,n):n()}},xt.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},xt.prototype.syncRTLPluginState=function(e,n,i){try{t.plugin.setState(n);var r=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=r){this.self.importScripts(r);var o=t.plugin.isParsed();i(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+r),o)}}catch(t){i(t.toString())}},xt.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e||(e=[]),e},xt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new i),e},xt.prototype.getWorkerSource=function(t,e,n){var i=this;return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][n]||(this.workerSources[t][e][n]=new this.workerSourceTypes[e]({send:function(e,n,r){i.actor.send(e,n,r,t)}},this.getLayerIndex(t),this.getAvailableImages(t))),this.workerSources[t][e][n]},xt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new c),this.demWorkerSources[t][e]},xt.prototype.enforceCacheSizeLimit=function(e,n){t.enforceCacheSizeLimit(n)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new xt(self)),xt})),i(0,(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!n(t)}function n(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===i[n=t&&t.failIfMajorPerformanceCaveat]&&(i[n]=function(t){var n=function(t){var n=document.createElement("canvas"),i=Object.create(e.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",i)||n.probablySupportsContext("experimental-webgl",i):n.supportsContext?n.supportsContext("webgl",i)||n.supportsContext("experimental-webgl",i):n.getContext("webgl",i)||n.getContext("experimental-webgl",i)}(t);if(!n)return!1;var i=n.createShader(n.VERTEX_SHADER);return!(!i||n.isContextLost())&&(n.shaderSource(i,"void main() {}"),n.compileShader(i),!0===n.getShaderParameter(i,n.COMPILE_STATUS))}(n)),i[n]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var n}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=n);var i={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),n={create:function(e,n,i){var r=t.window.document.createElement(e);return void 0!==n&&(r.className=n),i&&i.appendChild(r),r},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},i=t.window.document&&t.window.document.documentElement.style;function r(t){if(!i)return t[0];for(var e=0;e<t.length;e++)if(t[e]in i)return t[e];return t[0]}var o,a=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){i&&a&&(o=i[a],i[a]="none")},n.enableDrag=function(){i&&a&&(i[a]=o)};var l=r(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[l]=e};var s=!1;try{var u=Object.defineProperty({},"passive",{get:function(){s=!0}});t.window.addEventListener("test",u,u),t.window.removeEventListener("test",u,u)}catch(t){s=!1}n.addEventListener=function(t,e,n,i){void 0===i&&(i={}),t.addEventListener(e,n,"passive"in i&&s?i:i.capture)},n.removeEventListener=function(t,e,n,i){void 0===i&&(i={}),t.removeEventListener(e,n,"passive"in i&&s?i:i.capture)};var c=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",c,!0)};function p(t){var e=t.userImage;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}n.suppressClick=function(){t.window.addEventListener("click",c,!0),t.window.setTimeout((function(){t.window.removeEventListener("click",c,!0)}),0)},n.mousePos=function(e,n){var i=e.getBoundingClientRect();return new t.Point(n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop)},n.touchPos=function(e,n){for(var i=e.getBoundingClientRect(),r=[],o=0;o<n.length;o++)r.push(new t.Point(n[o].clientX-i.left-e.clientLeft,n[o].clientY-i.top-e.clientTop));return r},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var h=function(e){function n(){e.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.isLoaded=function(){return this.loaded},n.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var i=n[e];this._notify(i.ids,i.callback)}this.requestors=[]}},n.prototype.getImage=function(t){return this.images[t]},n.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},n.prototype._validate=function(e,n){var i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchX" value'))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchY" value'))),i=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "content" value'))),i=!1),i},n.prototype._validateStretch=function(t,e){if(!t)return!0;for(var n=0,i=0,r=t;i<r.length;i+=1){var o=r[i];if(o[0]<n||o[1]<o[0]||e<o[1])return!1;n=o[1]}return!0},n.prototype._validateContent=function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))},n.prototype.updateImage=function(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0},n.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},n.prototype.listImages=function(){return Object.keys(this.images)},n.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var i=0,r=t;i<r.length;i+=1)this.images[r[i]]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},n.prototype._notify=function(e,n){for(var i={},r=0,o=e;r<o.length;r+=1){var a=o[r];this.images[a]||this.fire(new t.Event("styleimagemissing",{id:a}));var l=this.images[a];l?i[a]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:Boolean(l.userImage&&l.userImage.render)}:t.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}n(null,i)},n.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},n.prototype.getPattern=function(e){var n=this.patterns[e],i=this.getImage(e);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{var r={w:i.data.width+2,h:i.data.height+2,x:0,y:0},o=new t.ImagePosition(r,i);this.patterns[e]={bin:r,position:o}}return this._updatePatternAtlas(),this.patterns[e].position},n.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},n.prototype._updatePatternAtlas=function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var i=t.potpack(e),r=i.w,o=i.h,a=this.atlasImage;for(var l in a.resize({width:r||1,height:o||1}),this.patterns){var s=this.patterns[l].bin,u=s.x+1,c=s.y+1,p=this.images[l].data,h=p.width,d=p.height;t.RGBAImage.copy(p,a,{x:0,y:0},{x:u,y:c},{width:h,height:d}),t.RGBAImage.copy(p,a,{x:0,y:d-1},{x:u,y:c-1},{width:h,height:1}),t.RGBAImage.copy(p,a,{x:0,y:0},{x:u,y:c+d},{width:h,height:1}),t.RGBAImage.copy(p,a,{x:h-1,y:0},{x:u-1,y:c},{width:1,height:d}),t.RGBAImage.copy(p,a,{x:0,y:0},{x:u+h,y:c},{width:1,height:d})}this.dirty=!0},n.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},n.prototype.dispatchRenderCallbacks=function(t){for(var e=0,n=t;e<n.length;e+=1){var i=n[e];if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var r=this.images[i];p(r)&&this.updateImage(i,r)}}},n}(t.Evented),d=g,f=g,m=1e20;function g(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function v(t,e,n,i,r,o,a){for(var l=0;l<e;l++){for(var s=0;s<n;s++)i[s]=t[s*e+l];for(y(i,r,o,a,n),s=0;s<n;s++)t[s*e+l]=r[s]}for(s=0;s<n;s++){for(l=0;l<e;l++)i[l]=t[s*e+l];for(y(i,r,o,a,e),l=0;l<e;l++)t[s*e+l]=Math.sqrt(r[l])}}function y(t,e,n,i,r){n[0]=0,i[0]=-m,i[1]=+m;for(var o=1,a=0;o<r;o++){for(var l=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);l<=i[a];)a--,l=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,i[a]=l,i[a+1]=+m}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}g.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var r=e.data[4*i+3]/255;this.gridOuter[i]=1===r?0:0===r?m:Math.pow(Math.max(0,.5-r),2),this.gridInner[i]=1===r?m:0===r?0:Math.pow(Math.max(0,r-.5),2)}for(v(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),v(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++)n[i]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[i]-this.gridInner[i])/this.radius+this.cutoff))));return n},d.default=f;var _=function(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}};_.prototype.setURL=function(t){this.url=t},_.prototype.getGlyphs=function(e,n){var i=this,r=[];for(var o in e)for(var a=0,l=e[o];a<l.length;a+=1)r.push({stack:o,id:l[a]});t.asyncAll(r,(function(t,e){var n=t.stack,r=t.id,o=i.entries[n];o||(o=i.entries[n]={glyphs:{},requests:{},ranges:{}});var a=o.glyphs[r];if(void 0===a){if(a=i._tinySDF(o,n,r))return o.glyphs[r]=a,void e(null,{stack:n,id:r,glyph:a});var l=Math.floor(r/256);if(256*l>65535)e(new Error("glyphs > 65535 not supported"));else if(o.ranges[l])e(null,{stack:n,id:r,glyph:a});else{var s=o.requests[l];s||(s=o.requests[l]=[],_.loadGlyphRange(n,l,i.url,i.requestManager,(function(t,e){if(e){for(var n in e)i._doesCharSupportLocalGlyph(+n)||(o.glyphs[+n]=e[+n]);o.ranges[l]=!0}for(var r=0,a=s;r<a.length;r+=1)(0,a[r])(t,e);delete o.requests[l]}))),s.push((function(t,i){t?e(t):i&&e(null,{stack:n,id:r,glyph:i[r]||null})}))}}else e(null,{stack:n,id:r,glyph:a})}),(function(t,e){if(t)n(t);else if(e){for(var i={},r=0,o=e;r<o.length;r+=1){var a=o[r],l=a.stack,s=a.id,u=a.glyph;(i[l]||(i[l]={}))[s]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}n(null,i)}}))},_.prototype._doesCharSupportLocalGlyph=function(e){return!!this.localIdeographFontFamily&&(t.isChar["CJK Unified Ideographs"](e)||t.isChar["Hangul Syllables"](e)||t.isChar.Hiragana(e)||t.isChar.Katakana(e))},_.prototype._tinySDF=function(e,n,i){var r=this.localIdeographFontFamily;if(r&&this._doesCharSupportLocalGlyph(i)){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new _.TinySDF(24,3,8,.25,r,a)}return{id:i,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(e,n,i,r,o){var a=256*n,l=a+255,s=r.transformRequest(r.normalizeGlyphsURL(i).replace("{fontstack}",e).replace("{range}",a+"-"+l),t.ResourceType.Glyphs);t.getArrayBuffer(s,(function(e,n){if(e)o(e);else if(n){for(var i={},r=0,a=t.parseGlyphPBF(n);r<a.length;r+=1){var l=a[r];i[l.id]=l}o(null,i)}}))},_.TinySDF=d;var b=function(){this.specification=t.styleSpec.light.position};b.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},b.prototype.interpolate=function(e,n,i){return{x:t.number(e.x,n.x,i),y:t.number(e.y,n.y,i),z:t.number(e.z,n.z,i)}};var x=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new b,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),w=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(x),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e,n){if(void 0===n&&(n={}),!this._validate(t.validateLight,e,n))for(var i in e){var r=e[i];t.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-"-transition".length),r):this._transitionable.setValue(i,r)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n,i){return(!i||!1!==i.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},n}(t.Evented),C=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};C.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]},C.prototype.getDashRanges=function(t,e,n){var i=[],r=t.length%2==1?-t[t.length-1]*n:0,o=t[0]*n,a=!0;i.push({left:r,right:o,isDash:a,zeroLength:0===t[0]});for(var l=t[0],s=1;s<t.length;s++){var u=t[s];i.push({left:r=l*n,right:o=(l+=u)*n,isDash:a=!a,zeroLength:0===u})}return i},C.prototype.addRoundDash=function(t,e,n){for(var i=e/2,r=-n;r<=n;r++)for(var o=this.width*(this.nextRow+n+r),a=0,l=t[a],s=0;s<this.width;s++){s/l.right>1&&(l=t[++a]);var u=Math.abs(s-l.left),c=Math.abs(s-l.right),p=Math.min(u,c),h=void 0,d=r/n*(i+1);if(l.isDash){var f=i-Math.abs(d);h=Math.sqrt(p*p+f*f)}else h=i-Math.sqrt(p*p+d*d);this.data[o+s]=Math.max(0,Math.min(255,h+128))}},C.prototype.addRegularDash=function(t){for(var e=t.length-1;e>=0;--e){var n=t[e],i=t[e+1];n.zeroLength?t.splice(e,1):i&&i.isDash===n.isDash&&(i.left=n.left,t.splice(e,1))}var r=t[0],o=t[t.length-1];r.isDash===o.isDash&&(r.left=o.left-this.width,o.right=r.right+this.width);for(var a=this.width*this.nextRow,l=0,s=t[l],u=0;u<this.width;u++){u/s.right>1&&(s=t[++l]);var c=Math.abs(u-s.left),p=Math.abs(u-s.right),h=Math.min(c,p);this.data[a+u]=Math.max(0,Math.min(255,(s.isDash?h:-h)+128))}},C.prototype.addDash=function(e,n){var i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];if(0!==o){var l=this.width/o,s=this.getDashRanges(e,this.width,l);n?this.addRoundDash(s,l,i):this.addRegularDash(s)}var u={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:o};return this.nextRow+=r,this.dirty=!0,u},C.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))};var E=function e(n,i){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var r=this.workerPool.acquire(this.id),o=0;o<r.length;o++){var a=new e.Actor(r[o],i,this.id);a.name="Worker "+o,this.actors.push(a)}};function S(e,n,i){var r=function(r,o){if(r)return i(r);if(o){var a=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(a.vectorLayers=o.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(t){return t.id}))),a.tiles=n.canonicalizeTileset(a,e.url),i(null,a)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),r):t.browser.frame((function(){return r(null,e)}))}E.prototype.broadcast=function(e,n,i){t.asyncAll(this.actors,(function(t,i){t.send(e,n,i)}),i=i||function(){})},E.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},E.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},E.Actor=t.Actor;var T=function(e,n,i){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=i||24};T.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},T.prototype.contains=function(e){var n=Math.pow(2,e.z),i=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),r=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=i&&e.x<o&&e.y>=r&&e.y<a};var I=function(e){function n(n,i,r,o){if(e.call(this),this.id=n,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(i,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=S(this._options,this.map._requestManager,(function(n,i){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new T(i.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(i.tiles,e.map._requestManager._customAccessToken),t.postMapLoadEvent(i.tiles,e.map._getMapId(),e.map._requestManager._skuToken,e.map._requestManager._customAccessToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setSourceProperty=function(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},n.prototype.setTiles=function(t){var e=this;return this.setSourceProperty((function(){e._options.tiles=t})),this},n.prototype.setUrl=function(t){var e=this;return this.setSourceProperty((function(){e.url=t,e._options.url=t})),this},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(i,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(i,r){return delete e.request,e.aborted?n(null):i&&404!==i.status?n(i):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}r.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",r,o.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",r,o.bind(this)))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),P=function(e){function n(n,i,r,o){e.call(this),this.id=n,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},i),t.extend(this,t.pick(i,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=S(this._options,this.map._requestManager,(function(n,i){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new T(i.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(i.tiles),t.postMapLoadEvent(i.tiles,e.map._getMapId(),e.map._requestManager._skuToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var i=this,r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),(function(r,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){i.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=i.map.painter.context,l=a.gl;e.texture=i.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,l.RGBA,{useMipmap:!0}),e.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(i.dispatcher),n(null)}}))},n.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),A=function(e){function n(n,i,r,o){e.call(this,n,i,r,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function r(t,i){t&&(e.state="errored",n(t)),i&&(e.dem=i,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),(function(i,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=t.window.ImageBitmap&&o instanceof t.window.ImageBitmap&&t.offscreenCanvasSupported()?o:t.browser.getImageData(o,1),l={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:a,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",l,r.bind(this)))}}).bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+i)%i,l=n.x+1===i?e.wrap+1:e.wrap,s={};return s[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y).key]={backfilled:!1},s[new t.OverscaledTileID(e.overscaledZ,l,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(s[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y-1).key]={backfilled:!1},s[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},s[new t.OverscaledTileID(e.overscaledZ,l,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<i&&(s[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y+1).key]={backfilled:!1},s[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},s[new t.OverscaledTileID(e.overscaledZ,l,n.z,a,n.y+1).key]={backfilled:!1}),s},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},n}(P),M=function(e){function n(n,i,r,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(o),this._data=i.data,this._options=t.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?Math.min(i.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:t.EXTENT,radius:(i.clusterRadius||50)*a,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(n){if(n)e.fire(new t.ErrorEvent(n));else{var i={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(i.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",i))}}))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)n.fire(new t.ErrorEvent(e));else{var i={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(i.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",i))}})),this},n.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},n.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},n.prototype.getClusterLeaves=function(t,e,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},i),this},n.prototype._updateWorkerData=function(e){var n=this;this._loaded=!1;var i=t.extend({},this.workerOptions),r=this._data;"string"==typeof r?(i.request=this.map._requestManager.transformRequest(t.browser.resolveURL(r),t.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(r),this.actor.send(this.type+".loadData",i,(function(t,r){n._removed||r&&r.abandoned||(n._loaded=!0,r&&r.resourceTiming&&r.resourceTiming[n.id]&&(n._resourceTiming=r.resourceTiming[n.id].slice(0)),n.actor.send(n.type+".coalesce",{source:i.source},null),e(t))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.loadTile=function(e,n){var i=this,r=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(r,{type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(t,o){return delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,i.map.painter,"reloadTile"===r),n(null))}))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},n.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),k=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),D=function(e){function n(t,n,i,r){e.call(this),this.id=t,this.dispatcher=i,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(e,n){var i=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(r,o){i._loaded=!0,r?i.fire(new t.ErrorEvent(r)):o&&(i.image=o,e&&(i.coordinates=e),n&&n(),i._finishLoading())}))},n.prototype.loaded=function(){return this._loaded},n.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null})),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){var n=this;this.coordinates=e;var i=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){for(var n=1/0,i=1/0,r=-1/0,o=-1/0,a=0,l=e;a<l.length;a+=1){var s=l[a];n=Math.min(n,s.x),i=Math.min(i,s.y),r=Math.max(r,s.x),o=Math.max(o,s.y)}var u=Math.max(r-n,o-i),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),p=Math.pow(2,c);return new t.CanonicalTileID(c,Math.floor((n+r)/2*p),Math.floor((i+o)/2*p))}(i),this.minzoom=this.maxzoom=this.tileID.z;var r=i.map((function(t){return n.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(r[2].x,r[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,k.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),L=function(e){function n(t,n,i,r){e.call(this,t,n,i,r),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1;var n=this.options;this.urls=[];for(var i=0,r=n.urls;i<r.length;i+=1)this.urls.push(this.map._requestManager.transformRequest(r[i],t.ResourceType.Source).url);t.getVideo(this.urls,(function(n,i){e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):i&&(e.video=i,e.video.loop=!0,e.video.setAttribute("playsinline",""),e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))},n.prototype.pause=function(){this.video&&this.video.pause()},n.prototype.play=function(){this.video&&this.video.play()},n.prototype.seek=function(e){if(this.video){var n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+n.start(0)+" and "+n.end(0)+"-second mark."))):this.video.currentTime=e}},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,k.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(D),O=function(e){function n(n,i,r,o){e.call(this,n,i,r,o),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,i=n.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,k.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,i.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[r];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(D),R={vector:I,raster:P,"raster-dem":A,geojson:M,video:L,image:D,canvas:O};function z(e,n){var i=t.identity([]);return t.translate(i,i,[1,1,0]),t.scale(i,i,[.5*e.width,.5*e.height,1]),t.multiply(i,i,e.calculatePosMatrix(n.toUnwrapped()))}function F(t,e,n,i,r,o){var a=function(t,e,n){if(t)for(var i=0,r=t;i<r.length;i+=1){var o=e[r[i]];if(o&&o.source===n&&"fill-extrusion"===o.type)return!0}else for(var a in e){var l=e[a];if(l.source===n&&"fill-extrusion"===l.type)return!0}return!1}(r&&r.layers,e,t.id),l=o.maxPitchScaleFactor(),s=t.tilesIn(i,l,a);s.sort(B);for(var u=[],c=0,p=s;c<p.length;c+=1){var h=p[c];u.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(e,n,t._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,r,o,l,z(t.transform,h.tileID))})}var d=function(t){for(var e={},n={},i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.queryResults,l=o.wrappedTileID,s=n[l]=n[l]||{};for(var u in a)for(var c=a[u],p=s[u]=s[u]||{},h=e[u]=e[u]||[],d=0,f=c;d<f.length;d+=1){var m=f[d];p[m.featureIndex]||(p[m.featureIndex]=!0,h.push(m))}}return e}(u);for(var f in d)d[f].forEach((function(e){var n=e.feature,i=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i}));return d}function B(t,e){var n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}var N=function(t,e){this.max=t,this.onRemove=e,this.reset()};N.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var i=n[e];i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}return this.data={},this.order=[],this},N.prototype.add=function(t,e,n){var i=this,r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout((function(){i.remove(t,o)}),n)),this.data[r].push(o),this.order.push(r),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},N.prototype.has=function(t){return t.wrapped().key in this.data},N.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},N.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},N.prototype.getByKey=function(t){var e=this.data[t];return e?e[0].value:null},N.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},N.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this},N.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},N.prototype.filter=function(t){var e=[];for(var n in this.data)for(var i=0,r=this.data[n];i<r.length;i+=1){var o=r[i];t(o.value)||e.push(o)}for(var a=0,l=e;a<l.length;a+=1){var s=l[a];this.remove(s.value.tileID,s)}};var U=function(t,e,n){this.context=t;var i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};U.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},U.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},U.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var j={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},V=function(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;var r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};V.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},V.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},V.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var i=e.attributes[this.attributes[n].name];void 0!==i&&t.enableVertexAttribArray(i)}},V.prototype.setVertexAttribPointers=function(t,e,n){for(var i=0;i<this.attributes.length;i++){var r=this.attributes[i],o=e.attributes[r.name];void 0!==o&&t.vertexAttribPointer(o,r.components,t[j[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}},V.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var q=function(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};q.prototype.get=function(){return this.current},q.prototype.set=function(t){},q.prototype.getDefault=function(){return this.default},q.prototype.setDefault=function(){this.set(this.default)};var G=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(q),Z=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},e}(q),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},e}(q),Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(q),X=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)},e}(q),W=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},e}(q),K=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},e}(q),J=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},e}(q),$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},e}(q),Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},e}(q),tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},e}(q),et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},e}(q),nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},e}(q),it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},e}(q),rt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(q),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},e}(q),at=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},e}(q),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)},e}(q),st=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)},e}(q),ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)},e}(q),ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},e}(q),pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(q),ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},e}(q),dt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(q),ft=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},e}(q),mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},e}(q),gt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},e}(q),vt=function(t){function e(e){t.call(this,e),this.vao=e.extVertexArrayObject}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},e}(q),yt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},e}(q),_t=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},e}(q),bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},e}(q),xt=function(t){function e(e,n){t.call(this,e),this.context=e,this.parent=n}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e}(q),wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e}(xt),Ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(xt),Et=function(t,e,n,i){this.context=t,this.width=e,this.height=n;var r=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new wt(t,r),i&&(this.depthAttachment=new Ct(t,r))};Et.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n)}t.deleteFramebuffer(this.framebuffer)};var St=function(t,e,n){this.func=t,this.mask=e,this.range=n};St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);var Tt=function(t,e,n,i,r,o){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=o};Tt.disabled=new Tt({func:519,mask:0},0,0,7680,7680,7680);var It=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};It.disabled=new It(It.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),It.unblended=new It(It.Replace,t.Color.transparent,[!0,!0,!0,!0]),It.alphaBlended=new It([1,771],t.Color.transparent,[!0,!0,!0,!0]);var Pt=function(t,e,n){this.enable=t,this.mode=e,this.frontFace=n};Pt.disabled=new Pt(!1,1029,2305),Pt.backCCW=new Pt(!0,1029,2305);var At=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new G(this),this.clearDepth=new Z(this),this.clearStencil=new H(this),this.colorMask=new Y(this),this.depthMask=new X(this),this.stencilMask=new W(this),this.stencilFunc=new K(this),this.stencilOp=new J(this),this.stencilTest=new $(this),this.depthRange=new Q(this),this.depthTest=new tt(this),this.depthFunc=new et(this),this.blend=new nt(this),this.blendFunc=new it(this),this.blendColor=new rt(this),this.blendEquation=new ot(this),this.cullFace=new at(this),this.cullFaceSide=new lt(this),this.frontFace=new st(this),this.program=new ut(this),this.activeTexture=new ct(this),this.viewport=new pt(this),this.bindFramebuffer=new ht(this),this.bindRenderbuffer=new dt(this),this.bindTexture=new ft(this),this.bindVertexBuffer=new mt(this),this.bindElementBuffer=new gt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new vt(this),this.pixelStoreUnpack=new yt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new bt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)};At.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},At.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},At.prototype.createIndexBuffer=function(t,e){return new U(this,t,e)},At.prototype.createVertexBuffer=function(t,e,n){return new V(this,t,e,n)},At.prototype.createRenderbuffer=function(t,e,n){var i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r},At.prototype.createFramebuffer=function(t,e,n){return new Et(this,t,e,n)},At.prototype.clear=function(t){var e=t.color,n=t.depth,i=this.gl,r=0;e&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(r|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),i.clear(r)},At.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},At.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},At.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},At.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,It.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},At.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Mt=function(e){function n(n,i,r){var o=this;e.call(this),this.id=n,this.dispatcher=r,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))})),this.on("error",(function(){o._sourceErrored=!0})),this._source=function(e,n,i,r){var o=new R[n.type](e,n,i,r);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o}(n,i,r,this),this._tiles={},this._cache=new N(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}},n.prototype.getIds=function(){return t.values(this._tiles).map((function(t){return t.tileID})).sort(kt).map((function(t){return t.key}))},n.prototype.getRenderableIds=function(e){var n=this,i=[];for(var r in this._tiles)this._isIdRenderable(r,e)&&i.push(this._tiles[r]);return e?i.sort((function(e,i){var r=e.tileID,o=i.tileID,a=new t.Point(r.canonical.x,r.canonical.y)._rotate(n.transform.angle),l=new t.Point(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return r.overscaledZ-o.overscaledZ||l.y-a.y||l.x-a.x})).map((function(t){return t.tileID.key})):i.map((function(t){return t.tileID})).sort(kt).map((function(t){return t.key}))},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,i,r){if(r)return e.state="errored",void(404!==r.status?this._source.fire(new t.ErrorEvent(r,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var i=e[n];if(t.neighboringTiles&&t.neighboringTiles[i]){var r=this.getTileByID(i);o(t,r),o(r,t)}}function o(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype._retainLoadedChildren=function(t,e,n,i){for(var r in this._tiles){var o=this._tiles[r];if(!(i[r]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var l=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[l.key])&&o.hasData()&&(a=l)}for(var s=a;s.overscaledZ>e;)if(t[(s=s.scaledTo(s.overscaledZ-1)).key]){i[a.key]=a;break}}}},n.prototype.findLoadedParent=function(t,e){if(t.key in this._loadedParentTiles){var n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(var i=t.overscaledZ-1;i>=e;i--){var r=t.scaledTo(i),o=this._getLoadedTile(r);if(o)return o}},n.prototype._getLoadedTile=function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)},n.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,n=Math.ceil(t.height/this._source.tileSize)+1,i=Math.floor(e*n*5),r="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(r)},n.prototype.handleWrapJump=function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var n={};for(var i in this._tiles){var r=this._tiles[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),n[r.tileID.key]=r}for(var o in this._tiles=n,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},n.prototype.update=function(e){var i=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var r;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(r=r.filter((function(t){return i._source.hasTile(t)})))):r=[];var o=e.coveringZoomLevel(this._source),a=Math.max(o-n.maxOverzooming,this._source.minzoom),l=Math.max(o+n.maxUnderzooming,this._source.minzoom),s=this._updateRetainedTiles(r,o);if(Dt(this._source.type)){for(var u={},c={},p=0,h=Object.keys(s);p<h.length;p+=1){var d=h[p],f=s[d],m=this._tiles[d];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=t.browser.now())){var g=this.findLoadedParent(f,a);g&&(this._addTile(g.tileID),u[g.tileID.key]=g.tileID),c[d]=f}}for(var v in this._retainLoadedChildren(c,o,l,s),u)s[v]||(this._coveredTiles[v]=!0,s[v]=u[v])}for(var y in s)this._tiles[y].clearFadeHold();for(var _=0,b=t.keysDifference(this._tiles,s);_<b.length;_+=1){var x=b[_],w=this._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(x)}this._updateLoadedParentTileCache()}},n.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},n.prototype._updateRetainedTiles=function(t,e){for(var i={},r={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),l={},s=0,u=t;s<u.length;s+=1){var c=u[s],p=this._addTile(c);i[c.key]=c,p.hasData()||e<this._source.maxzoom&&(l[c.key]=c)}this._retainLoadedChildren(l,e,a,i);for(var h=0,d=t;h<d.length;h+=1){var f=d[h],m=this._tiles[f.key];if(!m.hasData()){if(e+1>this._source.maxzoom){var g=f.children(this._source.maxzoom)[0],v=this.getTile(g);if(v&&v.hasData()){i[g.key]=g;continue}}else{var y=f.children(this._source.maxzoom);if(i[y[0].key]&&i[y[1].key]&&i[y[2].key]&&i[y[3].key])continue}for(var _=m.wasRequested(),b=f.overscaledZ-1;b>=o;--b){var x=f.scaledTo(b);if(r[x.key])break;if(r[x.key]=!0,!(m=this.getTile(x))&&_&&(m=this._addTile(x)),m&&(i[x.key]=x,_=m.wasRequested(),m.hasData()))break}}}return i},n.prototype._updateLoadedParentTileCache=function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],n=void 0,i=this._tiles[t].tileID;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);var r=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(r))break;i=r}for(var o=0,a=e;o<a.length;o+=1)this._loadedParentTiles[a[o]]=n}},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var i=Boolean(n);return i||(n=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,i||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((function(){n._reloadTile(t,"expired"),delete n._timers[t]}),i))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n,i){var r=this,o=[],a=this.transform;if(!a)return o;for(var l=i?a.getCameraQueryGeometry(e):e,s=e.map((function(t){return a.pointCoordinate(t)})),u=l.map((function(t){return a.pointCoordinate(t)})),c=this.getIds(),p=1/0,h=1/0,d=-1/0,f=-1/0,m=0,g=u;m<g.length;m+=1){var v=g[m];p=Math.min(p,v.x),h=Math.min(h,v.y),d=Math.max(d,v.x),f=Math.max(f,v.y)}for(var y=function(e){var i=r._tiles[c[e]];if(!i.holdingForFade()){var l=i.tileID,m=Math.pow(2,a.zoom-i.tileID.overscaledZ),g=n*i.queryPadding*t.EXTENT/i.tileSize/m,v=[l.getTilePoint(new t.MercatorCoordinate(p,h)),l.getTilePoint(new t.MercatorCoordinate(d,f))];if(v[0].x-g<t.EXTENT&&v[0].y-g<t.EXTENT&&v[1].x+g>=0&&v[1].y+g>=0){var y=s.map((function(t){return l.getTilePoint(t)})),_=u.map((function(t){return l.getTilePoint(t)}));o.push({tile:i,tileID:l,queryGeometry:y,cameraQueryGeometry:_,scale:m})}}},_=0;_<c.length;_++)y(_);return o},n.prototype.getVisibleCoordinates=function(t){for(var e=this,n=this.getRenderableIds(t).map((function(t){return e._tiles[t].tileID})),i=0,r=n;i<r.length;i+=1){var o=r[i];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Dt(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.browser.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)},n.prototype.removeFeatureState=function(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)},n.prototype.getFeatureState=function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)},n.prototype.setDependencies=function(t,e,n){var i=this._tiles[t];i&&i.setDependencies(e,n)},n.prototype.reloadTilesForDependencies=function(t,e){for(var n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((function(n){return!n.hasDependency(t,e)}))},n}(t.Evented);function kt(t,e){var n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Dt(t){return"raster"===t||"image"===t||"video"===t}function Lt(){return new t.window.Worker(Wr.workerUrl)}Mt.maxOverzooming=10,Mt.maxUnderzooming=3;var Ot="mapboxgl_preloaded_worker_pool",Rt=function(){this.active={}};Rt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Rt.workerCount;)this.workers.push(new Lt);return this.active[t]=!0,this.workers.slice()},Rt.prototype.release=function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)},Rt.prototype.isPreloaded=function(){return!!this.active[Ot]},Rt.prototype.numActive=function(){return Object.keys(this.active).length};var zt,Ft=Math.floor(t.browser.hardwareConcurrency/2);function Bt(){return zt||(zt=new Rt),zt}function Nt(e,n){var i={};for(var r in e)"ref"!==r&&(i[r]=e[r]);return t.refProperties.forEach((function(t){t in n&&(i[t]=n[t])})),i}function Ut(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=Nt(t[i],e[t[i].ref]));return t}Rt.workerCount=Math.max(Math.min(Ft,6),1);var jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Vt(t,e,n){n.push({command:jt.addSource,args:[t,e[t]]})}function qt(t,e,n){e.push({command:jt.removeSource,args:[t]}),n[t]=!0}function Gt(t,e,n,i){qt(t,n,i),Vt(t,e,n)}function Zt(e,n,i){var r;for(r in e[i])if(e[i].hasOwnProperty(r)&&"data"!==r&&!t.deepEqual(e[i][r],n[i][r]))return!1;for(r in n[i])if(n[i].hasOwnProperty(r)&&"data"!==r&&!t.deepEqual(e[i][r],n[i][r]))return!1;return!0}function Ht(e,n,i,r,o,a){var l;for(l in n=n||{},e=e||{})e.hasOwnProperty(l)&&(t.deepEqual(e[l],n[l])||i.push({command:a,args:[r,l,n[l],o]}));for(l in n)n.hasOwnProperty(l)&&!e.hasOwnProperty(l)&&(t.deepEqual(e[l],n[l])||i.push({command:a,args:[r,l,n[l],o]}))}function Yt(t){return t.id}function Xt(t,e){return t[e.id]=e,t}var Wt=function(t,e){this.reset(t,e)};Wt.prototype.reset=function(t,e){this.points=t||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Wt.prototype.lerp=function(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);for(var n=1,i=this._distances[n],r=e*this.paddedLength+this.padding;i<r&&n<this._distances.length;)i=this._distances[++n];var o=n-1,a=this._distances[o],l=i-a,s=l>0?(r-a)/l:0;return this.points[o].mult(1-s).add(this.points[n].mult(s))};var Kt=function(t,e,n){var i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};function Jt(e,n,i,r,o){var a=t.create();return n?(t.scale(a,a,[1/o,1/o,1]),i||t.rotateZ(a,a,r.angle)):t.multiply(a,r.labelPlaneMatrix,e),a}function $t(e,n,i,r,o){if(n){var a=t.clone(e);return t.scale(a,a,[o,o,1]),i||t.rotateZ(a,a,-r.angle),a}return r.glCoordMatrix}function Qt(e,n){var i=[e.x,e.y,0,1];ce(i,i,n);var r=i[3];return{point:new t.Point(i[0]/r,i[1]/r),signedDistanceFromCamera:r}}function te(t,e){return.5+t/e*.5}function ee(t,e){var n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function ne(e,n,i,r,o,a,l,s){var u=r?e.textSizeData:e.iconSizeData,c=t.evaluateSizeForZoom(u,i.transform.zoom),p=[256/i.width*2+1,256/i.height*2+1],h=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;h.clear();for(var d=e.lineVertexArray,f=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=i.transform.width/i.transform.height,g=!1,v=0;v<f.length;v++){var y=f.get(v);if(y.hidden||y.writingMode===t.WritingMode.vertical&&!g)ue(y.numGlyphs,h);else{g=!1;var _=[y.anchorX,y.anchorY,0,1];if(t.transformMat4(_,_,n),ee(_,p)){var b=te(i.transform.cameraToCenterDistance,_[3]),x=t.evaluateSizeForFeature(u,c,y),w=l?x/b:x*b,C=new t.Point(y.anchorX,y.anchorY),E=Qt(C,o).point,S={},T=oe(y,w,!1,s,n,o,a,e.glyphOffsetArray,d,h,E,C,S,m);g=T.useVertical,(T.notEnoughRoom||g||T.needsFlipping&&oe(y,w,!0,s,n,o,a,e.glyphOffsetArray,d,h,E,C,S,m).notEnoughRoom)&&ue(y.numGlyphs,h)}else ue(y.numGlyphs,h)}}r?e.text.dynamicLayoutVertexBuffer.updateData(h):e.icon.dynamicLayoutVertexBuffer.updateData(h)}function ie(t,e,n,i,r,o,a,l,s,u,c){var p=l.glyphStartIndex+l.numGlyphs,h=l.lineStartIndex,d=l.lineStartIndex+l.lineLength,f=e.getoffsetX(l.glyphStartIndex),m=e.getoffsetX(p-1),g=le(t*f,n,i,r,o,a,l.segment,h,d,s,u,c);if(!g)return null;var v=le(t*m,n,i,r,o,a,l.segment,h,d,s,u,c);return v?{first:g,last:v}:null}function re(e,n,i,r){return e===t.WritingMode.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function oe(e,n,i,r,o,a,l,s,u,c,p,h,d,f){var m,g=n/24,v=e.lineOffsetX*g,y=e.lineOffsetY*g;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=ie(g,s,v,y,i,p,h,e,u,a,d);if(!w)return{notEnoughRoom:!0};var C=Qt(w.first.point,l).point,E=Qt(w.last.point,l).point;if(r&&!i){var S=re(e.writingMode,C,E,f);if(S)return S}m=[w.first];for(var T=e.glyphStartIndex+1;T<_-1;T++)m.push(le(g*s.getoffsetX(T),v,y,i,p,h,e.segment,b,x,u,a,d));m.push(w.last)}else{if(r&&!i){var I=Qt(h,o).point,P=e.lineStartIndex+e.segment+1,A=new t.Point(u.getx(P),u.gety(P)),M=Qt(A,o),k=M.signedDistanceFromCamera>0?M.point:ae(h,A,I,1,o),D=re(e.writingMode,I,k,f);if(D)return D}var L=le(g*s.getoffsetX(e.glyphStartIndex),v,y,i,p,h,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,d);if(!L)return{notEnoughRoom:!0};m=[L]}for(var O=0,R=m;O<R.length;O+=1){var z=R[O];t.addDynamicAttributes(c,z.point,z.angle)}return{}}function ae(t,e,n,i,r){var o=Qt(t.add(t.sub(e)._unit()),r).point,a=n.sub(o);return n.add(a._mult(i/a.mag()))}function le(e,n,i,r,o,a,l,s,u,c,p,h){var d=r?e-n:e+n,f=d>0?1:-1,m=0;r&&(f*=-1,m=Math.PI),f<0&&(m+=Math.PI);for(var g=f>0?s+l:s+l+1,v=o,y=o,_=0,b=0,x=Math.abs(d),w=[];_+b<=x;){if((g+=f)<s||g>=u)return null;if(y=v,w.push(v),void 0===(v=h[g])){var C=new t.Point(c.getx(g),c.gety(g)),E=Qt(C,p);if(E.signedDistanceFromCamera>0)v=h[g]=E.point;else{var S=g-f;v=ae(0===_?a:new t.Point(c.getx(S),c.gety(S)),C,y,x-_+1,p)}}_+=b,b=y.dist(v)}var T=(x-_)/b,I=v.sub(y),P=I.mult(T)._add(y);P._add(I._unit()._perp()._mult(i*f));var A=m+Math.atan2(v.y-y.y,v.x-y.x);return w.push(P),{point:P,angle:A,path:w}}Kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Kt.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},Kt.prototype.insertCircle=function(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)},Kt.prototype._insertBoxCell=function(t,e,n,i,r,o){this.boxCells[r].push(o)},Kt.prototype._insertCircleCell=function(t,e,n,i,r,o){this.circleCells[r].push(o)},Kt.prototype._query=function(t,e,n,i,r,o){if(n<0||t>this.width||i<0||e>this.height)return!r&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(var l=0;l<this.boxKeys.length;l++)a.push({key:this.boxKeys[l],x1:this.bboxes[4*l],y1:this.bboxes[4*l+1],x2:this.bboxes[4*l+2],y2:this.bboxes[4*l+3]});for(var s=0;s<this.circleKeys.length;s++){var u=this.circles[3*s],c=this.circles[3*s+1],p=this.circles[3*s+2];a.push({key:this.circleKeys[s],x1:u-p,y1:c-p,x2:u+p,y2:c+p})}return o?a.filter(o):a}return this._forEachCell(t,e,n,i,this._queryCell,a,{hitTest:r,seenUids:{box:{},circle:{}}},o),r?a.length>0:a},Kt.prototype._queryCircle=function(t,e,n,i,r){var o=t-n,a=t+n,l=e-n,s=e+n;if(a<0||o>this.width||s<0||l>this.height)return!i&&[];var u=[];return this._forEachCell(o,l,a,s,this._queryCellCircle,u,{hitTest:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},r),i?u.length>0:u},Kt.prototype.query=function(t,e,n,i,r){return this._query(t,e,n,i,!1,r)},Kt.prototype.hitTest=function(t,e,n,i,r){return this._query(t,e,n,i,!0,r)},Kt.prototype.hitTestCircle=function(t,e,n,i){return this._queryCircle(t,e,n,!0,i)},Kt.prototype._queryCell=function(t,e,n,i,r,o,a,l){var s=a.seenUids,u=this.boxCells[r];if(null!==u)for(var c=this.bboxes,p=0,h=u;p<h.length;p+=1){var d=h[p];if(!s.box[d]){s.box[d]=!0;var f=4*d;if(t<=c[f+2]&&e<=c[f+3]&&n>=c[f+0]&&i>=c[f+1]&&(!l||l(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:c[f],y1:c[f+1],x2:c[f+2],y2:c[f+3]})}}}var m=this.circleCells[r];if(null!==m)for(var g=this.circles,v=0,y=m;v<y.length;v+=1){var _=y[v];if(!s.circle[_]){s.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(g[b],g[b+1],g[b+2],t,e,n,i)&&(!l||l(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=g[b],w=g[b+1],C=g[b+2];o.push({key:this.circleKeys[_],x1:x-C,y1:w-C,x2:x+C,y2:w+C})}}}},Kt.prototype._queryCellCircle=function(t,e,n,i,r,o,a,l){var s=a.circle,u=a.seenUids,c=this.boxCells[r];if(null!==c)for(var p=this.bboxes,h=0,d=c;h<d.length;h+=1){var f=d[h];if(!u.box[f]){u.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(s.x,s.y,s.radius,p[m+0],p[m+1],p[m+2],p[m+3])&&(!l||l(this.boxKeys[f])))return o.push(!0),!0}}var g=this.circleCells[r];if(null!==g)for(var v=this.circles,y=0,_=g;y<_.length;y+=1){var b=_[y];if(!u.circle[b]){u.circle[b]=!0;var x=3*b;if(this._circlesCollide(v[x],v[x+1],v[x+2],s.x,s.y,s.radius)&&(!l||l(this.circleKeys[b])))return o.push(!0),!0}}},Kt.prototype._forEachCell=function(t,e,n,i,r,o,a,l){for(var s=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),p=this._convertToYCellCoord(i),h=s;h<=c;h++)for(var d=u;d<=p;d++)if(r.call(this,t,e,n,i,this.xCellCount*d+h,o,a,l))return},Kt.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Kt.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Kt.prototype._circlesCollide=function(t,e,n,i,r,o){var a=i-t,l=r-e,s=n+o;return s*s>a*a+l*l},Kt.prototype._circleAndRectCollide=function(t,e,n,i,r,o,a){var l=(o-i)/2,s=Math.abs(t-(i+l));if(s>l+n)return!1;var u=(a-r)/2,c=Math.abs(e-(r+u));if(c>u+n)return!1;if(s<=l||c<=u)return!0;var p=s-l,h=c-u;return p*p+h*h<=n*n};var se=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ue(t,e){for(var n=0;n<t;n++){var i=e.length;e.resize(i+4),e.float32.set(se,3*i)}}function ce(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15],t}var pe=function(t,e,n){void 0===e&&(e=new Kt(t.width+200,t.height+200,25)),void 0===n&&(n=new Kt(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function he(e,n,i){return n*(t.EXTENT/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}pe.prototype.placeCollisionBox=function(t,e,n,i,r){var o=this.projectAndGetPerspectiveRatio(i,t.anchorPointX,t.anchorPointY),a=n*o.perspectiveRatio,l=t.x1*a+o.point.x,s=t.y1*a+o.point.y,u=t.x2*a+o.point.x,c=t.y2*a+o.point.y;return!this.isInsideGrid(l,s,u,c)||!e&&this.grid.hitTest(l,s,u,c,r)?{box:[],offscreen:!1}:{box:[l,s,u,c],offscreen:this.isOffscreen(l,s,u,c)}},pe.prototype.placeCollisionCircles=function(e,n,i,r,o,a,l,s,u,c,p,h,d){var f=[],m=new t.Point(n.anchorX,n.anchorY),g=Qt(m,a),v=te(this.transform.cameraToCenterDistance,g.signedDistanceFromCamera),y=(c?o/v:o*v)/t.ONE_EM,_=Qt(m,l).point,b=ie(y,r,n.lineOffsetX*y,n.lineOffsetY*y,!1,_,m,n,i,l,{}),x=!1,w=!1,C=!0;if(b){for(var E=.5*h*v+d,S=new t.Point(-100,-100),T=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),I=new Wt,P=b.first,A=b.last,M=[],k=P.path.length-1;k>=1;k--)M.push(P.path[k]);for(var D=1;D<A.path.length;D++)M.push(A.path[D]);var L=2.5*E;if(s){var O=M.map((function(t){return Qt(t,s)}));M=O.some((function(t){return t.signedDistanceFromCamera<=0}))?[]:O.map((function(t){return t.point}))}var R=[];if(M.length>0){for(var z=M[0].clone(),F=M[0].clone(),B=1;B<M.length;B++)z.x=Math.min(z.x,M[B].x),z.y=Math.min(z.y,M[B].y),F.x=Math.max(F.x,M[B].x),F.y=Math.max(F.y,M[B].y);R=z.x>=S.x&&F.x<=T.x&&z.y>=S.y&&F.y<=T.y?[M]:F.x<S.x||z.x>T.x||F.y<S.y||z.y>T.y?[]:t.clipLine([M],S.x,S.y,T.x,T.y)}for(var N=0,U=R;N<U.length;N+=1){var j;I.reset(U[N],.25*E),j=I.length<=.5*E?1:Math.ceil(I.paddedLength/L)+1;for(var V=0;V<j;V++){var q=V/Math.max(j-1,1),G=I.lerp(q),Z=G.x+100,H=G.y+100;f.push(Z,H,E,0);var Y=Z-E,X=H-E,W=Z+E,K=H+E;if(C=C&&this.isOffscreen(Y,X,W,K),w=w||this.isInsideGrid(Y,X,W,K),!e&&this.grid.hitTestCircle(Z,H,E,p)&&(x=!0,!u))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!u&&x||!w?[]:f,offscreen:C,collisionDetected:x}},pe.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],i=1/0,r=1/0,o=-1/0,a=-1/0,l=0,s=e;l<s.length;l+=1){var u=s[l],c=new t.Point(u.x+100,u.y+100);i=Math.min(i,c.x),r=Math.min(r,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y),n.push(c)}for(var p={},h={},d=0,f=this.grid.query(i,r,o,a).concat(this.ignoredGrid.query(i,r,o,a));d<f.length;d+=1){var m=f[d],g=m.key;if(void 0===p[g.bucketInstanceId]&&(p[g.bucketInstanceId]={}),!p[g.bucketInstanceId][g.featureIndex]){var v=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(n,v)&&(p[g.bucketInstanceId][g.featureIndex]=!0,void 0===h[g.bucketInstanceId]&&(h[g.bucketInstanceId]=[]),h[g.bucketInstanceId].push(g.featureIndex))}}return h},pe.prototype.insertCollisionBox=function(t,e,n,i,r){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:r},t[0],t[1],t[2],t[3])},pe.prototype.insertCollisionCircles=function(t,e,n,i,r){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:i,collisionGroupID:r},l=0;l<t.length;l+=4)o.insertCircle(a,t[l],t[l+1],t[l+2])},pe.prototype.projectAndGetPerspectiveRatio=function(e,n,i){var r=[n,i,0,1];return ce(r,r,e),{point:new t.Point((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5}},pe.prototype.isOffscreen=function(t,e,n,i){return n<100||t>=this.screenRightBoundary||i<100||e>this.screenBottomBoundary},pe.prototype.isInsideGrid=function(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary},pe.prototype.getViewportMatrix=function(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e};var de=function(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n};de.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var fe=function(t,e,n,i,r){this.text=new de(t?t.text:null,e,n,r),this.icon=new de(t?t.icon:null,e,i,r)};fe.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var me=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},ge=function(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]},ve=function(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r},ye=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};function _e(e,n,i,r,o){var a=t.getAnchorAlignment(e),l=-(a.horizontalAlign-.5)*n,s=-(a.verticalAlign-.5)*i,u=t.evaluateVariableOffset(e,r);return new t.Point(l+u[0]*o,s+u[1]*o)}function be(e,n,i,r,o,a){var l=e.x1,s=e.x2,u=e.y1,c=e.y2,p=e.anchorPointX,h=e.anchorPointY,d=new t.Point(n,i);return r&&d._rotate(o?a:-a),{x1:l+d.x,y1:u+d.y,x2:s+d.x,y2:c+d.y,anchorPointX:p,anchorPointY:h}}ye.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var xe=function(t,e,n,i){this.transform=t.clone(),this.collisionIndex=new pe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new ye(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}};function we(t,e,n,i,r){t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0)}xe.prototype.getBucketParts=function(e,n,i,r){var o=i.getBucket(n),a=i.latestFeatureIndex;if(o&&a&&n.id===o.layerIds[0]){var l=i.collisionBoxArray,s=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),c=i.tileSize/t.EXTENT,p=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),h="map"===s.get("text-pitch-alignment"),d="map"===s.get("text-rotation-alignment"),f=he(i,1,this.transform.zoom),m=Jt(p,h,d,this.transform,f),g=null;if(h){var v=$t(p,h,d,this.transform,f);g=t.multiply([],this.transform.labelPlaneMatrix,v)}this.retainedQueryData[o.bucketInstanceId]=new ve(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,i.tileID);var y={bucket:o,layout:s,posMatrix:p,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:u,textPixelRatio:c,holdingForFade:i.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(r)for(var _=0,b=o.sortKeyRanges;_<b.length;_+=1){var x=b[_];e.push({sortKey:x.sortKey,symbolInstanceStart:x.symbolInstanceStart,symbolInstanceEnd:x.symbolInstanceEnd,parameters:y})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:y})}},xe.prototype.attemptAnchorPlacement=function(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f){var m,g=[p.textOffset0,p.textOffset1],v=_e(t,n,i,g,r),y=this.collisionIndex.placeCollisionBox(be(e,v.x,v.y,o,a,this.transform.angle),c,l,s,u.predicate);if(!f||0!==this.collisionIndex.placeCollisionBox(be(f,v.x,v.y,o,a,this.transform.angle),c,l,s,u.predicate).box.length)return y.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(m=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={textOffset:g,width:n,height:i,anchor:t,textBoxScale:r,prevAnchor:m},this.markUsedJustification(h,t,p,d),h.allowVerticalPlacement&&(this.markUsedOrientation(h,d,p),this.placedOrientations[p.crossTileID]=d),{shift:v,placedGlyphBoxes:y}):void 0},xe.prototype.placeLayerBucketPart=function(e,n,i){var r=this,o=e.parameters,a=o.bucket,l=o.layout,s=o.posMatrix,u=o.textLabelPlaneMatrix,c=o.labelToScreenMatrix,p=o.textPixelRatio,h=o.holdingForFade,d=o.collisionBoxArray,f=o.partiallyEvaluatedTextSize,m=o.collisionGroup,g=l.get("text-optional"),v=l.get("icon-optional"),y=l.get("text-allow-overlap"),_=l.get("icon-allow-overlap"),b="map"===l.get("text-rotation-alignment"),x="map"===l.get("text-pitch-alignment"),w="none"!==l.get("icon-text-fit"),C="viewport-y"===l.get("symbol-z-order"),E=y&&(_||!a.hasIconData()||v),S=_&&(y||!a.hasTextData()||g);!a.collisionArrays&&d&&a.deserializeCollisionBoxes(d);var T=function(e,o){if(!n[e.crossTileID])if(h)r.placements[e.crossTileID]=new me(!1,!1,!1);else{var d,C=!1,T=!1,I=!0,P=null,A={box:null,offscreen:null},M={box:null,offscreen:null},k=null,D=null,L=0,O=0,R=0;o.textFeatureIndex?L=o.textFeatureIndex:e.useRuntimeCollisionCircles&&(L=e.featureIndex),o.verticalTextFeatureIndex&&(O=o.verticalTextFeatureIndex);var z=o.textBox;if(z){var F=function(n){var i=t.WritingMode.horizontal;if(a.allowVerticalPlacement&&!n&&r.prevPlacement){var o=r.prevPlacement.placedOrientations[e.crossTileID];o&&(r.placedOrientations[e.crossTileID]=o,r.markUsedOrientation(a,i=o,e))}return i},B=function(n,i){if(a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&o.verticalTextBox)for(var r=0,l=a.writingModes;r<l.length&&(l[r]===t.WritingMode.vertical?(A=i(),M=A):A=n(),!(A&&A.box&&A.box.length));r+=1);else A=n()};if(l.get("text-variable-anchor")){var N=l.get("text-variable-anchor");if(r.prevPlacement&&r.prevPlacement.variableOffsets[e.crossTileID]){var U=r.prevPlacement.variableOffsets[e.crossTileID];N.indexOf(U.anchor)>0&&(N=N.filter((function(t){return t!==U.anchor}))).unshift(U.anchor)}var j=function(t,n,i){for(var o=t.x2-t.x1,l=t.y2-t.y1,u=e.textBoxScale,c=w&&!_?n:null,h={box:[],offscreen:!1},d=y?2*N.length:N.length,f=0;f<d;++f){var g=r.attemptAnchorPlacement(N[f%N.length],t,o,l,u,b,x,p,s,m,f>=N.length,e,a,i,c);if(g&&(h=g.placedGlyphBoxes)&&h.box&&h.box.length){C=!0,P=g.shift;break}}return h};B((function(){return j(z,o.iconBox,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&!(A&&A.box&&A.box.length)&&e.numVerticalGlyphVertices>0&&n?j(n,o.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),A&&(C=A.box,I=A.offscreen);var V=F(A&&A.box);if(!C&&r.prevPlacement){var q=r.prevPlacement.variableOffsets[e.crossTileID];q&&(r.variableOffsets[e.crossTileID]=q,r.markUsedJustification(a,q.anchor,e,V))}}else{var G=function(t,n){var i=r.collisionIndex.placeCollisionBox(t,y,p,s,m.predicate);return i&&i.box&&i.box.length&&(r.markUsedOrientation(a,n,e),r.placedOrientations[e.crossTileID]=n),i};B((function(){return G(z,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?G(n,t.WritingMode.vertical):{box:null,offscreen:null}})),F(A&&A.box&&A.box.length)}}if(C=(d=A)&&d.box&&d.box.length>0,I=d&&d.offscreen,e.useRuntimeCollisionCircles){var Z=a.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),H=t.evaluateSizeForFeature(a.textSizeData,f,Z),Y=l.get("text-padding");k=r.collisionIndex.placeCollisionCircles(y,Z,a.lineVertexArray,a.glyphOffsetArray,H,s,u,c,i,x,m.predicate,e.collisionCircleDiameter,Y),C=y||k.circles.length>0&&!k.collisionDetected,I=I&&k.offscreen}if(o.iconFeatureIndex&&(R=o.iconFeatureIndex),o.iconBox){var X=function(t){var e=w&&P?be(t,P.x,P.y,b,x,r.transform.angle):t;return r.collisionIndex.placeCollisionBox(e,_,p,s,m.predicate)};T=M&&M.box&&M.box.length&&o.verticalIconBox?(D=X(o.verticalIconBox)).box.length>0:(D=X(o.iconBox)).box.length>0,I=I&&D.offscreen}var W=g||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,K=v||0===e.numIconVertices;if(W||K?K?W||(T=T&&C):C=T&&C:T=C=T&&C,C&&d&&d.box&&r.collisionIndex.insertCollisionBox(d.box,l.get("text-ignore-placement"),a.bucketInstanceId,M&&M.box&&O?O:L,m.ID),T&&D&&r.collisionIndex.insertCollisionBox(D.box,l.get("icon-ignore-placement"),a.bucketInstanceId,R,m.ID),k&&(C&&r.collisionIndex.insertCollisionCircles(k.circles,l.get("text-ignore-placement"),a.bucketInstanceId,L,m.ID),i)){var J=a.bucketInstanceId,$=r.collisionCircleArrays[J];void 0===$&&($=r.collisionCircleArrays[J]=new ge);for(var Q=0;Q<k.circles.length;Q+=4)$.circles.push(k.circles[Q+0]),$.circles.push(k.circles[Q+1]),$.circles.push(k.circles[Q+2]),$.circles.push(k.collisionDetected?1:0)}r.placements[e.crossTileID]=new me(C||E,T||S,I||a.justReloaded),n[e.crossTileID]=!0}};if(C)for(var I=a.getSortedSymbolIndexes(this.transform.angle),P=I.length-1;P>=0;--P){var A=I[P];T(a.symbolInstances.get(A),a.collisionArrays[A])}else for(var M=e.symbolInstanceStart;M<e.symbolInstanceEnd;M++)T(a.symbolInstances.get(M),a.collisionArrays[M]);if(i&&a.bucketInstanceId in this.collisionCircleArrays){var k=this.collisionCircleArrays[a.bucketInstanceId];t.invert(k.invProjMatrix,s),k.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1},xe.prototype.markUsedJustification=function(e,n,i,r){var o;o=r===t.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];for(var a=0,l=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];a<l.length;a+=1){var s=l[a];s>=0&&(e.text.placedSymbolArray.get(s).crossTileID=o>=0&&s!==o?0:i.crossTileID)}},xe.prototype.markUsedOrientation=function(e,n,i){for(var r=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,a=0,l=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];a<l.length;a+=1)e.text.placedSymbolArray.get(l[a]).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=o)},xe.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var i=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var l in this.placements){var s=this.placements[l],u=r[l];u?(this.opacities[l]=new fe(u,i,s.text,s.icon),n=n||s.text!==u.text.placed||s.icon!==u.icon.placed):(this.opacities[l]=new fe(null,i,s.text,s.icon,s.skipFade),n=n||s.text||s.icon)}for(var c in r){var p=r[c];if(!this.opacities[c]){var h=new fe(p,i,!1,!1);h.isHidden()||(this.opacities[c]=h,n=n||p.text.placed||p.icon.placed)}}for(var d in o)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=o[d]);for(var f in a)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=a[f]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},xe.prototype.updateLayerOpacities=function(t,e){for(var n={},i=0,r=e;i<r.length;i+=1){var o=r[i],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},xe.prototype.updateBucketOpacities=function(e,n,i){var r=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var o=e.layers[0].layout,a=new fe(null,0,!1,!1,!0),l=o.get("text-allow-overlap"),s=o.get("icon-allow-overlap"),u=o.get("text-variable-anchor"),c="map"===o.get("text-rotation-alignment"),p="map"===o.get("text-pitch-alignment"),h="none"!==o.get("icon-text-fit"),d=new fe(null,0,l&&(s||!e.hasIconData()||o.get("icon-optional")),s&&(l||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);for(var f=function(t,e,n){for(var i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(n)},m=function(i){var o=e.symbolInstances.get(i),l=o.numHorizontalGlyphVertices,s=o.numVerticalGlyphVertices,m=o.crossTileID,g=r.opacities[m];n[m]?g=a:g||(r.opacities[m]=g=d),n[m]=!0;var v=o.numIconVertices>0,y=r.placedOrientations[o.crossTileID],_=y===t.WritingMode.vertical,b=y===t.WritingMode.horizontal||y===t.WritingMode.horizontalOnly;if(l>0||s>0){var x=Me(g.text);f(e.text,l,_?ke:x),f(e.text,s,b?ke:x);var w=g.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t){t>=0&&(e.text.placedSymbolArray.get(t).hidden=w||_?1:0)})),o.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=w||b?1:0);var C=r.variableOffsets[o.crossTileID];C&&r.markUsedJustification(e,C.anchor,o,y);var E=r.placedOrientations[o.crossTileID];E&&(r.markUsedJustification(e,"left",o,E),r.markUsedOrientation(e,E,o))}if(v){var S=Me(g.icon),T=!(h&&o.verticalPlacedIconSymbolIndex&&_);o.placedIconSymbolIndex>=0&&(f(e.icon,o.numIconVertices,T?S:ke),e.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=g.icon.isHidden()),o.verticalPlacedIconSymbolIndex>=0&&(f(e.icon,o.numVerticalIconVertices,T?ke:S),e.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){var I=e.collisionArrays[i];if(I){var P=new t.Point(0,0);if(I.textBox||I.verticalTextBox){var A=!0;if(u){var M=r.variableOffsets[m];M?(P=_e(M.anchor,M.width,M.height,M.textOffset,M.textBoxScale),c&&P._rotate(p?r.transform.angle:-r.transform.angle)):A=!1}I.textBox&&we(e.textCollisionBox.collisionVertexArray,g.text.placed,!A||_,P.x,P.y),I.verticalTextBox&&we(e.textCollisionBox.collisionVertexArray,g.text.placed,!A||b,P.x,P.y)}var k=Boolean(!b&&I.verticalIconBox);I.iconBox&&we(e.iconCollisionBox.collisionVertexArray,g.icon.placed,k,h?P.x:0,h?P.y:0),I.verticalIconBox&&we(e.iconCollisionBox.collisionVertexArray,g.icon.placed,!k,h?P.x:0,h?P.y:0)}}},g=0;g<e.symbolInstances.length;g++)m(g);if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){var v=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=v.invProjMatrix,e.placementViewportMatrix=v.viewportMatrix,e.collisionCircleArray=v.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}},xe.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},xe.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},xe.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},xe.prototype.stillRecent=function(t,e){var n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t},xe.prototype.setStale=function(){this.stale=!0};var Ce=Math.pow(2,25),Ee=Math.pow(2,24),Se=Math.pow(2,17),Te=Math.pow(2,16),Ie=Math.pow(2,9),Pe=Math.pow(2,8),Ae=Math.pow(2,1);function Me(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Ce+e*Ee+n*Se+e*Te+n*Ie+e*Pe+n*Ae+e}var ke=0,De=function(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};De.prototype.continuePlacement=function(t,e,n,i,r){for(var o=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(o,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((function(t,e){return t.sortKey-e.sortKey})));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,r())return!0;return!1};var Le=function(t,e,n,i,r,o,a){this.placement=new xe(t,r,o,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1};Le.prototype.isDone=function(){return this._done},Le.prototype.continuePlacement=function(e,n,i){for(var r=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!r._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var l=n[e[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===l.type&&(!l.minzoom||l.minzoom<=s)&&(!l.maxzoom||l.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new De(l)),this._inProgressLayer.continuePlacement(i[l.source],this.placement,this._showCollisionBoxes,l,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Le.prototype.commit=function(t){return this.placement.commit(t),this.placement};var Oe=512/t.EXTENT/2,Re=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var i=0;i<e.length;i++){var r=e.get(i),o=r.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:r.crossTileID,coord:this.getScaledCoordinates(r,t)})}};Re.prototype.getScaledCoordinates=function(e,n){var i=Oe/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*i)}},Re.prototype.findMatches=function(t,e,n){for(var i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),r=0;r<t.length;r++){var o=t.get(r);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var l=this.getScaledCoordinates(o,e),s=0,u=a;s<u.length;s+=1){var c=u[s];if(Math.abs(c.coord.x-l.x)<=i&&Math.abs(c.coord.y-l.y)<=i&&!n[c.crossTileID]){n[c.crossTileID]=!0,o.crossTileID=c.crossTileID;break}}}}};var ze=function(){this.maxCrossTileID=0};ze.prototype.generate=function(){return++this.maxCrossTileID};var Fe=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Fe.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var i=this.indexes[n],r={};for(var o in i){var a=i[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),r[a.tileID.key]=a}this.indexes[n]=r}this.lng=t},Fe.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var i=0;i<e.symbolInstances.length;i++)e.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var r=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var l in a){var s=a[l];s.tileID.isChildOf(t)&&s.findMatches(e.symbolInstances,t,r)}else{var u=a[t.scaledTo(Number(o)).key];u&&u.findMatches(e.symbolInstances,t,r)}}for(var c=0;c<e.symbolInstances.length;c++){var p=e.symbolInstances.get(c);p.crossTileID||(p.crossTileID=n.generate(),r[p.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Re(t,e.symbolInstances,e.bucketInstanceId),!0},Fe.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var i=0,r=e.indexedSymbolInstances[n];i<r.length;i+=1)delete this.usedCrossTileIDs[t][r[i].crossTileID]},Fe.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var i=this.indexes[n];for(var r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e};var Be=function(){this.layerIndexes={},this.crossTileIDs=new ze,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Be.prototype.addLayer=function(t,e,n){var i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new Fe);var r=!1,o={};i.handleWrapJump(n);for(var a=0,l=e;a<l.length;a+=1){var s=l[a],u=s.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,u,this.crossTileIDs)&&(r=!0),o[u.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(r=!0),r},Be.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var Ne=function(e,n){return t.emitValidationErrors(e,n&&n.filter((function(t){return"source.canvas"!==t.identifier})))},Ue=t.pick(jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),je=t.pick(jt,["setCenter","setZoom","setBearing","setPitch"]),Ve=function(){var e={},n=t.styleSpec.$version;for(var i in t.styleSpec.$root){var r,o=t.styleSpec.$root[i];o.required&&null!=(r="version"===i?n:"array"===o.type?[]:{})&&(e[i]=r)}return e}(),qe=function(e){function n(i,r){var o=this;void 0===r&&(r={}),e.call(this),this.map=i,this.dispatcher=new E(Bt(),this),this.imageManager=new h,this.imageManager.setEventedParent(this),this.glyphManager=new _(i._requestManager,r.localIdeographFontFamily),this.lineAtlas=new C(256,512),this.crossTileSymbolIndex=new Be,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var a=this;this._rtlTextPluginCallback=n.registerForPluginStateChange((function(e){a.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(function(e,n){if(t.triggerPluginCompletionEvent(e),n&&n.every((function(t){return t})))for(var i in a.sourceCaches)a.sourceCaches[i].reload()}))})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var i in o._layers){var r=o._layers[i];r.source===n.id&&o._validateLayer(r)}}}}))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadURL=function(e,n){var i=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var r="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);var o=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,(function(e,n){i._request=null,e?i.fire(new t.ErrorEvent(e)):n&&i._load(n,r)}))},n.prototype.loadJSON=function(e,n){var i=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame((function(){i._request=null,i._load(e,!1!==n.validate)}))},n.prototype.loadEmpty=function(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ve,!1)},n.prototype._load=function(e,n){if(!n||!Ne(this,t.validateStyle(e))){for(var i in this._loaded=!0,this.stylesheet=e,e.sources)this.addSource(i,e.sources[i],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var r=Ut(this.stylesheet.layers);this._order=r.map((function(t){return t.id})),this._layers={},this._serializedLayers={};for(var o=0,a=r;o<a.length;o+=1){var l=a[o];(l=t.createStyleLayer(l)).setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=l,this._serializedLayers[l.id]=l.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._loadSprite=function(e){var n=this;this._spriteRequest=function(e,n,i){var r,o,a,l=t.browser.devicePixelRatio>1?"@2x":"",s=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,l,".json"),t.ResourceType.SpriteJSON),(function(t,e){s=null,a||(a=t,r=e,c())})),u=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,l,".png"),t.ResourceType.SpriteImage),(function(t,e){u=null,a||(a=t,o=e,c())}));function c(){if(a)i(a);else if(r&&o){var e=t.browser.getImageData(o),n={};for(var l in r){var s=r[l],u=s.width,c=s.height,p=s.x,h=s.y,d=s.sdf,f=s.pixelRatio,m=s.stretchX,g=s.stretchY,v=s.content,y=new t.RGBAImage({width:u,height:c});t.RGBAImage.copy(e,y,{x:p,y:h},{x:0,y:0},{width:u,height:c}),n[l]={data:y,pixelRatio:f,sdf:d,stretchX:m,stretchY:g,content:v}}i(null,n)}}return{cancel:function(){s&&(s.cancel(),s=null),u&&(u.cancel(),u=null)}}}(e,this.map._requestManager,(function(e,i){if(n._spriteRequest=null,e)n.fire(new t.ErrorEvent(e));else if(i)for(var r in i)n.imageManager.addImage(r,i[r]);n.imageManager.setLoaded(!0),n._availableImages=n.imageManager.listImages(),n.dispatcher.broadcast("setImages",n._availableImages),n.fire(new t.Event("data",{dataType:"style"}))}))},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var i=e.sourceLayer;if(i){var r=n.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+i+'" does not exist on source "'+r.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){for(var e=[],n=0,i=t;n<i.length;n+=1){var r=this._layers[i[n]];"custom"!==r.type&&e.push(r.serialize())}return e},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){var n=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);for(var o in(i.length||r.length)&&this._updateWorkerLayers(i,r),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var l in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[l].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}var s={};for(var u in this.sourceCaches){var c=this.sourceCaches[u];s[u]=c.used,c.used=!1}for(var p=0,h=this._order;p<h.length;p+=1){var d=this._layers[h[p]];d.recalculate(e,this._availableImages),!d.isHidden(e.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(var f in s){var m=this.sourceCaches[f];s[f]!==m.used&&m.fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}},n.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),Ne(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=Ut(e.layers);var i=function(e,n){if(!e)return[{command:jt.setStyle,args:[n]}];var i=[];try{if(!t.deepEqual(e.version,n.version))return[{command:jt.setStyle,args:[n]}];t.deepEqual(e.center,n.center)||i.push({command:jt.setCenter,args:[n.center]}),t.deepEqual(e.zoom,n.zoom)||i.push({command:jt.setZoom,args:[n.zoom]}),t.deepEqual(e.bearing,n.bearing)||i.push({command:jt.setBearing,args:[n.bearing]}),t.deepEqual(e.pitch,n.pitch)||i.push({command:jt.setPitch,args:[n.pitch]}),t.deepEqual(e.sprite,n.sprite)||i.push({command:jt.setSprite,args:[n.sprite]}),t.deepEqual(e.glyphs,n.glyphs)||i.push({command:jt.setGlyphs,args:[n.glyphs]}),t.deepEqual(e.transition,n.transition)||i.push({command:jt.setTransition,args:[n.transition]}),t.deepEqual(e.light,n.light)||i.push({command:jt.setLight,args:[n.light]});var r={},o=[];!function(e,n,i,r){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||qt(o,i,r));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.deepEqual(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&Zt(e,n,o)?i.push({command:jt.setGeoJSONSourceData,args:[o,n[o].data]}):Gt(o,n,i,r)):Vt(o,n,i))}(e.sources,n.sources,o,r);var a=[];e.layers&&e.layers.forEach((function(t){r[t.source]?i.push({command:jt.removeLayer,args:[t.id]}):a.push(t)})),i=i.concat(o),function(e,n,i){n=n||[];var r,o,a,l,s,u,c,p=(e=e||[]).map(Yt),h=n.map(Yt),d=e.reduce(Xt,{}),f=n.reduce(Xt,{}),m=p.slice(),g=Object.create(null);for(r=0,o=0;r<p.length;r++)f.hasOwnProperty(a=p[r])?o++:(i.push({command:jt.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(r=0,o=0;r<h.length;r++)m[m.length-1-r]!==(a=h[h.length-1-r])&&(d.hasOwnProperty(a)?(i.push({command:jt.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,i.push({command:jt.addLayer,args:[f[a],u=m[m.length-r]]}),m.splice(m.length-r,0,a),g[a]=!0);for(r=0;r<h.length;r++)if(l=d[a=h[r]],s=f[a],!g[a]&&!t.deepEqual(l,s))if(t.deepEqual(l.source,s.source)&&t.deepEqual(l["source-layer"],s["source-layer"])&&t.deepEqual(l.type,s.type)){for(c in Ht(l.layout,s.layout,i,a,null,jt.setLayoutProperty),Ht(l.paint,s.paint,i,a,null,jt.setPaintProperty),t.deepEqual(l.filter,s.filter)||i.push({command:jt.setFilter,args:[a,s.filter]}),t.deepEqual(l.minzoom,s.minzoom)&&t.deepEqual(l.maxzoom,s.maxzoom)||i.push({command:jt.setLayerZoomRange,args:[a,s.minzoom,s.maxzoom]}),l)l.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ht(l[c],s[c],i,a,c.slice(6),jt.setPaintProperty):t.deepEqual(l[c],s[c])||i.push({command:jt.setLayerProperty,args:[a,c,s[c]]}));for(c in s)s.hasOwnProperty(c)&&!l.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ht(l[c],s[c],i,a,c.slice(6),jt.setPaintProperty):t.deepEqual(l[c],s[c])||i.push({command:jt.setLayerProperty,args:[a,c,s[c]]}))}else i.push({command:jt.removeLayer,args:[a]}),u=m[m.lastIndexOf(a)+1],i.push({command:jt.addLayer,args:[s,u]})}(a,n.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:jt.setStyle,args:[n]}]}return i}(this.serialize(),e).filter((function(t){return!(t.command in je)}));if(0===i.length)return!1;var r=i.filter((function(t){return!(t.command in Ue)}));if(r.length>0)throw new Error("Unimplemented: "+r.map((function(t){return t.command})).join(", ")+".");return i.forEach((function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)})),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._afterImageUpdated(e)},n.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._afterImageUpdated(e)},n.prototype._afterImageUpdated=function(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(e,n,i){var r=this;if(void 0===i&&(i={}),this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,i))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Mt(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:r.loaded(),source:o.serialize(),sourceId:e}})),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.clearTiles(),i.onRemove&&i.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,i){void 0===i&&(i={}),this._checkLoaded();var r=e.id;if(this.getLayer(r))this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" already exists on this map')));else{var o;if("custom"===e.type){if(Ne(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone$1(e),e=t.extend(e,{source:r})),this._validate(t.validateStyle.layer,"layers."+r,e,{arrayIndex:-1},i))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[o.id]=o.serialize()}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,r),this._layerOrderChanged=!0,this._layers[r]=o,this._removedLayers[r]&&o.source&&"custom"!==o.type){var l=this._removedLayers[r];delete this._removedLayers[r],l.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var i=this._order.indexOf(e);this._order.splice(i,1);var r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(r,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.hasLayer=function(t){return t in this._layers},n.prototype.setLayerZoomRange=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n,i){void 0===i&&(i={}),this._checkLoaded();var r=this.getLayer(e);if(r){if(!t.deepEqual(r.filter,n))return null==n?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(t.validateStyle.filter,"layers."+r.id+".filter",n,null,i)||(r.filter=t.clone$1(n),this._updateLayer(r)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone$1(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,i,r){void 0===r&&(r={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getLayoutProperty(n),i)||(o.setLayoutProperty(n,i,r),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(e,n){var i=this.getLayer(e);if(i)return i.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style.")))},n.prototype.setPaintProperty=function(e,n,i,r){void 0===r&&(r={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getPaintProperty(n),i)||(o.setPaintProperty(n,i,r)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.setFeatureState=function(e,n){this._checkLoaded();var i=e.source,r=e.sourceLayer,o=this.sourceCaches[i];if(void 0!==o){var a=o.getSource().type;"geojson"===a&&r?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||r?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(r,e.id,n)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},n.prototype.removeFeatureState=function(e,n){this._checkLoaded();var i=e.source,r=this.sourceCaches[i];if(void 0!==r){var o=r.getSource().type,a="vector"===o?e.sourceLayer:void 0;"vector"!==o||a?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):r.removeFeatureState(a,e.id,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,i=e.sourceLayer,r=this.sourceCaches[n];if(void 0!==r){if("vector"!==r.getSource().type||i)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),r.getFeatureState(i,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,n=function(t){return"fill-extrusion"===e._layers[t].type},i={},r=[],o=this._order.length-1;o>=0;o--){var a=this._order[o];if(n(a)){i[a]=o;for(var l=0,s=t;l<s.length;l+=1){var u=s[l][a];if(u)for(var c=0,p=u;c<p.length;c+=1)r.push(p[c])}}}r.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var h=[],d=this._order.length-1;d>=0;d--){var f=this._order[d];if(n(f))for(var m=r.length-1;m>=0;m--){var g=r[m].feature;if(i[g.layer.id]<d)break;h.push(g),r.pop()}else for(var v=0,y=t;v<y.length;v+=1){var _=y[v][f];if(_)for(var b=0,x=_;b<x.length;b+=1)h.push(x[b].feature)}}return h},n.prototype.queryRenderedFeatures=function(e,n,i){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);var r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var l=a[o],s=this._layers[l];if(!s)return this.fire(new t.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be queried for features."))),[];r[s.source]=!0}}var u=[];for(var c in n.availableImages=this._availableImages,this.sourceCaches)n.layers&&!r[c]||u.push(F(this.sourceCaches[c],this._layers,this._serializedLayers,e,n,i));return this.placement&&u.push(function(t,e,n,i,r,o,a){for(var l={},s=o.queryRenderedSymbols(i),u=[],c=0,p=Object.keys(s).map(Number);c<p.length;c+=1)u.push(a[p[c]]);u.sort(B);for(var h=function(){var n=f[d],i=n.featureIndex.lookupSymbolFeatures(s[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(var o in i){var a=l[o]=l[o]||[],u=i[o];u.sort((function(t,e){var i=n.featureSortOrder;if(i){var r=i.indexOf(t.featureIndex);return i.indexOf(e.featureIndex)-r}return e.featureIndex-t.featureIndex}));for(var c=0,p=u;c<p.length;c+=1)a.push(p[c])}},d=0,f=u;d<f.length;d+=1)h();var m=function(e){l[e].forEach((function(i){var r=i.feature,o=n[t[e].source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=o}))};for(var g in l)m(g);return l}(this._layers,this._serializedLayers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);var i=this.sourceCaches[e];return i?function(t,e){for(var n=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),i=[],r={},o=0;o<n.length;o++){var a=n[o],l=a.tileID.canonical.key;r[l]||(r[l]=!0,a.querySourceFeatures(i,e))}return i}(i,n):[]},n.prototype.addSourceType=function(t,e,i){return n.getSourceType(t)?i(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e,n){void 0===n&&(n={}),this._checkLoaded();var i=this.light.getLight(),r=!1;for(var o in e)if(!t.deepEqual(e[o],i[o])){r=!0;break}if(r){var a={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(a)}},n.prototype._validate=function(e,n,i,r,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&Ne(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:i,styleSpec:t.styleSpec},r)))},n.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var n in this.sourceCaches)this.sourceCaches[n].clearTiles(),this.sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(e,n,i,r,o){void 0===o&&(o=!1);for(var a=!1,l=!1,s={},u=0,c=this._order;u<c.length;u+=1){var p=this._layers[c[u]];if("symbol"===p.type){if(!s[p.source]){var h=this.sourceCaches[p.source];s[p.source]=h.getRenderableIds(!0).map((function(t){return h.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var d=this.crossTileSymbolIndex.addLayer(p,s[p.source],e.center.lng);a=a||d}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((o=o||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now(),e.zoom))&&(this.pauseablePlacement=new Le(e,this._order,o,n,i,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.browser.now()),l=!0),a&&this.pauseablePlacement.placement.setStale()),l||a)for(var f=0,m=this._order;f<m.length;f+=1){var g=this._layers[m[f]];"symbol"===g.type&&this.placement.updateLayerOpacities(g,s[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();var i=this.sourceCaches[e.source];i&&i.setDependencies(e.tileID.key,e.type,e.icons)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n.prototype.getResource=function(e,n,i){return t.makeRequest(n,i)},n}(t.Evented);qe.getSourceType=function(t){return R[t]},qe.setSourceType=function(t,e){R[t]=e},qe.registerForPluginStateChange=t.registerForPluginStateChange;var Ge=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ze=yn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),He=yn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ye=yn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Xe=yn("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),We=yn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ke=yn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Je=yn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),$e=yn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Qe=yn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),tn=yn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),en=yn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),nn=yn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),rn=yn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),on=yn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),an=yn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),ln=yn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),sn=yn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),un=yn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),cn=yn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),pn=yn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),hn=yn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),dn=yn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),fn=yn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),mn=yn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),gn=yn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),vn=yn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function yn(t,e){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=e.match(/attribute ([\w]+) ([\w]+)/g),r=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(r):r,l={};return{fragmentSource:t=t.replace(n,(function(t,e,n,i,r){return l[r]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+r+"\nvarying "+n+" "+i+" "+r+";\n#else\nuniform "+n+" "+i+" u_"+r+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+r+"\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n"})),vertexSource:e=e.replace(n,(function(t,e,n,i,r){var o="float"===i?"vec2":"vec4",a=r.match(/color/)?"color":o;return l[r]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+n+" "+o+" a_"+r+";\nvarying "+n+" "+i+" "+r+";\n#else\nuniform "+n+" "+i+" u_"+r+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = a_"+r+";\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = unpack_mix_"+a+"(a_"+r+", u_"+r+"_t);\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+n+" "+o+" a_"+r+";\n#else\nuniform "+n+" "+i+" u_"+r+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+n+" "+i+" "+r+" = a_"+r+";\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+n+" "+i+" "+r+" = unpack_mix_"+a+"(a_"+r+", u_"+r+"_t);\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n"})),staticAttributes:i,staticUniforms:a}}var _n=Object.freeze({__proto__:null,prelude:Ze,background:He,backgroundPattern:Ye,circle:Xe,clippingMask:We,heatmap:Ke,heatmapTexture:Je,collisionBox:$e,collisionCircle:Qe,debug:tn,fill:en,fillOutline:nn,fillOutlinePattern:rn,fillPattern:on,fillExtrusion:an,fillExtrusionPattern:ln,hillshadePrepare:sn,hillshade:un,line:cn,lineGradient:pn,linePattern:hn,lineSDF:dn,raster:fn,symbolIcon:mn,symbolSDF:gn,symbolTextAndIcon:vn}),bn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function xn(t){for(var e=[],n=0;n<t.length;n++)if(null!==t[n]){var i=t[n].split(" ");e.push(i.pop())}return e}bn.prototype.bind=function(t,e,n,i,r,o,a,l){this.context=t;for(var s=this.boundPaintVertexBuffers.length!==i.length,u=0;!s&&u<i.length;u++)this.boundPaintVertexBuffers[u]!==i[u]&&(s=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!s&&this.boundIndexBuffer===r&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===l?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),r&&r.dynamicDraw&&r.bind(),l&&l.bind()):this.freshBind(e,n,i,r,o,a,l)},bn.prototype.freshBind=function(t,e,n,i,r,o,a){var l,s=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),l=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{l=u.currentNumAttributes||0;for(var p=s;p<l;p++)c.disableVertexAttribArray(p)}e.enableAttributes(c,t);for(var h=0,d=n;h<d.length;h+=1)d[h].enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,r);for(var f=0,m=n;f<m.length;f+=1){var g=m[f];g.bind(),g.setVertexAttribPointers(c,t,r)}o&&(o.bind(),o.setVertexAttribPointers(c,t,r)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,r)),u.currentNumAttributes=s},bn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var wn=function(t,e,n,i,r,o){var a=t.gl;this.program=a.createProgram();for(var l=xn(n.staticAttributes),s=i?i.getBinderAttributes():[],u=l.concat(s),c=n.staticUniforms?xn(n.staticUniforms):[],p=i?i.getBinderUniforms():[],h=[],d=0,f=c.concat(p);d<f.length;d+=1){var m=f[d];h.indexOf(m)<0&&h.push(m)}var g=i?i.defines():[];o&&g.push("#define OVERDRAW_INSPECTOR;");var v=g.concat(Ze.fragmentSource,n.fragmentSource).join("\n"),y=g.concat(Ze.vertexSource,n.vertexSource).join("\n"),_=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(_,v),a.compileShader(_),a.attachShader(this.program,_);var b=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(b,y),a.compileShader(b),a.attachShader(this.program,b),this.attributes={};var x={};this.numAttributes=u.length;for(var w=0;w<this.numAttributes;w++)u[w]&&(a.bindAttribLocation(this.program,w,u[w]),this.attributes[u[w]]=w);a.linkProgram(this.program),a.deleteShader(b),a.deleteShader(_);for(var C=0;C<h.length;C++){var E=h[C];if(E&&!x[E]){var S=a.getUniformLocation(this.program,E);S&&(x[E]=S)}}this.fixedUniforms=r(t,x),this.binderUniforms=i?i.getUniforms(t,x):[]}}};function Cn(t,e,n){var i=1/he(n,1,e.transform.tileZoom),r=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,e.transform.tileZoom)/r,a=o*(n.tileID.canonical.x+n.tileID.wrap*r),l=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,l>>16],u_pixel_coord_lower:[65535&a,65535&l]}}wn.prototype.draw=function(t,e,n,i,r,o,a,l,s,u,c,p,h,d,f,m){var g,v=t.gl;if(!this.failedToCreate){for(var y in t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(i),t.setColorMode(r),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[y].set(a[y]);d&&d.setUniforms(t,this.binderUniforms,p,{zoom:h});for(var _=(g={},g[v.LINES]=2,g[v.TRIANGLES]=3,g[v.LINE_STRIP]=1,g)[e],b=0,x=c.get();b<x.length;b+=1){var w=x[b],C=w.vaos||(w.vaos={});(C[l]||(C[l]=new bn)).bind(t,this,s,d?d.getPaintVertexBuffers():[],u,w.vertexOffset,f,m),v.drawElements(e,w.primitiveLength*_,v.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var En=function(e,n,i,r){var o=n.style.light,a=o.properties.get("position"),l=[a.x,a.y,a.z],s=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(s,-n.transform.angle),t.transformMat3(l,l,s);var u=o.properties.get("color");return{u_matrix:e,u_lightpos:l,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+i,u_opacity:r}},Sn=function(e,n,i,r,o,a,l){return t.extend(En(e,n,i,r),Cn(a,n,l),{u_height_factor:-Math.pow(2,o.overscaledZ)/l.tileSize/8})},Tn=function(t){return{u_matrix:t}},In=function(e,n,i,r){return t.extend(Tn(e),Cn(i,n,r))},Pn=function(t,e){return{u_matrix:t,u_world:e}},An=function(e,n,i,r,o){return t.extend(In(e,n,i,r),{u_world:o})},Mn=function(e,n,i,r){var o,a,l=e.transform;if("map"===r.paint.get("circle-pitch-alignment")){var s=he(i,1,l.zoom);o=!0,a=[s,s]}else o=!1,a=l.pixelsToGLUnits;return{u_camera_to_center_distance:l.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(n.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:t.browser.devicePixelRatio,u_extrude_scale:a}},kn=function(t,e,n){var i=he(n,1,e.zoom),r=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:i,u_extrude_scale:[e.pixelsToGLUnits[0]/(i*r),e.pixelsToGLUnits[1]/(i*r)],u_overscale_factor:o}},Dn=function(t,e,n){return{u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}},Ln=function(t,e,n){return void 0===n&&(n=1),{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}},On=function(t){return{u_matrix:t}},Rn=function(t,e,n,i){return{u_matrix:t,u_extrude_scale:he(e,1,n),u_intensity:i}},zn=function(e,n,i){var r=e.transform;return{u_matrix:jn(e,n,i),u_ratio:1/he(n,1,r.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},Fn=function(e,n,i,r){return t.extend(zn(e,n,i),{u_image:0,u_image_height:r})},Bn=function(e,n,i,r){var o=e.transform,a=Un(n,o);return{u_matrix:jn(e,n,i),u_texsize:n.imageAtlasTexture.size,u_ratio:1/he(n,1,o.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_image:0,u_scale:[a,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Nn=function(e,n,i,r,o){var a=e.lineAtlas,l=Un(n,e.transform),s="round"===i.layout.get("line-cap"),u=a.getDash(r.from,s),c=a.getDash(r.to,s),p=u.width*o.fromScale,h=c.width*o.toScale;return t.extend(zn(e,n,i),{u_patternscale_a:[l/p,-u.height/2],u_patternscale_b:[l/h,-c.height/2],u_sdfgamma:a.width/(256*Math.min(p,h)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:c.y,u_mix:o.t})};function Un(t,e){return 1/he(t,1,e.tileZoom)}function jn(t,e,n){return t.translatePosMatrix(e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Vn=function(t,e,n,i,r){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:qn(r.paint.get("raster-hue-rotate"))};var o,a};function qn(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}var Gn,Zn=function(t,e,n,i,r,o,a,l,s,u){var c=r.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:c.width/c.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+s,u_pitch_with_map:+i,u_texsize:u,u_texture:0}},Hn=function(e,n,i,r,o,a,l,s,u,c,p){var h=o.transform;return t.extend(Zn(e,n,i,r,o,a,l,s,u,c),{u_gamma_scale:r?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:t.browser.devicePixelRatio,u_is_halo:+p})},Yn=function(e,n,i,r,o,a,l,s,u,c){return t.extend(Hn(e,n,i,r,o,a,l,s,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1})},Xn=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},Wn=function(e,n,i,r,o,a){return t.extend(function(t,e,n,i){var r=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),a=n.imageManager.getPixelSize(),l=a.width,s=a.height,u=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,n.transform.tileZoom)/u,p=c*(i.tileID.canonical.x+i.tileID.wrap*u),h=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[l,s],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/he(i,1,n.transform.tileZoom),u_pixel_coord_upper:[p>>16,h>>16],u_pixel_coord_lower:[65535&p,65535&h]}}(r,a,i,o),{u_matrix:e,u_opacity:n})},Kn={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},collisionCircle:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}},debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image),u_image_height:new t.Uniform1f(e,n.u_image_height)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},symbolTextAndIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}}};function Jn(e,n,i,r,o,a,l){for(var s=e.context,u=s.gl,c=e.useProgram("collisionBox"),p=[],h=0,d=0,f=0;f<r.length;f++){var m=r[f],g=n.getTile(m),v=g.getBucket(i);if(v){var y=m.posMatrix;0===o[0]&&0===o[1]||(y=e.translatePosMatrix(m.posMatrix,g,o,a));var _=l?v.textCollisionBox:v.iconCollisionBox,b=v.collisionCircleArray;if(b.length>0){var x=t.create(),w=y;t.mul(x,v.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(x,x,v.placementViewportMatrix),p.push({circleArray:b,circleOffset:d,transform:w,invTransform:x}),d=h+=b.length/4}_&&c.draw(s,u.LINES,St.disabled,Tt.disabled,e.colorModeForRenderPass(),Pt.disabled,kn(y,e.transform,g),i.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}if(l&&p.length){var C=e.useProgram("collisionCircle"),E=new t.StructArrayLayout2f1f2i16;E.resize(4*h),E._trim();for(var S=0,T=0,I=p;T<I.length;T+=1)for(var P=I[T],A=0;A<P.circleArray.length/4;A++){var M=4*A,k=P.circleArray[M+0],D=P.circleArray[M+1],L=P.circleArray[M+2],O=P.circleArray[M+3];E.emplace(S++,k,D,L,O,0),E.emplace(S++,k,D,L,O,1),E.emplace(S++,k,D,L,O,2),E.emplace(S++,k,D,L,O,3)}(!Gn||Gn.length<2*h)&&(Gn=function(e){var n=2*e,i=new t.StructArrayLayout3ui6;i.resize(n),i._trim();for(var r=0;r<n;r++){var o=6*r;i.uint16[o+0]=4*r+0,i.uint16[o+1]=4*r+1,i.uint16[o+2]=4*r+2,i.uint16[o+3]=4*r+2,i.uint16[o+4]=4*r+3,i.uint16[o+5]=4*r+0}return i}(h));for(var R=s.createIndexBuffer(Gn,!0),z=s.createVertexBuffer(E,t.collisionCircleLayout.members,!0),F=0,B=p;F<B.length;F+=1){var N=B[F],U=Dn(N.transform,N.invTransform,e.transform);C.draw(s,u.TRIANGLES,St.disabled,Tt.disabled,e.colorModeForRenderPass(),Pt.disabled,U,i.id,z,R,t.SegmentVector.simpleSegment(0,2*N.circleOffset,N.circleArray.length,N.circleArray.length/2),null,e.transform.zoom,null,null,null)}z.destroy(),R.destroy()}}var $n=t.identity(new Float32Array(16));function Qn(e,n,i,r,o,a){var l=t.getAnchorAlignment(e),s=-(l.horizontalAlign-.5)*n,u=-(l.verticalAlign-.5)*i,c=t.evaluateVariableOffset(e,r);return new t.Point((s/o+c[0])*a,(u/o+c[1])*a)}function ti(e,n,i,r,o,a,l,s,u,c,p){var h=e.text.placedSymbolArray,d=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,m={};d.clear();for(var g=0;g<h.length;g++){var v=h.get(g),y=v.hidden||!v.crossTileID||e.allowVerticalPlacement&&!v.placedOrientation?null:r[v.crossTileID];if(y){var _=new t.Point(v.anchorX,v.anchorY),b=Qt(_,i?s:l),x=te(a.cameraToCenterDistance,b.signedDistanceFromCamera),w=o.evaluateSizeForFeature(e.textSizeData,c,v)*x/t.ONE_EM;i&&(w*=e.tilePixelRatio/u);for(var C=Qn(y.anchor,y.width,y.height,y.textOffset,y.textBoxScale,w),E=i?Qt(_.add(C),l).point:b.point.add(n?C.rotate(-a.angle):C),S=e.allowVerticalPlacement&&v.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,T=0;T<v.numGlyphs;T++)t.addDynamicAttributes(d,E,S);p&&v.associatedIconIndex>=0&&(m[v.associatedIconIndex]={shiftedAnchor:E,angle:S})}else ue(v.numGlyphs,d)}if(p){f.clear();for(var I=e.icon.placedSymbolArray,P=0;P<I.length;P++){var A=I.get(P);if(A.hidden)ue(A.numGlyphs,f);else{var M=m[P];if(M)for(var k=0;k<A.numGlyphs;k++)t.addDynamicAttributes(f,M.shiftedAnchor,M.angle);else ue(A.numGlyphs,f)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(d)}function ei(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function ni(e,n,i,r,o,a,l,s,u,c,p,h){for(var d=e.context,f=d.gl,m=e.transform,g="map"===s,v="map"===u,y=g&&"point"!==i.layout.get("symbol-placement"),_=g&&!v&&!y,b=void 0!==i.layout.get("symbol-sort-key").constantOr(1),x=!1,w=e.depthModeForSublayer(0,St.ReadOnly),C=i.layout.get("text-variable-anchor"),E=[],S=0,T=r;S<T.length;S+=1){var I=T[S],P=n.getTile(I),A=P.getBucket(i);if(A){var M=o?A.text:A.icon;if(M&&M.segments.get().length){var k=M.programConfigurations.get(i.id),D=o||A.sdfIcons,L=o?A.textSizeData:A.iconSizeData,O=v||0!==m.pitch,R=e.useProgram(ei(D,o,A),k),z=t.evaluateSizeForZoom(L,m.zoom),F=void 0,B=[0,0],N=void 0,U=void 0,j=null,V=void 0;if(o)N=P.glyphAtlasTexture,U=f.LINEAR,F=P.glyphAtlasTexture.size,A.iconsInText&&(B=P.imageAtlasTexture.size,j=P.imageAtlasTexture,V=O||e.options.rotating||e.options.zooming||"composite"===L.kind||"camera"===L.kind?f.LINEAR:f.NEAREST);else{var q=1!==i.layout.get("icon-size").constantOr(0)||A.iconsNeedLinear;N=P.imageAtlasTexture,U=D||e.options.rotating||e.options.zooming||q||O?f.LINEAR:f.NEAREST,F=P.imageAtlasTexture.size}var G=he(P,1,e.transform.zoom),Z=Jt(I.posMatrix,v,g,e.transform,G),H=$t(I.posMatrix,v,g,e.transform,G),Y=C&&A.hasTextData(),X="none"!==i.layout.get("icon-text-fit")&&Y&&A.hasIconData();y&&ne(A,I.posMatrix,e,o,Z,H,v,c);var W=e.translatePosMatrix(I.posMatrix,P,a,l),K=y||o&&C||X?$n:Z,J=e.translatePosMatrix(H,P,a,l,!0),$=D&&0!==i.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),Q={program:R,buffers:M,uniformValues:D?A.iconsInText?Yn(L.kind,z,_,v,e,W,K,J,F,B):Hn(L.kind,z,_,v,e,W,K,J,o,F,!0):Zn(L.kind,z,_,v,e,W,K,J,o,F),atlasTexture:N,atlasTextureIcon:j,atlasInterpolation:U,atlasInterpolationIcon:V,isSDF:D,hasHalo:$};if(b&&A.canOverlap){x=!0;for(var tt=0,et=M.segments.get();tt<et.length;tt+=1){var nt=et[tt];E.push({segments:new t.SegmentVector([nt]),sortKey:nt.sortKey,state:Q})}}else E.push({segments:M.segments,sortKey:0,state:Q})}}}x&&E.sort((function(t,e){return t.sortKey-e.sortKey}));for(var it=0,rt=E;it<rt.length;it+=1){var ot=rt[it],at=ot.state;if(d.activeTexture.set(f.TEXTURE0),at.atlasTexture.bind(at.atlasInterpolation,f.CLAMP_TO_EDGE),at.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),at.atlasTextureIcon&&at.atlasTextureIcon.bind(at.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),at.isSDF){var lt=at.uniformValues;at.hasHalo&&(lt.u_is_halo=1,ii(at.buffers,ot.segments,i,e,at.program,w,p,h,lt)),lt.u_is_halo=0}ii(at.buffers,ot.segments,i,e,at.program,w,p,h,at.uniformValues)}}function ii(t,e,n,i,r,o,a,l,s){var u=i.context;r.draw(u,u.gl.TRIANGLES,o,a,l,Pt.disabled,s,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,i.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function ri(t,e,n,i,r,o,a){var l,s,u,c,p,h=t.context.gl,d=n.paint.get("fill-pattern"),f=d&&d.constantOr(1),m=n.getCrossfadeParameters();a?(s=f&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",l=h.LINES):(s=f?"fillPattern":"fill",l=h.TRIANGLES);for(var g=0,v=i;g<v.length;g+=1){var y=v[g],_=e.getTile(y);if(!f||_.patternsLoaded()){var b=_.getBucket(n);if(b){var x=b.programConfigurations.get(n.id),w=t.useProgram(s,x);f&&(t.context.activeTexture.set(h.TEXTURE0),_.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),x.updatePaintBuffers(m));var C=d.constantOr(null);if(C&&_.imageAtlas){var E=_.imageAtlas,S=E.patternPositions[C.to.toString()],T=E.patternPositions[C.from.toString()];S&&T&&x.setConstantPatternPositions(S,T)}var I=t.translatePosMatrix(y.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){c=b.indexBuffer2,p=b.segments2;var P=[h.drawingBufferWidth,h.drawingBufferHeight];u="fillOutlinePattern"===s&&f?An(I,t,m,_,P):Pn(I,P)}else c=b.indexBuffer,p=b.segments,u=f?In(I,t,m,_):Tn(I);w.draw(t.context,l,r,t.stencilModeForClipping(y),o,Pt.disabled,u,n.id,b.layoutVertexBuffer,c,p,n.paint,t.transform.zoom,x)}}}}function oi(t,e,n,i,r,o,a){for(var l=t.context,s=l.gl,u=n.paint.get("fill-extrusion-pattern"),c=u.constantOr(1),p=n.getCrossfadeParameters(),h=n.paint.get("fill-extrusion-opacity"),d=0,f=i;d<f.length;d+=1){var m=f[d],g=e.getTile(m),v=g.getBucket(n);if(v){var y=v.programConfigurations.get(n.id),_=t.useProgram(c?"fillExtrusionPattern":"fillExtrusion",y);c&&(t.context.activeTexture.set(s.TEXTURE0),g.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),y.updatePaintBuffers(p));var b=u.constantOr(null);if(b&&g.imageAtlas){var x=g.imageAtlas,w=x.patternPositions[b.to.toString()],C=x.patternPositions[b.from.toString()];w&&C&&y.setConstantPatternPositions(w,C)}var E=t.translatePosMatrix(m.posMatrix,g,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),S=n.paint.get("fill-extrusion-vertical-gradient"),T=c?Sn(E,t,S,h,m,p,g):En(E,t,S,h);_.draw(l,l.gl.TRIANGLES,r,o,a,Pt.backCCW,T,n.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,n.paint,t.transform.zoom,y)}}}function ai(e,n,i,r,o,a){var l=e.context,s=l.gl,u=n.fbo;if(u){var c=e.useProgram("hillshade");l.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,u.colorAttachment.get());var p=function(e,n,i){var r=i.paint.get("hillshade-shadow-color"),o=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color"),l=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(l-=e.transform.angle);var s,u,c,p=!e.options.moving;return{u_matrix:e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),p),u_image:0,u_latrange:(s=n.tileID,u=Math.pow(2,s.canonical.z),c=s.canonical.y,[new t.MercatorCoordinate(0,c/u).toLngLat().lat,new t.MercatorCoordinate(0,(c+1)/u).toLngLat().lat]),u_light:[i.paint.get("hillshade-exaggeration"),l],u_shadow:r,u_highlight:o,u_accent:a}}(e,n,i);c.draw(l,s.TRIANGLES,r,o,a,Pt.disabled,p,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function li(e,n,i,r,o,a){var l=e.context,s=l.gl,u=n.dem;if(u&&u.data){var c=u.dim,p=u.stride,h=u.getPixels();if(l.activeTexture.set(s.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(p),n.demTexture){var d=n.demTexture;d.update(h,{premultiply:!1}),d.bind(s.NEAREST,s.CLAMP_TO_EDGE)}else n.demTexture=new t.Texture(l,h,s.RGBA,{premultiply:!1}),n.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE);l.activeTexture.set(s.TEXTURE0);var f=n.fbo;if(!f){var m=new t.Texture(l,{width:c,height:c,data:null},s.RGBA);m.bind(s.LINEAR,s.CLAMP_TO_EDGE),(f=n.fbo=l.createFramebuffer(c,c,!0)).colorAttachment.set(m.texture)}l.bindFramebuffer.set(f.framebuffer),l.viewport.set([0,0,c,c]),e.useProgram("hillshadePrepare").draw(l,s.TRIANGLES,r,o,a,Pt.disabled,function(e,n){var i=n.stride,r=t.create();return t.ortho(r,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(r,r,[0,-t.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_unpack:n.getUnpackVector()}}(n.tileID,u),i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function si(e,n,i,r,o){var a=r.paint.get("raster-fade-duration");if(a>0){var l=t.browser.now(),s=(l-e.timeAdded)/a,u=n?(l-n.timeAdded)/a:-1,c=i.getSource(),p=o.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-p)>Math.abs(e.tileID.overscaledZ-p),d=h&&e.refreshedUponExpiration?1:t.clamp(h?s:1-u,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}var ui=new t.Color(1,0,0,1),ci=new t.Color(0,1,0,1),pi=new t.Color(0,0,1,1),hi=new t.Color(1,0,1,1),di=new t.Color(0,1,1,1);function fi(t,e,n,i){gi(t,0,e+n/2,t.transform.width,n,i)}function mi(t,e,n,i){gi(t,e-n/2,0,n,t.transform.height,i)}function gi(e,n,i,r,o,a){var l=e.context,s=l.gl;s.enable(s.SCISSOR_TEST),s.scissor(n*t.browser.devicePixelRatio,i*t.browser.devicePixelRatio,r*t.browser.devicePixelRatio,o*t.browser.devicePixelRatio),l.clear({color:a}),s.disable(s.SCISSOR_TEST)}function vi(e,n,i){var r=e.context,o=r.gl,a=i.posMatrix,l=e.useProgram("debug"),s=St.disabled,u=Tt.disabled,c=e.colorModeForRenderPass();r.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),l.draw(r,o.LINE_STRIP,s,u,c,Pt.disabled,Ln(a,t.Color.red),"$debug",e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);var p=n.getTileByID(i.key).latestRawTileData,h=Math.floor((p&&p.byteLength||0)/1024),d=n.getTile(i).tileSize,f=512/Math.min(d,512)*(i.overscaledZ/e.transform.zoom)*.5,m=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(m+=" => "+i.overscaledZ),function(t,e){t.initDebugOverlayCanvas();var n=t.debugOverlayCanvas,i=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,m+" "+h+"kb"),l.draw(r,o.TRIANGLES,s,u,It.alphaBlended,Pt.disabled,Ln(a,t.Color.transparent,f),"$debug",e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}var yi={symbol:function(e,n,i,r,o){if("translucent"===e.renderPass){var a=Tt.disabled,l=e.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(e,n,i,r,o,a,l){for(var s=n.transform,u="map"===o,c="map"===a,p=0,h=e;p<h.length;p+=1){var d=h[p],f=r.getTile(d),m=f.getBucket(i);if(m&&m.text&&m.text.segments.get().length){var g=t.evaluateSizeForZoom(m.textSizeData,s.zoom),v=he(f,1,n.transform.zoom),y=Jt(d.posMatrix,c,u,n.transform,v),_="none"!==i.layout.get("icon-text-fit")&&m.hasIconData();if(g){var b=Math.pow(2,s.zoom-f.tileID.overscaledZ);ti(m,u,c,l,t.symbolSize,s,y,d.posMatrix,b,g,_)}}}}(r,e,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),o),0!==i.paint.get("icon-opacity").constantOr(1)&&ni(e,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),a,l),0!==i.paint.get("text-opacity").constantOr(1)&&ni(e,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),a,l),n.map.showCollisionBoxes&&(Jn(e,n,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Jn(e,n,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(e,n,i,r){if("translucent"===e.renderPass){var o=i.paint.get("circle-opacity"),a=i.paint.get("circle-stroke-width"),l=i.paint.get("circle-stroke-opacity"),s=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==l.constantOr(1)){for(var u=e.context,c=u.gl,p=e.depthModeForSublayer(0,St.ReadOnly),h=Tt.disabled,d=e.colorModeForRenderPass(),f=[],m=0;m<r.length;m++){var g=r[m],v=n.getTile(g),y=v.getBucket(i);if(y){var _=y.programConfigurations.get(i.id),b={programConfiguration:_,program:e.useProgram("circle",_),layoutVertexBuffer:y.layoutVertexBuffer,indexBuffer:y.indexBuffer,uniformValues:Mn(e,g,v,i)};if(s)for(var x=0,w=y.segments.get();x<w.length;x+=1){var C=w[x];f.push({segments:new t.SegmentVector([C]),sortKey:C.sortKey,state:b})}else f.push({segments:y.segments,sortKey:0,state:b})}}s&&f.sort((function(t,e){return t.sortKey-e.sortKey}));for(var E=0,S=f;E<S.length;E+=1){var T=S[E],I=T.state;I.program.draw(u,c.TRIANGLES,p,h,d,Pt.disabled,I.uniformValues,i.id,I.layoutVertexBuffer,I.indexBuffer,T.segments,i.paint,e.transform.zoom,I.programConfiguration)}}}},heatmap:function(e,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,l=Tt.disabled,s=new It([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{var o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),r=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,i){var r=t.gl;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width/4,e.height/4,0,r.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:r.UNSIGNED_BYTE,null),i.colorAttachment.set(n)}(t,e,o,r)}}(o,e,i),o.clear({color:t.Color.transparent});for(var u=0;u<r.length;u++){var c=r[u];if(!n.hasRenderableParent(c)){var p=n.getTile(c),h=p.getBucket(i);if(h){var d=h.programConfigurations.get(i.id);e.useProgram("heatmap",d).draw(o,a.TRIANGLES,St.disabled,l,s,Pt.disabled,Rn(c.posMatrix,p,e.transform.zoom,i.paint.get("heatmap-intensity")),i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,i.paint,e.transform.zoom,d)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var i=e.context,r=i.gl,o=n.heatmapFbo;if(o){i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new t.Texture(i,n.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(i,r.TRIANGLES,St.disabled,Tt.disabled,e.colorModeForRenderPass(),Pt.disabled,function(e,n,i,r){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}}(e,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,i))},line:function(e,n,i,r){if("translucent"===e.renderPass){var o=i.paint.get("line-opacity"),a=i.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1))for(var l=e.depthModeForSublayer(0,St.ReadOnly),s=e.colorModeForRenderPass(),u=i.paint.get("line-dasharray"),c=i.paint.get("line-pattern"),p=c.constantOr(1),h=i.paint.get("line-gradient"),d=i.getCrossfadeParameters(),f=p?"linePattern":u?"lineSDF":h?"lineGradient":"line",m=e.context,g=m.gl,v=!0,y=0,_=r;y<_.length;y+=1){var b=_[y],x=n.getTile(b);if(!p||x.patternsLoaded()){var w=x.getBucket(i);if(w){var C=w.programConfigurations.get(i.id),E=e.context.program.get(),S=e.useProgram(f,C),T=v||S.program!==E,I=c.constantOr(null);if(I&&x.imageAtlas){var P=x.imageAtlas,A=P.patternPositions[I.to.toString()],M=P.patternPositions[I.from.toString()];A&&M&&C.setConstantPatternPositions(A,M)}var k=p?Bn(e,x,i,d):u?Nn(e,x,i,u,d):h?Fn(e,x,i,w.lineClipsArray.length):zn(e,x,i);if(p)m.activeTexture.set(g.TEXTURE0),x.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),C.updatePaintBuffers(d);else if(u&&(T||e.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(m);else if(h){var D=w.gradients[i.id],L=D.texture;if(i.gradientVersion!==D.version){var O=256;if(i.stepInterpolant){var R=n.getSource().maxzoom,z=b.canonical.z===R?Math.ceil(1<<e.transform.maxZoom-b.canonical.z):1;O=t.clamp(t.nextPowerOfTwo(w.maxLineLength/t.EXTENT*1024*z),256,m.maxTextureSize)}D.gradient=t.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:D.gradient||void 0,clips:w.lineClipsArray}),D.texture?D.texture.update(D.gradient):D.texture=new t.Texture(m,D.gradient,g.RGBA),D.version=i.gradientVersion,L=D.texture}m.activeTexture.set(g.TEXTURE0),L.bind(i.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}S.draw(m,g.TRIANGLES,l,e.stencilModeForClipping(b),s,Pt.disabled,k,i.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,i.paint,e.transform.zoom,C,w.layoutVertexBuffer2),v=!1}}}}},fill:function(e,n,i,r){var o=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var l=e.colorModeForRenderPass(),s=i.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!s.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){var c=e.depthModeForSublayer(1,"opaque"===e.renderPass?St.ReadWrite:St.ReadOnly);ri(e,n,i,r,c,l,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){var p=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);ri(e,n,i,r,p,l,!0)}}},"fill-extrusion":function(t,e,n,i){var r=n.paint.get("fill-extrusion-opacity");if(0!==r&&"translucent"===t.renderPass){var o=new St(t.context.gl.LEQUAL,St.ReadWrite,t.depthRangeFor3D);if(1!==r||n.paint.get("fill-extrusion-pattern").constantOr(1))oi(t,e,n,i,o,Tt.disabled,It.disabled),oi(t,e,n,i,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();oi(t,e,n,i,o,Tt.disabled,a)}}},hillshade:function(t,e,n,i){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var r=t.context,o=t.depthModeForSublayer(0,St.ReadOnly),a=t.colorModeForRenderPass(),l="translucent"===t.renderPass?t.stencilConfigForOverlap(i):[{},i],s=l[0],u=0,c=l[1];u<c.length;u+=1){var p=c[u],h=e.getTile(p);h.needsHillshadePrepare&&"offscreen"===t.renderPass?li(t,h,n,o,Tt.disabled,a):"translucent"===t.renderPass&&ai(t,h,n,o,s[p.overscaledZ],a)}r.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,i){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")&&i.length)for(var r=t.context,o=r.gl,a=e.getSource(),l=t.useProgram("raster"),s=t.colorModeForRenderPass(),u=a instanceof D?[{},i]:t.stencilConfigForOverlap(i),c=u[0],p=u[1],h=p[p.length-1].overscaledZ,d=!t.options.moving,f=0,m=p;f<m.length;f+=1){var g=m[f],v=t.depthModeForSublayer(g.overscaledZ-h,1===n.paint.get("raster-opacity")?St.ReadWrite:St.ReadOnly,o.LESS),y=e.getTile(g),_=t.transform.calculatePosMatrix(g.toUnwrapped(),d);y.registerFadeDuration(n.paint.get("raster-fade-duration"));var b=e.findLoadedParent(g,0),x=si(y,b,e,n,t.transform),w=void 0,C=void 0,E="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;r.activeTexture.set(o.TEXTURE0),y.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),r.activeTexture.set(o.TEXTURE1),b?(b.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,b.tileID.overscaledZ-y.tileID.overscaledZ),C=[y.tileID.canonical.x*w%1,y.tileID.canonical.y*w%1]):y.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var S=Vn(_,C||[0,0],w||1,x,n);a instanceof D?l.draw(r,o.TRIANGLES,v,Tt.disabled,s,Pt.disabled,S,n.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):l.draw(r,o.TRIANGLES,v,c[g.overscaledZ],s,Pt.disabled,S,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n){var i=n.paint.get("background-color"),r=n.paint.get("background-opacity");if(0!==r){var o=t.context,a=o.gl,l=t.transform,s=l.tileSize,u=n.paint.get("background-pattern");if(!t.isPatternMissing(u)){var c=!u&&1===i.a&&1===r&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===c){var p=Tt.disabled,h=t.depthModeForSublayer(0,"opaque"===c?St.ReadWrite:St.ReadOnly),d=t.colorModeForRenderPass(),f=t.useProgram(u?"backgroundPattern":"background"),m=l.coveringTiles({tileSize:s});u&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));for(var g=n.getCrossfadeParameters(),v=0,y=m;v<y.length;v+=1){var _=y[v],b=t.transform.calculatePosMatrix(_.toUnwrapped()),x=u?Wn(b,r,t,u,{tileID:_,tileSize:s},g):Xn(b,r,i);f.draw(o,a.TRIANGLES,h,p,d,Pt.disabled,x,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,n){for(var i=0;i<n.length;i++)vi(t,e,n[i])},custom:function(t,e,n){var i=t.context,r=n.implementation;if("offscreen"===t.renderPass){var o=r.prerender;o&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),o.call(r,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(Tt.disabled);var a="3d"===r.renderingMode?new St(t.context.gl.LEQUAL,St.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,St.ReadOnly);i.setDepthMode(a),r.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}},_i=function(t,e){this.context=new At(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=Mt.maxUnderzooming+Mt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Be,this.gpuTimers={}};_i.prototype.resize=function(e,n){if(this.width=e*t.browser.devicePixelRatio,this.height=n*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,r=this.style._order;i<r.length;i+=1)this.style._layers[r[i]].resize()},_i.prototype.setup=function(){var e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,Ge.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(i,Ge.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var r=new t.StructArrayLayout4i8;r.emplaceBack(0,0,0,0),r.emplaceBack(t.EXTENT,0,t.EXTENT,0),r.emplaceBack(0,t.EXTENT,0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(r,k.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,Ge.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var l=new t.StructArrayLayout3ui6;l.emplaceBack(0,1,2),l.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(l),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);var s=this.context.gl;this.stencilClearMode=new Tt({func:s.ALWAYS,mask:0},0,255,s.ZERO,s.ZERO,s.ZERO)},_i.prototype.clearStencil=function(){var e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=t.create();t.ortho(i,0,this.width,this.height,0,0,1),t.scale(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,St.disabled,this.stencilClearMode,It.disabled,Pt.disabled,On(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},_i.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var n=this.context,i=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(It.disabled),n.setDepthMode(St.disabled);var r=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=e;o<a.length;o+=1){var l=a[o],s=this._tileClippingMaskIDs[l.key]=this.nextStencilID++;r.draw(n,i.TRIANGLES,St.disabled,new Tt({func:i.ALWAYS,mask:0},s,255,i.KEEP,i.KEEP,i.REPLACE),It.disabled,Pt.disabled,On(l.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},_i.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new Tt({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},_i.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Tt({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},_i.prototype.stencilConfigForOverlap=function(t){var e,n=this.context.gl,i=t.sort((function(t,e){return e.overscaledZ-t.overscaledZ})),r=i[i.length-1].overscaledZ,o=i[0].overscaledZ-r+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();for(var a={},l=0;l<o;l++)a[l+r]=new Tt({func:n.GEQUAL,mask:255},l+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=o,[a,i]}return[(e={},e[r]=Tt.disabled,e),i]},_i.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new It([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?It.unblended:It.alphaBlended},_i.prototype.depthModeForSublayer=function(t,e,n){if(!this.opaquePassEnabledForLayer())return St.disabled;var i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new St(n||this.context.gl.LEQUAL,e,[i,i])},_i.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},_i.prototype.render=function(e,n){var i=this;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now()),this.imageManager.beginFrame();var r=this.style._order,o=this.style.sourceCaches;for(var a in o){var l=o[a];l.used&&l.prepare(this.context)}var s,u,c={},p={},h={};for(var d in o){var f=o[d];c[d]=f.getVisibleCoordinates(),p[d]=c[d].slice().reverse(),h[d]=f.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<r.length;m++)if(this.style._layers[r[m]].is3D()){this.opaquePassCutoff=m;break}this.renderPass="offscreen";for(var g=0,v=r;g<v.length;g+=1){var y=this.style._layers[v[g]];if(y.hasOffscreenPass()&&!y.isHidden(this.transform.zoom)){var _=p[y.source];("custom"===y.type||_.length)&&this.renderLayer(this,o[y.source],y,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){var b=this.style._layers[r[this.currentLayer]],x=o[b.source],w=c[b.source];this._renderTileClippingMasks(b,w),this.renderLayer(this,x,b,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){var C=this.style._layers[r[this.currentLayer]],E=o[C.source],S=("symbol"===C.type?h:p)[C.source];this._renderTileClippingMasks(C,c[C.source]),this.renderLayer(this,E,C,S)}this.options.showTileBoundaries&&(t.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(i.transform.zoom)&&(t.source!==(u&&u.id)&&(u=i.style.sourceCaches[t.source]),(!s||s.getSource().maxzoom<u.getSource().maxzoom)&&(s=u))})),s&&yi.debug(this,s,s.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;fi(t,t.transform.height-(e.top||0),3,ui),fi(t,e.bottom||0,3,ci),mi(t,e.left||0,3,pi),mi(t,t.transform.width-(e.right||0),3,hi);var n=t.transform.centerPoint;!function(t,e,n,i){gi(t,e-1,n-10,2,20,i),gi(t,e-10,n-1,20,2,i)}(t,n.x,t.transform.height-n.y,di)}(this),this.context.setDefault()},_i.prototype.renderLayer=function(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||i.length)&&(this.id=n.id,this.gpuTimingStart(n),yi[n.type](t,e,n,i,this.style.placement.variableOffsets),this.gpuTimingEnd())},_i.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}},_i.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},_i.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},_i.prototype.queryGpuTimers=function(t){var e={};for(var n in t){var i=t[n],r=this.context.extTimerQuery,o=r.getQueryObjectEXT(i.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(i.query),e[n]=o}return e},_i.prototype.translatePosMatrix=function(e,n,i,r,o){if(!i[0]&&!i[1])return e;var a=o?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(a){var l=Math.sin(a),s=Math.cos(a);i=[i[0]*s-i[1]*l,i[0]*l+i[1]*s]}var u=[o?i[0]:he(n,i[0],this.transform.zoom),o?i[1]:he(n,i[1],this.transform.zoom),0],c=new Float32Array(16);return t.translate(c,e,u),c},_i.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},_i.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},_i.prototype.isPatternMissing=function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n},_i.prototype.useProgram=function(t,e){this.cache=this.cache||{};var n=""+t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new wn(this.context,t,_n[t],e,Kn[t],this._showOverdrawInspector)),this.cache[n]},_i.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},_i.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)},_i.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},_i.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var bi=function(t,e){this.points=t,this.planes=e};bi.fromInvProjectionMatrix=function(e,n,i){var r=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(n){return t.transformMat4([],n,e)})).map((function(e){return t.scale$1([],e,1/e[3]/n*r)})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var n=t.sub([],o[e[0]],o[e[1]]),i=t.sub([],o[e[2]],o[e[1]]),r=t.normalize([],t.cross([],n,i)),a=-t.dot(r,o[e[1]]);return r.concat(a)}));return new bi(o,a)};var xi=function(e,n){this.min=e,this.max=n,this.center=t.scale$2([],t.add([],this.min,this.max),.5)};xi.prototype.quadrant=function(e){for(var n=[e%2==0,e<2],i=t.clone$2(this.min),r=t.clone$2(this.max),o=0;o<n.length;o++)i[o]=n[o]?this.min[o]:this.center[o],r[o]=n[o]?this.center[o]:this.max[o];return r[2]=this.max[2],new xi(i,r)},xi.prototype.distanceX=function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]},xi.prototype.distanceY=function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]},xi.prototype.intersects=function(e){for(var n=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,r=0;r<e.planes.length;r++){for(var o=e.planes[r],a=0,l=0;l<n.length;l++)a+=t.dot$1(o,n[l])>=0;if(0===a)return 0;a!==n.length&&(i=!1)}if(i)return 2;for(var s=0;s<3;s++){for(var u=Number.MAX_VALUE,c=-Number.MAX_VALUE,p=0;p<e.points.length;p++){var h=e.points[p][s]-this.min[s];u=Math.min(u,h),c=Math.max(c,h)}if(c<0||u>this.max[s]-this.min[s])return 0}return 1};var wi=function(t,e,n,i){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=i};wi.prototype.interpolate=function(e,n,i){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,i)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,i)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,i)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,i)),this},wi.prototype.getCenter=function(e,n){var i=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.Point(i,r)},wi.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right},wi.prototype.clone=function(){return new wi(this.top,this.bottom,this.left,this.right)},wi.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ci=function(e,n,i,r,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wi,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ei={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ci.prototype.clone=function(){var t=new Ci(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t},Ei.minZoom.get=function(){return this._minZoom},Ei.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Ei.maxZoom.get=function(){return this._maxZoom},Ei.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Ei.minPitch.get=function(){return this._minPitch},Ei.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},Ei.maxPitch.get=function(){return this._maxPitch},Ei.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},Ei.renderWorldCopies.get=function(){return this._renderWorldCopies},Ei.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Ei.worldSize.get=function(){return this.tileSize*this.scale},Ei.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ei.size.get=function(){return new t.Point(this.width,this.height)},Ei.bearing.get=function(){return-this.angle/Math.PI*180},Ei.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ei.pitch.get=function(){return this._pitch/Math.PI*180},Ei.pitch.set=function(e){var n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},Ei.fov.get=function(){return this._fov/Math.PI*180},Ei.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Ei.zoom.get=function(){return this._zoom},Ei.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Ei.center.get=function(){return this._center},Ei.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Ei.padding.get=function(){return this._edgeInsets.toJSON()},Ei.padding.set=function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())},Ei.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ci.prototype.isPaddingEqual=function(t){return this._edgeInsets.equals(t)},Ci.prototype.interpolatePadding=function(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()},Ci.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},Ci.prototype.getVisibleUnwrappedCoordinates=function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new t.Point(0,0)),r=this.pointCoordinate(new t.Point(this.width,0)),o=this.pointCoordinate(new t.Point(this.width,this.height)),a=this.pointCoordinate(new t.Point(0,this.height)),l=Math.floor(Math.min(i.x,r.x,o.x,a.x)),s=Math.floor(Math.max(i.x,r.x,o.x,a.x)),u=l-1;u<=s+1;u++)0!==u&&n.push(new t.UnwrappedTileID(u,e));return n},Ci.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),i=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var r=t.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,n),a=[o*r.x,o*r.y,0],l=bi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),s=e.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(s=n);var u=function(t){return{aabb:new xi([t*o,0,0],[(t+1)*o,o,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}},c=[],p=[],h=n,d=e.reparseOverscaled?i:n;if(this._renderWorldCopies)for(var f=1;f<=3;f++)c.push(u(-f)),c.push(u(f));for(c.push(u(0));c.length>0;){var m=c.pop(),g=m.x,v=m.y,y=m.fullyVisible;if(!y){var _=m.aabb.intersects(l);if(0===_)continue;y=2===_}var b=m.aabb.distanceX(a),x=m.aabb.distanceY(a),w=Math.max(Math.abs(b),Math.abs(x));if(m.zoom===h||w>3+(1<<h-m.zoom)-2&&m.zoom>=s)p.push({tileID:new t.OverscaledTileID(m.zoom===h?d:m.zoom,m.wrap,m.zoom,g,v),distanceSq:t.sqrLen([a[0]-.5-g,a[1]-.5-v])});else for(var C=0;C<4;C++){var E=(g<<1)+C%2,S=(v<<1)+(C>>1);c.push({aabb:m.aabb.quadrant(C),zoom:m.zoom+1,x:E,y:S,wrap:m.wrap,fullyVisible:y})}}return p.sort((function(t,e){return t.distanceSq-e.distanceSq})).map((function(t){return t.tileID}))},Ci.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Ei.unmodified.get=function(){return this._unmodified},Ci.prototype.zoomScale=function(t){return Math.pow(2,t)},Ci.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Ci.prototype.project=function(e){var n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)},Ci.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},Ei.point.get=function(){return this.project(this.center)},Ci.prototype.setLocationAtPoint=function(e,n){var i=this.pointCoordinate(n),r=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(i.x-r.x),o.y-(i.y-r.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},Ci.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Ci.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Ci.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},Ci.prototype.coordinateLocation=function(t){return t.toLngLat()},Ci.prototype.pointCoordinate=function(e){var n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse);var r=n[3],o=i[3],a=n[1]/r,l=i[1]/o,s=n[2]/r,u=i[2]/o,c=s===u?0:(0-s)/(u-s);return new t.MercatorCoordinate(t.number(n[0]/r,i[0]/o,c)/this.worldSize,t.number(a,l,c)/this.worldSize)},Ci.prototype.coordinatePoint=function(e){var n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},Ci.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},Ci.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ci.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ci.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var i=e.key,r=n?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),l=o.x+Math.pow(2,o.z)*e.wrap,s=t.identity(new Float64Array(16));return t.translate(s,s,[l*a,o.y*a,0]),t.scale(s,s,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(s,n?this.alignedProjMatrix:this.projMatrix,s),r[i]=new Float32Array(s),r[i]},Ci.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ci.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,i,r,o=-90,a=90,l=-180,s=180,u=this.size,c=this._unmodified;if(this.latRange){var p=this.latRange;o=t.mercatorYfromLat(p[1])*this.worldSize,e=(a=t.mercatorYfromLat(p[0])*this.worldSize)-o<u.y?u.y/(a-o):0}if(this.lngRange){var h=this.lngRange;l=t.mercatorXfromLng(h[0])*this.worldSize,n=(s=t.mercatorXfromLng(h[1])*this.worldSize)-l<u.x?u.x/(s-l):0}var d=this.point,f=Math.max(n||0,e||0);if(f)return this.center=this.unproject(new t.Point(n?(s+l)/2:d.x,e?(a+o)/2:d.y)),this.zoom+=this.scaleZoom(f),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var m=d.y,g=u.y/2;m-g<o&&(r=o+g),m+g>a&&(r=a-g)}if(this.lngRange){var v=d.x,y=u.x/2;v-y<l&&(i=l+y),v+y>s&&(i=s-y)}void 0===i&&void 0===r||(this.center=this.unproject(new t.Point(void 0!==i?i:d.x,void 0!==r?r:d.y))),this._unmodified=c,this._constraining=!1}},Ci.prototype._calcMatrices=function(){if(this.height){var e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var n=Math.PI/2+this._pitch,i=this._fov*(.5+e.y/this.height),r=Math.sin(i)*this.cameraToCenterDistance/Math.sin(t.clamp(Math.PI-n-i,.01,Math.PI-.01)),o=this.point,a=o.x,l=o.y,s=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),u=this.height/50,c=new Float64Array(16);t.perspective(c,this._fov,this.width/this.height,u,s),c[8]=2*-e.x/this.width,c[9]=2*e.y/this.height,t.scale(c,c,[1,-1,1]),t.translate(c,c,[0,0,-this.cameraToCenterDistance]),t.rotateX(c,c,this._pitch),t.rotateZ(c,c,this.angle),t.translate(c,c,[-a,-l,0]),this.mercatorMatrix=t.scale([],c,[this.worldSize,this.worldSize,this.worldSize]),t.scale(c,c,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=c,this.invProjMatrix=t.invert([],this.projMatrix);var p=this.width%2/2,h=this.height%2/2,d=Math.cos(this.angle),f=Math.sin(this.angle),m=a-Math.round(a)+d*p+f*h,g=l-Math.round(l)+d*h+f*p,v=new Float64Array(c);if(t.translate(v,v,[m>.5?m-1:m,g>.5?g-1:g,0]),this.alignedProjMatrix=v,c=t.create(),t.scale(c,c,[this.width/2,-this.height/2,1]),t.translate(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=t.create(),t.scale(c,c,[1,-1,1]),t.translate(c,c,[-1,-1,0]),t.scale(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(c=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ci.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ci.prototype.getCameraPoint=function(){var e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))},Ci.prototype.getCameraQueryGeometry=function(e){var n=this.getCameraPoint();if(1===e.length)return[e[0],n];for(var i=n.x,r=n.y,o=n.x,a=n.y,l=0,s=e;l<s.length;l+=1){var u=s[l];i=Math.min(i,u.x),r=Math.min(r,u.y),o=Math.max(o,u.x),a=Math.max(a,u.y)}return[new t.Point(i,r),new t.Point(o,r),new t.Point(o,a),new t.Point(i,a),new t.Point(i,r)]},Object.defineProperties(Ci.prototype,Ei);var Si=function(e){var n,i,r,o;this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),i=!1,r=null,o=function(){r=null,i&&(n(),r=setTimeout(o,300),i=!1)},function(){return i=!0,r||o(),r})};Si.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Si.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Si.prototype.getHashString=function(e){var n=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,r),a=Math.round(n.lng*o)/o,l=Math.round(n.lat*o)/o,s=this._map.getBearing(),u=this._map.getPitch(),c="";if(c+=e?"/"+a+"/"+l+"/"+i:i+"/"+l+"/"+a,(s||u)&&(c+="/"+Math.round(10*s)/10),u&&(c+="/"+Math.round(u)),this._hashName){var p=this._hashName,h=!1,d=t.window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===p?(h=!0,e+"="+c):t})).filter((function(t){return t}));return h||d.push(p+"="+c),"#"+d.join("&")}return"#"+c},Si.prototype._getCurrentHash=function(){var e,n=this,i=t.window.location.hash.replace("#","");return this._hashName?(i.split("&").map((function(t){return t.split("=")})).forEach((function(t){t[0]===n._hashName&&(e=t)})),(e&&e[1]||"").split("/")):i.split("/")},Si.prototype._onHashChange=function(){var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(t){return isNaN(t)}))){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},Si.prototype._updateHashUnthrottled=function(){var e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());try{t.window.history.replaceState(t.window.history.state,null,e)}catch(t){}};var Ti={linearity:.3,easing:t.bezier(0,0,.3,1)},Ii=t.extend({deceleration:2500,maxSpeed:1400},Ti),Pi=t.extend({deceleration:20,maxSpeed:1400},Ti),Ai=t.extend({deceleration:1e3,maxSpeed:360},Ti),Mi=t.extend({deceleration:1e3,maxSpeed:90},Ti),ki=function(t){this._map=t,this.clear()};function Di(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Li(e,n,i){var r=i.maxSpeed,o=i.linearity,a=i.deceleration,l=t.clamp(e*o/(n/1e3),-r,r),s=Math.abs(l)/(a*o);return{easing:i.easing,duration:1e3*s,amount:l*(s/2)}}ki.prototype.clear=function(){this._inertiaBuffer=[]},ki.prototype.record=function(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.browser.now(),settings:e})},ki.prototype._drainInertiaBuffer=function(){for(var e=this._inertiaBuffer,n=t.browser.now();e.length>0&&n-e[0].time>160;)e.shift()},ki.prototype._onMoveEnd=function(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var n={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0},i=0,r=this._inertiaBuffer;i<r.length;i+=1){var o=r[i].settings;n.zoom+=o.zoomDelta||0,n.bearing+=o.bearingDelta||0,n.pitch+=o.pitchDelta||0,o.panDelta&&n.pan._add(o.panDelta),o.around&&(n.around=o.around),o.pinchAround&&(n.pinchAround=o.pinchAround)}var a=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,l={};if(n.pan.mag()){var s=Li(n.pan.mag(),a,t.extend({},Ii,e||{}));l.offset=n.pan.mult(s.amount/n.pan.mag()),l.center=this._map.transform.center,Di(l,s)}if(n.zoom){var u=Li(n.zoom,a,Pi);l.zoom=this._map.transform.zoom+u.amount,Di(l,u)}if(n.bearing){var c=Li(n.bearing,a,Ai);l.bearing=this._map.transform.bearing+t.clamp(c.amount,-179,179),Di(l,c)}if(n.pitch){var p=Li(n.pitch,a,Mi);l.pitch=this._map.transform.pitch+p.amount,Di(l,p)}if(l.zoom||l.bearing){var h=void 0===n.pinchAround?n.around:n.pinchAround;l.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),t.extend(l,{noMoveStart:!0})}};var Oi=function(e){function i(i,r,o,a){void 0===a&&(a={});var l=n.mousePos(r.getCanvasContainer(),o),s=r.unproject(l);e.call(this,i,t.extend({point:l,lngLat:s,originalEvent:o},a)),this._defaultPrevented=!1,this.target=r}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var r={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,r),i}(t.Event),Ri=function(e){function i(i,r,o){var a="touchend"===i?o.changedTouches:o.touches,l=n.touchPos(r.getCanvasContainer(),a),s=l.map((function(t){return r.unproject(t)})),u=l.reduce((function(t,e,n,i){return t.add(e.div(i.length))}),new t.Point(0,0)),c=r.unproject(u);e.call(this,i,{points:l,point:u,lngLats:s,lngLat:c,originalEvent:o}),this._defaultPrevented=!1}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var r={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,r),i}(t.Event),zi=function(t){function e(e,n,i){t.call(this,e,{originalEvent:i}),this._defaultPrevented=!1}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),Fi=function(t,e){this._map=t,this._clickTolerance=e.clickTolerance};Fi.prototype.reset=function(){delete this._mousedownPos},Fi.prototype.wheel=function(t){return this._firePreventable(new zi(t.type,this._map,t))},Fi.prototype.mousedown=function(t,e){return this._mousedownPos=e,this._firePreventable(new Oi(t.type,this._map,t))},Fi.prototype.mouseup=function(t){this._map.fire(new Oi(t.type,this._map,t))},Fi.prototype.click=function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Oi(t.type,this._map,t))},Fi.prototype.dblclick=function(t){return this._firePreventable(new Oi(t.type,this._map,t))},Fi.prototype.mouseover=function(t){this._map.fire(new Oi(t.type,this._map,t))},Fi.prototype.mouseout=function(t){this._map.fire(new Oi(t.type,this._map,t))},Fi.prototype.touchstart=function(t){return this._firePreventable(new Ri(t.type,this._map,t))},Fi.prototype.touchmove=function(t){this._map.fire(new Ri(t.type,this._map,t))},Fi.prototype.touchend=function(t){this._map.fire(new Ri(t.type,this._map,t))},Fi.prototype.touchcancel=function(t){this._map.fire(new Ri(t.type,this._map,t))},Fi.prototype._firePreventable=function(t){if(this._map.fire(t),t.defaultPrevented)return{}},Fi.prototype.isEnabled=function(){return!0},Fi.prototype.isActive=function(){return!1},Fi.prototype.enable=function(){},Fi.prototype.disable=function(){};var Bi=function(t){this._map=t};Bi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Bi.prototype.mousemove=function(t){this._map.fire(new Oi(t.type,this._map,t))},Bi.prototype.mousedown=function(){this._delayContextMenu=!0},Bi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Oi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Bi.prototype.contextmenu=function(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Oi(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()},Bi.prototype.isEnabled=function(){return!0},Bi.prototype.isActive=function(){return!1},Bi.prototype.enable=function(){},Bi.prototype.disable=function(){};var Ni=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1};function Ui(t,e){for(var n={},i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}Ni.prototype.isEnabled=function(){return!!this._enabled},Ni.prototype.isActive=function(){return!!this._active},Ni.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ni.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ni.prototype.mousedown=function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(n.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)},Ni.prototype.mousemoveWindow=function(t,e){if(this._active){var i=e;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=i,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var o=Math.min(r.x,i.x),a=Math.max(r.x,i.x),l=Math.min(r.y,i.y),s=Math.max(r.y,i.y);n.setTransform(this._box,"translate("+o+"px,"+l+"px)"),this._box.style.width=a-o+"px",this._box.style.height=s-l+"px"}}},Ni.prototype.mouseupWindow=function(e,i){var r=this;if(this._active&&0===e.button){var o=this._startPos,a=i;if(this.reset(),n.suppressClick(),o.x!==a.x||o.y!==a.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:function(t){return t.fitScreenCoordinates(o,a,r._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",e)}},Ni.prototype.keydown=function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))},Ni.prototype.blur=function(){this.reset()},Ni.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},Ni.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var ji=function(t){this.reset(),this.numTouches=t.numTouches};ji.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},ji.prototype.touchstart=function(e,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){for(var n=new t.Point(0,0),i=0,r=e;i<r.length;i+=1)n._add(r[i]);return n.div(e.length)}(n),this.touches=Ui(i,n)))},ji.prototype.touchmove=function(t,e,n){if(!this.aborted&&this.centroid){var i=Ui(n,e);for(var r in this.touches){var o=i[r];(!o||o.dist(this.touches[r])>30)&&(this.aborted=!0)}}},ji.prototype.touchend=function(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){var i=!this.aborted&&this.centroid;if(this.reset(),i)return i}};var Vi=function(t){this.singleTap=new ji(t),this.numTaps=t.numTaps,this.reset()};Vi.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Vi.prototype.touchstart=function(t,e,n){this.singleTap.touchstart(t,e,n)},Vi.prototype.touchmove=function(t,e,n){this.singleTap.touchmove(t,e,n)},Vi.prototype.touchend=function(t,e,n){var i=this.singleTap.touchend(t,e,n);if(i){var r=t.timeStamp-this.lastTime<500,o=!this.lastTap||this.lastTap.dist(i)<30;if(r&&o||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}};var qi=function(){this._zoomIn=new Vi({numTouches:1,numTaps:2}),this._zoomOut=new Vi({numTouches:2,numTaps:1}),this.reset()};qi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},qi.prototype.touchstart=function(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)},qi.prototype.touchmove=function(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)},qi.prototype.touchend=function(t,e,n){var i=this,r=this._zoomIn.touchend(t,e,n),o=this._zoomOut.touchend(t,e,n);return r?(this._active=!0,t.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(r)},{originalEvent:t})}}):o?(this._active=!0,t.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(o)},{originalEvent:t})}}):void 0},qi.prototype.touchcancel=function(){this.reset()},qi.prototype.enable=function(){this._enabled=!0},qi.prototype.disable=function(){this._enabled=!1,this.reset()},qi.prototype.isEnabled=function(){return this._enabled},qi.prototype.isActive=function(){return this._active};var Gi={0:1,2:2},Zi=function(t){this.reset(),this._clickTolerance=t.clickTolerance||1};Zi.prototype.blur=function(){this.reset()},Zi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Zi.prototype._correctButton=function(t,e){return!1},Zi.prototype._move=function(t,e){return{}},Zi.prototype.mousedown=function(t,e){if(!this._lastPoint){var i=n.mouseButton(t);this._correctButton(t,i)&&(this._lastPoint=e,this._eventButton=i)}},Zi.prototype.mousemoveWindow=function(t,e){var n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){var n=Gi[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)},Zi.prototype.mouseupWindow=function(t){this._lastPoint&&n.mouseButton(t)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},Zi.prototype.enable=function(){this._enabled=!0},Zi.prototype.disable=function(){this._enabled=!1,this.reset()},Zi.prototype.isEnabled=function(){return this._enabled},Zi.prototype.isActive=function(){return this._active};var Hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.mousedown=function(e,n){t.prototype.mousedown.call(this,e,n),this._lastPoint&&(this._active=!0)},e.prototype._correctButton=function(t,e){return 0===e&&!t.ctrlKey},e.prototype._move=function(t,e){return{around:e,panDelta:e.sub(t)}},e}(Zi),Yi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Zi),Xi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Zi),Wi=function(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()};Wi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)},Wi.prototype.touchstart=function(t,e,n){return this._calculateTransform(t,e,n)},Wi.prototype.touchmove=function(t,e,n){if(this._active&&!(n.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,n)},Wi.prototype.touchend=function(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()},Wi.prototype.touchcancel=function(){this.reset()},Wi.prototype._calculateTransform=function(e,n,i){i.length>0&&(this._active=!0);var r=Ui(i,n),o=new t.Point(0,0),a=new t.Point(0,0),l=0;for(var s in r){var u=r[s],c=this._touches[s];c&&(o._add(u),a._add(u.sub(c)),l++,r[s]=u)}if(this._touches=r,!(l<this._minTouches)&&a.mag()){var p=a.div(l);if(this._sum._add(p),!(this._sum.mag()<this._clickTolerance))return{around:o.div(l),panDelta:p}}},Wi.prototype.enable=function(){this._enabled=!0},Wi.prototype.disable=function(){this._enabled=!1,this.reset()},Wi.prototype.isEnabled=function(){return this._enabled},Wi.prototype.isActive=function(){return this._active};var Ki=function(){this.reset()};function Ji(t,e,n){for(var i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function $i(t,e){return Math.log(t/e)/Math.LN2}Ki.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ki.prototype._start=function(t){},Ki.prototype._move=function(t,e,n){return{}},Ki.prototype.touchstart=function(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))},Ki.prototype.touchmove=function(t,e,n){if(this._firstTwoTouches){t.preventDefault();var i=this._firstTwoTouches,r=i[1],o=Ji(n,e,i[0]),a=Ji(n,e,r);if(o&&a){var l=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],l,t)}}},Ki.prototype.touchend=function(t,e,i){if(this._firstTwoTouches){var r=this._firstTwoTouches,o=r[1],a=Ji(i,e,r[0]),l=Ji(i,e,o);a&&l||(this._active&&n.suppressClick(),this.reset())}},Ki.prototype.touchcancel=function(){this.reset()},Ki.prototype.enable=function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around},Ki.prototype.disable=function(){this._enabled=!1,this.reset()},Ki.prototype.isEnabled=function(){return this._enabled},Ki.prototype.isActive=function(){return this._active};var Qi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._distance,delete this._startDistance},e.prototype._start=function(t){this._startDistance=this._distance=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs($i(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$i(this._distance,n),pinchAround:e}},e}(Ki);function tr(t,e){return 180*t.angleWith(e)/Math.PI}var er=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},e.prototype._start=function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:tr(this._vector,n),pinchAround:e}},e.prototype._isBelowThreshold=function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,n=tr(t,this._startVector);return Math.abs(n)<e},e}(Ki);function nr(t){return Math.abs(t.y)>Math.abs(t.x)}var ir=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},e.prototype._start=function(t){this._lastPoints=t,nr(t[0].sub(t[1]))&&(this._valid=!1)},e.prototype._move=function(t,e,n){var i=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(i,r,n.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+r.y)/2*-.5}},e.prototype.gestureBeginsVertically=function(t,e,n){if(void 0!==this._valid)return this._valid;var i=t.mag()>=2,r=e.mag()>=2;if(i||r){if(!i||!r)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;var o=t.y>0==e.y>0;return nr(t)&&nr(e)&&o}},e}(Ki),rr={panStep:100,bearingStep:15,pitchStep:10},or=function(){var t=rr;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1};function ar(t){return t*(2-t)}or.prototype.blur=function(){this.reset()},or.prototype.reset=function(){this._active=!1},or.prototype.keydown=function(t){var e=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var n=0,i=0,r=0,o=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),o=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),o=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(i=0,r=0),{cameraAnimation:function(l){var s=l.getZoom();l.easeTo({duration:300,easeId:"keyboardHandler",easing:ar,zoom:n?Math.round(s)+n*(t.shiftKey?2:1):s,bearing:l.getBearing()+i*e._bearingStep,pitch:l.getPitch()+r*e._pitchStep,offset:[-o*e._panStep,-a*e._panStep],center:l.getCenter()},{originalEvent:t})}}}},or.prototype.enable=function(){this._enabled=!0},or.prototype.disable=function(){this._enabled=!1,this.reset()},or.prototype.isEnabled=function(){return this._enabled},or.prototype.isActive=function(){return this._active},or.prototype.disableRotation=function(){this._rotationDisabled=!0},or.prototype.enableRotation=function(){this._rotationDisabled=!1};var lr=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,t.bindAll(["_onTimeout"],this)};lr.prototype.setZoomRate=function(t){this._defaultZoomRate=t},lr.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},lr.prototype.isEnabled=function(){return!!this._enabled},lr.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},lr.prototype.isZooming=function(){return!!this._zooming},lr.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},lr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},lr.prototype.wheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,i=t.browser.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}},lr.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},lr.prototype._start=function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var i=n.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},lr.prototype.renderFrame=function(){var e=this;if(this._frameId&&(this._frameId=null,this.isActive())){var n=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==r&&(r=1/r);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*r))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a,l="number"==typeof this._targetZoom?this._targetZoom:n.zoom,s=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&s&&u){var p=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),h=u(p);a=t.number(s,l,h),p<1?this._frameId||(this._frameId=!0):c=!0}else a=l,c=!0;return this._active=!0,c&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._handler._triggerRenderFrame(),delete e._targetZoom,delete e._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!c,zoomDelta:a-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},lr.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var i=this._prevEase,r=(t.browser.now()-i.start)/i.duration,o=i.easing(r+.01)-i.easing(r),a=.27/Math.sqrt(o*o+1e-4)*.01,l=Math.sqrt(.0729-a*a);n=t.bezier(a,l,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:n},n},lr.prototype.blur=function(){this.reset()},lr.prototype.reset=function(){this._active=!1};var sr=function(t,e){this._clickZoom=t,this._tapZoom=e};sr.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},sr.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},sr.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},sr.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ur=function(){this.reset()};ur.prototype.reset=function(){this._active=!1},ur.prototype.blur=function(){this.reset()},ur.prototype.dblclick=function(t,e){return t.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}},ur.prototype.enable=function(){this._enabled=!0},ur.prototype.disable=function(){this._enabled=!1,this.reset()},ur.prototype.isEnabled=function(){return this._enabled},ur.prototype.isActive=function(){return this._active};var cr=function(){this._tap=new Vi({numTouches:1,numTaps:1}),this.reset()};cr.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},cr.prototype.touchstart=function(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))},cr.prototype.touchmove=function(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var i=e[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,n)},cr.prototype.touchend=function(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)},cr.prototype.touchcancel=function(){this.reset()},cr.prototype.enable=function(){this._enabled=!0},cr.prototype.disable=function(){this._enabled=!1,this.reset()},cr.prototype.isEnabled=function(){return this._enabled},cr.prototype.isActive=function(){return this._active};var pr=function(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n};pr.prototype.enable=function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},pr.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},pr.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},pr.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var hr=function(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n};hr.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},hr.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},hr.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},hr.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var dr=function(t,e,n,i){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0};dr.prototype.enable=function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},dr.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},dr.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},dr.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},dr.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},dr.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var fr=function(t){return t.zoom||t.drag||t.pitch||t.rotate},mr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(t.Event);function gr(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}var vr=function(e,i){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ki(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i),t.bindAll(["handleEvent","handleWindowEvent"],this);var r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[t.window,"blur",void 0]];for(var o=0,a=this._listeners;o<a.length;o+=1){var l=a[o],s=l[0];n.addEventListener(s,l[1],s===t.window.document?this.handleWindowEvent:this.handleEvent,l[2])}};vr.prototype.destroy=function(){for(var e=0,i=this._listeners;e<i.length;e+=1){var r=i[e],o=r[0];n.removeEventListener(o,r[1],o===t.window.document?this.handleWindowEvent:this.handleEvent,r[2])}},vr.prototype._addDefaultHandlers=function(t){var e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Fi(e,t));var i=e.boxZoom=new Ni(e,t);this._add("boxZoom",i);var r=new qi,o=new ur;e.doubleClickZoom=new sr(o,r),this._add("tapZoom",r),this._add("clickZoom",o);var a=new cr;this._add("tapDragZoom",a);var l=e.touchPitch=new ir;this._add("touchPitch",l);var s=new Yi(t),u=new Xi(t);e.dragRotate=new hr(t,s,u),this._add("mouseRotate",s,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new Hi(t),p=new Wi(t);e.dragPan=new pr(n,c,p),this._add("mousePan",c),this._add("touchPan",p,["touchZoom","touchRotate"]);var h=new er,d=new Qi;e.touchZoomRotate=new dr(n,d,h,a),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]);var f=e.scrollZoom=new lr(e,this);this._add("scrollZoom",f,["mousePan"]);var m=e.keyboard=new or;this._add("keyboard",m),this._add("blockableMapEvent",new Bi(e));for(var g=0,v=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];g<v.length;g+=1){var y=v[g];t.interactive&&t[y]&&e[y].enable(t[y])}},vr.prototype._add=function(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e},vr.prototype.stop=function(t){if(!this._updatingCamera){for(var e=0,n=this._handlers;e<n.length;e+=1)n[e].handler.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}},vr.prototype.isActive=function(){for(var t=0,e=this._handlers;t<e.length;t+=1)if(e[t].handler.isActive())return!0;return!1},vr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},vr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},vr.prototype.isMoving=function(){return Boolean(fr(this._eventsInProgress))||this.isZooming()},vr.prototype._blockedByActive=function(t,e,n){for(var i in t)if(i!==n&&(!e||e.indexOf(i)<0))return!0;return!1},vr.prototype.handleWindowEvent=function(t){this.handleEvent(t,t.type+"Window")},vr.prototype._getMapTouches=function(t){for(var e=[],n=0,i=t;n<i.length;n+=1){var r=i[n];this._el.contains(r.target)&&e.push(r)}return e},vr.prototype.handleEvent=function(t,e){this._updatingCamera=!0;for(var i="renderFrame"===t.type?void 0:t,r={needsRenderFrame:!1},o={},a={},l=t.touches?this._getMapTouches(t.touches):void 0,s=l?n.touchPos(this._el,l):n.mousePos(this._el,t),u=0,c=this._handlers;u<c.length;u+=1){var p=c[u],h=p.handlerName,d=p.handler,f=p.allowed;if(d.isEnabled()){var m=void 0;this._blockedByActive(a,f,h)?d.reset():d[e||t.type]&&(m=d[e||t.type](t,s,l),this.mergeHandlerResult(r,o,m,h,i),m&&m.needsRenderFrame&&this._triggerRenderFrame()),(m||d.isActive())&&(a[h]=d)}}var g={};for(var v in this._previousActiveHandlers)a[v]||(g[v]=i);this._previousActiveHandlers=a,(Object.keys(g).length||gr(r))&&(this._changes.push([r,o,g]),this._triggerRenderFrame()),(Object.keys(a).length||gr(r))&&this._map._stop(!0),this._updatingCamera=!1;var y=r.cameraAnimation;y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],y(this._map))},vr.prototype.mergeHandlerResult=function(e,n,i,r,o){if(i){t.extend(e,i);var a={handlerName:r,originalEvent:i.originalEvent||o};void 0!==i.zoomDelta&&(n.zoom=a),void 0!==i.panDelta&&(n.drag=a),void 0!==i.pitchDelta&&(n.pitch=a),void 0!==i.bearingDelta&&(n.rotate=a)}},vr.prototype._applyChanges=function(){for(var e={},n={},i={},r=0,o=this._changes;r<o.length;r+=1){var a=o[r],l=a[0],s=a[1],u=a[2];l.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(l.panDelta)),l.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+l.zoomDelta),l.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+l.bearingDelta),l.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+l.pitchDelta),void 0!==l.around&&(e.around=l.around),void 0!==l.pinchAround&&(e.pinchAround=l.pinchAround),l.noInertia&&(e.noInertia=l.noInertia),t.extend(n,s),t.extend(i,u)}this._updateMapTransform(e,n,i),this._changes=[]},vr.prototype._updateMapTransform=function(t,e,n){var i=this._map,r=i.transform;if(!gr(t))return this._fireEvents(e,n,!0);var o=t.panDelta,a=t.zoomDelta,l=t.bearingDelta,s=t.pitchDelta,u=t.around,c=t.pinchAround;void 0!==c&&(u=c),i._stop(!0),u=u||i.transform.centerPoint;var p=r.pointLocation(o?u.sub(o):u);l&&(r.bearing+=l),s&&(r.pitch+=s),a&&(r.zoom+=a),r.setLocationAtPoint(p,u),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,n,!0)},vr.prototype._fireEvents=function(e,n,i){var r=this,o=fr(this._eventsInProgress),a=fr(e),l={};for(var s in e)this._eventsInProgress[s]||(l[s+"start"]=e[s].originalEvent),this._eventsInProgress[s]=e[s];for(var u in!o&&a&&this._fireEvent("movestart",a.originalEvent),l)this._fireEvent(u,l[u]);for(var c in a&&this._fireEvent("move",a.originalEvent),e)this._fireEvent(c,e[c].originalEvent);var p,h={};for(var d in this._eventsInProgress){var f=this._eventsInProgress[d],m=f.handlerName,g=f.originalEvent;this._handlersById[m].isActive()||(delete this._eventsInProgress[d],h[d+"end"]=p=n[m]||g)}for(var v in h)this._fireEvent(v,h[v]);var y=fr(this._eventsInProgress);if(i&&(o||a)&&!y){this._updatingCamera=!0;var _=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),b=function(t){return 0!==t&&-r._bearingSnap<t&&t<r._bearingSnap};_?(b(_.bearing||this._map.getBearing())&&(_.bearing=0),this._map.easeTo(_,{originalEvent:p})):(this._map.fire(new t.Event("moveend",{originalEvent:p})),b(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},vr.prototype._fireEvent=function(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},vr.prototype._requestFrame=function(){var t=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(e){delete t._frameId,t.handleEvent(new mr("renderFrame",{timeStamp:e})),t._applyChanges()}))},vr.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var yr=function(e){function n(n,i){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=i.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCenter=function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,i){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),i)},n.prototype.panTo=function(e,n,i){return this.easeTo(t.extend({center:e},n),i)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,i){return this.easeTo(t.extend({zoom:e},n),i)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.getPadding=function(){return this.transform.padding},n.prototype.setPadding=function(t,e){return this.jumpTo({padding:t},e),this},n.prototype.rotateTo=function(e,n,i){return this.easeTo(t.extend({bearing:e},n),i)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.resetNorthPitch=function(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(e,n){e=t.LngLatBounds.convert(e);var i=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),i,n)},n.prototype._cameraForBoxAndBearing=function(e,n,i,r){var o={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=t.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){var a=r.padding;r.padding={top:a,bottom:a,right:a,left:a}}r.padding=t.extend(o,r.padding);var l=this.transform,s=l.padding,u=l.project(t.LngLat.convert(e)),c=l.project(t.LngLat.convert(n)),p=u.rotate(-i*Math.PI/180),h=c.rotate(-i*Math.PI/180),d=new t.Point(Math.max(p.x,h.x),Math.max(p.y,h.y)),f=new t.Point(Math.min(p.x,h.x),Math.min(p.y,h.y)),m=d.sub(f),g=(l.width-(s.left+s.right+r.padding.left+r.padding.right))/m.x,v=(l.height-(s.top+s.bottom+r.padding.top+r.padding.bottom))/m.y;if(!(v<0||g<0)){var y=Math.min(l.scaleZoom(l.scale*Math.min(g,v)),r.maxZoom),_="number"==typeof r.offset.x?new t.Point(r.offset.x,r.offset.y):t.Point.convert(r.offset),b=new t.Point((r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2).rotate(i*Math.PI/180),x=_.add(b).mult(l.scale/l.zoomScale(y));return{center:l.unproject(u.add(c).div(2).sub(x)),zoom:y,bearing:i}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},n.prototype.fitBounds=function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)},n.prototype.fitScreenCoordinates=function(e,n,i,r,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(n)),i,r),r,o)},n.prototype._fitInternal=function(e,n,i){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this},n.prototype.jumpTo=function(e,n){this.stop();var i=this.transform,r=!1,o=!1,a=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(r=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.LngLat.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(o=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(a=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),r&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var i=this;this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.browser.prefersReducedMotion)&&(e.duration=0);var r=this.transform,o=this.getZoom(),a=this.getBearing(),l=this.getPitch(),s=this.getPadding(),u="zoom"in e?+e.zoom:o,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,p="pitch"in e?+e.pitch:l,h="padding"in e?e.padding:r.padding,d=t.Point.convert(e.offset),f=r.centerPoint.add(d),m=r.pointLocation(f),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);var v,y,_=r.project(m),b=r.project(g).sub(_),x=r.zoomScale(u-o);e.around&&(v=t.LngLat.convert(e.around),y=r.locationPoint(v));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||u!==o,this._rotating=this._rotating||a!==c,this._pitching=this._pitching||p!==l,this._padding=!r.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,w),this._ease((function(e){if(i._zooming&&(r.zoom=t.number(o,u,e)),i._rotating&&(r.bearing=t.number(a,c,e)),i._pitching&&(r.pitch=t.number(l,p,e)),i._padding&&(r.interpolatePadding(s,h,e),f=r.centerPoint.add(d)),v)r.setLocationAtPoint(v,y);else{var m=r.zoomScale(r.zoom-o),g=u>o?Math.min(2,x):Math.max(.5,x),w=Math.pow(g,1-e),C=r.unproject(_.add(b.mult(e*w)).mult(m));r.setLocationAtPoint(r.renderWorldCopies?C.wrap():C,f)}i._fireMoveEvents(n)}),(function(t){i._afterEase(n,t)}),e),this},n.prototype._prepareEase=function(e,n,i){void 0===i&&(i={}),this._moving=!0,n||i.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e,n){if(!this._easeId||!n||this._easeId!==n){delete this._easeId;var i=this._zooming,r=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}},n.prototype.flyTo=function(e,n){var i=this;if(!e.essential&&t.browser.prefersReducedMotion){var r=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var o=this.transform,a=this.getZoom(),l=this.getBearing(),s=this.getPitch(),u=this.getPadding(),c="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):a,p="bearing"in e?this._normalizeBearing(e.bearing,l):l,h="pitch"in e?+e.pitch:s,d="padding"in e?e.padding:o.padding,f=o.zoomScale(c-a),m=t.Point.convert(e.offset),g=o.centerPoint.add(m),v=o.pointLocation(g),y=t.LngLat.convert(e.center||v);this._normalizeCenter(y);var _=o.project(v),b=o.project(y).sub(_),x=e.curve,w=Math.max(o.width,o.height),C=w/f,E=b.mag();if("minZoom"in e){var S=t.clamp(Math.min(e.minZoom,a,c),o.minZoom,o.maxZoom),T=w/o.zoomScale(S-a);x=Math.sqrt(T/E*2)}var I=x*x;function P(t){var e=(C*C-w*w+(t?-1:1)*I*I*E*E)/(2*(t?C:w)*I*E);return Math.log(Math.sqrt(e*e+1)-e)}function A(t){return(Math.exp(t)-Math.exp(-t))/2}function M(t){return(Math.exp(t)+Math.exp(-t))/2}var k=P(0),D=function(t){return M(k)/M(k+x*t)},L=function(t){return w*((M(k)*(A(e=k+x*t)/M(e))-A(k))/I)/E;var e},O=(P(1)-k)/x;if(Math.abs(E)<1e-6||!isFinite(O)){if(Math.abs(w-C)<1e-6)return this.easeTo(e,n);var R=C<w?-1:1;O=Math.abs(Math.log(C/w))/x,L=function(){return 0},D=function(t){return Math.exp(R*x*t)}}return e.duration="duration"in e?+e.duration:1e3*O/("screenSpeed"in e?+e.screenSpeed/x:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=l!==p,this._pitching=h!==s,this._padding=!o.isPaddingEqual(d),this._prepareEase(n,!1),this._ease((function(e){var r=e*O,f=1/D(r);o.zoom=1===e?c:a+o.scaleZoom(f),i._rotating&&(o.bearing=t.number(l,p,e)),i._pitching&&(o.pitch=t.number(s,h,e)),i._padding&&(o.interpolatePadding(u,d,e),g=o.centerPoint.add(m));var v=1===e?y:o.unproject(_.add(b.mult(L(r))).mult(f));o.setLocationAtPoint(o.renderWorldCopies?v.wrap():v,g),i._fireMoveEvents(n)}),(function(){return i._afterEase(n)}),e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){return this._stop()},n.prototype._stop=function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var n=this._onEaseEnd;delete this._onEaseEnd,n.call(this,e)}if(!t){var i=this.handlers;i&&i.stop(!1)}return this},n.prototype._ease=function(e,n,i){!1===i.animate||0===i.duration?(e(1),n()):(this._easeStart=t.browser.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),_r=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};_r.prototype.getDefaultPosition=function(){return"bottom-right"},_r.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=n.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_r.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},_r.prototype._setElementTitle=function(t,e){var n=this._map._getUIString("AttributionControl."+e);t.title=n,t.setAttribute("aria-label",n)},_r.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},_r.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){var i=n.reduce((function(t,e,i){return e.value&&(t+=e.key+"="+e.value+(i<n.length-1?"&":"")),t}),"?");e.href=t.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}},_r.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},_r.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var i in n){var r=n[i];if(r.used){var o=r.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}t.sort((function(t,e){return t.length-e.length}));var a=(t=t.filter((function(e,n){for(var i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,t.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},_r.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var br=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};br.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},br.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},br.prototype.getDefaultPosition=function(){return"bottom-left"},br.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},br.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},br.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var xr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};xr.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},xr.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,i=e?this._queue.concat(e):this._queue;n<i.length;n+=1){var r=i[n];if(r.id===t)return void(r.cancelled=!0)}},xr.prototype.run=function(t){void 0===t&&(t=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,i=e;n<i.length;n+=1){var r=i[n];if(!r.cancelled&&(r.callback(t),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},xr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var wr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Cr=t.window.HTMLImageElement,Er=t.window.HTMLElement,Sr=t.window.ImageBitmap,Tr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ir=function(i){function r(e){var n=this;if(null!=(e=t.extend({},Tr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var r=new Ci(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(i.call(this,r,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new xr,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},wr,e.locale),this._clickTolerance=e.clickTolerance,this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken),"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof Er))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return n._update(!1)})),this.on("moveend",(function(){return n._update(!1)})),this.on("zoom",(function(){return n._update(!0)})),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new vr(this,e),this._hash=e.hash&&new Si("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new _r({customAttribution:e.customAttribution})),this.addControl(new br,e.logoPosition),this.on("style.load",(function(){n.transform.unmodified&&n.jumpTo(n.style.stylesheet)})),this.on("data",(function(e){n._update("style"===e.dataType),n.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(function(e){n.fire(new t.Event(e.dataType+"dataloading",e))}))}i&&(r.__proto__=i),(r.prototype=Object.create(i&&i.prototype)).constructor=r;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return r.prototype._getMapId=function(){return this._mapId},r.prototype.addControl=function(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var i=e.onAdd(this);this._controls.push(e);var r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this},r.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this},r.prototype.hasControl=function(t){return this._controls.indexOf(t)>-1},r.prototype.resize=function(e){var n=this._containerDimensions(),i=n[0],r=n[1];if(i===this.transform.width&&r===this.transform.height)return this;this._resizeCanvas(i,r),this.transform.resize(i,r),this.painter.resize(i,r);var o=!this._moving;return o&&this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this},r.prototype.getBounds=function(){return this.transform.getBounds()},r.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},r.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},r.prototype.setMinZoom=function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},r.prototype.getMinZoom=function(){return this.transform.minZoom},r.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},r.prototype.getMaxZoom=function(){return this.transform.maxZoom},r.prototype.setMinPitch=function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},r.prototype.getMinPitch=function(){return this.transform.minPitch},r.prototype.setMaxPitch=function(t){if((t=null==t?60:t)>60)throw new Error("maxPitch must be less than or equal to 60");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},r.prototype.getMaxPitch=function(){return this.transform.maxPitch},r.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},r.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},r.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},r.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},r.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},r.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},r.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},r.prototype._createDelegatedListener=function(t,e,n){var i,r=this;if("mouseenter"===t||"mouseover"===t){var o=!1;return{layer:e,listener:n,delegates:{mousemove:function(i){var a=r.getLayer(e)?r.queryRenderedFeatures(i.point,{layers:[e]}):[];a.length?o||(o=!0,n.call(r,new Oi(t,r,i.originalEvent,{features:a}))):o=!1},mouseout:function(){o=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:n,delegates:{mousemove:function(i){(r.getLayer(e)?r.queryRenderedFeatures(i.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,n.call(r,new Oi(t,r,i.originalEvent)))},mouseout:function(e){a&&(a=!1,n.call(r,new Oi(t,r,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(i={},i[t]=function(t){var i=r.getLayer(e)?r.queryRenderedFeatures(t.point,{layers:[e]}):[];i.length&&(t.features=i,n.call(r,t),delete t.features)},i)}},r.prototype.on=function(t,e,n){if(void 0===n)return i.prototype.on.call(this,t,e);var r=this._createDelegatedListener(t,e,n);for(var o in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r),r.delegates)this.on(o,r.delegates[o]);return this},r.prototype.once=function(t,e,n){if(void 0===n)return i.prototype.once.call(this,t,e);var r=this._createDelegatedListener(t,e,n);for(var o in r.delegates)this.once(o,r.delegates[o]);return this},r.prototype.off=function(t,e,n){var r=this;return void 0===n?i.prototype.off.call(this,t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&function(i){for(var o=i[t],a=0;a<o.length;a++){var l=o[a];if(l.layer===e&&l.listener===n){for(var s in l.delegates)r.off(s,l.delegates[s]);return o.splice(a,1),r}}}(this._delegatedListeners),this)},r.prototype.queryRenderedFeatures=function(e,n){if(!this.style)return[];var i;if(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])i=[t.Point.convert(e)];else{var r=t.Point.convert(e[0]),o=t.Point.convert(e[1]);i=[r,new t.Point(o.x,r.y),o,new t.Point(r.x,o.y),r]}return this.style.queryRenderedFeatures(i,n,this.transform)},r.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},r.prototype.setStyle=function(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))},r.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},r.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new qe(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},r.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new qe(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},r.prototype._diffStyle=function(e,n){var i=this;if("string"==typeof e){var r=this._requestManager.normalizeStyleURL(e),o=this._requestManager.transformRequest(r,t.ResourceType.Style);t.getJSON(o,(function(e,r){e?i.fire(new t.ErrorEvent(e)):r&&i._updateDiff(r,n)}))}else"object"==typeof e&&this._updateDiff(e,n)},r.prototype._updateDiff=function(e,n){try{this.style.setState(e)&&this._update(!0)}catch(i){t.warnOnce("Unable to perform style diff: "+(i.message||i.error||i)+".  Rebuilding the style from scratch."),this._updateStyle(e,n)}},r.prototype.getStyle=function(){if(this.style)return this.style.serialize()},r.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},r.prototype.addSource=function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)},r.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},r.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var i in n){var r=n[i];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0},r.prototype.addSourceType=function(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)},r.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},r.prototype.getSource=function(t){return this.style.getSource(t)},r.prototype.addImage=function(e,n,i){void 0===i&&(i={});var r=i.pixelRatio;void 0===r&&(r=1);var o=i.sdf;void 0===o&&(o=!1);var a=i.stretchX,l=i.stretchY,s=i.content;if(this._lazyInitEmptyStyle(),n instanceof Cr||Sr&&n instanceof Sr){var u=t.browser.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:u.width,height:u.height},u.data),pixelRatio:r,stretchX:a,stretchY:l,content:s,sdf:o,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=n;this.style.addImage(e,{data:new t.RGBAImage({width:n.width,height:n.height},new Uint8Array(n.data)),pixelRatio:r,stretchX:a,stretchY:l,content:s,sdf:o,version:0,userImage:c}),c.onAdd&&c.onAdd(this,e)}},r.prototype.updateImage=function(e,n){var i=this.style.getImage(e);if(!i)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var r=n instanceof Cr||Sr&&n instanceof Sr?t.browser.getImageData(n):n,o=r.width,a=r.height,l=r.data;return void 0===o||void 0===a?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==i.data.width||a!==i.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(l,!(n instanceof Cr||Sr&&n instanceof Sr)),void this.style.updateImage(e,i))},r.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},r.prototype.removeImage=function(t){this.style.removeImage(t)},r.prototype.loadImage=function(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)},r.prototype.listImages=function(){return this.style.listImages()},r.prototype.addLayer=function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)},r.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},r.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},r.prototype.getLayer=function(t){return this.style.getLayer(t)},r.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)},r.prototype.setFilter=function(t,e,n){return void 0===n&&(n={}),this.style.setFilter(t,e,n),this._update(!0)},r.prototype.getFilter=function(t){return this.style.getFilter(t)},r.prototype.setPaintProperty=function(t,e,n,i){return void 0===i&&(i={}),this.style.setPaintProperty(t,e,n,i),this._update(!0)},r.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},r.prototype.setLayoutProperty=function(t,e,n,i){return void 0===i&&(i={}),this.style.setLayoutProperty(t,e,n,i),this._update(!0)},r.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},r.prototype.setLight=function(t,e){return void 0===e&&(e={}),this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)},r.prototype.getLight=function(){return this.style.getLight()},r.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},r.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},r.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},r.prototype.getContainer=function(){return this._container},r.prototype.getCanvasContainer=function(){return this._canvasContainer},r.prototype.getCanvas=function(){return this._canvas},r.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},r.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},r.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var r=this._controlContainer=n.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){o[t]=n.create("div","mapboxgl-ctrl-"+t,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)},r.prototype._resizeCanvas=function(e,n){var i=t.browser.devicePixelRatio||1;this._canvas.width=i*e,this._canvas.height=i*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},r.prototype._setupPainter=function(){var n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);i?(this.painter=new _i(i,this.transform),t.webpSupported.testSupport(i)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},r.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},r.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},r.prototype._onMapScroll=function(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},r.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},r.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},r.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},r.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},r.prototype._render=function(e){var n,i=this,r=0,o=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,n),r=t.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){var a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var l=this.transform.zoom,s=t.browser.now();this.style.zoomHistory.update(l,s);var u=new t.EvaluationParameters(l,{now:s,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();1===c&&c===this._crossFadingFactor||(a=!0,this._crossFadingFactor=c),this.style.update(u)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var p=t.browser.now()-r;o.endQueryEXT(o.TIME_ELAPSED_EXT,n),setTimeout((function(){var e=o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(n),i.fire(new t.Event("gpu-timing-frame",{cpuTime:p,gpuTime:e}))}),50)}if(this.listens("gpu-timing-layer")){var h=this.painter.collectGpuTimers();setTimeout((function(){var e=i.painter.queryGpuTimers(h);i.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}var d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0),this}},r.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,n=this._controls;e<n.length;e+=1)n[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),Pr(this._canvasContainer),Pr(this._controlContainer),Pr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new t.Event("remove"))},r.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame((function(t){e._frame=null,e._render(t)})))},r.prototype._onWindowOnline=function(){this._update()},r.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(t){this._showPadding!==t&&(this._showPadding=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},r.prototype._setCacheLimits=function(e,n){t.setCacheLimits(e,n)},o.version.get=function(){return t.version},Object.defineProperties(r.prototype,o),r}(yr);function Pr(t){t.parentNode&&t.parentNode.removeChild(t)}var Ar={showCompass:!0,showZoom:!0,visualizePitch:!1},Mr=function(e){var i=this;this.options=t.extend({},Ar,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(t){return i._map.zoomIn({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(t){return i._map.zoomOut({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(t){i.options.visualizePitch?i._map.resetNorthPitch({},{originalEvent:t}):i._map.resetNorth({},{originalEvent:t})})),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Mr.prototype._updateZoomButtons=function(){var t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Mr.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},Mr.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kr(this._map,this._compass,this.options.visualizePitch)),this._container},Mr.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Mr.prototype._createButton=function(t,e){var i=n.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i},Mr.prototype._setButtonTitle=function(t,e){var n=this._map._getUIString("NavigationControl."+e);t.title=n,t.setAttribute("aria-label",n)};var kr=function(e,i,r){void 0===r&&(r=!1),this._clickTolerance=10,this.element=i,this.mouseRotate=new Yi({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,r&&(this.mousePitch=new Xi({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(i,"mousedown",this.mousedown),n.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(i,"touchmove",this.touchmove),n.addEventListener(i,"touchend",this.touchend),n.addEventListener(i,"touchcancel",this.reset)};function Dr(e,n,i){if(e=new t.LngLat(e.lng,e.lat),n){var r=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=i.locationPoint(e).distSqr(n);i.locationPoint(r).distSqr(n)<a?e=r:i.locationPoint(o).distSqr(n)<a&&(e=o)}for(;Math.abs(e.lng-i.center.lng)>180;){var l=i.locationPoint(e);if(l.x>=0&&l.y>=0&&l.x<=i.width&&l.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e}kr.prototype.down=function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),n.disableDrag()},kr.prototype.move=function(t,e){var n=this.map,i=this.mouseRotate.mousemoveWindow(t,e);if(i&&i.bearingDelta&&n.setBearing(n.getBearing()+i.bearingDelta),this.mousePitch){var r=this.mousePitch.mousemoveWindow(t,e);r&&r.pitchDelta&&n.setPitch(n.getPitch()+r.pitchDelta)}},kr.prototype.off=function(){var t=this.element;n.removeEventListener(t,"mousedown",this.mousedown),n.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(t,"touchmove",this.touchmove),n.removeEventListener(t,"touchend",this.touchend),n.removeEventListener(t,"touchcancel",this.reset),this.offTemp()},kr.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(t.window,"mousemove",this.mousemove),n.removeEventListener(t.window,"mouseup",this.mouseup)},kr.prototype.mousedown=function(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:function(){return e.preventDefault()}}),n.mousePos(this.element,e)),n.addEventListener(t.window,"mousemove",this.mousemove),n.addEventListener(t.window,"mouseup",this.mouseup)},kr.prototype.mousemove=function(t){this.move(t,n.mousePos(this.element,t))},kr.prototype.mouseup=function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()},kr.prototype.touchstart=function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))},kr.prototype.touchmove=function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))},kr.prototype.touchend=function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},kr.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Lr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Or(t,e,n){var i=t.classList;for(var r in Lr)i.remove("mapboxgl-"+n+"-anchor-"+r);i.add("mapboxgl-"+n+"-anchor-"+e)}var Rr,zr=function(e){function i(i,r){if(e.call(this),(i instanceof t.window.HTMLElement||r)&&(i=t.extend({element:i},r)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&"auto"!==i.pitchAlignment?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=t.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var o=n.createNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","41px"),o.setAttributeNS(null,"width","27px"),o.setAttributeNS(null,"viewBox","0 0 27 41");var a=n.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");var l=n.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill-rule","nonzero");var s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");for(var u=0,c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];u<c.length;u+=1){var p=c[u],h=n.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",p.rx),h.setAttributeNS(null,"ry",p.ry),s.appendChild(h)}var d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var f=n.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(f);var m=n.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"fill","#000000");var g=n.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),m.appendChild(g);var v=n.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");var y=n.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _=n.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000"),_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962");var b=n.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#FFFFFF"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962"),y.appendChild(_),y.appendChild(b),l.appendChild(s),l.appendChild(d),l.appendChild(m),l.appendChild(v),l.appendChild(y),o.appendChild(l),o.setAttributeNS(null,"height",41*this._scale+"px"),o.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(o),this._offset=t.Point.convert(i&&i.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(t){t.preventDefault()})),this._element.addEventListener("mousedown",(function(t){t.preventDefault()})),Or(this._element,this._anchor,"marker"),this._popup=null}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},i.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},i.prototype.getElement=function(){return this._element},i.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},i.prototype._onKeyPress=function(t){var e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()},i.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},i.prototype.getPopup=function(){return this._popup},i.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},i.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Dr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,Lr[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+i+" "+e)}},i.prototype.getOffset=function(){return this._offset},i.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},i.prototype._onMove=function(e){if(!this._isDragging){var n=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=n}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))},i.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},i.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},i.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},i.prototype.isDraggable=function(){return this._draggable},i.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},i.prototype.getRotation=function(){return this._rotation},i.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},i.prototype.getRotationAlignment=function(){return this._rotationAlignment},i.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},i.prototype.getPitchAlignment=function(){return this._pitchAlignment},i}(t.Evented),Fr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Br=0,Nr=!1,Ur=function(e){function i(n){e.call(this),this.options=t.extend({},Fr,n),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.onAdd=function(e){var i;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==Rr?i(Rr):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((function(t){i(Rr="denied"!==t.state)})):i(Rr=!!t.window.navigator.geolocation),this._container},i.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Br=0,Nr=!1},i.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())},i.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},i.prototype._onSuccess=function(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}},i.prototype._updateCamera=function(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,r=this._map.getBearing(),o=t.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(i),o,{geolocateSource:!0})},i.prototype._updateMarker=function(e){if(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},i.prototype._updateCircleRadius=function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([1,t]),i=e.distanceTo(n),r=Math.ceil(2*this._accuracy/i);this._circleElement.style.width=r+"px",this._circleElement.style.height=r+"px"},i.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},i.prototype._onError=function(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Nr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}},i.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},i.prototype._setupUI=function(e){var i=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new zr(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==i._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(i._watchState="BACKGROUND",i._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),i._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),i.fire(new t.Event("trackuserlocationend")))}))},i.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Br--,Nr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Br>1?(e={maximumAge:6e5,timeout:0},Nr=!0):(e=this.options.positionOptions,Nr=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},i.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},i}(t.Evented),jr={maxWidth:100,unit:"metric"},Vr=function(e){this.options=t.extend({},jr,e),t.bindAll(["_onMove","setUnit"],this)};function qr(t,e,n){var i=n&&n.maxWidth||100,r=t._container.clientHeight/2,o=t.unproject([0,r]),a=t.unproject([i,r]),l=o.distanceTo(a);if(n&&"imperial"===n.unit){var s=3.2808*l;s>5280?Gr(e,i,s/5280,t._getUIString("ScaleControl.Miles")):Gr(e,i,s,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?Gr(e,i,l/1852,t._getUIString("ScaleControl.NauticalMiles")):l>=1e3?Gr(e,i,l/1e3,t._getUIString("ScaleControl.Kilometers")):Gr(e,i,l,t._getUIString("ScaleControl.Meters"))}function Gr(t,e,n,i){var r,o,a,l=(r=n,(o=Math.pow(10,(""+Math.floor(r)).length-1))*(a=(a=r/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(a)));t.style.width=e*(l/n)+"px",t.innerHTML=l+"&nbsp;"+i}Vr.prototype.getDefaultPosition=function(){return"bottom-left"},Vr.prototype._onMove=function(){qr(this._map,this._container,this.options)},Vr.prototype.onAdd=function(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vr.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vr.prototype.setUnit=function(t){this.options.unit=t,qr(this._map,this._container,this.options)};var Zr=function(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange")};Zr.prototype.onAdd=function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Zr.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Zr.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},Zr.prototype._setupUI=function(){var e=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Zr.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},Zr.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Zr.prototype._isFullscreen=function(){return this._fullscreen},Zr.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Zr.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Hr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Yr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Xr=function(e){function i(n){e.call(this),this.options=t.extend(Object.create(Hr),n),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.addTo=function(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this},i.prototype.isOpen=function(){return!!this._map},i.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},i.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},i.prototype.getElement=function(){return this._container},i.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},i.prototype.setHTML=function(e){var n,i=t.window.document.createDocumentFragment(),r=t.window.document.createElement("body");for(r.innerHTML=e;n=r.firstChild;)i.appendChild(n);return this.setDOMContent(i)},i.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},i.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},i.prototype.setDOMContent=function(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=n.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this},i.prototype.addClassName=function(t){this._container&&this._container.classList.add(t)},i.prototype.removeClassName=function(t){this._container&&this._container.classList.remove(t)},i.prototype.setOffset=function(t){return this.options.offset=t,this._update(),this},i.prototype.toggleClassName=function(t){if(this._container)return this._container.classList.toggle(t)},i.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},i.prototype._onMouseUp=function(t){this._update(t.point)},i.prototype._onMouseMove=function(t){this._update(t.point)},i.prototype._onDrag=function(t){this._update(t.point)},i.prototype._update=function(e){var i=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return i._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Dr(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var r=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),o=this.options.anchor,a=function e(n){if(n){if("number"==typeof n){var i=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.Point(0,0),top:new t.Point(0,n),"top-left":new t.Point(i,i),"top-right":new t.Point(-i,i),bottom:new t.Point(0,-n),"bottom-left":new t.Point(i,-i),"bottom-right":new t.Point(-i,-i),left:new t.Point(n,0),right:new t.Point(-n,0)}}if(n instanceof t.Point||Array.isArray(n)){var r=t.Point.convert(n);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.Point.convert(n.center||[0,0]),top:t.Point.convert(n.top||[0,0]),"top-left":t.Point.convert(n["top-left"]||[0,0]),"top-right":t.Point.convert(n["top-right"]||[0,0]),bottom:t.Point.convert(n.bottom||[0,0]),"bottom-left":t.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(n["bottom-right"]||[0,0]),left:t.Point.convert(n.left||[0,0]),right:t.Point.convert(n.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!o){var l,s=this._container.offsetWidth,u=this._container.offsetHeight;l=r.y+a.bottom.y<u?["top"]:r.y>this._map.transform.height-u?["bottom"]:[],r.x<s/2?l.push("left"):r.x>this._map.transform.width-s/2&&l.push("right"),o=0===l.length?"bottom":l.join("-")}var c=r.add(a[o]).round();n.setTransform(this._container,Lr[o]+" translate("+c.x+"px,"+c.y+"px)"),Or(this._container,o,"popup")}},i.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var t=this._container.querySelector(Yr);t&&t.focus()}},i.prototype._onClose=function(){this.remove()},i}(t.Evented),Wr={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:Ir,NavigationControl:Mr,GeolocateControl:Ur,AttributionControl:_r,ScaleControl:Vr,FullscreenControl:Zr,Popup:Xr,Marker:zr,Style:qe,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,prewarm:function(){Bt().acquire(Ot)},clearPrewarmedResources:function(){var t=zt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Ot),zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Rt.workerCount},set workerCount(t){Rt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:""};return Wr})),n}()},"4b23":function(t,e,n){for(var i=self.crypto||self.msCrypto,r="-_",o=36;o--;)r+=o.toString(36);for(o=36;o---10;)r+=o.toString(36).toUpperCase();t.exports=function(t){var e="",n=i.getRandomValues(new Uint8Array(t||21));for(o=t||21;o--;)e+=r[63&n[o]];return e}},"5K5J":function(t,e,n){var i,r;i=this,r=function(){var t=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function e(e){return e.match(t)||[]}function n(t){return{language:(t=e(t))[1]||"",extlang:t[2]||"",script:t[3]||"",region:t[4]||""}}function i(t,e,n){Object.defineProperty(t,e,{value:n,enumerable:!0})}function r(t,r,o){function a(n){return e(n)[t]||""}i(a,"pattern",r),i(n,o,a)}return r(1,/^[a-zA-Z]{2,3}$/,"language"),r(2,/^[a-zA-Z]{3}$/,"extlang"),r(3,/^[a-zA-Z]{4}$/,"script"),r(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),i(n,"split",(function(t){return e(t).filter((function(t,e){return t&&e}))})),n},t.exports?t.exports=r():i.subtag=r()},"6C0F":function(t,e,n){const i=n("FxjX"),r=n("uI0s"),o=n("GHAK"),a=n("GRlr"),l=n("hyT3"),s={onSetup:function(){const t=this.newFeature({type:o.geojsonTypes.FEATURE,properties:{},geometry:{type:o.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),r.disable(this),this.updateUIClasses({mouse:o.cursors.ADD}),this.activateUIButton(o.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&a(e,t.polygon.coordinates[0][t.currentVertexPosition-1]))return this.changeMode(o.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]});this.updateUIClasses({mouse:o.cursors.ADD}),t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),t.currentVertexPosition++,t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(o.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},onMouseMove:function(t,e){t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),i.isVertex(e)&&this.updateUIClasses({mouse:o.cursors.POINTER})}};s.onTap=s.onClick=function(t,e){return i.isVertex(e)?this.clickOnVertex(t,e):this.clickAnywhere(t,e)},s.onKeyUp=function(t,e){i.isEscapeKey(e)?(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(o.modes.SIMPLE_SELECT)):i.isEnterKey(e)&&this.changeMode(o.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},s.onStop=function(t){this.updateUIClasses({mouse:o.cursors.NONE}),r.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.polygon.id)&&(t.polygon.removeCoordinate("0."+t.currentVertexPosition),t.polygon.isValid()?this.map.fire(o.events.CREATE,{features:[t.polygon.toGeoJSON()]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(o.modes.SIMPLE_SELECT,{},{silent:!0})))},s.toDisplayFeatures=function(t,e,n){const i=e.properties.id===t.polygon.id;if(e.properties.active=i?o.activeStates.ACTIVE:o.activeStates.INACTIVE,!i)return n(e);if(0===e.geometry.coordinates.length)return;const r=e.geometry.coordinates[0].length;if(!(r<3)){if(e.properties.meta=o.meta.FEATURE,n(l(t.polygon.id,e.geometry.coordinates[0][0],"0.0",!1)),r>3){const i=e.geometry.coordinates[0].length-3;n(l(t.polygon.id,e.geometry.coordinates[0][i],"0."+i,!1))}if(r<=4){const t=[[e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][1]],[e.geometry.coordinates[0][1][0],e.geometry.coordinates[0][1][1]]];if(n({type:o.geojsonTypes.FEATURE,properties:e.properties,geometry:{coordinates:t,type:o.geojsonTypes.LINE_STRING}}),3===r)return}return n(e)}},s.onTrash=function(t){this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(o.modes.SIMPLE_SELECT)},t.exports=s},"6JyC":function(t,e){t.exports=function(t,e){const n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},i={on:function(t,e,i){if(void 0===n[t])throw new Error("Invalid event type: "+t);n[t].push({selector:e,fn:i})},render:function(t){e.store.featureChanged(t)}},r=function(t,r){const o=n[t];let a=o.length;for(;a--;){const t=o[a];if(t.selector(r)){t.fn.call(i,r),e.store.render(),e.ui.updateMapClasses();break}}};return t.start.call(i),{render:t.render,stop:function(){t.stop&&t.stop()},trash:function(){t.trash&&(t.trash(),e.store.render())},combineFeatures:function(){t.combineFeatures&&t.combineFeatures()},uncombineFeatures:function(){t.uncombineFeatures&&t.uncombineFeatures()},drag:function(t){r("drag",t)},click:function(t){r("click",t)},mousemove:function(t){r("mousemove",t)},mousedown:function(t){r("mousedown",t)},mouseup:function(t){r("mouseup",t)},mouseout:function(t){r("mouseout",t)},keydown:function(t){r("keydown",t)},keyup:function(t){r("keyup",t)},touchstart:function(t){r("touchstart",t)},touchmove:function(t){r("touchmove",t)},touchend:function(t){r("touchend",t)},tap:function(t){r("tap",t)}}}},"73jG":function(t,e,n){"use strict";var i=n("jLWS");t.exports=function(t){var e,n=t.type||i.ERROR_HTTP;if(t.body)try{e=JSON.parse(t.body)}catch(o){e=t.body}else e=null;var r=t.message||null;r||("string"==typeof e?r=e:e&&"string"==typeof e.message?r=e.message:n===i.ERROR_REQUEST_ABORTED&&(r="Request aborted")),this.message=r,this.type=n,this.statusCode=t.statusCode||null,this.request=t.request,this.body=e}},"7VZy":function(t,e,n){const i=n("FxjX"),r=n("GHAK"),o={onSetup:function(){const t=this.newFeature({type:r.geojsonTypes.FEATURE,properties:{},geometry:{type:r.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:r.cursors.ADD}),this.activateUIButton(r.types.POINT),this.setActionableState({trash:!0}),{point:t}},stopDrawingAndRemove:function(t){this.deleteFeature([t.point.id],{silent:!0}),this.changeMode(r.modes.SIMPLE_SELECT)}};o.onTap=o.onClick=function(t,e){this.updateUIClasses({mouse:r.cursors.MOVE}),t.point.updateCoordinate("",e.lngLat.lng,e.lngLat.lat),this.map.fire(r.events.CREATE,{features:[t.point.toGeoJSON()]}),this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[t.point.id]})},o.onStop=function(t){this.activateUIButton(),t.point.getCoordinate().length||this.deleteFeature([t.point.id],{silent:!0})},o.toDisplayFeatures=function(t,e,n){const i=e.properties.id===t.point.id;if(e.properties.active=i?r.activeStates.ACTIVE:r.activeStates.INACTIVE,!i)return n(e)},o.onTrash=o.stopDrawingAndRemove,o.onKeyUp=function(t,e){if(i.isEscapeKey(e)||i.isEnterKey(e))return this.stopDrawingAndRemove(t,e)},t.exports=o},8:function(t,e){},"9/5/":function(t,e){var n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt,l="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,u=l||s||Function("return this")(),c=Object.prototype.toString,p=Math.max,h=Math.min,d=function(){return u.Date.now()};function f(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function m(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==c.call(t)}(t))return NaN;if(f(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=f(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(n,"");var l=r.test(t);return l||o.test(t)?a(t.slice(2),l?2:8):i.test(t)?NaN:+t}t.exports=function(t,e,n){var i,r,o,a,l,s,u=0,c=!1,g=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var n=i,o=r;return i=r=void 0,u=e,a=t.apply(o,n)}function _(t){return u=t,l=setTimeout(x,e),c?y(t):a}function b(t){var n=t-s;return void 0===s||n>=e||n<0||g&&t-u>=o}function x(){var t=d();if(b(t))return w(t);l=setTimeout(x,function(t){var n=e-(t-s);return g?h(n,o-(t-u)):n}(t))}function w(t){return l=void 0,v&&i?y(t):(i=r=void 0,a)}function C(){var t=d(),n=b(t);if(i=arguments,r=this,s=t,n){if(void 0===l)return _(s);if(g)return l=setTimeout(x,e),y(s)}return void 0===l&&(l=setTimeout(x,e)),a}return e=m(e)||0,f(n)&&(c=!!n.leading,o=(g="maxWait"in n)?p(m(n.maxWait)||0,e):o,v="trailing"in n?!!n.trailing:v),C.cancel=function(){void 0!==l&&clearTimeout(l),u=0,i=s=r=l=void 0},C.flush=function(){return void 0===l?a:w(d())},C}},AGgr:function(t,e){t.exports=function(t,e){const n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},AojJ:function(t,e,n){const i=n("muZk"),r=n("GHAK");t.exports=function(t,e){const n=i.click(t,null,e),o={mouse:r.cursors.NONE};return n[0]&&(o.mouse=n[0].properties.active===r.activeStates.ACTIVE?r.cursors.MOVE:r.cursors.POINTER,o.feature=n[0].properties.meta),-1!==e.events.currentModeName().indexOf("draw")&&(o.mouse=r.cursors.ADD),e.ui.queueMapClasses(o),e.ui.updateMapClasses(),n[0]}},AxvH:function(t,e,n){"use strict";t.exports=function(t){return t?t.split(/,\s*</).reduce((function(t,e){var n=function(t){var e=t.match(/<?([^>]*)>(.*)/);if(!e)return null;var n=e[1],i=e[2].split(";"),r=null,o=i.reduce((function(t,e){var n=function(t){var e=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return e?{key:e[1],value:e[2]}:null}(e);return n?"rel"===n.key?(r||(r=n.value),t):(t[n.key]=n.value,t):t}),{});return r?{url:n,rel:r,params:o}:null}(e);return n?(n.rel.split(/\s+/).forEach((function(e){t[e]||(t[e]={url:n.url,params:n.params})})),t):t}),{}):{}}},Bi8L:function(t,e,n){"use strict";var i=n("R/WN");t.exports=i,"undefined"!=typeof window&&(window.Suggestions=i)},CI1V:function(t,e){t.exports=function t(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce((function(e,n){return e.concat(t(n))}),[]),e;case"Feature":return e.geometry?t(e.geometry).map((function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return void 0!==e.id&&(n.id=e.id),n})):e;case"MultiPoint":return e.coordinates.map((function(t){return{type:"Point",coordinates:t}}));case"MultiPolygon":return e.coordinates.map((function(t){return{type:"Polygon",coordinates:t}}));case"MultiLineString":return e.coordinates.map((function(t){return{type:"LineString",coordinates:t}}));case"GeometryCollection":return e.geometries.map(t).reduce((function(t,e){return t.concat(e)}),[]);case"Point":case"Polygon":case"LineString":return[e]}}},Cu2R:function(t,e,n){"use strict";var i=n("ncV3"),r=n("KXza");t.exports=function(t){return function(e){var n;n=i.prototype.isPrototypeOf(e)?e:r(e);var o=Object.create(t);return o.client=n,o}}},D9nX:function(t,e,n){const i=n("f4Td"),r=n("GHAK"),o=n("VbFZ"),a={MultiPoint:n("EhmD"),MultiLineString:n("2PSg"),MultiPolygon:n("4Qsb")},l=(t,e,n,i,r)=>{const o=n.split("."),a=parseInt(o[0],10),l=o[1]?o.slice(1).join("."):null;return t[a][e](l,i,r)},s=function(t,e){if(i.call(this,t,e),delete this.coordinates,this.model=a[e.geometry.type],void 0===this.model)throw new TypeError(e.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(e.geometry.coordinates)};s.prototype=Object.create(i.prototype),s.prototype._coordinatesToFeatures=function(t){const e=this.model.bind(this);return t.map(t=>new e(this.ctx,{id:o(),type:r.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:t,type:this.type.replace("Multi","")}}))},s.prototype.isValid=function(){return this.features.every(t=>t.isValid())},s.prototype.setCoordinates=function(t){this.features=this._coordinatesToFeatures(t),this.changed()},s.prototype.getCoordinate=function(t){return l(this.features,"getCoordinate",t)},s.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(t=>t.type===r.geojsonTypes.POLYGON?t.getCoordinates():t.coordinates)))},s.prototype.updateCoordinate=function(t,e,n){l(this.features,"updateCoordinate",t,e,n),this.changed()},s.prototype.addCoordinate=function(t,e,n){l(this.features,"addCoordinate",t,e,n),this.changed()},s.prototype.removeCoordinate=function(t){l(this.features,"removeCoordinate",t),this.changed()},s.prototype.getFeatures=function(){return this.features},t.exports=s},DZyk:function(t,e,n){const i=n("rmaQ"),r=n("xykm"),o=n("djHk"),a=n("GHAK"),l=n("U6jy");t.exports=function(t){let e=null,n=null;const s={onRemove:function(){return t.map.off("load",s.connect),clearInterval(n),s.removeLayers(),t.store.restoreMapConfig(),t.ui.removeButtons(),t.events.removeEventListeners(),t.ui.clearMapClasses(),t.map=null,t.container=null,t.store=null,e&&e.parentNode&&e.parentNode.removeChild(e),e=null,this},connect:function(){t.map.off("load",s.connect),clearInterval(n),s.addLayers(),t.store.storeMapConfig(),t.events.addEventListeners()},onAdd:function(a){{const t=a.fire;a.fire=function(e,n){let i=arguments;return 1===t.length&&1!==arguments.length&&(i=[l({},{type:e},n)]),t.apply(a,i)}}return t.map=a,t.events=i(t),t.ui=o(t),t.container=a.getContainer(),t.store=new r(t),e=t.ui.addButtons(),t.options.boxSelect&&(a.boxZoom.disable(),a.dragPan.disable(),a.dragPan.enable()),a.loaded()?s.connect():(a.on("load",s.connect),n=setInterval(()=>{a.loaded()&&s.connect()},16)),t.events.start(),e},addLayers:function(){t.map.addSource(a.sources.COLD,{data:{type:a.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.map.addSource(a.sources.HOT,{data:{type:a.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.options.styles.forEach(e=>{t.map.addLayer(e)}),t.store.setDirty(!0),t.store.render()},removeLayers:function(){t.options.styles.forEach(e=>{t.map.getLayer(e.id)&&t.map.removeLayer(e.id)}),t.map.getSource(a.sources.COLD)&&t.map.removeSource(a.sources.COLD),t.map.getSource(a.sources.HOT)&&t.map.removeSource(a.sources.HOT)}};return t.setup=s,s}},"EX2/":function(t,e,n){const i=n("DZyk"),r=n("yDy9"),o=n("Ft5u"),a=n("GHAK");t.exports=function(t){!function(t,e){const n={options:t=r(t)};e=o(n,e),n.api=e;const l=i(n);e.onAdd=l.onAdd,e.onRemove=l.onRemove,e.types=a.types,e.options=t}(t,this)},t.exports.modes=n("vMx6")},EZ5H:function(t,e,n){const i=n("EX2/"),r=n("GHAK"),o=n("uI0s"),a=n("NDak"),l=n("k+DL").default,s=n("Qidy").default,u=n("0wsv"),c={...i.modes.draw_polygon};c.onSetup=function(t){const e=this.newFeature({type:r.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:r.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),o.disable(this),a.disable(this),this.updateUIClasses({mouse:r.cursors.ADD}),this.activateUIButton(r.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},c.onMouseDown=c.onTouchStart=function(t,e){0===t.polygon.properties.center.length&&(t.polygon.properties.center=[e.lngLat.lng,e.lngLat.lat])},c.onDrag=c.onMouseMove=function(t,e){const n=t.polygon.properties.center;if(n.length>0){const i=s(u.point(n),u.point([e.lngLat.lng,e.lngLat.lat]),{units:"kilometers"}),r=l(n,i);t.polygon.incomingCoords(r.geometry.coordinates),t.polygon.properties.radiusInKm=i}},c.onMouseUp=c.onTouchEnd=function(t,e){return a.enable(this),this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},c.onClick=c.onTap=function(t,e){t.polygon.properties.center=[]},c.toDisplayFeatures=function(t,e,n){const i=e.properties.id===t.polygon.id;return e.properties.active=i?r.activeStates.ACTIVE:r.activeStates.INACTIVE,n(e)},t.exports=c},EhmD:function(t,e,n){const i=n("f4Td"),r=function(t,e){i.call(this,t,e)};r.prototype=Object.create(i.prototype),r.prototype.isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},r.prototype.updateCoordinate=function(t,e,n){3===arguments.length?this.coordinates=[e,n]:this.coordinates=[t,e],this.changed()},r.prototype.getCoordinate=function(){return this.getCoordinates()},t.exports=r},Ek1X:function(t,e){t.exports=function(t,e=0){return[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]}},Ft5u:function(t,e,n){const i=n("XaGS"),r=n("lJFB"),o=n("VbFZ"),a=n("muZk"),l=n("kHz5"),s=n("qKyw"),u=n("GHAK"),c=n("RXCC"),p={Polygon:n("4Qsb"),LineString:n("2PSg"),Point:n("EhmD"),MultiPolygon:n("D9nX"),MultiLineString:n("D9nX"),MultiPoint:n("D9nX")};t.exports=function(t,e){return e.modes=u.modes,e.getFeatureIdsAt=function(e){return a.click({point:e},null,t).map(t=>t.properties.id)},e.getSelectedIds=function(){return t.store.getSelectedIds()},e.getSelected=function(){return{type:u.geojsonTypes.FEATURE_COLLECTION,features:t.store.getSelectedIds().map(e=>t.store.get(e)).map(t=>t.toGeoJSON())}},e.getSelectedPoints=function(){return{type:u.geojsonTypes.FEATURE_COLLECTION,features:t.store.getSelectedCoordinates().map(t=>({type:u.geojsonTypes.FEATURE,properties:{},geometry:{type:u.geojsonTypes.POINT,coordinates:t.coordinates}}))}},e.set=function(n){if(void 0===n.type||n.type!==u.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(n.features))throw new Error("Invalid FeatureCollection");const i=t.store.createRenderBatch();let r=t.store.getAllIds().slice();const o=e.add(n),a=new c(o);return r=r.filter(t=>!a.has(t)),r.length&&e.delete(r),i(),o},e.add=function(e){const n=s.hint(e,{precisionWarning:!1}).filter(t=>"message"!==t.level);if(n.length)throw new Error(n[0].message);const a=JSON.parse(JSON.stringify(r(e))).features.map(e=>{if(e.id=e.id||o(),null===e.geometry)throw new Error("Invalid geometry: null");if(void 0===t.store.get(e.id)||t.store.get(e.id).type!==e.geometry.type){const n=p[e.geometry.type];if(void 0===n)throw new Error(`Invalid geometry type: ${e.geometry.type}.`);const i=new n(t,e);t.store.add(i)}else{const n=t.store.get(e.id);n.properties=e.properties,i(n.getCoordinates(),e.geometry.coordinates)||n.incomingCoords(e.geometry.coordinates)}return e.id});return t.store.render(),a},e.get=function(e){const n=t.store.get(e);if(n)return n.toGeoJSON()},e.getAll=function(){return{type:u.geojsonTypes.FEATURE_COLLECTION,features:t.store.getAll().map(t=>t.toGeoJSON())}},e.delete=function(n){return t.store.delete(n,{silent:!0}),e.getMode()!==u.modes.DIRECT_SELECT||t.store.getSelectedIds().length?t.store.render():t.events.changeMode(u.modes.SIMPLE_SELECT,void 0,{silent:!0}),e},e.deleteAll=function(){return t.store.delete(t.store.getAllIds(),{silent:!0}),e.getMode()===u.modes.DIRECT_SELECT?t.events.changeMode(u.modes.SIMPLE_SELECT,void 0,{silent:!0}):t.store.render(),e},e.changeMode=function(n,i={}){return n===u.modes.SIMPLE_SELECT&&e.getMode()===u.modes.SIMPLE_SELECT?(l(i.featureIds||[],t.store.getSelectedIds())||(t.store.setSelected(i.featureIds,{silent:!0}),t.store.render()),e):(n===u.modes.DIRECT_SELECT&&e.getMode()===u.modes.DIRECT_SELECT&&i.featureId===t.store.getSelectedIds()[0]||t.events.changeMode(n,i,{silent:!0}),e)},e.getMode=function(){return t.events.getMode()},e.trash=function(){return t.events.trash({silent:!0}),e},e.combineFeatures=function(){return t.events.combineFeatures({silent:!0}),e},e.uncombineFeatures=function(){return t.events.uncombineFeatures({silent:!0}),e},e.setFeatureProperty=function(n,i,r){return t.store.setFeatureProperty(n,i,r),e},e}},FxjX:function(t,e,n){const i=n("GHAK");t.exports={isOfMetaType:function(t){return function(e){const n=e.featureTarget;return!!n&&(!!n.properties&&n.properties.meta===t)}},isShiftMousedown:function(t){return!!t.originalEvent&&(!!t.originalEvent.shiftKey&&0===t.originalEvent.button)},isActiveFeature:function(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&(t.featureTarget.properties.active===i.activeStates.ACTIVE&&t.featureTarget.properties.meta===i.meta.FEATURE))},isInactiveFeature:function(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&(t.featureTarget.properties.active===i.activeStates.INACTIVE&&t.featureTarget.properties.meta===i.meta.FEATURE))},noTarget:function(t){return void 0===t.featureTarget},isFeature:function(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&t.featureTarget.properties.meta===i.meta.FEATURE)},isVertex:function(t){const e=t.featureTarget;return!!e&&(!!e.properties&&e.properties.meta===i.meta.VERTEX)},isShiftDown:function(t){return!!t.originalEvent&&!0===t.originalEvent.shiftKey},isEscapeKey:function(t){return 27===t.keyCode},isEnterKey:function(t){return 13===t.keyCode},true:function(){return!0}}},GHAK:function(t,e){t.exports={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}},GRlr:function(t,e){t.exports=function(t,e){return!!t.lngLat&&(t.lngLat.lng===e[0]&&t.lngLat.lat===e[1])}},IH3z:function(t,e,n){const i=n("EX2/"),r=n("/Jvy"),o=n("n8Y1"),a=n("GHAK"),l=n("2j5T"),s=n("Qidy").default,u=n("0wsv"),c=n("k+DL").default,p=n("rtvZ"),h=i.modes.direct_select;h.dragFeature=function(t,e,n){o(this.getSelected(),n),this.getSelected().filter(t=>t.properties.isCircle).map(t=>t.properties.center).forEach(t=>{t[0]+=n.lng,t[1]+=n.lat}),t.dragMoveLocation=e.lngLat},h.dragVertex=function(t,e,n){if(t.feature.properties.isCircle){const n=t.feature.properties.center,i=[e.lngLat.lng,e.lngLat.lat],r=s(u.point(n),u.point(i),{units:"kilometers"}),o=c(n,r);t.feature.incomingCoords(o.geometry.coordinates),t.feature.properties.radiusInKm=r}else{const e=t.selectedCoordPaths.map(e=>t.feature.getCoordinate(e)),i=e.map(t=>({type:a.geojsonTypes.FEATURE,properties:{},geometry:{type:a.geojsonTypes.POINT,coordinates:t}})),r=l(i,n);for(let n=0;n<e.length;n++){const i=e[n];t.feature.updateCoordinate(t.selectedCoordPaths[n],i[0]+r.lng,i[1]+r.lat)}}},h.toDisplayFeatures=function(t,e,n){if(t.featureId===e.properties.id){e.properties.active=a.activeStates.ACTIVE,n(e);(e.properties.user_isCircle?p(e):r(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths})).forEach(n)}else e.properties.active=a.activeStates.INACTIVE,n(e);this.fireActionable(t)},t.exports=h},Iab2:function(t,e,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){"use strict";function e(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){a(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,o=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(t,o,a){var l=r.URL||r.webkitURL,s=document.createElement("a");o=o||t.name||"download",s.download=o,s.rel="noopener","string"==typeof t?(s.href=t,s.origin===location.origin?i(s):n(s.href)?e(t,o,a):i(s,s.target="_blank")):(s.href=l.createObjectURL(t),setTimeout((function(){l.revokeObjectURL(s.href)}),4e4),setTimeout((function(){i(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,r,o){if(r=r||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,o),r);else if(n(t))e(t,r,o);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){i(a)}))}}:function(t,n,i,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,i);var l="application/octet-stream"===t.type,s=/constructor/i.test(r.HTMLElement)||r.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||l&&s||o)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=t:location=t,a=null},c.readAsDataURL(t)}else{var p=r.URL||r.webkitURL,h=p.createObjectURL(t);a?a.location=h:location.href=h,a=null,setTimeout((function(){p.revokeObjectURL(h)}),4e4)}});r.saveAs=a.saveAs=a,t.exports=a})?i.apply(e,r):i)||(t.exports=o)},KKCa:function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},KXza:function(t,e,n){"use strict";var i=n("oGbY"),r=n("ncV3");function o(t){r.call(this,t)}o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.sendRequest=i.browserSend,o.prototype.abortRequest=i.browserAbort,t.exports=function(t){return new o(t)}},"Ki6+":function(t,e,n){const i=n("AGgr");t.exports=function(t,e,n={}){const r=null!=n.fineTolerance?n.fineTolerance:4,o=null!=n.grossTolerance?n.grossTolerance:12,a=null!=n.interval?n.interval:500;t.point=t.point||e.point,t.time=t.time||e.time;const l=i(t.point,e.point);return l<r||l<o&&e.time-t.time<a}},KtRk:function(t,e,n){"use strict";var i=n("U6jy"),r=n("pit/");t.exports=i(r,{file:function(t){if("undefined"!=typeof window){if(t instanceof global.Blob||t instanceof global.ArrayBuffer)return;return"Blob or ArrayBuffer"}if("string"!=typeof t&&void 0===t.pipe)return"Filename or Readable stream"},date:function(t){if("boolean"==typeof t)return"date";try{var e=new Date(t);if(e.getTime&&isNaN(e.getTime()))return"date"}catch(n){return"date"}},coordinates:function(t){return r.tuple(r.number,r.number)(t)},assertShape:function(t,e){return r.assert(r.strictShape(t),e)}})},LFDd:function(t,e,n){"use strict";var i=n("U6jy"),r=n("KtRk"),o=n("baNz"),a=n("eFQn"),l=n("Cu2R"),s={},u=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];s.forwardGeocode=function(t){r.assertShape({query:r.required(r.string),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),proximity:r.oneOf(r.coordinates,"ip"),types:r.arrayOf(r.oneOf(u)),autocomplete:r.boolean,bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),routing:r.boolean,fuzzyMatch:r.boolean,worldview:r.string})(t),t.mode=t.mode||"mapbox.places";var e=a(i({country:t.countries},o(t,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:o(t,["mode","query"]),query:e})},s.reverseGeocode=function(t){r.assertShape({query:r.required(r.coordinates),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),types:r.arrayOf(r.oneOf(u)),bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),reverseMode:r.oneOf("distance","score"),routing:r.boolean,worldview:r.string})(t),t.mode=t.mode||"mapbox.places";var e=a(i({country:t.countries},o(t,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:o(t,["mode","query"]),query:e})},t.exports=l(s)},LXM9:function(t,e,n){const i=n("1+09"),r={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},o=Object.keys(r);t.exports=function(t){const e=Object.keys(t);return function(n,a={}){let l={};const s=e.reduce((e,n)=>(e[n]=t[n],e),new i(n));return{start:function(){l=s.onSetup(a),o.forEach(e=>{const n=r[e];let i=()=>!1;var o;t[n]&&(i=()=>!0),this.on(e,i,(o=n,function(t){s[o](l,t)}))})},stop:function(){s.onStop(l)},trash:function(){s.onTrash(l)},combineFeatures:function(){s.onCombineFeatures(l)},uncombineFeatures:function(){s.onUncombineFeatures(l)},render:function(t,e){s.toDisplayFeatures(l,t,e)}}}}},MCLT:function(t,e,n){var i=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,l=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}})),s=r[n];n<o;s=r[++n])f(s)||!_(s)?l+=" "+s:l+=" "+a(s);return l},e.deprecate=function(t,n){if(v(global.process))return function(){return e.deprecate(t,n).apply(this,arguments)};if(!0===process.noDeprecation)return t;var i=!1;return function(){if(!i){if(process.throwDeprecation)throw new Error(n);process.traceDeprecation?console.trace(n):console.error(n),i=!0}return t.apply(this,arguments)}};var r,o={};function a(t,n){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),d(n)?i.showHidden=n:n&&e._extend(i,n),v(i.showHidden)&&(i.showHidden=!1),v(i.depth)&&(i.depth=2),v(i.colors)&&(i.colors=!1),v(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),u(i,t,i.depth)}function l(t,e){var n=a.styles[e];return n?"\x1b["+a.colors[n][0]+"m"+t+"\x1b["+a.colors[n][1]+"m":t}function s(t,e){return t}function u(t,n,i){if(t.customInspect&&n&&w(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,t);return g(r)||(r=u(t,r,i)),r}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(m(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(f(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),l=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),x(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(n);if(0===a.length){if(w(n)){var s=n.name?": "+n.name:"";return t.stylize("[Function"+s+"]","special")}if(y(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(b(n))return t.stylize(Date.prototype.toString.call(n),"date");if(x(n))return c(n)}var _,C="",E=!1,S=["{","}"];(h(n)&&(E=!0,S=["[","]"]),w(n))&&(C=" [Function"+(n.name?": "+n.name:"")+"]");return y(n)&&(C=" "+RegExp.prototype.toString.call(n)),b(n)&&(C=" "+Date.prototype.toUTCString.call(n)),x(n)&&(C=" "+c(n)),0!==a.length||E&&0!=n.length?i<0?y(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),_=E?function(t,e,n,i,r){for(var o=[],a=0,l=e.length;a<l;++a)I(e,String(a))?o.push(p(t,e,n,i,String(a),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(p(t,e,n,i,r,!0))})),o}(t,n,i,l,a):a.map((function(e){return p(t,n,i,l,e,E)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(_,C,S)):S[0]+C+S[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,i,r,o){var a,l,s;if((s=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?l=s.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):s.set&&(l=t.stylize("[Setter]","special")),I(i,r)||(a="["+r+"]"),l||(t.seen.indexOf(s.value)<0?(l=f(n)?u(t,s.value,null):u(t,s.value,n-1)).indexOf("\n")>-1&&(l=o?l.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+l.split("\n").map((function(t){return"   "+t})).join("\n")):l=t.stylize("[Circular]","special")),v(a)){if(o&&r.match(/^\d+$/))return l;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+l}function h(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function f(t){return null===t}function m(t){return"number"==typeof t}function g(t){return"string"==typeof t}function v(t){return void 0===t}function y(t){return _(t)&&"[object RegExp]"===C(t)}function _(t){return"object"==typeof t&&null!==t}function b(t){return _(t)&&"[object Date]"===C(t)}function x(t){return _(t)&&("[object Error]"===C(t)||t instanceof Error)}function w(t){return"function"==typeof t}function C(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(v(r)&&(r=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(r)){var n=process.pid;o[t]=function(){var i=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,i)}}else o[t]=function(){};return o[t]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=d,e.isNull=f,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=y,e.isObject=_,e.isDate=b,e.isError=x,e.isFunction=w,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n("1gqn");var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),S[t.getMonth()],e].join(" ")}function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",T(),e.format.apply(e,arguments))},e.inherits=n("KKCa"),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}},NDak:function(t,e){t.exports={enable(t){setTimeout(()=>{t.map&&t.map.dragPan&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("dragPan")&&t.map.dragPan.enable()},0)},disable(t){setTimeout(()=>{t.map&&t.map.doubleClickZoom&&t.map.dragPan.disable()},0)}}},"NW+h":function(t,e){t.exports=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}]},"NkL+":function(t,e,n){"use strict";var i=Object.prototype.toString;t.exports=function(t){var e;return"[object Object]"===i.call(t)&&(null===(e=Object.getPrototypeOf(t))||e===Object.getPrototypeOf({}))}},Oh0o:function(t,e,n){const i=n("mhV4"),r=n("GHAK"),o={Point:0,LineString:1,Polygon:2};function a(t,e){const n=o[t.geometry.type]-o[e.geometry.type];return 0===n&&t.geometry.type===r.geojsonTypes.POLYGON?t.area-e.area:n}t.exports=function(t){return t.map(t=>(t.geometry.type===r.geojsonTypes.POLYGON&&(t.area=i.geometry({type:r.geojsonTypes.FEATURE,property:{},geometry:t.geometry})),t)).sort(a).map(t=>(delete t.area,t))}},"P8+q":function(t,e,n){var i;i={},t.exports=i,i.simpleFilter=function(t,e){return e.filter((function(e){return i.test(t,e)}))},i.test=function(t,e){return null!==i.match(t,e)},i.match=function(t,e,n){n=n||{};var i,r=0,o=[],a=e.length,l=0,s=0,u=n.pre||"",c=n.post||"",p=n.caseSensitive&&e||e.toLowerCase();t=n.caseSensitive&&t||t.toLowerCase();for(var h=0;h<a;h++)i=e[h],p[h]===t[r]?(i=u+i+c,r+=1,s+=1+s):s=0,l+=s,o[o.length]=i;return r===t.length?(l=p===t?1/0:l,{rendered:o.join(""),score:l}):null},i.filter=function(t,e,n){return e&&0!==e.length?"string"!=typeof t?e:(n=n||{},e.reduce((function(e,r,o,a){var l=r;n.extract&&(l=n.extract(r));var s=i.match(t,l,n);return null!=s&&(e[e.length]={string:s.rendered,score:s.score,index:o,original:r}),e}),[]).sort((function(t,e){var n=e.score-t.score;return n||t.index-e.index}))):[]}},Qidy:function(t,e,n){"use strict";n.r(e);var i=n("RwN2"),r=n("0wsv");e.default=function(t,e,n){void 0===n&&(n={});var o=Object(i.a)(t),a=Object(i.a)(e),l=Object(r.degreesToRadians)(a[1]-o[1]),s=Object(r.degreesToRadians)(a[0]-o[0]),u=Object(r.degreesToRadians)(o[1]),c=Object(r.degreesToRadians)(a[1]),p=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(u)*Math.cos(c);return Object(r.radiansToLength)(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)),n.units)}},QoH1:function(t,e){t.exports=function(t){return[].concat(t).filter(t=>void 0!==t)}},"R/WN":function(t,e,n){"use strict";var i=n("U6jy"),r=n("P8+q"),o=n("SX8C"),a=function(t,e,n){return n=n||{},this.options=i({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n),this.el=t,this.data=e||[],this.list=new o(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(t){this.handleKeyUp(t.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(t){this.handleKeyDown(t)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(t){this.handlePaste(t)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};a.prototype.handleKeyUp=function(t){40!==t&&38!==t&&27!==t&&13!==t&&9!==t&&this.handleInputChange(this.el.value)},a.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&t.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},a.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},a.prototype.handlePaste=function(t){if(t.clipboardData)this.handleInputChange(t.clipboardData.getData("Text"));else{var e=this;setTimeout((function(){e.handleInputChange(t.target.value)}),100)}},a.prototype.handleInputChange=function(t){this.query=this.normalize(t),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates((function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}).bind(this))},a.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},a.prototype.update=function(t){this.data=t,this.handleKeyUp()},a.prototype.clear=function(){this.data=[],this.list.clear()},a.prototype.normalize=function(t){return t=t.toLowerCase()},a.prototype.match=function(t,e){return t.indexOf(e)>-1},a.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},a.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:(function(t){return this.getItemValue(t)}).bind(this)};t(this.options.filter?r.filter(this.query,this.data,e).map((function(t){return{original:t.original,string:this.render(t.original,t.string)}}).bind(this)):this.data.map((function(t){return{original:t,string:this.render(t)}}).bind(this)))},a.prototype.getItemValue=function(t){return t},a.prototype.render=function(t,e){if(e)return e;for(var n=t.original?this.getItemValue(t.original):this.getItemValue(t),i=this.normalize(n),r=i.lastIndexOf(this.query);r>-1;){var o=r+this.query.length;n=n.slice(0,r)+"<strong>"+n.slice(r,o)+"</strong>"+n.slice(o),r=i.slice(0,r).lastIndexOf(this.query)}return n},a.prototype.renderError=function(t){this.list.drawError(t)},t.exports=a},RXCC:function(t,e){function n(t){if(this._items={},this._nums={},this._length=t?t.length:0,t)for(let e=0,n=t.length;e<n;e++)this.add(t[e]),void 0!==t[e]&&("string"==typeof t[e]?this._items[t[e]]=e:this._nums[t[e]]=e)}n.prototype.add=function(t){return this.has(t)||(this._length++,"string"==typeof t?this._items[t]=this._length:this._nums[t]=this._length),this},n.prototype.delete=function(t){return!1===this.has(t)||(this._length--,delete this._items[t],delete this._nums[t]),this},n.prototype.has=function(t){return("string"==typeof t||"number"==typeof t)&&(void 0!==this._items[t]||void 0!==this._nums[t])},n.prototype.values=function(){const t=[];return Object.keys(this._items).forEach(e=>{t.push({k:e,v:this._items[e]})}),Object.keys(this._nums).forEach(e=>{t.push({k:JSON.parse(e),v:this._nums[e]})}),t.sort((t,e)=>t.v-e.v).map(t=>t.k)},n.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this},t.exports=n},RwN2:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("0wsv");function i(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}},SX8C:function(t,e,n){"use strict";var i=function(t){return this.component=t,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};i.prototype.show=function(){this.element.style.display="block"},i.prototype.hide=function(){this.element.style.display="none"},i.prototype.add=function(t){this.items.push(t)},i.prototype.clear=function(){this.items=[],this.active=0},i.prototype.isEmpty=function(){return!this.items.length},i.prototype.isVisible=function(){return"block"===this.element.style.display},i.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()}else this.hide()},i.prototype.drawItem=function(t,e){var n=document.createElement("li"),i=document.createElement("a");e&&(n.className+=" active"),i.innerHTML=t.string,n.appendChild(i),this.element.appendChild(n),n.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),n.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,t)}).bind(this))},i.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()},i.prototype.move=function(t){this.active=t,this.draw()},i.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},i.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},i.prototype.drawError=function(t){var e=document.createElement("li");e.innerHTML=t,this.element.appendChild(e),this.show()},t.exports=i},"Smn/":function(t,e,n){"use strict";t.exports=function(t,e){return Object.keys(t).reduce((function(n,i){return n[i]=e(i,t[i]),n}),{})}},SsYf:function(t,e){t.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},U6jy:function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var i=arguments[e];for(var r in i)n.call(i,r)&&(t[r]=i[r])}return t};var n=Object.prototype.hasOwnProperty},U8pU:function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.d(e,"a",(function(){return i}))},VKWs:function(t,e,n){const i=n("xnQO");t.exports=function(t,e){const n=e.getBoundingClientRect();return new i(t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0))}},VbFZ:function(t,e){var n=t.exports=function(t,e){if(e||(e=16),void 0===t&&(t=128),t<=0)return"0";for(var i=Math.log(Math.pow(2,t))/Math.log(e),r=2;i===1/0;r*=2)i=Math.log(Math.pow(2,t/r))/Math.log(e)*r;var o=i-Math.floor(i),a="";for(r=0;r<Math.floor(i);r++){a=Math.floor(Math.random()*e).toString(e)+a}if(o){var l=Math.pow(e,o);a=Math.floor(Math.random()*l).toString(e)+a}var s=parseInt(a,e);return s!==1/0&&s>=Math.pow(2,t)?n(t,e):a};n.rack=function(t,e,i){var r=function(r){var a=0;do{if(a++>10){if(!i)throw new Error("too many ID collisions, use more bits");t+=i}var l=n(t,e)}while(Object.hasOwnProperty.call(o,l));return o[l]=r,l},o=r.hats={};return r.get=function(t){return r.hats[t]},r.set=function(t,e){return r.hats[t]=e,r},r.bits=t||128,r.base=e||16,r}},WpKc:function(t,e,n){"use strict";var i=n("4b23");function r(t){this.origin=t.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=t.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=t,this.send=this.send.bind(this),this.countries=t.countries?t.countries.split(","):null,this.types=t.types?t.types.split(","):null,this.bbox=t.bbox?t.bbox:null,this.language=t.language?t.language.split(","):null,this.limit=t.limit?+t.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(t),this.eventQueue=new Array,this.flushInterval=t.flushInterval||1e3,this.maxQueueSize=t.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}r.prototype={select:function(t,e){var n=this.getSelectedIndex(t,e),i=this.getEventPayload("search.select",e);if(i.resultIndex=n,i.resultPlaceName=t.place_name,i.resultId=t.id,(n!==this.lastSentIndex||i.queryString!==this.lastSentInput)&&-1!=n&&(this.lastSentIndex=n,this.lastSentInput=i.queryString,i.queryString))return this.push(i)},start:function(t){var e=this.getEventPayload("search.start",t);if(e.queryString)return this.push(e)},keyevent:function(t,e){if(t.key&&!t.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(t.keyCode)){var n=this.getEventPayload("search.keystroke",e);if(n.lastAction=t.key,n.queryString)return this.push(n)}},send:function(t,e){if(!this.enableEventLogging)return e?e():void 0;var n=this.getRequestOptions(t);this.request(n,(function(t){return t?this.handleError(t,e):e?e():void 0}).bind(this))},getRequestOptions:function(t){return Array.isArray(t)||(t=[t]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}},getEventPayload:function(t,e){var n;n=e.options.proximity?[e.options.proximity.longitude,e.options.proximity.latitude]:null;var i=e._map?e._map.getZoom():void 0,r={event:t,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:e.options.autocomplete,fuzzyMatch:e.options.fuzzyMatch,proximity:n,limit:e.options.limit,routing:e.options.routing,worldview:e.options.worldview,mapZoom:i,keyboardLocale:this.locale};return"search.select"===t?r.queryString=e.inputString:"search.select"!=t&&e._inputEl?r.queryString=e._inputEl.value:r.queryString=e.inputString,r},request:function(t,e){var n=new XMLHttpRequest;for(var i in n.onreadystatechange=function(){if(4==this.readyState)return 204==this.status?e(null):e(this.statusText)},n.open(t.method,t.host+"/"+t.path,!0),t.headers){var r=t.headers[i];n.setRequestHeader(i,r)}n.send(t.body)},handleError:function(t,e){if(e)return e(t)},generateSessionID:function(){return i()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(t,e){if(e._typeahead){var n=e._typeahead.data,i=t.id;return n.map((function(t){return t.id})).indexOf(i)}},shouldEnableLogging:function(t){return!1!==t.enableEventLogging&&((!t.origin||-1!=t.origin.indexOf("api.mapbox.com"))&&(!t.localGeocoder&&!t.filter))},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(t,e){this.eventQueue.push(t),(this.eventQueue.length>=this.maxQueueSize||e)&&this.flush()},remove:function(){this.flush()}},t.exports=r},XaGS:function(t,e,n){(function(t){var n="[object Arguments]",i="[object Map]",r="[object Object]",o="[object Set]",a=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s[n]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s[i]=s["[object Number]"]=s[r]=s["[object RegExp]"]=s[o]=s["[object String]"]=s["[object WeakMap]"]=!1;var u="object"==typeof global&&global&&global.Object===Object&&global,c="object"==typeof self&&self&&self.Object===Object&&self,p=u||c||Function("return this")(),h=e&&!e.nodeType&&e,d=h&&"object"==typeof t&&t&&!t.nodeType&&t,f=d&&d.exports===h,m=f&&u.process,g=function(){try{return m&&m.binding&&m.binding("util")}catch(t){}}(),v=g&&g.isTypedArray;function y(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function _(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function b(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var x,w,C,E=Array.prototype,S=Function.prototype,T=Object.prototype,I=p["__core-js_shared__"],P=S.toString,A=T.hasOwnProperty,M=(x=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"",k=T.toString,D=RegExp("^"+P.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),L=f?p.Buffer:void 0,O=p.Symbol,R=p.Uint8Array,z=T.propertyIsEnumerable,F=E.splice,B=O?O.toStringTag:void 0,N=Object.getOwnPropertySymbols,U=L?L.isBuffer:void 0,j=(w=Object.keys,C=Object,function(t){return w(C(t))}),V=gt(p,"DataView"),q=gt(p,"Map"),G=gt(p,"Promise"),Z=gt(p,"Set"),H=gt(p,"WeakMap"),Y=gt(Object,"create"),X=bt(V),W=bt(q),K=bt(G),J=bt(Z),$=bt(H),Q=O?O.prototype:void 0,tt=Q?Q.valueOf:void 0;function et(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function nt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function it(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function rt(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new it;++e<n;)this.add(t[e])}function ot(t){var e=this.__data__=new nt(t);this.size=e.size}function at(t,e){var n=Ct(t),i=!n&&wt(t),r=!n&&!i&&Et(t),o=!n&&!i&&!r&&At(t),a=n||i||r||o,l=a?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],s=l.length;for(var u in t)!e&&!A.call(t,u)||a&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||_t(u,s))||l.push(u);return l}function lt(t,e){for(var n=t.length;n--;)if(xt(t[n][0],e))return n;return-1}function st(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":B&&B in Object(t)?function(t){var e=A.call(t,B),n=t[B];try{t[B]=void 0;var i=!0}catch(o){}var r=k.call(t);i&&(e?t[B]=n:delete t[B]);return r}(t):function(t){return k.call(t)}(t)}function ut(t){return Pt(t)&&st(t)==n}function ct(t,e,a,l,s){return t===e||(null==t||null==e||!Pt(t)&&!Pt(e)?t!=t&&e!=e:function(t,e,a,l,s,u){var c=Ct(t),p=Ct(e),h=c?"[object Array]":yt(t),d=p?"[object Array]":yt(e),f=(h=h==n?r:h)==r,m=(d=d==n?r:d)==r,g=h==d;if(g&&Et(t)){if(!Et(e))return!1;c=!0,f=!1}if(g&&!f)return u||(u=new ot),c||At(t)?dt(t,e,a,l,s,u):function(t,e,n,r,a,l,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!l(new R(t),new R(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return xt(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case i:var u=_;case o:var c=1&r;if(u||(u=b),t.size!=e.size&&!c)return!1;var p=s.get(t);if(p)return p==e;r|=2,s.set(t,e);var h=dt(u(t),u(e),r,a,l,s);return s.delete(t),h;case"[object Symbol]":if(tt)return tt.call(t)==tt.call(e)}return!1}(t,e,h,a,l,s,u);if(!(1&a)){var v=f&&A.call(t,"__wrapped__"),y=m&&A.call(e,"__wrapped__");if(v||y){var x=v?t.value():t,w=y?e.value():e;return u||(u=new ot),s(x,w,a,l,u)}}if(!g)return!1;return u||(u=new ot),function(t,e,n,i,r,o){var a=1&n,l=ft(t),s=l.length,u=ft(e).length;if(s!=u&&!a)return!1;var c=s;for(;c--;){var p=l[c];if(!(a?p in e:A.call(e,p)))return!1}var h=o.get(t);if(h&&o.get(e))return h==e;var d=!0;o.set(t,e),o.set(e,t);var f=a;for(;++c<s;){p=l[c];var m=t[p],g=e[p];if(i)var v=a?i(g,m,p,e,t,o):i(m,g,p,t,e,o);if(!(void 0===v?m===g||r(m,g,n,i,o):v)){d=!1;break}f||(f="constructor"==p)}if(d&&!f){var y=t.constructor,_=e.constructor;y==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(d=!1)}return o.delete(t),o.delete(e),d}(t,e,a,l,s,u)}(t,e,a,l,ct,s))}function pt(t){return!(!It(t)||function(t){return!!M&&M in t}(t))&&(St(t)?D:a).test(bt(t))}function ht(t){if(n=(e=t)&&e.constructor,i="function"==typeof n&&n.prototype||T,e!==i)return j(t);var e,n,i,r=[];for(var o in Object(t))A.call(t,o)&&"constructor"!=o&&r.push(o);return r}function dt(t,e,n,i,r,o){var a=1&n,l=t.length,s=e.length;if(l!=s&&!(a&&s>l))return!1;var u=o.get(t);if(u&&o.get(e))return u==e;var c=-1,p=!0,h=2&n?new rt:void 0;for(o.set(t,e),o.set(e,t);++c<l;){var d=t[c],f=e[c];if(i)var m=a?i(f,d,c,e,t,o):i(d,f,c,t,e,o);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!y(e,(function(t,e){if(a=e,!h.has(a)&&(d===t||r(d,t,n,i,o)))return h.push(e);var a}))){p=!1;break}}else if(d!==f&&!r(d,f,n,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function ft(t){return function(t,e,n){var i=e(t);return Ct(t)?i:function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}(i,n(t))}(t,Mt,vt)}function mt(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function gt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return pt(n)?n:void 0}et.prototype.clear=function(){this.__data__=Y?Y(null):{},this.size=0},et.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},et.prototype.get=function(t){var e=this.__data__;if(Y){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return A.call(e,t)?e[t]:void 0},et.prototype.has=function(t){var e=this.__data__;return Y?void 0!==e[t]:A.call(e,t)},et.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Y&&void 0===e?"__lodash_hash_undefined__":e,this},nt.prototype.clear=function(){this.__data__=[],this.size=0},nt.prototype.delete=function(t){var e=this.__data__,n=lt(e,t);return!(n<0)&&(n==e.length-1?e.pop():F.call(e,n,1),--this.size,!0)},nt.prototype.get=function(t){var e=this.__data__,n=lt(e,t);return n<0?void 0:e[n][1]},nt.prototype.has=function(t){return lt(this.__data__,t)>-1},nt.prototype.set=function(t,e){var n=this.__data__,i=lt(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},it.prototype.clear=function(){this.size=0,this.__data__={hash:new et,map:new(q||nt),string:new et}},it.prototype.delete=function(t){var e=mt(this,t).delete(t);return this.size-=e?1:0,e},it.prototype.get=function(t){return mt(this,t).get(t)},it.prototype.has=function(t){return mt(this,t).has(t)},it.prototype.set=function(t,e){var n=mt(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},rt.prototype.add=rt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},rt.prototype.has=function(t){return this.__data__.has(t)},ot.prototype.clear=function(){this.__data__=new nt,this.size=0},ot.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},ot.prototype.get=function(t){return this.__data__.get(t)},ot.prototype.has=function(t){return this.__data__.has(t)},ot.prototype.set=function(t,e){var n=this.__data__;if(n instanceof nt){var i=n.__data__;if(!q||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new it(i)}return n.set(t,e),this.size=n.size,this};var vt=N?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var a=t[n];e(a,n,t)&&(o[r++]=a)}return o}(N(t),(function(e){return z.call(t,e)})))}:function(){return[]},yt=st;function _t(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||l.test(t))&&t>-1&&t%1==0&&t<e}function bt(t){if(null!=t){try{return P.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function xt(t,e){return t===e||t!=t&&e!=e}(V&&"[object DataView]"!=yt(new V(new ArrayBuffer(1)))||q&&yt(new q)!=i||G&&"[object Promise]"!=yt(G.resolve())||Z&&yt(new Z)!=o||H&&"[object WeakMap]"!=yt(new H))&&(yt=function(t){var e=st(t),n=e==r?t.constructor:void 0,a=n?bt(n):"";if(a)switch(a){case X:return"[object DataView]";case W:return i;case K:return"[object Promise]";case J:return o;case $:return"[object WeakMap]"}return e});var wt=ut(function(){return arguments}())?ut:function(t){return Pt(t)&&A.call(t,"callee")&&!z.call(t,"callee")},Ct=Array.isArray;var Et=U||function(){return!1};function St(t){if(!It(t))return!1;var e=st(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Tt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function It(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Pt(t){return null!=t&&"object"==typeof t}var At=v?function(t){return function(e){return t(e)}}(v):function(t){return Pt(t)&&Tt(t.length)&&!!s[st(t)]};function Mt(t){return null!=(e=t)&&Tt(e.length)&&!St(e)?at(t):ht(t);var e}t.exports=function(t,e){return ct(t,e)}}).call(this,n("YuTi")(t))},YI60:function(t,e,n){"use strict";var i=n("aqBw"),r={};function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t){if(r[t])return r[t];var e=t.split("."),n=e[0],a=e[1];if(!a)throw new Error("Invalid token");var l=function(t){try{return JSON.parse(i.decode(t))}catch(e){throw new Error("Invalid token")}}(a),s={usage:n,user:l.u};return o(l,"a")&&(s.authorization=l.a),o(l,"exp")&&(s.expires=1e3*l.exp),o(l,"iat")&&(s.created=1e3*l.iat),o(l,"scopes")&&(s.scopes=l.scopes),o(l,"client")&&(s.client=l.client),o(l,"ll")&&(s.lastLogin=l.ll),o(l,"iu")&&(s.impersonator=l.iu),r[t]=s,s}},ZK94:function(t,e){t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},aqBw:function(t,e,n){(function(t){var i;!function(r){var o=e,a=(t&&t.exports,"object"==typeof global&&global);a.global!==a&&a.window;var l=function(t){this.message=t};l.prototype=new Error,l.prototype.name="InvalidCharacterError";var s=function(t){throw new l(t)},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,p={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var e,n=t.length%3,i="",r=-1,o=t.length-n;++r<o;)e=(t.charCodeAt(r)<<16)+(t.charCodeAt(++r)<<8)+t.charCodeAt(++r),i+=u.charAt(e>>18&63)+u.charAt(e>>12&63)+u.charAt(e>>6&63)+u.charAt(63&e);return 2==n?(e=(t.charCodeAt(r)<<8)+t.charCodeAt(++r),i+=u.charAt(e>>10)+u.charAt(e>>4&63)+u.charAt(e<<2&63)+"="):1==n&&(e=t.charCodeAt(r),i+=u.charAt(e>>2)+u.charAt(e<<4&63)+"=="),i},decode:function(t){var e=(t=String(t).replace(c,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),(e%4==1||/[^+a-zA-Z0-9/]/.test(t))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var n,i,r=0,o="",a=-1;++a<e;)i=u.indexOf(t.charAt(a)),n=r%4?64*n+i:i,r++%4&&(o+=String.fromCharCode(255&n>>(-2*r&6)));return o},version:"0.1.0"};void 0===(i=(function(){return p}).call(e,n,e,t))||(t.exports=i)}()}).call(this,n("YuTi")(t))},bRaG:function(t,e){t.exports=function(t,e,n){let i,r;function o(){i=!1,r&&(a.apply(n,r),r=!1)}function a(){i?r=arguments:(i=!0,t.apply(n,arguments),setTimeout(o,e))}return a}},baNz:function(t,e,n){"use strict";t.exports=function(t,e){var n=function(t,n){return-1!==e.indexOf(t)&&void 0!==n};return"function"==typeof e&&(n=e),Object.keys(t).filter((function(e){return n(e,t[e])})).reduce((function(e,n){return e[n]=t[n],e}),{})}},cRm7:function(t,e,n){"use strict";var i=n("AxvH");function r(t,e){this.request=t,this.headers=e.headers,this.rawBody=e.body,this.statusCode=e.statusCode;try{this.body=JSON.parse(e.body||"{}")}catch(n){this.body=e.body}this.links=i(this.headers.link)}r.prototype.hasNextPage=function(){return!!this.links.next},r.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},t.exports=r},cW3J:function(t,e,n){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!t)throw TypeError("Cannot convert undefined or null to object");for(var i=function(e){e&&Object.keys(e).forEach((function(n){return t[n]=e[n]}))},r=0,o=e;r<o.length;r++){var a=o[r];i(a)}return t})},cryX:function(t,e,n){"use strict";t.exports=function(t){var e={};return t?(t.trim().split(/[\r|\n]+/).forEach((function(t){var n=function(t){var e=t.indexOf(":");return{name:t.substring(0,e).trim().toLowerCase(),value:t.substring(e+1).trim()}}(t);e[n.name]=n.value})),e):e}},d0rS:function(t,e,n){"use strict";function i(t){return Array.isArray(t)?t.map(encodeURIComponent).join(","):encodeURIComponent(String(t))}function r(t,e,n){if(!1===n||null===n)return t;var r=/\?/.test(t)?"&":"?",o=encodeURIComponent(e);return void 0!==n&&""!==n&&!0!==n&&(o+="="+i(n)),""+t+r+o}t.exports={appendQueryObject:function(t,e){if(!e)return t;var n=t;return Object.keys(e).forEach((function(t){var i=e[t];void 0!==i&&(Array.isArray(i)&&(i=i.filter((function(t){return null!=t})).join(",")),n=r(n,t,i))})),n},appendQueryParam:r,prependOrigin:function(t,e){if(!e)return t;if("http"===t.slice(0,4))return t;var n="/"===t[0]?"":"/";return""+e.replace(/\/$/,"")+n+t},interpolateRouteParams:function(t,e){return e?t.replace(/\/:([a-zA-Z0-9]+)/g,(function(t,n){var r=e[n];if(void 0===r)throw new Error("Unspecified route parameter "+n);return"/"+i(r)})):t}}},d9Rt:function(t,e,n){const i=n("EX2/"),r=n("GHAK"),o=n("uI0s"),a=n("k+DL").default,l={...i.modes.draw_polygon};l.onSetup=function(t){const e=this.newFeature({type:r.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:r.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),o.disable(this),this.updateUIClasses({mouse:r.cursors.ADD}),this.activateUIButton(r.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:t.initialRadiusInKm||2,polygon:e,currentVertexPosition:0}},l.clickAnywhere=function(t,e){if(0===t.currentVertexPosition){t.currentVertexPosition++;const n=[e.lngLat.lng,e.lngLat.lat],i=a(n,t.initialRadiusInKm);t.polygon.incomingCoords(i.geometry.coordinates),t.polygon.properties.center=n,t.polygon.properties.radiusInKm=t.initialRadiusInKm}return this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},t.exports=l},dLdS:function(t,e,n){const i=n("GHAK");t.exports=function(t,e,n,r){const o=e.geometry.coordinates,a=n.geometry.coordinates;if(o[1]>i.LAT_RENDERED_MAX||o[1]<i.LAT_RENDERED_MIN||a[1]>i.LAT_RENDERED_MAX||a[1]<i.LAT_RENDERED_MIN)return null;const l=r.project([o[0],o[1]]),s=r.project([a[0],a[1]]),u=r.unproject([(l.x+s.x)/2,(l.y+s.y)/2]);return{type:i.geojsonTypes.FEATURE,properties:{meta:i.meta.MIDPOINT,parent:t,lng:u.lng,lat:u.lat,coord_path:n.properties.coord_path},geometry:{type:i.geojsonTypes.POINT,coordinates:[u.lng,u.lat]}}}},djHk:function(t,e,n){const i=n("U6jy"),r=n("GHAK"),o=["mode","feature","mouse"];t.exports=function(t){const e={};let n=null,a={mode:null,feature:null,mouse:null},l={mode:null,feature:null,mouse:null};function s(t){l=i(l,t)}function u(){if(!t.container)return;const e=[],n=[];o.forEach(t=>{l[t]!==a[t]&&(e.push(`${t}-${a[t]}`),null!==l[t]&&n.push(`${t}-${l[t]}`))}),e.length>0&&t.container.classList.remove.apply(t.container.classList,e),n.length>0&&t.container.classList.add.apply(t.container.classList,n),a=i(a,l)}function c(t,e={}){const i=document.createElement("button");return i.className=`${r.classes.CONTROL_BUTTON} ${e.className}`,i.setAttribute("title",e.title),e.container.appendChild(i),i.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation();i.target!==n?(h(t),e.onActivate()):p()},!0),i}function p(){n&&(n.classList.remove(r.classes.ACTIVE_BUTTON),n=null)}function h(t){p();const i=e[t];i&&i&&"trash"!==t&&(i.classList.add(r.classes.ACTIVE_BUTTON),n=i)}return{setActiveButton:h,queueMapClasses:s,updateMapClasses:u,clearMapClasses:function(){s({mode:null,feature:null,mouse:null}),u()},addButtons:function(){const n=t.options.controls,i=document.createElement("div");return i.className=`${r.classes.CONTROL_GROUP} ${r.classes.CONTROL_BASE}`,n?(n[r.types.LINE]&&(e[r.types.LINE]=c(r.types.LINE,{container:i,className:r.classes.CONTROL_BUTTON_LINE,title:"LineString tool "+(t.options.keybindings?"(l)":""),onActivate:()=>t.events.changeMode(r.modes.DRAW_LINE_STRING)})),n[r.types.POLYGON]&&(e[r.types.POLYGON]=c(r.types.POLYGON,{container:i,className:r.classes.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(t.options.keybindings?"(p)":""),onActivate:()=>t.events.changeMode(r.modes.DRAW_POLYGON)})),n[r.types.POINT]&&(e[r.types.POINT]=c(r.types.POINT,{container:i,className:r.classes.CONTROL_BUTTON_POINT,title:"Marker tool "+(t.options.keybindings?"(m)":""),onActivate:()=>t.events.changeMode(r.modes.DRAW_POINT)})),n.trash&&(e.trash=c("trash",{container:i,className:r.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{t.events.trash()}})),n.combine_features&&(e.combine_features=c("combineFeatures",{container:i,className:r.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{t.events.combineFeatures()}})),n.uncombine_features&&(e.uncombine_features=c("uncombineFeatures",{container:i,className:r.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{t.events.uncombineFeatures()}})),i):i},removeButtons:function(){Object.keys(e).forEach(t=>{const n=e[t];n.parentNode&&n.parentNode.removeChild(n),delete e[t]})}}}},eFQn:function(t,e,n){"use strict";var i=n("Smn/");t.exports=function(t){return i(t,(function(t,e){return"boolean"==typeof e?JSON.stringify(e):e}))}},eGrx:function(t,e,n){"use strict";function i(t){return Object.prototype.toString.call(t)}var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)}var a=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},l=Object.prototype.hasOwnProperty||function(t,e){return e in t};function s(t){if("object"==typeof t&&null!==t){var e;if(r(t))e=[];else if("[object Date]"===i(t))e=new Date(t.getTime?t.getTime():t);else if(function(t){return"[object RegExp]"===i(t)}(t))e=new RegExp(t);else if(function(t){return"[object Error]"===i(t)}(t))e={message:t.message};else if(function(t){return"[object Boolean]"===i(t)}(t)||function(t){return"[object Number]"===i(t)}(t)||function(t){return"[object String]"===i(t)}(t))e=Object(t);else if(Object.create&&Object.getPrototypeOf)e=Object.create(Object.getPrototypeOf(t));else if(t.constructor===Object)e={};else{var n=t.constructor&&t.constructor.prototype||t.__proto__||{},l=function(){};l.prototype=n,e=new l}return o(a(t),(function(n){e[n]=t[n]})),e}return t}function u(t,e,n){var i=[],u=[],c=!0;return function t(p){var h=n?s(p):p,d={},f=!0,m={node:h,node_:p,path:[].concat(i),parent:u[u.length-1],parents:u,key:i[i.length-1],isRoot:0===i.length,level:i.length,circular:null,update:function(t,e){m.isRoot||(m.parent.node[m.key]=t),m.node=t,e&&(f=!1)},delete:function(t){delete m.parent.node[m.key],t&&(f=!1)},remove:function(t){r(m.parent.node)?m.parent.node.splice(m.key,1):delete m.parent.node[m.key],t&&(f=!1)},keys:null,before:function(t){d.before=t},after:function(t){d.after=t},pre:function(t){d.pre=t},post:function(t){d.post=t},stop:function(){c=!1},block:function(){f=!1}};if(!c)return m;function g(){if("object"==typeof m.node&&null!==m.node){m.keys&&m.node_===m.node||(m.keys=a(m.node)),m.isLeaf=0===m.keys.length;for(var t=0;t<u.length;t++)if(u[t].node_===p){m.circular=u[t];break}}else m.isLeaf=!0,m.keys=null;m.notLeaf=!m.isLeaf,m.notRoot=!m.isRoot}g();var v=e.call(m,m.node);return void 0!==v&&m.update&&m.update(v),d.before&&d.before.call(m,m.node),f?("object"!=typeof m.node||null===m.node||m.circular||(u.push(m),g(),o(m.keys,(function(e,r){i.push(e),d.pre&&d.pre.call(m,m.node[e],e);var o=t(m.node[e]);n&&l.call(m.node,e)&&(m.node[e]=o.node),o.isLast=r===m.keys.length-1,o.isFirst=0===r,d.post&&d.post.call(m,o),i.pop()})),u.pop()),d.after&&d.after.call(m,m.node),m):m}(t).node}function c(t){this.value=t}function p(t){return new c(t)}c.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var i=t[n];if(!e||!l.call(e,i))return;e=e[i]}return e},c.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var i=t[n];if(!e||!l.call(e,i))return!1;e=e[i]}return!0},c.prototype.set=function(t,e){for(var n=this.value,i=0;i<t.length-1;i++){var r=t[i];l.call(n,r)||(n[r]={}),n=n[r]}return n[t[i]]=e,e},c.prototype.map=function(t){return u(this.value,t,!0)},c.prototype.forEach=function(t){return this.value=u(this.value,t,!1),this.value},c.prototype.reduce=function(t,e){var n=1===arguments.length,i=n?this.value:e;return this.forEach((function(e){this.isRoot&&n||(i=t.call(this,i,e))})),i},c.prototype.paths=function(){var t=[];return this.forEach((function(){t.push(this.path)})),t},c.prototype.nodes=function(){var t=[];return this.forEach((function(){t.push(this.node)})),t},c.prototype.clone=function(){var t=[],e=[];return function n(i){for(var r=0;r<t.length;r++)if(t[r]===i)return e[r];if("object"==typeof i&&null!==i){var l=s(i);return t.push(i),e.push(l),o(a(i),(function(t){l[t]=n(i[t])})),t.pop(),e.pop(),l}return i}(this.value)},o(a(c.prototype),(function(t){p[t]=function(e){var n=[].slice.call(arguments,1),i=new c(e);return i[t].apply(i,n)}})),t.exports=p},epIz:function(t,e){function n(t){if(!(this instanceof n))return new n(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}t.exports=n,n.prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this},n.prototype.equals=function(t){var e;return e=t instanceof n?t.bbox():t,this._bbox[0]==e[0]&&this._bbox[1]==e[1]&&this._bbox[2]==e[2]&&this._bbox[3]==e[3]},n.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},n.prototype.union=function(t){var e;return this._valid=!0,e=t instanceof n?t.bbox():t,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this},n.prototype.bbox=function(){return this._valid?this._bbox:null},n.prototype.contains=function(t){if(!t)return this._fastContains();if(!this._valid)return null;var e=t[0],n=t[1];return this._bbox[0]<=e&&this._bbox[1]<=n&&this._bbox[2]>=e&&this._bbox[3]>=n},n.prototype.intersect=function(t){return this._valid?(e=t instanceof n?t.bbox():t,!(this._bbox[0]>e[2]||this._bbox[2]<e[0]||this._bbox[3]<e[1]||this._bbox[1]>e[3])):null;var e},n.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",t)},n.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null}},"f3+a":function(t,e,n){(function(t){var i=function(){var t=function(t,e,n,i){for(n=n||{},i=t.length;i--;n[t[i]]=e);return n},e=[1,12],n=[1,13],i=[1,9],r=[1,10],o=[1,11],a=[1,14],l=[1,15],s=[14,18,22,24],u=[18,22],c=[22,24],p={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,n,i,r,o,a){var l=o.length-1;switch(r){case 1:this.$=t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(t);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=o[l-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=o[l-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[o[l-2],o[l]];break;case 16:this.$={},this.$[o[l][0]]=o[l][1];break;case 17:this.$=o[l-2],void 0!==o[l-2][o[l][0]]&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(o[l][0])),o[l-2][o[l][0]]=o[l][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[o[l]];break;case 21:this.$=o[l-2],o[l-2].push(o[l])}},table:[{3:5,4:e,5:6,6:n,7:3,8:i,9:4,10:r,11:o,12:1,13:2,15:7,16:8,17:a,23:l},{1:[3]},{14:[1,16]},t(s,[2,7]),t(s,[2,8]),t(s,[2,9]),t(s,[2,10]),t(s,[2,11]),t(s,[2,12]),t(s,[2,3]),t(s,[2,4]),t(s,[2,5]),t([14,18,21,22,24],[2,1]),t(s,[2,2]),{3:20,4:e,18:[1,17],19:18,20:19},{3:5,4:e,5:6,6:n,7:3,8:i,9:4,10:r,11:o,13:23,15:7,16:8,17:a,23:l,24:[1,21],25:22},{1:[2,6]},t(s,[2,13]),{18:[1,24],22:[1,25]},t(u,[2,16]),{21:[1,26]},t(s,[2,18]),{22:[1,28],24:[1,27]},t(c,[2,20]),t(s,[2,14]),{3:20,4:e,20:29},{3:5,4:e,5:6,6:n,7:3,8:i,9:4,10:r,11:o,13:30,15:7,16:8,17:a,23:l},t(s,[2,19]),{3:5,4:e,5:6,6:n,7:3,8:i,9:4,10:r,11:o,13:31,15:7,16:8,17:a,23:l},t(u,[2,17]),t(u,[2,15]),t(c,[2,21])],defaultActions:{16:[2,6]},parseError:function(t,e){if(!e.recoverable){function n(t,e){this.message=t,this.hash=e}throw n.prototype=Error,new n(t,e)}this.trace(t)},parse:function(t){var e=this,n=[0],i=[null],r=[],o=this.table,a="",l=0,s=0,u=0,c=2,p=1,h=r.slice.call(arguments,1),d=Object.create(this.lexer),f={yy:{}};for(var m in this.yy)Object.prototype.hasOwnProperty.call(this.yy,m)&&(f.yy[m]=this.yy[m]);d.setInput(t,f.yy),f.yy.lexer=d,f.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var g=d.yylloc;r.push(g);var v=d.options&&d.options.ranges;"function"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,_,b,x,w,C,E,S,T,I=function(){var t;return"number"!=typeof(t=d.lex()||p)&&(t=e.symbols_[t]||t),t},P={};;){if(b=n[n.length-1],this.defaultActions[b]?x=this.defaultActions[b]:(null==y&&(y=I()),x=o[b]&&o[b][y]),void 0===x||!x.length||!x[0]){var A="";for(C in T=[],o[b])this.terminals_[C]&&C>c&&T.push("'"+this.terminals_[C]+"'");A=d.showPosition?"Parse error on line "+(l+1)+":\n"+d.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(l+1)+": Unexpected "+(y==p?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(A,{text:d.match,token:this.terminals_[y]||y,line:d.yylineno,loc:g,expected:T})}if(x[0]instanceof Array&&x.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+y);switch(x[0]){case 1:n.push(y),i.push(d.yytext),r.push(d.yylloc),n.push(x[1]),y=null,_?(y=_,_=null):(s=d.yyleng,a=d.yytext,l=d.yylineno,g=d.yylloc,u>0&&u--);break;case 2:if(E=this.productions_[x[1]][1],P.$=i[i.length-E],P._$={first_line:r[r.length-(E||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(E||1)].first_column,last_column:r[r.length-1].last_column},v&&(P._$.range=[r[r.length-(E||1)].range[0],r[r.length-1].range[1]]),void 0!==(w=this.performAction.apply(P,[a,s,l,f.yy,x[1],i,r].concat(h))))return w;E&&(n=n.slice(0,-1*E*2),i=i.slice(0,-1*E),r=r.slice(0,-1*E)),n.push(this.productions_[x[1]][0]),i.push(P.$),r.push(P._$),S=o[n[n.length-2]][n[n.length-1]],n.push(S);break;case 3:return!0}}return!0}},h={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(i=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var o in r)this[o]=r[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,i;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),o=0;o<r.length;o++)if((n=this._input.match(this.rules[r[o]]))&&(!e||n[0].length>e[0].length)){if(e=n,i=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,r[o])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,r[i]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,i){switch(n){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function d(){this.yy={}}return p.lexer=h,d.prototype=p,p.Parser=d,new d}();e.parser=i,e.Parser=i.Parser,e.parse=function(){return i.parse.apply(i,arguments)},e.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),process.exit(1));var i=n(8).readFileSync(n("2U8Y").normalize(t[1]),"utf8");return e.parser.parse(i)},n.c[n.s]===t&&e.main(process.argv.slice(1))}).call(this,n("YuTi")(t))},f4Td:function(t,e,n){const i=n("VbFZ"),r=n("GHAK"),o=function(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||i(),this.type=e.geometry.type};o.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},o.prototype.incomingCoords=function(t){this.setCoordinates(t)},o.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},o.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},o.prototype.setProperty=function(t,e){this.properties[t]=e},o.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:r.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},o.prototype.internal=function(t){const e={id:this.id,meta:r.meta.FEATURE,"meta:type":this.type,active:r.activeStates.INACTIVE,mode:t};if(this.ctx.options.userProperties)for(const n in this.properties)e["user_"+n]=this.properties[n];return{type:r.geojsonTypes.FEATURE,properties:e,geometry:{coordinates:this.getCoordinates(),type:this.type}}},t.exports=o},fytV:function(t,e,n){var i=n("ohRi"),r=n("eGrx"),o=n("epIz"),a={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},l=Object.keys(a);function s(t){for(var e=o(),n=i(t),r=0;r<n.length;r++)e.include(n[r]);return e}t.exports=function(t){return s(t).bbox()},t.exports.polygon=function(t){return s(t).polygon()},t.exports.bboxify=function(t){return r(t).map((function(t){t&&(l.some((function(e){return!!t[e]&&-1!==a[e].indexOf(t.type)}))&&(t.bbox=s(t).bbox(),this.update(t)))}))}},hyT3:function(t,e,n){const i=n("GHAK");t.exports=function(t,e,n,r){return{type:i.geojsonTypes.FEATURE,properties:{meta:i.meta.VERTEX,parent:t,coord_path:n,active:r?i.activeStates.ACTIVE:i.activeStates.INACTIVE},geometry:{type:i.geojsonTypes.POINT,coordinates:e}}}},iFvi:function(t,e,n){"use strict";var i=n("Bi8L"),r=n("9/5/"),o=n("U6jy"),a=n("+qE3").EventEmitter,l=n("SsYf"),s=n("0KjW"),u=n("LFDd"),c=n("WpKc"),p=n("/5w7"),h=n("5K5J");const d=0,f=1,m=2;function g(t){this._eventEmitter=new a,this.options=o({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null}g.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(t){return t.place_name},render:function(t){var e=t.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+e[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+e.splice(1,e.length).join(",")+"</div></div>"}},addTo:function(t){function e(t,e){if(!document.body.contains(e))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const n=t.onAdd();e.appendChild(n)}if(t._controlContainer)t.addControl(this);else if(t instanceof HTMLElement)e(this,t);else{if("string"!=typeof t)throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element");{const n=document.querySelectorAll(t);if(0===n.length)throw new Error("Element ",t,"not found.");if(n.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,n[0])}}},onAdd:function(t){if(t&&"string"!=typeof t&&(this._map=t),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=u(s({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new c(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var e=this.container=document.createElement("div");e.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var n=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",r(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(t){this.eventManager.keyevent(t,this)}).bind(this));var o=document.createElement("div");o.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var a=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(a),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),o.appendChild(this._clearEl),o.appendChild(this._loadingEl),e.appendChild(n),e.appendChild(this._inputEl),e.appendChild(o),this._typeahead=new i(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),e},createIcon:function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+t),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width",18),n.setAttribute("height",18),"innerHTML"in n)n.innerHTML=e;else{var i=document.createElement("div");i.innerHTML="<svg>"+e.valueOf().toString()+"</svg>";var r=i.firstChild.firstChild;n.appendChild(r)}return n},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(t){var e=(t.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this._geocode(e)},_onKeyDown:function(t){var e=27,n=9;if(t.keyCode===e&&this.options.clearAndBlurOnEsc)return this._clear(t),this._inputEl.blur();var i=t.target&&t.target.shadowRoot?t.target.shadowRoot.activeElement:t.target;if(!(i?i.value:""))return this.fresh=!0,t.keyCode!==n&&this.clear(t),this._clearEl.style.display="none";t.metaKey||-1!==[n,e,37,39,13,38,40].indexOf(t.keyCode)||i.value.length>=this.options.minLength&&this._geocode(i.value)},_showButton:function(){this._typeahead.selected&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(t){this.options.clearOnBlur&&this._clearOnBlur(t),this.options.collapsed&&this._collapse()},_onChange:function(){var t=this._typeahead.selected;if(t&&JSON.stringify(t)!==this.lastSelected){var e;if(this._clearEl.style.display="none",this.options.flyTo)if(t.properties&&l[t.properties.short_code])e=o({},this.options.flyTo),this._map&&this._map.fitBounds(l[t.properties.short_code].bbox,e);else if(t.bbox){var n=t.bbox;e=o({},this.options.flyTo),this._map&&this._map.fitBounds([[n[0],n[1]],[n[2],n[3]]],e)}else{var i={zoom:this.options.zoom};e=o({},i,this.options.flyTo),t.center?e.center=t.center:t.geometry&&t.geometry.type&&"Point"===t.geometry.type&&t.geometry.coordinates&&(e.center=t.geometry.coordinates),this._map&&this._map.flyTo(e)}this.options.marker&&this._mapboxgl&&this._handleMarker(t),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(t),this._eventEmitter.emit("result",{result:t}),this.eventManager.select(t,this)}},_requestType:function(t,e){return t.localGeocoderOnly?f:t.reverseGeocode&&/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(e)?m:d},_setupConfig:function(t,e){const n=/[\s,]+/;var i=this,r=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"].reduce((function(t,e){if(void 0===i.options[e]||null===i.options[e])return t;["countries","types","language"].indexOf(e)>-1?t[e]=i.options[e].split(n):t[e]=i.options[e];const r="number"==typeof i.options[e].longitude&&"number"==typeof i.options[e].latitude;if("proximity"===e&&r){const n=i.options[e].longitude,r=i.options[e].latitude;t[e]=[n,r]}return t}),{});switch(t){case m:var a=e.split(n).map((function(t){return parseFloat(t,10)})).reverse();!r.types||r.types[0],r=o(r,{query:a,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach((function(t){t in r&&delete r[t]}));break;case d:/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)*[ ]*$/.test(e)&&(e=e.replace(/,/g," ")),r=o(r,{query:e})}return r},_geocode:function(t){this.inputString=t,this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:t});const e=this._requestType(this.options,t),n=this._setupConfig(e,t);var i;switch(e){case f:i=Promise.resolve();break;case d:i=this.geocoderService.forwardGeocode(n).send();break;case m:i=this.geocoderService.reverseGeocode(n).send()}var r=this.options.localGeocoder&&this.options.localGeocoder(t)||[],o=[],a=null;return i.catch((function(t){a=t}).bind(this)).then((function(e){this._loadingEl.style.display="none";var i={};return e?"200"==e.statusCode&&((i=e.body).request=e.request,i.headers=e.headers):i={type:"FeatureCollection",features:[]},i.config=n,this.fresh&&(this.eventManager.start(this),this.fresh=!1),i.features=i.features?r.concat(i.features):r,this.options.externalGeocoder?(o=this.options.externalGeocoder(t,i.features)||[]).then((function(t){return i.features=i.features?t.concat(i.features):t,i}),(function(){return i})):i}).bind(this)).then((function(t){if(a)throw a;this.options.filter&&t.features.length&&(t.features=t.features.filter(this.options.filter)),t.features.length?(this._clearEl.style.display="block",this._eventEmitter.emit("results",t),this._typeahead.update(t.features)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",t))}).bind(this)).catch((function(t){this._loadingEl.style.display="none",r.length&&this.options.localGeocoder||o.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(r)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:r}),this._eventEmitter.emit("error",{error:t})}).bind(this)),i},_clear:function(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(t){this._clear(t),this._inputEl.focus()},_clearOnBlur:function(t){t.relatedTarget&&this._clear(t)},_onQueryResult:function(t){var e=t.body;if(e.features.length){var n=e.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},_updateProximity:function(){if(this._map)if(this._map.getZoom()>9){var t=this._map.getCenter().wrap();this.setProximity({longitude:t.lng,latitude:t.lat})}else this.setProximity(null)},_collapse:function(){this._inputEl.value||this._inputEl===document.activeElement||this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(t){return this._geocode(t).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderMessage:function(t){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(t)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var t=this.options.language.split(",")[0],e=h.language(t),n=p.placeholder[e];if(n)return n}return"Search"},setInput:function(t){return this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),t.length>=this.options.minLength&&this._geocode(t),this},setProximity:function(t){return this.options.proximity=t,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(t){return t&&"function"==typeof t&&(this._typeahead.render=t),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(t){var e=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=t||this.options.language||e,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(t){return this.options.zoom=t,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(t){return this.options.flyTo=t,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(t){return this.placeholder=t||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(t){return this.options.bbox=t,this},getCountries:function(){return this.options.countries},setCountries:function(t){return this.options.countries=t,this},getTypes:function(){return this.options.types},setTypes:function(t){return this.options.types=t,this},getMinLength:function(){return this.options.minLength},setMinLength:function(t){return this.options.minLength=t,this._typeahead&&(this._typeahead.options.minLength=t),this},getLimit:function(){return this.options.limit},setLimit:function(t){return this.options.limit=t,this._typeahead&&(this._typeahead.options.limit=t),this},getFilter:function(){return this.options.filter},setFilter:function(t){return this.options.filter=t,this},setOrigin:function(t){return this.options.origin=t,this.geocoderService=u(s({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAutocomplete:function(t){return this.options.autocomplete=t,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(t){return this.options.fuzzyMatch=t,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(t){return this.options.routing=t,this},getRouting:function(){return this.options.routing},setWorldview:function(t){return this.options.worldview=t,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(t){if(this._map){this._removeMarker();var e=o({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(e),t.center?this.mapMarker.setLngLat(t.center).addTo(this._map):t.geometry&&t.geometry.type&&"Point"===t.geometry.type&&t.geometry.coordinates&&this.mapMarker.setLngLat(t.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(t,e){return this._eventEmitter.on(t,e),this},off:function(t,e){return this._eventEmitter.removeListener(t,e),this.eventManager.remove(),this}},t.exports=g},ilH9:function(t,e,n){"use strict";n.r(e);var i=n("8Y7J"),r=n("8lb9");function o(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}var a=n("U8pU");function l(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function s(t){l(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===Object(a.a)(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function u(t,e){l(2,arguments);var n=s(t),i=o(e);return isNaN(i)?new Date(NaN):i?(n.setDate(n.getDate()+i),n):n}function c(t,e){l(2,arguments);var n=s(t).getTime(),i=o(e);return new Date(n+i)}function p(t,e){l(2,arguments);var n=o(e);return c(t,36e5*n)}function h(t,e){l(2,arguments);var n=o(e);return c(t,6e4*n)}function d(t,e){l(2,arguments);var n=o(e);return c(t,1e3*n)}function f(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function m(t){l(1,arguments);var e=s(t);return e.setHours(0,0,0,0),e}function g(t,e){l(2,arguments);var n=m(t),i=m(e),r=n.getTime()-f(n),o=i.getTime()-f(i);return Math.round((r-o)/864e5)}function v(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function y(t,e){l(2,arguments);var n=s(t),i=s(e),r=v(n,i),o=Math.abs(g(n,i));n.setDate(n.getDate()-r*o);var a=Number(v(n,i)===-r),u=r*(o-a);return 0===u?0:u}Math.pow(10,8);function _(t,e){return l(2,arguments),s(t).getTime()-s(e).getTime()}var b={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}};function x(t){return t?b[t]:b.trunc}function w(t,e,n){l(2,arguments);var i=_(t,e)/6e4;return x(null==n?void 0:n.roundingMethod)(i)}function C(t,e,n){l(2,arguments);var i=_(t,e)/1e3;return x(null==n?void 0:n.roundingMethod)(i)}function E(t){l(1,arguments);var e=s(t);return e.setHours(23,59,59,999),e}function S(t){l(1,arguments);var e=s(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}var T={};function I(){return T}function P(t,e){var n,i,r,a,u,c,p,h;l(1,arguments);var d=I(),f=o(null!==(n=null!==(i=null!==(r=null!==(a=null==e?void 0:e.weekStartsOn)&&void 0!==a?a:null==e||null===(u=e.locale)||void 0===u||null===(c=u.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==r?r:d.weekStartsOn)&&void 0!==i?i:null===(p=d.locale)||void 0===p||null===(h=p.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==n?n:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=s(t),g=m.getDay(),v=6+(g<f?-7:0)-(g-f);return m.setDate(m.getDate()+v),m.setHours(23,59,59,999),m}function A(t){l(1,arguments);var e=s(t),n=e.getDay();return n}function M(t){l(1,arguments);var e=s(t),n=e.getMonth();return n}function k(t,e){l(2,arguments);var n=m(t),i=m(e);return n.getTime()===i.getTime()}function D(t,e){l(2,arguments);var n=s(t),i=s(e);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}function L(t){l(1,arguments);var e=s(t);return e.setMilliseconds(0),e}function O(t,e){l(2,arguments);var n=L(t),i=L(e);return n.getTime()===i.getTime()}function R(t){var e,n;if(l(1,arguments),t&&"function"==typeof t.forEach)e=t;else{if("object"!==Object(a.a)(t)||null===t)return new Date(NaN);e=Array.prototype.slice.call(t)}return e.forEach((function(t){var e=s(t);(void 0===n||n<e||isNaN(Number(e)))&&(n=e)})),n||new Date(NaN)}function z(t,e){l(2,arguments);var n=s(t),i=o(e);return n.setHours(i),n}function F(t,e){l(2,arguments);var n=s(t),i=o(e);return n.setMinutes(i),n}function B(t){l(1,arguments);var e=s(t);return e.setSeconds(0,0),e}function N(t){l(1,arguments);var e=s(t);return e.setDate(1),e.setHours(0,0,0,0),e}function U(t,e){var n,i,r,a,u,c,p,h;l(1,arguments);var d=I(),f=o(null!==(n=null!==(i=null!==(r=null!==(a=null==e?void 0:e.weekStartsOn)&&void 0!==a?a:null==e||null===(u=e.locale)||void 0===u||null===(c=u.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==r?r:d.weekStartsOn)&&void 0!==i?i:null===(p=d.locale)||void 0===p||null===(h=p.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==n?n:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=s(t),g=m.getDay(),v=(g<f?7:0)+g-f;return m.setDate(m.getDate()-v),m.setHours(0,0,0,0),m}function j(t){l(1,arguments);var e=s(t),n=e.getHours();return n}function V(t){l(1,arguments);var e=s(t),n=e.getMinutes();return n}function q(t,e){l(2,arguments);var n=o(e),i=7*n;return u(t,i)}function G(t,e){l(2,arguments);var n=s(t),i=o(e);if(isNaN(i))return new Date(NaN);if(!i)return n;var r=n.getDate(),a=new Date(n.getTime());a.setMonth(n.getMonth()+i+1,0);var u=a.getDate();return r>=u?a:(n.setFullYear(a.getFullYear(),a.getMonth(),r),n)}function Z(t,e){l(2,arguments);var n=o(e);return u(t,-n)}function H(t,e){l(2,arguments);var n=o(e);return q(t,-n)}function Y(t,e){l(2,arguments);var n=o(e);return G(t,-n)}function X(t){return l(1,arguments),U(t,{weekStartsOn:1})}function W(t){l(1,arguments);var e=s(t),n=e.getFullYear(),i=new Date(0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);var r=X(i),o=new Date(0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);var a=X(o);return e.getTime()>=r.getTime()?n+1:e.getTime()>=a.getTime()?n:n-1}function K(t){l(1,arguments);var e=W(t),n=new Date(0);n.setFullYear(e,0,4),n.setHours(0,0,0,0);var i=X(n);return i}function J(t){l(1,arguments);var e=s(t),n=X(e).getTime()-K(e).getTime();return Math.round(n/6048e5)+1}function $(t,e){l(2,arguments);var n=s(t),i=o(e);return n.setDate(i),n}function Q(t){l(1,arguments);var e=s(t),n=e.getFullYear(),i=e.getMonth(),r=new Date(0);return r.setFullYear(n,i+1,0),r.setHours(0,0,0,0),r.getDate()}function tt(t,e){l(2,arguments);var n=s(t),i=o(e),r=n.getFullYear(),a=n.getDate(),u=new Date(0);u.setFullYear(r,i,15),u.setHours(0,0,0,0);var c=Q(u);return n.setMonth(i,Math.min(a,c)),n}function et(t,e){l(2,arguments);var n=s(t),i=o(e);return isNaN(n.getTime())?new Date(NaN):(n.setFullYear(i),n)}function nt(t){l(1,arguments);var e=s(t),n=e.getDate();return n}function it(t){return l(1,arguments),s(t).getFullYear()}var rt=n("SVse"),ot=n("2Yyj"),at=n.n(ot);Object(rt.I)(at.a,"es");const lt=function(){return Object(r.a)(Object(r.a)({},{addDays:u,addHours:p,addMinutes:h,addSeconds:d,differenceInDays:y,differenceInMinutes:w,differenceInSeconds:C,endOfDay:E,endOfMonth:S,endOfWeek:P,getDay:A,getMonth:M,isSameDay:k,isSameMonth:D,isSameSecond:O,max:R,setHours:z,setMinutes:F,startOfDay:m,startOfMinute:B,startOfMonth:N,startOfWeek:U,getHours:j,getMinutes:V}),{addWeeks:q,addMonths:G,subDays:Z,subWeeks:H,subMonths:Y,getISOWeek:J,setDate:$,setMonth:tt,setYear:et,getDate:nt,getYear:it})};class st{}var ut=n("9AJC"),ct=n("pMnS"),pt=n("iInd"),ht=n("xkgV"),dt=n("abRS"),ft=n("l0gW"),mt=n("s7LF");class gt{constructor(t,e,n,i){this._branchService=t,this._formBuilder=e,this._modalService=n,this._sweetAlertService=i,this.sucursales=[],this.loading=!0,this.config={itemsPerPage:10,currentPage:1,previousLabel:"Ant.",nextLabel:"Sig.",responsive:!0}}ngOnInit(){this.getBranches(),this.form=this.getFormBuilder()}getBranches(){this._branchService.getSucursales().subscribe(t=>{this.loading=!1,this.sucursales=t.mapas},()=>{this.loading=!1})}getFormBuilder(){return this._formBuilder.group({busqueda:["",[mt.B.required]]})}pageChanged(t){this.config.currentPage=t}openModal(t,e){this.modalRef=this._modalService.open(t)}changeVisibility(t,{idSucursal:e}){let n;n=t.target.checked?1:0,this._branchService.changeStatus(e,n).subscribe(t=>{this._sweetAlertService.alertoast("Actualizado con \xe9xito.","success"),this.getBranches()},()=>{this._sweetAlertService.alertoast("Error al cambiar visibilidad.","error")})}}var vt=n("+Cn7"),yt=n("G0yt"),_t=n("HHVr"),bt=[[".form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{float:none}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination .current{border-radius:50%}"]],xt=i["\u0275crt"]({encapsulation:0,styles:bt,data:{animation:[{type:7,name:"dropIn",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0,transform:"translateY(-100%)"},offset:null},options:void 0},{type:1,expr:":enter",animation:{type:4,styles:{type:6,styles:{opacity:1,transform:"translateY(0)"},offset:null},timings:"600ms linear"},options:null}],options:{}},{type:7,name:"slideIn",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0},offset:null},options:void 0},{type:0,name:"in",styles:{type:6,styles:{transform:"translateX(0)"},offset:null},options:void 0},{type:0,name:"out",styles:{type:6,styles:{transform:"translateX(-100%)"},offset:null},options:void 0},{type:1,expr:":enter",animation:{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"600ms ease-in"},options:null},{type:1,expr:"in => out",animation:{type:4,styles:null,timings:"600ms ease-in"},options:null}],options:{}},{type:7,name:"modalExpand",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0,transform:"scale(1.5)"},offset:null},options:void 0},{type:1,expr:":enter",animation:{type:4,styles:{type:6,styles:{opacity:1,transform:"scale(1)"},offset:null},timings:"800ms ease-in"},options:null},{type:1,expr:"* => void",animation:{type:4,styles:{type:6,styles:{opacity:0,transform:"scale(0.5)"},offset:null},timings:"500ms ease-out"},options:null}],options:{}}]}});function wt(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,3,"div",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,0,"div",[["class","spinner-border avatar-lg"],["role","status"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["CARGANDO..."]))],null,null)}function Ct(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,7,"div",[["class","text-center mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,6,"div",[["class","row justify-content-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,5,"div",[["class","col-lg-4"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,4,"div",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,0,"i",[["class","mdi mdi-cloud-alert"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,1,"h4",[["class","text-uppercase text-lith mt-3 txtnofount"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,[" NO HAY RESULTADOS. "]))],null,null)}function Et(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,20,"tr",[["class","text-center"]],[[24,"@dropIn",0]],null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](2,null,["",""])),(t()(),i["\u0275eld"](3,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](4,null,["",""])),(t()(),i["\u0275eld"](5,0,null,null,3,"td",[["class","table-action myPointerCursor"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,6).onClick()&&r);return r}),null,null)),i["\u0275did"](6,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275eld"](7,0,null,null,1,"a",[["class","action-icon"]],null,null,null,null,null)),(t()(),i["\u0275eld"](8,0,null,null,0,"i",[["class","mdi mdi-square-edit-outline"]],null,null,null,null,null)),(t()(),i["\u0275eld"](9,0,null,null,4,"td",[],null,null,null,null,null)),(t()(),i["\u0275eld"](10,0,null,null,3,"div",[["class","form-check"]],null,null,null,null,null)),(t()(),i["\u0275eld"](11,0,null,null,0,"input",[["class","form-check-input"],["type","checkbox"]],[[8,"id",0],[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeVisibility(n,t.context.$implicit)&&i);return i}),null,null)),(t()(),i["\u0275eld"](12,0,null,null,1,"label",[["class","form-check-label ms-2"]],[[8,"htmlFor",0]],null,null,null,null)),(t()(),i["\u0275ted"](13,null,["",""])),(t()(),i["\u0275eld"](14,0,null,null,3,"td",[["class","table-action myPointerCursor"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,15).onClick()&&r);return r}),null,null)),i["\u0275did"](15,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275eld"](16,0,null,null,1,"a",[["class","action-icon"]],null,null,null,null,null)),(t()(),i["\u0275eld"](17,0,null,null,0,"i",[["class","mdi mdi-cog text-primary"]],null,null,null,null,null)),(t()(),i["\u0275eld"](18,0,null,null,2,"td",[["class","table-action myPointerCursor"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,19).onClick()&&r);return r}),null,null)),i["\u0275did"](19,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275eld"](20,0,null,null,0,"img",[["alt","image"],["class","img-fluid avatar-sm"],["src","./assets/biorestaurant/iconos/iconsCaja/rappi-01.png"]],null,null,null,null,null))],(function(t,e){t(e,6,0,"../actualizar/"+e.context.$implicit.idSucursal);t(e,15,0,"../reservas");t(e,19,0,"../deliveries")}),(function(t,e){t(e,0,0,void 0),t(e,2,0,e.context.$implicit.idSucursal),t(e,4,0,e.context.$implicit.sucursal),t(e,11,0,i["\u0275inlineInterpolate"](1,"visible",e.context.index,""),1==e.context.$implicit.idStatusFk),t(e,12,0,i["\u0275inlineInterpolate"](1,"visible",e.context.index,"")),t(e,13,0,1==e.context.$implicit.idStatusFk?"Visible":"No visible")}))}function St(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,23,"div",[["class","table-responsive"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,19,"table",[["class","table table-centered w-100 dt-responsive nowrap"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,13,"thead",[["class","table-light"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,12,"tr",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Numero"])),(t()(),i["\u0275eld"](6,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Nombre"])),(t()(),i["\u0275eld"](8,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Editar"])),(t()(),i["\u0275eld"](10,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Visible?"])),(t()(),i["\u0275eld"](12,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Habilitaci\xf3n de Dias de Entrega"])),(t()(),i["\u0275eld"](14,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Configurar Rappi"])),(t()(),i["\u0275eld"](16,0,null,null,4,"tbody",[],null,null,null,null,null)),(t()(),i["\u0275and"](16777216,null,null,3,null,Et)),i["\u0275did"](18,278528,null,0,rt.n,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),i["\u0275ppd"](19,2),i["\u0275pid"](0,ht.b,[ht.e]),(t()(),i["\u0275eld"](21,0,null,null,2,"div",[["class","mt-4 d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](22,0,null,null,1,"pagination-controls",[["class","my-pagination"]],null,[[null,"pageChange"]],(function(t,e,n){var i=!0,r=t.component;"pageChange"===e&&(i=!1!==r.pageChanged(n)&&i);return i}),dt.b,dt.a)),i["\u0275did"](23,49152,null,0,ht.c,[],{previousLabel:[0,"previousLabel"],nextLabel:[1,"nextLabel"]},{pageChange:"pageChange"})],(function(t,e){var n=e.component,r=i["\u0275unv"](e,18,0,i["\u0275nov"](e,20).transform(i["\u0275unv"](e,18,0,t(e,19,0,i["\u0275nov"](e.parent,0),n.sucursales,n.form.controls.busqueda.value)),n.config));t(e,18,0,r),t(e,23,0,n.config.previousLabel,n.config.nextLabel)}),null)}function Tt(t){return i["\u0275vid"](0,[i["\u0275pid"](0,ft.a,[]),(t()(),i["\u0275eld"](1,0,null,null,40,"div",[["class","content-page"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,39,"div",[["class","content"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,38,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,11,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,10,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,9,"div",[["class","page-title-box"]],null,null,null,null,null)),(t()(),i["\u0275eld"](7,0,null,null,6,"div",[["class","page-title-right"]],null,null,null,null,null)),(t()(),i["\u0275eld"](8,0,null,null,5,"ol",[["class","breadcrumb m-0"]],null,null,null,null,null)),(t()(),i["\u0275eld"](9,0,null,null,2,"li",[["class","breadcrumb-item"]],null,null,null,null,null)),(t()(),i["\u0275eld"](10,0,null,null,1,"a",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Sucursales"])),(t()(),i["\u0275eld"](12,0,null,null,1,"li",[["class","breadcrumb-item active"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Listado"])),(t()(),i["\u0275eld"](14,0,null,null,1,"h4",[["class","page-title"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Sucursales"])),(t()(),i["\u0275eld"](16,0,null,null,25,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](17,0,null,null,24,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](18,0,null,null,23,"div",[["class","card"]],null,null,null,null,null)),(t()(),i["\u0275eld"](19,0,null,null,22,"div",[["class","card-body"]],null,null,null,null,null)),(t()(),i["\u0275eld"](20,0,null,null,15,"div",[["class","row mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](21,0,null,null,9,"div",[["class","col-sm-5"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;"submit"===e&&(r=!1!==i["\u0275nov"](t,22).onSubmit(n)&&r);"reset"===e&&(r=!1!==i["\u0275nov"](t,22).onReset()&&r);return r}),null,null)),i["\u0275did"](22,540672,null,0,mt.k,[[8,null],[8,null]],{form:[0,"form"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.k]),i["\u0275did"](24,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](25,0,null,null,5,"input",[["class","form-control customInputRadius"],["formControlName","busqueda"],["name","busqueda"],["placeholder","Nombre de la sucursal"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,26)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,26).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,26)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,26)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](26,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](28,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](30,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](31,0,null,null,4,"div",[["class","col-sm-7"]],null,null,null,null,null)),(t()(),i["\u0275eld"](32,0,null,null,3,"div",[["class","text-sm-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](33,0,null,null,2,"button",[["class","btn btn-success mb-2"],["routerLink","../crear"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,34).onClick()&&r);return r}),null,null)),i["\u0275did"](34,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275ted"](-1,null,[" Nueva "])),(t()(),i["\u0275and"](16777216,null,null,1,null,wt)),i["\u0275did"](37,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,Ct)),i["\u0275did"](39,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,St)),i["\u0275did"](41,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(t,e){var n=e.component;t(e,22,0,n.form);t(e,28,0,"busqueda");t(e,34,0,"../crear"),t(e,37,0,n.loading),t(e,39,0,!n.loading&&0==n.sucursales.length),t(e,41,0,!n.loading&&n.sucursales.length>0)}),(function(t,e){t(e,21,0,i["\u0275nov"](e,24).ngClassUntouched,i["\u0275nov"](e,24).ngClassTouched,i["\u0275nov"](e,24).ngClassPristine,i["\u0275nov"](e,24).ngClassDirty,i["\u0275nov"](e,24).ngClassValid,i["\u0275nov"](e,24).ngClassInvalid,i["\u0275nov"](e,24).ngClassPending),t(e,25,0,i["\u0275nov"](e,30).ngClassUntouched,i["\u0275nov"](e,30).ngClassTouched,i["\u0275nov"](e,30).ngClassPristine,i["\u0275nov"](e,30).ngClassDirty,i["\u0275nov"](e,30).ngClassValid,i["\u0275nov"](e,30).ngClassInvalid,i["\u0275nov"](e,30).ngClassPending)}))}var It=i["\u0275ccf"]("app-table",gt,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-table",[],null,null,null,Tt,xt)),i["\u0275did"](1,114688,null,0,gt,[vt.a,mt.f,yt.G,_t.a],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),Pt=n("4ZJM"),At=n("yugo"),Mt=n.n(At),kt=n("iFvi"),Dt=n.n(kt);const Lt=n("d9Rt"),Ot=n("EZ5H"),Rt=n("IH3z"),zt=n("3zpe");class Ft{constructor(t,e,n,r,o,a){this._sweetAlertsService=e,this._botService=n,this.service=r,this._route=o,this.admin=a,this.markers=[],this.setLocationLng=new i.EventEmitter,this.updateLocations=new i.EventEmitter,this.changeLoading=new i.EventEmitter,this.changeDetectorRef=t}ngOnInit(){Pt.accessToken="pk.eyJ1IjoiamVzc2Fkb2xmb3IiLCJhIjoiY2tidjM5ZWhhMDA0ZTJvb3lneXp4dTE1MSJ9.9kdR3CbbkAaC9I-NQuRjbQ",this.map=new Pt.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-58.45337711310299,-34.591064077979176],zoom:13}),this.id=this._route.snapshot.paramMap.get("id"),this.id&&this.map.on("load",()=>{this.service.getSucursalesById(this.id).subscribe(t=>{this.areas=t.mapas[0].areas,this.admin.tempFeatures=this.areas;let e=[];for(let n in this.areas){e=[];for(let i in this.areas[n].coordenadas){let t=Object.values(this.areas[n].coordenadas[i]).map(t=>parseFloat(t));e.push(Object.values(t))}let t=Object.values(this.areas[n].coordenadas[0]).map(t=>parseFloat(t));e.push(t),e.length>=4&&this.draw.add({id:"mapa"+n,type:"Feature",properties:{description:"<strong>Mad Men Season Five Finale Watch Party</strong><p>Head to Lounge 201 (201 Massachusetts Avenue NE) Sunday for a Mad Men Season Five Finale Watch Party, complete with 60s costume contest, Mad Men trivia, and retro food and drink. 8:00-11:00 p.m. $10 general admission, $20 admission and two hour open bar.</p>"},geometry:{type:"Polygon",coordinates:[e]}})}this.changeLoading.emit("xd"),this.initMap(),this.getAreas()})}),this.map.on("load",()=>{this.draw=new Mt.a({defaultMode:"draw_circle",userProperties:!0,modes:Object.assign({},Mt.a.modes,{draw_circle:Lt,drag_circle:Ot,direct_select:Rt,simple_select:zt})}),this.map.addControl(new Dt.a({accessToken:Pt.accessToken,mapboxgl:Pt})),this.map.addControl(this.draw),this.draw.changeMode("draw_circle",{initialRadiusInKm:.5}),this.map.on("draw.create",this.updateArea.bind(this)),this.map.on("draw.delete",this.updateArea.bind(this)),this.map.on("draw.update",this.updateArea.bind(this))})}getAreas(){const{features:t}=this.draw.getAll();this.updateLocations.emit(t)}updateArea(t){const{features:e}=this.draw.getAll(),n={features:e,e:t};this.setLocationLng.emit(n)}initMap(){this.areas.forEach((t,e)=>{const n=t.coordenadas.map(t=>[t.latitud,t.longitud]).filter(t=>t),i=e%2==0?"#008":"#f57c00",r=e%2==0?.3:.5;this.paintArea("zona-"+(e+1),n,i,r)})}paintArea(t,e,n,i){this.map.addSource(t,{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[e]}}}),this.map.addLayer({id:t,type:"fill",source:t,layout:{},paint:{"fill-color":n,"fill-opacity":i}}),this.map.on("draw.delete",e=>{var n=/(\d+)/g,i=e.features[0].id.match(n)[0];if(1==this.permissionDeleteZone){i=parseInt(i)+1;var r=t.match(n)[0];i===parseInt(r)&&this.map.removeLayer(t)}else this._sweetAlertsService.alertoast("El Parametro de Habilitar edici\xf3n zonas de envio esta apagado ","error")}),this.map.on("click",t,e=>{(new Pt.Popup).setLngLat(e.lngLat).setHTML(""+t).addTo(this.map)})}}var Bt=n("j6Vb"),Nt=n("AJ6+"),Ut=[["#map[_ngcontent-%COMP%]{margin-bottom:1rem;width:100%;height:70vh}"]],jt=i["\u0275crt"]({encapsulation:0,styles:Ut,data:{}});function Vt(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,3,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,2,"div",[["class","row justify-content-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,1,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,0,"div",[["id","map"]],null,null,null,null,null))],null,null)}i["\u0275ccf"]("app-map-two",Ft,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-map-two",[],null,null,null,Vt,jt)),i["\u0275did"](1,114688,null,0,Ft,[i.ChangeDetectorRef,_t.a,Bt.a,vt.a,pt.a,Nt.a],null,null)],(function(t,e){t(e,1,0)}),null)}),{tempFeature:"tempFeature",mapConfiguration:"mapConfiguration",permissionDeleteZone:"permissionDeleteZone"},{setLocationLng:"setLocationLng",updateLocations:"updateLocations",changeLoading:"changeLoading"},[]);var qt=n("iAfa"),Gt=n("Wiza");class Zt{constructor(t,e,n,i,r){this.service=t,this._sweetAlertsService=e,this.formBuilder=n,this.route=i,this._paramsService=r,this.mapConfiguration={},this.features=[],this.activeZone=!1,this.parameter29=!1,this.loading=!1,this.fileData=null,this.methods=[{name:"Efectivo",value:"f.isCash.value",abrv:"isCash",id:1},{name:"Cr\xe9dito",value:"f.isCredit.value",abrv:"isCredit",id:2},{name:"Debito",value:"f.isDredit.value",abrv:"isDredit",id:3},{name:"Transferencia",value:"f.isTransfer.value",abrv:"isTransfer",id:4},{name:"Mercado Pago",value:"f.isMercadoPago.value",abrv:"isMercadoPago",id:5},{name:"Bofa",value:"f.isBofa.value",abrv:"isBofa",id:14},{name:"Zelle",value:"f.isZelle.value",abrv:"isZelle",id:15},{name:"PayPal",value:"f.isPayapal.value",abrv:"isPayapal",id:16}],this.formData=new FormData,this.zonesValues=[]}ngOnInit(){this.createSucursal=this.formBuilder.group({name:["",mt.B.required],coste:this.formBuilder.array([]),zoneStatus:this.formBuilder.array([]),timeStore:["",mt.B.required],timeDelivery:["",mt.B.required],squedule:["",mt.B.required],isOpen:["0",mt.B.required],liWs:["0",mt.B.required],address:["",mt.B.required],clienteid:["",mt.B.required],secretid:["",mt.B.required],nameAppExternal:["",mt.B.required],deliveryStore:["",mt.B.required],takeAwey:["",mt.B.required],delieveryExternal:["",mt.B.required],localConsumption:["",mt.B.required],numberBank:["",mt.B.required],isCash:["0",mt.B.required],isCredit:["0",mt.B.required],isDedit:["0",mt.B.required],isTransfer:["0",mt.B.required],isMercadoPago:["0",mt.B.required],isPayapal:["0",mt.B.required],isZelle:["0",mt.B.required],isBofa:["0",mt.B.required],isPayapalInput:["0"],isZelleInput:["0"],isBofaInput:["0"],publicKeyMercadoPago:[""],accessToken:[""],ptoVenta:[""],zencillo:["0",mt.B.required],isZencillo:["0",mt.B.required],usdt:["0",mt.B.required],isUSDT:["0",mt.B.required],biopago:["0",mt.B.required],isBiopago:["0",mt.B.required]}),this._paramsService.GetParam().subscribe(t=>{this.parameter29=t.response[29].param,0==t.response[29].param?this.activeZone=!0:this.activeZone=!1},t=>{this._sweetAlertsService.alertoast("No se pud\xf3 obtener los paramentros","error")})}createItem(t){return this.formBuilder.group({value:["",mt.B.required]})}get coste(){return this.createSucursal.get("coste")}get zoneStatus(){return this.createSucursal.get("zoneStatus")}setLocationLng(t){if("draw.update"!==t.e.type)if("draw.delete"===t.e.type){const e=this.features.findIndex(e=>e.id==t.e.features[0].id);console.log("removed feature index",e),this.coste.removeAt(e),this.features.splice(e,1)}else this.features=t.features,this.coste.insert(this.coste.length,this.createItem()),this.zoneStatus.insert(this.coste.length,this.createItem(!1));else this.features=t.features}get f(){return this.createSucursal.controls}changeCheckbox(t){t.target.checked?("delivery"===t.target.name&&this.f.deliveryStore.setValue("1"),"externalDelivery"===t.target.name&&this.f.delieveryExternal.setValue("1"),"local"===t.target.name&&this.f.localConsumption.setValue("1"),"open"===t.target.name&&this.f.isOpen.setValue("1"),"away"===t.target.name&&this.f.takeAwey.setValue("1")):("delivery"===t.target.name&&this.f.deliveryStore.setValue("0"),"externalDelivery"===t.target.name&&this.f.delieveryExternal.setValue("0"),"local"===t.target.name&&this.f.localConsumption.setValue("0"),"open"===t.target.name&&this.f.isOpen.setValue("0"),"away"===t.target.name&&this.f.takeAwey.setValue("0"))}changeCheckboxPayments(t,e){t.target.checked?("isCash"===t.target.name&&this.f.isCash.setValue("1"),"isCredit"===t.target.name&&this.f.isCredit.setValue("1"),"isDebit"===t.target.name&&this.f.isDedit.setValue("1"),"isTransfer"===t.target.name&&this.f.isTransfer.setValue("1"),"isMercadoPago"===t.target.name&&this.f.isMercadoPago.setValue("1"),"isPayapal"===t.target.name&&this.f.isPayapal.setValue("1"),"isZelle"===t.target.name&&this.f.isZelle.setValue("1"),"isBofa"===t.target.name&&this.f.isBofa.setValue("1"),"isZencillo"===t.target.name&&this.f.isZencillo.setValue("1"),"isUSDT"===t.target.name&&this.f.isUSDT.setValue("1"),"isBiopago"===t.target.name&&this.f.isBiopago.setValue("1")):("isCash"===t.target.name&&this.f.isCash.setValue("0"),"isCredit"===t.target.name&&this.f.isCredit.setValue("0"),"isDebit"===t.target.name&&this.f.isDedit.setValue("0"),"isTransfer"===t.target.name&&this.f.isTransfer.setValue("0"),"isMercadoPago"===t.target.name&&this.f.isMercadoPago.setValue("0"),"isPayapal"===t.target.name&&this.f.isPayapal.setValue("0"),"isZelle"===t.target.name&&this.f.isZelle.setValue("0"),"isBofa"===t.target.name&&this.f.isBofa.setValue("0"),"isZencillo"===t.target.name&&this.f.isZencillo.setValue("0"),"isUSDT"===t.target.name&&this.f.isUSDT.setValue("0"),"isBiopago"===t.target.name&&this.f.isBiopago.setValue("0"))}changeZoneStatus(){this.createSucursal.get("zoneStatus").value.forEach(t=>{t.value=!!t.value})}saveAreas(){this.loading=!0,console.log("features save areas",this.features);let t=[];this.features.forEach(e=>{const n=e.geometry.coordinates[0];n.pop();const i=n.map(t=>({latitud:t[0],longitud:t[1]}));t.push(i)});let e={};t.forEach((t,n)=>{const i={coordenadas:t,costoEnvio:this.coste.value[n].value,status:this.zoneStatus.value[n].value?"1":"0"};e["area"+(n+1)]=[i]}),console.log("areas",e);let n={nameSucursal:this.f.name.value,timeStore:this.f.timeStore.value,timeDelivery:this.f.timeDelivery.value,liWs:this.f.liWs.value,isOpen:this.f.isOpen.value,numberBank:this.f.numberBank.value,address:this.f.address.value,clienteid:this.f.clienteid.value,secretid:this.f.secretid.value,nameAppExternal:this.f.nameAppExternal.value,deliveryStore:this.f.deliveryStore.value,takeAwey:this.f.takeAwey.value,delieveryExternal:this.f.delieveryExternal.value,localConsumption:this.f.localConsumption.value,squedule:this.f.squedule.value,mpprivateToken:this.f.accessToken.value,mppublicToken:this.f.publicKeyMercadoPago.value,ptoVenta:this.f.ptoVenta.value,isChash:this.f.isCash.value,isDebit:this.f.isCredit.value,isTransfer:this.f.isTransfer.value,isCredit:this.f.isCredit.value,isMercadoPago:this.f.isMercadoPago.value,isPayapal:this.f.isPayapal.value,isZelle:this.f.isZelle.value,isBofa:this.f.isBofa.value,accountPayapal:this.f.isPayapalInput.value,accountBofa:this.f.isBofaInput.value,accountZelle:this.f.isZelleInput.value,zencillo:this.f.zencillo.value,isZencillo:this.f.isZencillo.value,usdt:this.f.usdt.value,isUSDT:this.f.isUSDT.value,biopago:this.f.biopago.value,isBiopago:this.f.isBiopago.value,areas:e};this.service.NewSucursal(n).subscribe(t=>{this._sweetAlertsService.alertoast("Surcursal Creada","success"),this.loading=!1,this.route.navigateByUrl("admin/sucursales/listar")},()=>{this.loading=!1,this._sweetAlertsService.alertoast("Hubo un error, vuelva a intentarlo","error")})}}var Ht=n("HjzM"),Yt=[[""]],Xt=i["\u0275crt"]({encapsulation:0,styles:Yt,data:{}});function Wt(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,11,"div",[["class","col"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](1,212992,null,0,mt.l,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.l]),i["\u0275did"](3,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](4,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),i["\u0275ted"](5,null,["Coste env\xedo zona ",""])),(t()(),i["\u0275eld"](6,0,null,null,5,"input",[["class","form-control"],["formControlName","value"]],[[8,"readOnly",0],[8,"placeholder",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,7)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,7).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,7)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,7)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](7,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](9,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](11,16384,null,0,mt.q,[[4,mt.p]],null,null)],(function(t,e){t(e,1,0,e.context.index);t(e,9,0,"value")}),(function(t,e){var n=e.component;t(e,0,0,i["\u0275nov"](e,3).ngClassUntouched,i["\u0275nov"](e,3).ngClassTouched,i["\u0275nov"](e,3).ngClassPristine,i["\u0275nov"](e,3).ngClassDirty,i["\u0275nov"](e,3).ngClassValid,i["\u0275nov"](e,3).ngClassInvalid,i["\u0275nov"](e,3).ngClassPending),t(e,5,0,e.context.index+1),t(e,6,0,n.activeZone,i["\u0275inlineInterpolate"](1,"Coste de env\xedo de la zona ",e.context.index+1,""),i["\u0275nov"](e,11).ngClassUntouched,i["\u0275nov"](e,11).ngClassTouched,i["\u0275nov"](e,11).ngClassPristine,i["\u0275nov"](e,11).ngClassDirty,i["\u0275nov"](e,11).ngClassValid,i["\u0275nov"](e,11).ngClassInvalid,i["\u0275nov"](e,11).ngClassPending)}))}function Kt(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,14,"div",[["class","col"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](1,212992,null,0,mt.l,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.l]),i["\u0275did"](3,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](4,0,null,null,10,"div",[["class","form-group"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,9,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,1,"label",[["class","form-label"]],[[8,"htmlFor",0]],null,null,null,null)),(t()(),i["\u0275ted"](7,null,["Estado Zona ",""])),(t()(),i["\u0275eld"](8,0,null,null,5,"input",[["data-switch","success"],["formControlName","value"],["type","checkbox"]],[[8,"id",0],[8,"name",0],[8,"checked",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],(function(t,e,n){var r=!0,o=t.component;"change"===e&&(r=!1!==i["\u0275nov"](t,9).onChange(n.target.checked)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,9).onTouched()&&r);"change"===e&&(r=!1!==o.changeZoneStatus()&&r);return r}),null,null)),i["\u0275did"](9,16384,null,0,mt.b,[i.Renderer2,i.ElementRef],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.b]),i["\u0275did"](11,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](13,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](14,0,null,null,0,"label",[],[[8,"htmlFor",0]],null,null,null,null))],(function(t,e){t(e,1,0,e.context.index);t(e,11,0,"value")}),(function(t,e){var n=e.component;t(e,0,0,i["\u0275nov"](e,3).ngClassUntouched,i["\u0275nov"](e,3).ngClassTouched,i["\u0275nov"](e,3).ngClassPristine,i["\u0275nov"](e,3).ngClassDirty,i["\u0275nov"](e,3).ngClassValid,i["\u0275nov"](e,3).ngClassInvalid,i["\u0275nov"](e,3).ngClassPending),t(e,6,0,i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]")),t(e,7,0,e.context.index+1),t(e,8,0,i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]"),i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]"),n.zonesValues[e.context.index],i["\u0275nov"](e,13).ngClassUntouched,i["\u0275nov"](e,13).ngClassTouched,i["\u0275nov"](e,13).ngClassPristine,i["\u0275nov"](e,13).ngClassDirty,i["\u0275nov"](e,13).ngClassValid,i["\u0275nov"](e,13).ngClassInvalid,i["\u0275nov"](e,13).ngClassPending),t(e,14,0,i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]"))}))}function Jt(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,337,"div",[["class","content-page"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,336,"div",[["class","content"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,335,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,12,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,11,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,10,"div",[["class","page-title-box"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,7,"div",[["class","page-title-right"]],null,null,null,null,null)),(t()(),i["\u0275eld"](7,0,null,null,6,"ol",[["class","breadcrumb m-0"]],null,null,null,null,null)),(t()(),i["\u0275eld"](8,0,null,null,3,"li",[["class","breadcrumb-item myPointerCursor"],["routerLink","/admin/sucursales"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,9).onClick()&&r);return r}),null,null)),i["\u0275did"](9,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275eld"](10,0,null,null,1,"a",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Sucursales"])),(t()(),i["\u0275eld"](12,0,null,null,1,"li",[["class","breadcrumb-item active"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Nueva sucursal"])),(t()(),i["\u0275eld"](14,0,null,null,1,"h4",[["class","page-title"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Nueva sucursal"])),(t()(),i["\u0275eld"](16,0,null,null,321,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](17,0,null,null,320,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](18,0,null,null,319,"div",[["class","card"]],null,null,null,null,null)),(t()(),i["\u0275eld"](19,0,null,null,318,"div",[["class","card-body"]],null,null,null,null,null)),(t()(),i["\u0275eld"](20,0,null,null,317,"form",[["class","needs-validation"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0,o=t.component;"submit"===e&&(r=!1!==i["\u0275nov"](t,22).onSubmit(n)&&r);"reset"===e&&(r=!1!==i["\u0275nov"](t,22).onReset()&&r);"ngSubmit"===e&&(r=!1!==o.saveAreas()&&r);return r}),null,null)),i["\u0275did"](21,16384,null,0,mt.G,[],null,null),i["\u0275did"](22,540672,null,0,mt.k,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),i["\u0275prd"](2048,null,mt.c,null,[mt.k]),i["\u0275did"](24,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](25,0,null,null,310,"div",[["class","py-2 px-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](26,0,null,null,10,"ul",[["class","nav nav-tabs mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](27,0,null,null,4,"li",[["class","nav-item text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](28,0,null,null,3,"a",[["aria-expanded","true"],["class","nav-link active"],["data-bs-toggle","tab"],["href","#basicInformation"]],null,null,null,null,null)),(t()(),i["\u0275eld"](29,0,null,null,0,"i",[["class","mdi mdi-home-variant d-md-none d-block"]],null,null,null,null,null)),(t()(),i["\u0275eld"](30,0,null,null,1,"span",[["class","d-none d-md-block"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Datos b\xe1sicos"])),(t()(),i["\u0275eld"](32,0,null,null,4,"li",[["class","nav-item"]],null,null,null,null,null)),(t()(),i["\u0275eld"](33,0,null,null,3,"a",[["aria-expanded","false"],["class","nav-link"],["data-bs-toggle","tab"],["href","#paymentsMethods"]],null,null,null,null,null)),(t()(),i["\u0275eld"](34,0,null,null,0,"i",[["class","mdi mdi-note-text-outline d-md-none d-block"]],null,null,null,null,null)),(t()(),i["\u0275eld"](35,0,null,null,1,"span",[["class","d-none d-md-block"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Formas de pago"])),(t()(),i["\u0275eld"](37,0,null,null,277,"div",[["class","tab-content"]],null,null,null,null,null)),(t()(),i["\u0275eld"](38,0,null,null,140,"div",[["class","tab-pane show active"],["id","basicInformation"]],null,null,null,null,null)),(t()(),i["\u0275eld"](39,0,null,null,139,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](40,0,null,null,138,"div",[["class","row col-12 text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](41,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](42,0,null,null,1,"label",[["class","form-label"],["for","nombre"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Nombre de la sucursal"])),(t()(),i["\u0275eld"](44,0,null,null,5,"input",[["class","form-control"],["formControlName","name"],["id","nombre"],["placeholder","Nombre de la sucursal"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,45)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,45).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,45)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,45)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](45,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](47,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](49,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](50,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](51,0,null,null,1,"label",[["class","form-label"],["for","clienteid"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["T\xedtulo de portada"])),(t()(),i["\u0275eld"](53,0,null,null,5,"input",[["class","form-control"],["formControlName","clienteid"],["id","clienteid"],["placeholder","T\xedtulo de portada"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,54)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,54).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,54)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,54)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](54,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](56,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](58,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](59,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](60,0,null,null,1,"label",[["class","form-label"],["for","secretid"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["ID secreto"])),(t()(),i["\u0275eld"](62,0,null,null,5,"input",[["class","form-control"],["formControlName","secretid"],["id","secretid"],["placeholder","ID secreto"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,63)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,63).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,63)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,63)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](63,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](65,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](67,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](68,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](69,0,null,null,1,"label",[["class","form-label"],["for","liWs"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["N\xfamero de WhatsApp"])),(t()(),i["\u0275eld"](71,0,null,null,5,"input",[["class","form-control"],["formControlName","liWs"],["id","liWs"],["placeholder","N\xfamero de WhatsApp"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,72)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,72).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,72)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,72)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](72,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](74,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](76,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](77,0,null,null,8,"div",[["class","form-group col-12 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](78,0,null,null,1,"label",[["class","form-label"],["for","address"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Direcci\xf3n"])),(t()(),i["\u0275eld"](80,0,null,null,5,"input",[["class","form-control"],["formControlName","address"],["id","address"],["placeholder","Direcci\xf3n"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,81)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,81).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,81)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,81)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](81,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](83,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](85,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](86,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](87,0,null,null,1,"label",[["class","form-label"],["for","nameAppExternal"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Nombre de la app externa"])),(t()(),i["\u0275eld"](89,0,null,null,5,"input",[["class","form-control"],["formControlName","nameAppExternal"],["id","nameAppExternal"],["placeholder","Nombre de la app externa"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,90)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,90).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,90)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,90)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](90,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](92,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](94,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](95,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](96,0,null,null,1,"label",[["class","form-label"],["for","squedule"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Horario"])),(t()(),i["\u0275eld"](98,0,null,null,5,"input",[["class","form-control"],["formControlName","squedule"],["id","squedule"],["placeholder","Horario"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,99)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,99).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,99)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,99)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](99,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](101,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](103,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](104,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](105,0,null,null,1,"label",[["class","form-label"],["for","timeStore"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Tiempo de espera"])),(t()(),i["\u0275eld"](107,0,null,null,5,"input",[["class","form-control"],["formControlName","timeStore"],["id","timeStore"],["placeholder","Tiempo de espera"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,108)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,108).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,108)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,108)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](108,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](110,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](112,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](113,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](114,0,null,null,1,"label",[["class","form-label"],["for","timeDelivery"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Tiempo de espera del delivery"])),(t()(),i["\u0275eld"](116,0,null,null,5,"input",[["class","form-control"],["formControlName","timeDelivery"],["id","timeDelivery"],["placeholder","Tiempo de espera del delivery"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,117)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,117).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,117)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,117)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](117,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](119,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](121,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](122,0,null,null,8,"div",[["class","form-group col-12 col-lg-4 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](123,0,null,null,1,"label",[["class","form-label"],["for","publicKeyMercadoPago"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Public Key Mercado pago"])),(t()(),i["\u0275eld"](125,0,null,null,5,"input",[["class","form-control"],["formControlName","publicKeyMercadoPago"],["id","publicKeyMercadoPago"],["placeholder","Public Key Mercado pago"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,126)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,126).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,126)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,126)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](126,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](128,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](130,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](131,0,null,null,8,"div",[["class","form-group col-12 col-lg-4 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](132,0,null,null,1,"label",[["class","form-label"],["for","accessToken"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Access Token Mercado Pago"])),(t()(),i["\u0275eld"](134,0,null,null,5,"input",[["class","form-control"],["formControlName","accessToken"],["id","accessToken"],["placeholder","Access Token Mercado Pago"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,135)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,135).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,135)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,135)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](135,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](137,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](139,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](140,0,null,null,8,"div",[["class","form-group col-12 col-lg-4 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](141,0,null,null,1,"label",[["class","form-label"],["for","ptoVenta"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Punto de venta fiscal"])),(t()(),i["\u0275eld"](143,0,null,null,5,"input",[["class","form-control"],["formControlName","ptoVenta"],["id","ptoVenta"],["placeholder","Punto de venta fiscal"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,144)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,144).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,144)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,144)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](144,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](146,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](148,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](149,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](150,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](151,0,null,null,1,"label",[["class","form-label"],["for","open"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Est\xe1 abierto?"])),(t()(),i["\u0275eld"](153,0,null,null,0,"input",[["data-switch","success"],["id","open"],["name","open"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](154,0,null,null,0,"label",[["for","open"]],null,null,null,null,null)),(t()(),i["\u0275eld"](155,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](156,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](157,0,null,null,1,"label",[["class","form-label"],["for","away"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Take Away?"])),(t()(),i["\u0275eld"](159,0,null,null,0,"input",[["data-switch","success"],["id","away"],["name","away"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](160,0,null,null,0,"label",[["for","away"]],null,null,null,null,null)),(t()(),i["\u0275eld"](161,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](162,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](163,0,null,null,1,"label",[["class","form-label"],["for","delivery"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Delivery?"])),(t()(),i["\u0275eld"](165,0,null,null,0,"input",[["data-switch","success"],["id","delivery"],["name","delivery"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](166,0,null,null,0,"label",[["for","delivery"]],null,null,null,null,null)),(t()(),i["\u0275eld"](167,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](168,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](169,0,null,null,1,"label",[["class","form-label"],["for","externalDelivery"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Delivery externo?"])),(t()(),i["\u0275eld"](171,0,null,null,0,"input",[["data-switch","success"],["id","externalDelivery"],["name","externalDelivery"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](172,0,null,null,0,"label",[["for","externalDelivery"]],null,null,null,null,null)),(t()(),i["\u0275eld"](173,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](174,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](175,0,null,null,1,"label",[["class","form-label"],["for","local"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Consumir en local?"])),(t()(),i["\u0275eld"](177,0,null,null,0,"input",[["data-switch","success"],["id","local"],["name","local"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](178,0,null,null,0,"label",[["for","local"]],null,null,null,null,null)),(t()(),i["\u0275eld"](179,0,null,null,135,"div",[["class","tab-pane"],["id","paymentsMethods"]],null,null,null,null,null)),(t()(),i["\u0275eld"](180,0,null,null,134,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](181,0,null,null,133,"div",[["class","row col-12 text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](182,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](183,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](184,0,null,null,1,"label",[["class","form-label"],["for","isCash"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Efectivo"])),(t()(),i["\u0275eld"](186,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](187,0,null,null,0,"input",[["data-switch","success"],["id","isCash"],["name","isCash"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isCash")&&i);return i}),null,null)),(t()(),i["\u0275eld"](188,0,null,null,0,"label",[["for","isCash"]],null,null,null,null,null)),(t()(),i["\u0275eld"](189,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](190,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](191,0,null,null,1,"label",[["class","form-label"],["for","isMercadoPago"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Mercado Pago"])),(t()(),i["\u0275eld"](193,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](194,0,null,null,0,"input",[["data-switch","success"],["id","isMercadoPago"],["name","isMercadoPago"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isMercadoPago")&&i);return i}),null,null)),(t()(),i["\u0275eld"](195,0,null,null,0,"label",[["for","isMercadoPago"]],null,null,null,null,null)),(t()(),i["\u0275eld"](196,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](197,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](198,0,null,null,1,"label",[["class","form-label"],["for","isDedit"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["D\xe9bito"])),(t()(),i["\u0275eld"](200,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](201,0,null,null,0,"input",[["data-switch","success"],["id","isDedit"],["name","isDedit"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isDedit")&&i);return i}),null,null)),(t()(),i["\u0275eld"](202,0,null,null,0,"label",[["for","isDedit"]],null,null,null,null,null)),(t()(),i["\u0275eld"](203,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](204,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](205,0,null,null,1,"label",[["class","form-label"],["for","isBofa"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Bofa"])),(t()(),i["\u0275eld"](207,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](208,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](209,0,null,null,5,"input",[["class","form-control"],["formControlName","isBofaInput"],["id","isBofaInput"],["name","isBofaInput"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,210)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,210).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,210)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,210)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](210,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](212,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](214,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](215,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](216,0,null,null,0,"input",[["data-switch","success"],["id","isBofa"],["name","isBofa"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isBofa")&&i);return i}),null,null)),(t()(),i["\u0275eld"](217,0,null,null,0,"label",[["for","isBofa"]],null,null,null,null,null)),(t()(),i["\u0275eld"](218,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](219,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](220,0,null,null,1,"label",[["class","form-label"],["for","isCredit"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Cr\xe9dito"])),(t()(),i["\u0275eld"](222,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](223,0,null,null,0,"input",[["data-switch","success"],["id","isCredit"],["name","isCredit"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isCredit")&&i);return i}),null,null)),(t()(),i["\u0275eld"](224,0,null,null,0,"label",[["for","isCredit"]],null,null,null,null,null)),(t()(),i["\u0275eld"](225,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](226,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](227,0,null,null,1,"label",[["class","form-label"],["for","isPayapal"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Paypal"])),(t()(),i["\u0275eld"](229,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](230,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](231,0,null,null,5,"input",[["class","form-control"],["formControlName","isPayapalInput"],["id","isPayapalInput"],["name","isPayapalInput"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,232)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,232).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,232)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,232)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](232,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](234,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](236,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](237,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](238,0,null,null,0,"input",[["data-switch","success"],["id","isPayapal"],["name","isPayapal"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isPayapal")&&i);return i}),null,null)),(t()(),i["\u0275eld"](239,0,null,null,0,"label",[["for","isPayapal"]],null,null,null,null,null)),(t()(),i["\u0275eld"](240,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](241,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](242,0,null,null,1,"label",[["class","form-label"],["for","isTransfer"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Transferencia"])),(t()(),i["\u0275eld"](244,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](245,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](246,0,null,null,5,"input",[["class","form-control"],["formControlName","numberBank"],["placeholder","Banco"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,247)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,247).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,247)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,247)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](247,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](249,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](251,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](252,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](253,0,null,null,0,"input",[["data-switch","success"],["id","isTransfer"],["name","isTransfer"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isTransfer")&&i);return i}),null,null)),(t()(),i["\u0275eld"](254,0,null,null,0,"label",[["for","isTransfer"]],null,null,null,null,null)),(t()(),i["\u0275eld"](255,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](256,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](257,0,null,null,1,"label",[["class","form-label"],["for","isZelle"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Zelle"])),(t()(),i["\u0275eld"](259,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](260,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](261,0,null,null,5,"input",[["class","form-control"],["formControlName","isZelleInput"],["id","isZelleInput"],["name","isZelleInput"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,262)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,262).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,262)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,262)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](262,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](264,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](266,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](267,0,null,null,2,"div",[["class","row d-flex justify-content-end col mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](268,0,null,null,0,"input",[["data-switch","success"],["id","isZelle"],["name","isZelle"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isZelle")&&i);return i}),null,null)),(t()(),i["\u0275eld"](269,0,null,null,0,"label",[["for","isZelle"]],null,null,null,null,null)),(t()(),i["\u0275eld"](270,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](271,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](272,0,null,null,1,"label",[["class","form-label"],["for","isZencillo"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Zencillo"])),(t()(),i["\u0275eld"](274,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](275,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](276,0,null,null,5,"input",[["class","form-control"],["formControlName","zencillo"],["placeholder","Zencillo"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,277)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,277).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,277)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,277)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](277,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](279,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](281,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](282,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](283,0,null,null,0,"input",[["data-switch","success"],["id","isZencillo"],["name","isZencillo"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isZencillo")&&i);return i}),null,null)),(t()(),i["\u0275eld"](284,0,null,null,0,"label",[["for","isZencillo"]],null,null,null,null,null)),(t()(),i["\u0275eld"](285,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](286,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](287,0,null,null,1,"label",[["class","form-label"],["for","isUSDT"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["USDT"])),(t()(),i["\u0275eld"](289,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](290,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](291,0,null,null,5,"input",[["class","form-control"],["formControlName","usdt"],["id","nombre"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,292)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,292).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,292)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,292)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](292,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](294,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](296,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](297,0,null,null,2,"div",[["class","row d-flex justify-content-end col mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](298,0,null,null,0,"input",[["data-switch","success"],["id","isUSDT"],["name","isUSDT"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isUSDT")&&i);return i}),null,null)),(t()(),i["\u0275eld"](299,0,null,null,0,"label",[["for","isUSDT"]],null,null,null,null,null)),(t()(),i["\u0275eld"](300,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](301,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](302,0,null,null,1,"label",[["class","form-label"],["for","isBiopago"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Bio Pago"])),(t()(),i["\u0275eld"](304,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](305,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](306,0,null,null,5,"input",[["class","form-control"],["formControlName","biopago"],["id","nombre"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,307)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,307).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,307)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,307)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](307,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](309,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](311,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](312,0,null,null,2,"div",[["class","row d-flex justify-content-end col mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](313,0,null,null,0,"input",[["data-switch","success"],["id","isBiopago"],["name","isBiopago"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isBiopago")&&i);return i}),null,null)),(t()(),i["\u0275eld"](314,0,null,null,0,"label",[["for","isBiopago"]],null,null,null,null,null)),(t()(),i["\u0275eld"](315,0,null,null,20,"div",[["class","row my-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](316,0,null,null,4,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](317,0,null,null,1,"p",[["class","h4"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Mapa de env\xedo"])),(t()(),i["\u0275eld"](319,0,null,null,1,"p",[["class","h5"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,[" Configure las zonas de env\xedo "])),(t()(),i["\u0275eld"](321,0,null,null,2,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](322,0,null,null,1,"app-map-two",[],null,[[null,"setLocationLng"]],(function(t,e,n){var i=!0,r=t.component;"setLocationLng"===e&&(i=!1!==r.setLocationLng(n)&&i);return i}),Vt,jt)),i["\u0275did"](323,114688,null,0,Ft,[i.ChangeDetectorRef,_t.a,Bt.a,vt.a,pt.a,Nt.a],{mapConfiguration:[0,"mapConfiguration"],permissionDeleteZone:[1,"permissionDeleteZone"]},{setLocationLng:"setLocationLng"}),(t()(),i["\u0275eld"](324,0,null,null,5,"div",[["class","d-flex flex-row text-center"],["formArrayName","coste"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](325,212992,null,0,mt.e,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.e]),i["\u0275did"](327,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275and"](16777216,null,null,1,null,Wt)),i["\u0275did"](329,278528,null,0,rt.n,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),i["\u0275eld"](330,0,null,null,5,"div",[["class","d-flex flex-row text-center"],["formArrayName","zoneStatus"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](331,212992,null,0,mt.e,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.e]),i["\u0275did"](333,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275and"](16777216,null,null,1,null,Kt)),i["\u0275did"](335,278528,null,0,rt.n,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),i["\u0275eld"](336,0,null,null,1,"button",[["class","btn btn-success w-100"],["type","submit"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Guardar"])),(t()(),i["\u0275eld"](338,0,null,null,2,"ngx-loading",[],null,null,null,qt.b,qt.a)),i["\u0275did"](339,114688,null,0,Gt.a,[Gt.c,i.ChangeDetectorRef],{show:[0,"show"],config:[1,"config"]},null),i["\u0275pod"](340,{backdropBorderRadius:0})],(function(t,e){var n=e.component;t(e,9,0,"/admin/sucursales"),t(e,22,0,n.createSucursal);t(e,47,0,"name");t(e,56,0,"clienteid");t(e,65,0,"secretid");t(e,74,0,"liWs");t(e,83,0,"address");t(e,92,0,"nameAppExternal");t(e,101,0,"squedule");t(e,110,0,"timeStore");t(e,119,0,"timeDelivery");t(e,128,0,"publicKeyMercadoPago");t(e,137,0,"accessToken");t(e,146,0,"ptoVenta");t(e,212,0,"isBofaInput");t(e,234,0,"isPayapalInput");t(e,249,0,"numberBank");t(e,264,0,"isZelleInput");t(e,279,0,"zencillo");t(e,294,0,"usdt");t(e,309,0,"biopago"),t(e,323,0,n.mapConfiguration,n.parameter29);t(e,325,0,"coste"),t(e,329,0,n.coste.controls);t(e,331,0,"zoneStatus"),t(e,335,0,n.zoneStatus.controls);var i=n.loading,r=t(e,340,0,"3px");t(e,339,0,i,r)}),(function(t,e){var n=e.component;t(e,20,0,i["\u0275nov"](e,24).ngClassUntouched,i["\u0275nov"](e,24).ngClassTouched,i["\u0275nov"](e,24).ngClassPristine,i["\u0275nov"](e,24).ngClassDirty,i["\u0275nov"](e,24).ngClassValid,i["\u0275nov"](e,24).ngClassInvalid,i["\u0275nov"](e,24).ngClassPending),t(e,44,0,i["\u0275nov"](e,49).ngClassUntouched,i["\u0275nov"](e,49).ngClassTouched,i["\u0275nov"](e,49).ngClassPristine,i["\u0275nov"](e,49).ngClassDirty,i["\u0275nov"](e,49).ngClassValid,i["\u0275nov"](e,49).ngClassInvalid,i["\u0275nov"](e,49).ngClassPending),t(e,53,0,i["\u0275nov"](e,58).ngClassUntouched,i["\u0275nov"](e,58).ngClassTouched,i["\u0275nov"](e,58).ngClassPristine,i["\u0275nov"](e,58).ngClassDirty,i["\u0275nov"](e,58).ngClassValid,i["\u0275nov"](e,58).ngClassInvalid,i["\u0275nov"](e,58).ngClassPending),t(e,62,0,i["\u0275nov"](e,67).ngClassUntouched,i["\u0275nov"](e,67).ngClassTouched,i["\u0275nov"](e,67).ngClassPristine,i["\u0275nov"](e,67).ngClassDirty,i["\u0275nov"](e,67).ngClassValid,i["\u0275nov"](e,67).ngClassInvalid,i["\u0275nov"](e,67).ngClassPending),t(e,71,0,i["\u0275nov"](e,76).ngClassUntouched,i["\u0275nov"](e,76).ngClassTouched,i["\u0275nov"](e,76).ngClassPristine,i["\u0275nov"](e,76).ngClassDirty,i["\u0275nov"](e,76).ngClassValid,i["\u0275nov"](e,76).ngClassInvalid,i["\u0275nov"](e,76).ngClassPending),t(e,80,0,i["\u0275nov"](e,85).ngClassUntouched,i["\u0275nov"](e,85).ngClassTouched,i["\u0275nov"](e,85).ngClassPristine,i["\u0275nov"](e,85).ngClassDirty,i["\u0275nov"](e,85).ngClassValid,i["\u0275nov"](e,85).ngClassInvalid,i["\u0275nov"](e,85).ngClassPending),t(e,89,0,i["\u0275nov"](e,94).ngClassUntouched,i["\u0275nov"](e,94).ngClassTouched,i["\u0275nov"](e,94).ngClassPristine,i["\u0275nov"](e,94).ngClassDirty,i["\u0275nov"](e,94).ngClassValid,i["\u0275nov"](e,94).ngClassInvalid,i["\u0275nov"](e,94).ngClassPending),t(e,98,0,i["\u0275nov"](e,103).ngClassUntouched,i["\u0275nov"](e,103).ngClassTouched,i["\u0275nov"](e,103).ngClassPristine,i["\u0275nov"](e,103).ngClassDirty,i["\u0275nov"](e,103).ngClassValid,i["\u0275nov"](e,103).ngClassInvalid,i["\u0275nov"](e,103).ngClassPending),t(e,107,0,i["\u0275nov"](e,112).ngClassUntouched,i["\u0275nov"](e,112).ngClassTouched,i["\u0275nov"](e,112).ngClassPristine,i["\u0275nov"](e,112).ngClassDirty,i["\u0275nov"](e,112).ngClassValid,i["\u0275nov"](e,112).ngClassInvalid,i["\u0275nov"](e,112).ngClassPending),t(e,116,0,i["\u0275nov"](e,121).ngClassUntouched,i["\u0275nov"](e,121).ngClassTouched,i["\u0275nov"](e,121).ngClassPristine,i["\u0275nov"](e,121).ngClassDirty,i["\u0275nov"](e,121).ngClassValid,i["\u0275nov"](e,121).ngClassInvalid,i["\u0275nov"](e,121).ngClassPending),t(e,125,0,i["\u0275nov"](e,130).ngClassUntouched,i["\u0275nov"](e,130).ngClassTouched,i["\u0275nov"](e,130).ngClassPristine,i["\u0275nov"](e,130).ngClassDirty,i["\u0275nov"](e,130).ngClassValid,i["\u0275nov"](e,130).ngClassInvalid,i["\u0275nov"](e,130).ngClassPending),t(e,134,0,i["\u0275nov"](e,139).ngClassUntouched,i["\u0275nov"](e,139).ngClassTouched,i["\u0275nov"](e,139).ngClassPristine,i["\u0275nov"](e,139).ngClassDirty,i["\u0275nov"](e,139).ngClassValid,i["\u0275nov"](e,139).ngClassInvalid,i["\u0275nov"](e,139).ngClassPending),t(e,143,0,i["\u0275nov"](e,148).ngClassUntouched,i["\u0275nov"](e,148).ngClassTouched,i["\u0275nov"](e,148).ngClassPristine,i["\u0275nov"](e,148).ngClassDirty,i["\u0275nov"](e,148).ngClassValid,i["\u0275nov"](e,148).ngClassInvalid,i["\u0275nov"](e,148).ngClassPending),t(e,153,0,"1"===n.f.isOpen.value),t(e,159,0,"1"===n.f.takeAwey.value),t(e,165,0,"1"===n.f.deliveryStore.value),t(e,171,0,"1"===n.f.delieveryExternal.value),t(e,177,0,"1"===n.f.localConsumption.value),t(e,187,0,"1"===n.f.isCash.value),t(e,194,0,"1"===n.f.isMercadoPago.value),t(e,201,0,"1"===n.f.isDedit.value),t(e,209,0,i["\u0275nov"](e,214).ngClassUntouched,i["\u0275nov"](e,214).ngClassTouched,i["\u0275nov"](e,214).ngClassPristine,i["\u0275nov"](e,214).ngClassDirty,i["\u0275nov"](e,214).ngClassValid,i["\u0275nov"](e,214).ngClassInvalid,i["\u0275nov"](e,214).ngClassPending),t(e,216,0,"1"===n.f.isBofa.value),t(e,223,0,"1"===n.f.isCredit.value),t(e,231,0,i["\u0275nov"](e,236).ngClassUntouched,i["\u0275nov"](e,236).ngClassTouched,i["\u0275nov"](e,236).ngClassPristine,i["\u0275nov"](e,236).ngClassDirty,i["\u0275nov"](e,236).ngClassValid,i["\u0275nov"](e,236).ngClassInvalid,i["\u0275nov"](e,236).ngClassPending),t(e,238,0,"1"===n.f.isPayapal.value),t(e,246,0,i["\u0275nov"](e,251).ngClassUntouched,i["\u0275nov"](e,251).ngClassTouched,i["\u0275nov"](e,251).ngClassPristine,i["\u0275nov"](e,251).ngClassDirty,i["\u0275nov"](e,251).ngClassValid,i["\u0275nov"](e,251).ngClassInvalid,i["\u0275nov"](e,251).ngClassPending),t(e,253,0,"1"===n.f.isTransfer.value),t(e,261,0,i["\u0275nov"](e,266).ngClassUntouched,i["\u0275nov"](e,266).ngClassTouched,i["\u0275nov"](e,266).ngClassPristine,i["\u0275nov"](e,266).ngClassDirty,i["\u0275nov"](e,266).ngClassValid,i["\u0275nov"](e,266).ngClassInvalid,i["\u0275nov"](e,266).ngClassPending),t(e,268,0,"1"===n.f.isZelle.value),t(e,276,0,i["\u0275nov"](e,281).ngClassUntouched,i["\u0275nov"](e,281).ngClassTouched,i["\u0275nov"](e,281).ngClassPristine,i["\u0275nov"](e,281).ngClassDirty,i["\u0275nov"](e,281).ngClassValid,i["\u0275nov"](e,281).ngClassInvalid,i["\u0275nov"](e,281).ngClassPending),t(e,283,0,"1"===n.f.isZencillo.value),t(e,291,0,i["\u0275nov"](e,296).ngClassUntouched,i["\u0275nov"](e,296).ngClassTouched,i["\u0275nov"](e,296).ngClassPristine,i["\u0275nov"](e,296).ngClassDirty,i["\u0275nov"](e,296).ngClassValid,i["\u0275nov"](e,296).ngClassInvalid,i["\u0275nov"](e,296).ngClassPending),t(e,298,0,"1"===n.f.isUSDT.value),t(e,306,0,i["\u0275nov"](e,311).ngClassUntouched,i["\u0275nov"](e,311).ngClassTouched,i["\u0275nov"](e,311).ngClassPristine,i["\u0275nov"](e,311).ngClassDirty,i["\u0275nov"](e,311).ngClassValid,i["\u0275nov"](e,311).ngClassInvalid,i["\u0275nov"](e,311).ngClassPending),t(e,313,0,"1"===n.f.isBiopago.value),t(e,324,0,i["\u0275nov"](e,327).ngClassUntouched,i["\u0275nov"](e,327).ngClassTouched,i["\u0275nov"](e,327).ngClassPristine,i["\u0275nov"](e,327).ngClassDirty,i["\u0275nov"](e,327).ngClassValid,i["\u0275nov"](e,327).ngClassInvalid,i["\u0275nov"](e,327).ngClassPending),t(e,330,0,i["\u0275nov"](e,333).ngClassUntouched,i["\u0275nov"](e,333).ngClassTouched,i["\u0275nov"](e,333).ngClassPristine,i["\u0275nov"](e,333).ngClassDirty,i["\u0275nov"](e,333).ngClassValid,i["\u0275nov"](e,333).ngClassInvalid,i["\u0275nov"](e,333).ngClassPending)}))}var $t=i["\u0275ccf"]("app-create",Zt,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-create",[],null,null,null,Jt,Xt)),i["\u0275did"](1,114688,null,0,Zt,[vt.a,_t.a,mt.f,pt.k,Ht.a],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),Qt=n("Iab2"),te=n("PSD3"),ee=n.n(te),ne=n("AytR");class ie{constructor(t,e,n,i,r,o,a){this.service=t,this._paramsService=e,this._sweetAlertsService=n,this.formBuilder=i,this._route=r,this.admin=o,this.router=a,this.mapConfiguration={},this.loading=!1,this.activeZone=!1,this.parameter29=!1,this.features=[],this.newFeatures=[],this.response=[],this.tempFeatures=[],this.fileData=null,this.formData=new FormData,this.zonesValues=[],this.urlMapaBackUp=ne.a.apiHost+"/api/v2/mapasGlobales/backup",this.createSucursal=this.formBuilder.group({name:["",mt.B.required],coste:this.formBuilder.array([]),zoneStatus:this.formBuilder.array([]),timeStore:["",mt.B.required],timeDelivery:["",mt.B.required],squedule:["",mt.B.required],isOpen:["0",mt.B.required],liWs:["0",mt.B.required],address:["",mt.B.required],clienteid:["",mt.B.required],secretid:["",mt.B.required],nameAppExternal:["",mt.B.required],deliveryStore:["",mt.B.required],takeAwey:["",mt.B.required],delieveryExternal:["",mt.B.required],localConsumption:["",mt.B.required],numberBank:["",mt.B.required],isCash:["0",mt.B.required],isCredit:["0",mt.B.required],isDedit:["0",mt.B.required],isTransfer:["0",mt.B.required],isMercadoPago:["0",mt.B.required],isPayapal:["0",mt.B.required],isZelle:["0",mt.B.required],isBofa:["0",mt.B.required],isPayapalInput:["0"],isZelleInput:["0"],isBofaInput:["0"],publicKeyMercadoPago:[""],accessToken:[""],ptoVenta:[""],zencillo:["0",mt.B.required],isZencillo:["0",mt.B.required],usdt:["0",mt.B.required],isUSDT:["0",mt.B.required],biopago:["0",mt.B.required],isBiopago:["0",mt.B.required],percentajebills:[""]})}ngOnInit(){this.id=this._route.snapshot.paramMap.get("id"),this.loading=!0,this.service.getSucursalesById(this.id).subscribe(t=>{this.response=t.mapas[0].areas,console.log("data",t.mapas[0]);for(let e in this.response)this.coste.insert(this.coste.length,this.createItem(this.response[e].costoEnvio)),this.zoneStatus.insert(this.coste.length,this.createItem("1"===this.response[e].status));this.zonesValues=[];for(const e of this.zoneStatus.controls)this.zonesValues.push(e.value.value);this.f.name.setValue(t.mapas[0].sucursal),this.f.timeStore.setValue(t.mapas[0].timeStore),this.f.timeDelivery.setValue(t.mapas[0].timeDelivery),this.f.isOpen.setValue(t.mapas[0].isOpen),this.f.liWs.setValue(t.mapas[0].liWs),this.f.isMercadoPago.setValue(t.mapas[0].isMercadoPago),this.f.isCash.setValue(t.mapas[0].isChash),this.f.isTransfer.setValue(t.mapas[0].isTransfer),this.f.address.setValue(t.mapas[0].address),this.f.clienteid.setValue(t.mapas[0].clienteid),this.f.secretid.setValue(t.mapas[0].secretid),this.f.nameAppExternal.setValue(t.mapas[0].nameAppExternal),this.f.deliveryStore.setValue(t.mapas[0].deliveryStore),this.f.takeAwey.setValue(t.mapas[0].takeAwey),this.f.delieveryExternal.setValue(t.mapas[0].delieveryExternal),this.f.localConsumption.setValue(t.mapas[0].localConsumption),this.idSucursal=t.mapas[0].idSucursal,this.f.squedule.setValue(t.mapas[0].squedule),this.f.numberBank.setValue(t.mapas[0].numberBank),this.f.isDedit.setValue(t.mapas[0].isDebit),this.f.isCredit.setValue(t.mapas[0].isCredit),this.f.publicKeyMercadoPago.setValue(t.mapas[0].mppublicToken),this.f.accessToken.setValue(t.mapas[0].mpprivateToken),this.f.ptoVenta.setValue(t.mapas[0].ptoVenta),this.f.percentajebills.setValue(t.mapas[0].percentajebills),this.f.isBofa.setValue(t.mapas[0].isBofa),this.f.isBofaInput.setValue(t.mapas[0].accountBofa),this.f.isPayapal.setValue(t.mapas[0].isPayapal),this.f.isPayapalInput.setValue(t.mapas[0].accountPayapal),this.f.isZelle.setValue(t.mapas[0].isZelle),this.f.isZelleInput.setValue(t.mapas[0].accountZelle),this.f.zencillo.setValue(t.mapas[0].zencillo),this.f.isZencillo.setValue(t.mapas[0].isZencillo),this.f.usdt.setValue(t.mapas[0].accountUsdt),this.f.isUSDT.setValue(t.mapas[0].isUSDT),this.f.biopago.setValue(t.mapas[0].biopago),this.f.isBiopago.setValue(t.mapas[0].isBiopago),this.loading=!1}),this._paramsService.GetParam().subscribe(t=>{this.parameter29=t.response[29].param,this.parameter50=t.response[50].param,0==t.response[29].param?this.activeZone=!0:this.activeZone=!1},()=>{this._sweetAlertsService.alertoast("No se pud\xf3 obtener los paramentros","error")})}changeLoading(t){this.loading=!1}setLocationLng(t){if("draw.update"!==t.e.type)if("draw.delete"===t.e.type){let e="";for(let n in t.e.features)for(let i in this.features)t.e.features[n].id===this.features[i].id&&(e=i);this.features.findIndex(e=>e.id==t.e.features[0].id);this.coste.removeAt(parseInt(e)-1),this.zoneStatus.removeAt(parseInt(e)-1),this.features.splice(parseInt(e),1)}else this.features=t.features,this.features.forEach((t,e)=>{t.id.includes("mapa")||(this.newFeatures.push(t),this.features.splice(e,1))}),this.newFeatures.forEach(t=>{this.features.push(t)}),this.coste.insert(this.coste.length,this.createItem("")),this.zoneStatus.insert(this.coste.length,this.createItem(!1));else this.features=t.features}updateLocations(t){this.features=t}get f(){return this.createSucursal.controls}createItem(t){return this.formBuilder.group({value:[t,mt.B.required]})}get coste(){return this.createSucursal.get("coste")}get zoneStatus(){return this.createSucursal.get("zoneStatus")}changeCheckbox(t){t.target.checked?("mercado"===t.target.name&&this.f.isMercadoPago.setValue("1"),"efectivo"===t.target.name&&this.f.isChash.setValue("1"),"transferencia"===t.target.name&&this.f.isTransfer.setValue("1"),"delivery"===t.target.name&&this.f.deliveryStore.setValue("1"),"externalDelivery"===t.target.name&&this.f.delieveryExternal.setValue("1"),"local"===t.target.name&&this.f.localConsumption.setValue("1"),"open"===t.target.name&&this.f.isOpen.setValue("1"),"away"===t.target.name&&this.f.takeAwey.setValue("1"),"isDebit"===t.target.name&&this.f.isDebit.setValue("1"),"isCredit"===t.target.name&&this.f.isCredit.setValue("1"),"isZencillo"===t.target.name&&this.f.isZencillo.setValue("1"),"isUSDT"===t.target.name&&this.f.isUSDT.setValue("1"),"isBiopago"===t.target.name&&this.f.isBiopago.setValue("1")):("mercado"===t.target.name&&this.f.isMercadoPago.setValue("0"),"efectivo"===t.target.name&&this.f.isChash.setValue("0"),"transferencia"===t.target.name&&this.f.isTransfer.setValue("0"),"delivery"===t.target.name&&this.f.deliveryStore.setValue("0"),"externalDelivery"===t.target.name&&this.f.delieveryExternal.setValue("0"),"local"===t.target.name&&this.f.localConsumption.setValue("0"),"open"===t.target.name&&this.f.isOpen.setValue("0"),"away"===t.target.name&&this.f.takeAwey.setValue("0"),"isDebit"===t.target.name&&this.f.isDebit.setValue("0"),"isCredit"===t.target.name&&this.f.isCredit.setValue("0"),"isZencillo"===t.target.name&&this.f.isZencillo.setValue("0"),"isUSDT"===t.target.name&&this.f.isUSDT.setValue("0"),"isBiopago"===t.target.name&&this.f.isBiopago.setValue("0"))}changeZoneStatus(){this.createSucursal.get("zoneStatus").value.forEach(t=>{t.value=!!t.value})}eliminarObjetosDuplicados(t,e){let n=[],i={};for(var r in t)i[t[r][e]]=t[r];for(r in i)n.push(i[r]);return n}saveAreas(){this.features=this.eliminarObjetosDuplicados(this.features,"id");const t=[];let e={};this.features.forEach(e=>{let n=e.geometry.coordinates;"LineString"===e.geometry.type||(n=e.geometry.coordinates[0],n.pop());const i=n.map(t=>({latitud:t[0],longitud:t[1]}));t.push(i)}),t.forEach((e,n)=>{e.length<=3&&t.splice(n,1)});let n={nameSucursal:this.f.name.value,timeStore:this.f.timeStore.value,timeDelivery:this.f.timeDelivery.value,isMercadoPago:this.f.isMercadoPago.value,squedule:this.f.squedule.value,liWs:this.f.liWs.value,isOpen:this.f.isOpen.value,isChash:this.f.isCash.value,isTransfer:this.f.isTransfer.value,address:this.f.address.value,clienteid:this.f.clienteid.value,secretid:this.f.secretid.value,nameAppExternal:this.f.nameAppExternal.value,deliveryStore:this.f.deliveryStore.value,takeAwey:this.f.takeAwey.value,delieveryExternal:this.f.delieveryExternal.value,numberBank:this.f.numberBank.value,localConsumption:this.f.localConsumption.value,idSucursal:this.idSucursal,isDebit:this.f.isDedit.value,isBofa:this.f.isBofa.value,accountBofa:this.f.isBofaInput.value,isPayapal:this.f.isPayapal.value,accountPayapal:this.f.isPayapalInput.value,isZelle:this.f.isZelle.value,accountZelle:this.f.isZelleInput.value,isCredit:this.f.isCredit.value,mpprivateToken:this.f.accessToken.value,mppublicToken:this.f.publicKeyMercadoPago.value,ptoVenta:this.f.ptoVenta.value,zencillo:this.f.zencillo.value,isZencillo:this.f.isZencillo.value,accountUsdt:this.f.usdt.value,isUSDT:this.f.isUSDT.value,biopago:this.f.biopago.value,isBiopago:this.f.isBiopago.value,percentajebills:this.f.percentajebills.value,areas:{}};if(t.forEach((t,i)=>{e={},e.coordenadas=t,n.areas["area"+(i+1)]=[],n.areas["area"+(i+1)].push(e),n.areas["area"+(i+1)][0].costoEnvio=this.coste.value[i].value,n.areas["area"+(i+1)][0].status=this.zoneStatus.value[i].value?"1":"0"}),t.length<this.admin.tempFeatures.length||t.length>this.admin.tempFeatures.length)ee.a.fire({title:"Detectar cambios en el mapa",text:"Si usted realiz\xf3 cambios en el mapa presione guardar, si no presione cancelar.",showLoaderOnConfirm:!0,showCancelButton:!0,confirmButtonColor:"#41d29d",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"Guardar"}).then(t=>{t.value?(this.loading=!0,this.service.putSucursal(n).subscribe(t=>{this.loading=!1,this._sweetAlertsService.alertoast("Sucursal editada","success"),this.f.isOpen.value!=localStorage.getItem("branchStatus")&&(localStorage.setItem("branchStatus",this.f.isOpen.value),document.getElementById("branchHeaderSwitch").checked=1==this.f.isOpen.value)},t=>{this.loading=!1,this._sweetAlertsService.alertoast("error al editar la sucursal","error")})):location.reload()});else{for(let e in t)for(let i in t[e]){if(Object.values(this.admin.tempFeatures[e].coordenadas[i])[0]!=Object.values(t[e][i])[0])return void ee.a.fire({title:"Detectar cambios en el mapa",text:"Si usted realiz\xf2 cambios en el mapa presione guardar, si no presione cancelar.",showLoaderOnConfirm:!0,showCancelButton:!0,confirmButtonColor:"#41d29d",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"Guardar"}).then(t=>{t.value?(this.loading=!0,this.service.putSucursal(n).subscribe(t=>{this.loading=!1,this._sweetAlertsService.alertoast("Sucursal editada","success"),this.f.isOpen.value!=localStorage.getItem("branchStatus")&&(localStorage.setItem("branchStatus",this.f.isOpen.value),document.getElementById("branchHeaderSwitch").checked=1==this.f.isOpen.value)},t=>{this.loading=!1,this._sweetAlertsService.alertoast("error al editar la sucursal","error")})):location.reload()});if(Object.values(this.admin.tempFeatures[e].coordenadas[i])[1]!=Object.values(t[e][i])[1])return void ee.a.fire({title:"Detectar cambios en el mapa",text:"Si usted realiz\xf2 cambios en el mapa presione guardar, si no presione cancelar.",showLoaderOnConfirm:!0,showCancelButton:!0,confirmButtonColor:"#41d29d",cancelButtonColor:"#f96767",cancelButtonText:"Cancelar",confirmButtonText:"Guardar"}).then(t=>{t.value?(this.loading=!0,this.service.putSucursal(n).subscribe(t=>{this.loading=!1,this._sweetAlertsService.alertoast("Sucursal editada","success"),this.f.isOpen.value!=localStorage.getItem("branchStatus")&&(localStorage.setItem("branchStatus",this.f.isOpen.value),document.getElementById("branchHeaderSwitch").checked=1==this.f.isOpen.value)},t=>{this.loading=!1,this._sweetAlertsService.alertoast("El mapa es obligatorio","error")})):location.reload()})}this.loading=!0,this.service.putSucursal(n).subscribe(t=>{this.loading=!1,this._sweetAlertsService.alertoast("Sucursal editada","success"),this.f.isOpen.value!=localStorage.getItem("branchStatus")&&(localStorage.setItem("branchStatus",this.f.isOpen.value),document.getElementById("branchHeaderSwitch").checked=1==this.f.isOpen.value,this.router.navigateByUrl("/admin/sucursales/listar"))},t=>{this.loading=!1,this._sweetAlertsService.alertoast(t.error.status,"error")})}}onSelectFile(t){t.target.files&&t.target.files[0]&&(this.fileData=t.target.files[0],this.formData.append("file",this.fileData),this.service.importFile(this.formData,this.id).subscribe(t=>{this._sweetAlertsService.alertoast("Archivo Cargado","success"),location.reload()},t=>{this._sweetAlertsService.alertoast("Error al Cargar Archivo","error")}))}getBackups(){this.service.getBackups().subscribe(t=>{if(t&&t.respaldo&&t.respaldo.length>0){const e=t.respaldo.map(t=>`INSERT INTO \`tb_posiciones_mapa_global\` VALUES (${t.idPosicionMapaGlobal}, '${t.longitud}', '${t.latitud}', ${t.costoEnvio}, '${t.nameMapa}', ${t.idSucursalFk}, '${t.status}');`).join("\n"),n=new Blob([e],{type:"application/sql"});Object(Qt.saveAs)(n,"backup.sql")}else console.error("Datos de respaldo no v\xe1lidos.")},t=>{console.error("Error al descargar el archivo",t)})}changeCheckboxPayments(t,e){t.target.checked?("isCash"===t.target.name&&this.f.isCash.setValue("1"),"isCredit"===t.target.name&&this.f.isCredit.setValue("1"),"isDedit"===t.target.name&&this.f.isDedit.setValue("1"),"isTransfer"===t.target.name&&this.f.isTransfer.setValue("1"),"isMercadoPago"===t.target.name&&this.f.isMercadoPago.setValue("1"),"isPayapal"===t.target.name&&this.f.isPayapal.setValue("1"),"isZelle"===t.target.name&&this.f.isZelle.setValue("1"),"isBofa"===t.target.name&&this.f.isBofa.setValue("1"),"isZencillo"===t.target.name&&this.f.isZencillo.setValue("1"),"isUSDT"===t.target.name&&this.f.isUSDT.setValue("1"),"isBiopago"===t.target.name&&this.f.isBiopago.setValue("1")):("isCash"===t.target.name&&this.f.isCash.setValue("0"),"isCredit"===t.target.name&&this.f.isCredit.setValue("0"),"isDedit"===t.target.name&&this.f.isDedit.setValue("0"),"isTransfer"===t.target.name&&this.f.isTransfer.setValue("0"),"isMercadoPago"===t.target.name&&this.f.isMercadoPago.setValue("0"),"isPayapal"===t.target.name&&this.f.isPayapal.setValue("0"),"isZelle"===t.target.name&&this.f.isZelle.setValue("0"),"isBofa"===t.target.name&&this.f.isBofa.setValue("0"),"isZencillo"===t.target.name&&this.f.isZencillo.setValue("0"),"isUSDT"===t.target.name&&this.f.isUSDT.setValue("0"),"isBiopago"===t.target.name&&this.f.isBiopago.setValue("0"))}}var re=[["input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]],oe=i["\u0275crt"]({encapsulation:0,styles:re,data:{}});function ae(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["o pago m\xf3vil"]))],null,null)}function le(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,11,"div",[["class","col"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](1,212992,null,0,mt.l,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.l]),i["\u0275did"](3,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](4,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),i["\u0275ted"](5,null,["Coste env\xedo zona ",""])),(t()(),i["\u0275eld"](6,0,null,null,5,"input",[["class","form-control"],["formControlName","value"]],[[8,"readOnly",0],[8,"placeholder",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,7)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,7).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,7)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,7)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](7,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](9,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](11,16384,null,0,mt.q,[[4,mt.p]],null,null)],(function(t,e){t(e,1,0,e.context.index);t(e,9,0,"value")}),(function(t,e){var n=e.component;t(e,0,0,i["\u0275nov"](e,3).ngClassUntouched,i["\u0275nov"](e,3).ngClassTouched,i["\u0275nov"](e,3).ngClassPristine,i["\u0275nov"](e,3).ngClassDirty,i["\u0275nov"](e,3).ngClassValid,i["\u0275nov"](e,3).ngClassInvalid,i["\u0275nov"](e,3).ngClassPending),t(e,5,0,e.context.index+1),t(e,6,0,n.activeZone,i["\u0275inlineInterpolate"](1,"Coste de env\xedo de la zona ",e.context.index+1,""),i["\u0275nov"](e,11).ngClassUntouched,i["\u0275nov"](e,11).ngClassTouched,i["\u0275nov"](e,11).ngClassPristine,i["\u0275nov"](e,11).ngClassDirty,i["\u0275nov"](e,11).ngClassValid,i["\u0275nov"](e,11).ngClassInvalid,i["\u0275nov"](e,11).ngClassPending)}))}function se(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,14,"div",[["class","col"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](1,212992,null,0,mt.l,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.l]),i["\u0275did"](3,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](4,0,null,null,10,"div",[["class","form-group"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,9,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,1,"label",[["class","form-label"]],[[8,"htmlFor",0]],null,null,null,null)),(t()(),i["\u0275ted"](7,null,["Estado Zona ",""])),(t()(),i["\u0275eld"](8,0,null,null,5,"input",[["data-switch","success"],["formControlName","value"],["type","checkbox"]],[[8,"id",0],[8,"name",0],[8,"checked",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],(function(t,e,n){var r=!0,o=t.component;"change"===e&&(r=!1!==i["\u0275nov"](t,9).onChange(n.target.checked)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,9).onTouched()&&r);"change"===e&&(r=!1!==o.changeZoneStatus()&&r);return r}),null,null)),i["\u0275did"](9,16384,null,0,mt.b,[i.Renderer2,i.ElementRef],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.b]),i["\u0275did"](11,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](13,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](14,0,null,null,0,"label",[],[[8,"htmlFor",0]],null,null,null,null))],(function(t,e){t(e,1,0,e.context.index);t(e,11,0,"value")}),(function(t,e){var n=e.component;t(e,0,0,i["\u0275nov"](e,3).ngClassUntouched,i["\u0275nov"](e,3).ngClassTouched,i["\u0275nov"](e,3).ngClassPristine,i["\u0275nov"](e,3).ngClassDirty,i["\u0275nov"](e,3).ngClassValid,i["\u0275nov"](e,3).ngClassInvalid,i["\u0275nov"](e,3).ngClassPending),t(e,6,0,i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]")),t(e,7,0,e.context.index+1),t(e,8,0,i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]"),i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]"),n.zonesValues[e.context.index],i["\u0275nov"](e,13).ngClassUntouched,i["\u0275nov"](e,13).ngClassTouched,i["\u0275nov"](e,13).ngClassPristine,i["\u0275nov"](e,13).ngClassDirty,i["\u0275nov"](e,13).ngClassValid,i["\u0275nov"](e,13).ngClassInvalid,i["\u0275nov"](e,13).ngClassPending),t(e,14,0,i["\u0275inlineInterpolate"](1,"status[",e.context.index,"]"))}))}function ue(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,354,"div",[["class","content-page"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,353,"div",[["class","content"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,352,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,12,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,11,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,10,"div",[["class","page-title-box"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,7,"div",[["class","page-title-right"]],null,null,null,null,null)),(t()(),i["\u0275eld"](7,0,null,null,6,"ol",[["class","breadcrumb m-0"]],null,null,null,null,null)),(t()(),i["\u0275eld"](8,0,null,null,3,"li",[["class","breadcrumb-item myPointerCursor"],["routerLink","/admin/sucursales"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,9).onClick()&&r);return r}),null,null)),i["\u0275did"](9,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275eld"](10,0,null,null,1,"a",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Sucursales"])),(t()(),i["\u0275eld"](12,0,null,null,1,"li",[["class","breadcrumb-item active"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Editar sucursal"])),(t()(),i["\u0275eld"](14,0,null,null,1,"h4",[["class","page-title"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Editar sucursal"])),(t()(),i["\u0275eld"](16,0,null,null,338,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](17,0,null,null,337,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](18,0,null,null,336,"div",[["class","card"]],null,null,null,null,null)),(t()(),i["\u0275eld"](19,0,null,null,335,"div",[["class","card-body"]],null,null,null,null,null)),(t()(),i["\u0275eld"](20,0,null,null,334,"form",[["class","needs-validation"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0,o=t.component;"submit"===e&&(r=!1!==i["\u0275nov"](t,22).onSubmit(n)&&r);"reset"===e&&(r=!1!==i["\u0275nov"](t,22).onReset()&&r);"ngSubmit"===e&&(r=!1!==o.saveAreas()&&r);return r}),null,null)),i["\u0275did"](21,16384,null,0,mt.G,[],null,null),i["\u0275did"](22,540672,null,0,mt.k,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),i["\u0275prd"](2048,null,mt.c,null,[mt.k]),i["\u0275did"](24,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](25,0,null,null,327,"div",[["class","py-2 px-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](26,0,null,null,10,"ul",[["class","nav nav-tabs mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](27,0,null,null,4,"li",[["class","nav-item text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](28,0,null,null,3,"a",[["aria-expanded","true"],["class","nav-link active"],["data-bs-toggle","tab"],["href","#basicInformation"]],null,null,null,null,null)),(t()(),i["\u0275eld"](29,0,null,null,0,"i",[["class","mdi mdi-home-variant d-md-none d-block"]],null,null,null,null,null)),(t()(),i["\u0275eld"](30,0,null,null,1,"span",[["class","d-none d-md-block"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Datos b\xe1sicos"])),(t()(),i["\u0275eld"](32,0,null,null,4,"li",[["class","nav-item"]],null,null,null,null,null)),(t()(),i["\u0275eld"](33,0,null,null,3,"a",[["aria-expanded","false"],["class","nav-link"],["data-bs-toggle","tab"],["href","#paymentsMethods"]],null,null,null,null,null)),(t()(),i["\u0275eld"](34,0,null,null,0,"i",[["class","mdi mdi-note-text-outline d-md-none d-block"]],null,null,null,null,null)),(t()(),i["\u0275eld"](35,0,null,null,1,"span",[["class","d-none d-md-block"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Formas de pago"])),(t()(),i["\u0275eld"](37,0,null,null,289,"div",[["class","tab-content"]],null,null,null,null,null)),(t()(),i["\u0275eld"](38,0,null,null,150,"div",[["class","tab-pane show active"],["id","basicInformation"]],null,null,null,null,null)),(t()(),i["\u0275eld"](39,0,null,null,149,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](40,0,null,null,148,"div",[["class","row col-12 text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](41,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](42,0,null,null,1,"label",[["class","form-label"],["for","nombre"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Nombre de la sucursal"])),(t()(),i["\u0275eld"](44,0,null,null,5,"input",[["class","form-control"],["formControlName","name"],["id","nombre"],["placeholder","Nombre de la sucursal"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,45)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,45).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,45)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,45)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](45,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](47,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](49,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](50,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](51,0,null,null,1,"label",[["class","form-label"],["for","clienteid"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["T\xedtulo de portada"])),(t()(),i["\u0275eld"](53,0,null,null,5,"input",[["class","form-control"],["formControlName","clienteid"],["id","clienteid"],["placeholder","T\xedtulo de portada"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,54)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,54).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,54)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,54)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](54,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](56,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](58,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](59,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](60,0,null,null,1,"label",[["class","form-label"],["for","secretid"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["ID secreto"])),(t()(),i["\u0275eld"](62,0,null,null,5,"input",[["class","form-control"],["formControlName","secretid"],["id","secretid"],["placeholder","ID secreto"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,63)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,63).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,63)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,63)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](63,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](65,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](67,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](68,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](69,0,null,null,1,"label",[["class","form-label"],["for","liWs"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["N\xfamero de WhatsApp"])),(t()(),i["\u0275eld"](71,0,null,null,5,"input",[["class","form-control"],["formControlName","liWs"],["id","liWs"],["placeholder","N\xfamero de WhatsApp"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,72)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,72).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,72)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,72)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](72,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](74,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](76,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](77,0,null,null,8,"div",[["class","form-group col-12 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](78,0,null,null,1,"label",[["class","form-label"],["for","address"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Direcci\xf3n"])),(t()(),i["\u0275eld"](80,0,null,null,5,"input",[["class","form-control"],["formControlName","address"],["id","address"],["placeholder","Direcci\xf3n"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,81)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,81).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,81)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,81)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](81,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](83,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](85,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](86,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](87,0,null,null,1,"label",[["class","form-label"],["for","nameAppExternal"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Nombre de la app externa"])),(t()(),i["\u0275eld"](89,0,null,null,5,"input",[["class","form-control"],["formControlName","nameAppExternal"],["id","nameAppExternal"],["placeholder","Nombre de la app externa"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,90)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,90).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,90)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,90)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](90,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](92,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](94,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](95,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](96,0,null,null,1,"label",[["class","form-label"],["for","squedule"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Horario"])),(t()(),i["\u0275eld"](98,0,null,null,5,"input",[["class","form-control"],["formControlName","squedule"],["id","squedule"],["placeholder","Horario"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,99)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,99).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,99)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,99)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](99,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](101,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](103,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](104,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](105,0,null,null,1,"label",[["class","form-label"],["for","timeStore"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Tiempo de espera"])),(t()(),i["\u0275eld"](107,0,null,null,5,"input",[["class","form-control"],["formControlName","timeStore"],["id","timeStore"],["placeholder","Tiempo de espera"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,108)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,108).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,108)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,108)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](108,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](110,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](112,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](113,0,null,null,8,"div",[["class","form-group col-12 col-lg-3 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](114,0,null,null,1,"label",[["class","form-label"],["for","timeDelivery"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Tiempo de espera del delivery"])),(t()(),i["\u0275eld"](116,0,null,null,5,"input",[["class","form-control"],["formControlName","timeDelivery"],["id","timeDelivery"],["placeholder","Tiempo de espera del delivery"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,117)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,117).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,117)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,117)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](117,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](119,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](121,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](122,0,null,null,8,"div",[["class","form-group col-12 col-lg-4 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](123,0,null,null,1,"label",[["class","form-label"],["for","publicKeyMercadoPago"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Public Key Mercado pago"])),(t()(),i["\u0275eld"](125,0,null,null,5,"input",[["class","form-control"],["formControlName","publicKeyMercadoPago"],["id","publicKeyMercadoPago"],["placeholder","Public Key Mercado pago"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,126)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,126).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,126)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,126)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](126,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](128,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](130,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](131,0,null,null,8,"div",[["class","form-group col-12 col-lg-4 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](132,0,null,null,1,"label",[["class","form-label"],["for","accessToken"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Access Token Mercado Pago"])),(t()(),i["\u0275eld"](134,0,null,null,5,"input",[["class","form-control"],["formControlName","accessToken"],["id","accessToken"],["placeholder","Access Token Mercado Pago"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,135)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,135).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,135)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,135)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](135,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](137,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](139,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](140,0,null,null,8,"div",[["class","form-group col-12 col-lg-2 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](141,0,null,null,1,"label",[["class","form-label"],["for","ptoVenta"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Punto de venta fiscal"])),(t()(),i["\u0275eld"](143,0,null,null,5,"input",[["class","form-control"],["formControlName","ptoVenta"],["id","ptoVenta"],["placeholder","Punto de venta fiscal"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,144)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,144).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,144)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,144)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](144,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](146,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](148,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](149,0,null,null,9,"div",[["class","form-group col-12 col-lg-2 mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](150,0,null,null,1,"label",[["class","form-label"],["for","percentajebills"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["% de gastos"])),(t()(),i["\u0275eld"](152,0,null,null,6,"input",[["class","form-control"],["formControlName","percentajebills"],["id","percentajebills"],["placeholder","% de gastos"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,153)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,153).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,153)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,153)._compositionEnd(n.target.value)&&r);"change"===e&&(r=!1!==i["\u0275nov"](t,154).onChange(n.target.value)&&r);"input"===e&&(r=!1!==i["\u0275nov"](t,154).onChange(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,154).onTouched()&&r);return r}),null,null)),i["\u0275did"](153,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275did"](154,16384,null,0,mt.v,[i.Renderer2,i.ElementRef],null,null),i["\u0275prd"](1024,null,mt.o,(function(t,e){return[t,e]}),[mt.d,mt.v]),i["\u0275did"](156,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](158,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](159,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](160,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](161,0,null,null,1,"label",[["class","form-label"],["for","open"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Est\xe1 abierto?"])),(t()(),i["\u0275eld"](163,0,null,null,0,"input",[["data-switch","success"],["id","open"],["name","open"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](164,0,null,null,0,"label",[["for","open"]],null,null,null,null,null)),(t()(),i["\u0275eld"](165,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](166,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](167,0,null,null,1,"label",[["class","form-label"],["for","away"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Take Away?"])),(t()(),i["\u0275eld"](169,0,null,null,0,"input",[["data-switch","success"],["id","away"],["name","away"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](170,0,null,null,0,"label",[["for","away"]],null,null,null,null,null)),(t()(),i["\u0275eld"](171,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](172,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](173,0,null,null,1,"label",[["class","form-label"],["for","delivery"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Delivery?"])),(t()(),i["\u0275eld"](175,0,null,null,0,"input",[["data-switch","success"],["id","delivery"],["name","delivery"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](176,0,null,null,0,"label",[["for","delivery"]],null,null,null,null,null)),(t()(),i["\u0275eld"](177,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](178,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](179,0,null,null,1,"label",[["class","form-label"],["for","externalDelivery"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Delivery externo?"])),(t()(),i["\u0275eld"](181,0,null,null,0,"input",[["data-switch","success"],["id","externalDelivery"],["name","externalDelivery"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](182,0,null,null,0,"label",[["for","externalDelivery"]],null,null,null,null,null)),(t()(),i["\u0275eld"](183,0,null,null,5,"div",[["class","form-group col-12 col-lg text-lg-left mb-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](184,0,null,null,4,"div",[["class","form-check form-switch"]],null,null,null,null,null)),(t()(),i["\u0275eld"](185,0,null,null,1,"label",[["class","form-label"],["for","local"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Consumir en local?"])),(t()(),i["\u0275eld"](187,0,null,null,0,"input",[["data-switch","success"],["id","local"],["name","local"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckbox(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](188,0,null,null,0,"label",[["for","local"]],null,null,null,null,null)),(t()(),i["\u0275eld"](189,0,null,null,137,"div",[["class","tab-pane"],["id","paymentsMethods"]],null,null,null,null,null)),(t()(),i["\u0275eld"](190,0,null,null,136,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](191,0,null,null,135,"div",[["class","row col-12 text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](192,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](193,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](194,0,null,null,1,"label",[["class","form-label"],["for","isCash"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Efectivo"])),(t()(),i["\u0275eld"](196,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](197,0,null,null,0,"input",[["data-switch","success"],["id","isCash"],["name","isCash"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isCash")&&i);return i}),null,null)),(t()(),i["\u0275eld"](198,0,null,null,0,"label",[["for","isCash"]],null,null,null,null,null)),(t()(),i["\u0275eld"](199,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](200,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](201,0,null,null,1,"label",[["class","form-label"],["for","isMercadoPago"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Mercado Pago"])),(t()(),i["\u0275eld"](203,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](204,0,null,null,0,"input",[["data-switch","success"],["id","isMercadoPago"],["name","isMercadoPago"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isMercadoPago")&&i);return i}),null,null)),(t()(),i["\u0275eld"](205,0,null,null,0,"label",[["for","isMercadoPago"]],null,null,null,null,null)),(t()(),i["\u0275eld"](206,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](207,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](208,0,null,null,1,"label",[["class","form-label"],["for","isDedit"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["D\xe9bito"])),(t()(),i["\u0275eld"](210,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](211,0,null,null,0,"input",[["data-switch","success"],["id","isDedit"],["name","isDedit"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isDedit")&&i);return i}),null,null)),(t()(),i["\u0275eld"](212,0,null,null,0,"label",[["for","isDedit"]],null,null,null,null,null)),(t()(),i["\u0275eld"](213,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](214,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](215,0,null,null,1,"label",[["class","form-label"],["for","isBofa"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Bofa"])),(t()(),i["\u0275eld"](217,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](218,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](219,0,null,null,5,"input",[["class","form-control"],["formControlName","isBofaInput"],["id","isBofaInput"],["name","isBofaInput"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,220)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,220).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,220)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,220)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](220,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](222,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](224,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](225,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](226,0,null,null,0,"input",[["data-switch","success"],["id","isBofa"],["name","isBofa"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isBofa")&&i);return i}),null,null)),(t()(),i["\u0275eld"](227,0,null,null,0,"label",[["for","isBofa"]],null,null,null,null,null)),(t()(),i["\u0275eld"](228,0,null,null,6,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](229,0,null,null,5,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](230,0,null,null,1,"label",[["class","form-label"],["for","isCredit"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Cr\xe9dito"])),(t()(),i["\u0275eld"](232,0,null,null,2,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](233,0,null,null,0,"input",[["data-switch","success"],["id","isCredit"],["name","isCredit"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isCredit")&&i);return i}),null,null)),(t()(),i["\u0275eld"](234,0,null,null,0,"label",[["for","isCredit"]],null,null,null,null,null)),(t()(),i["\u0275eld"](235,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](236,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](237,0,null,null,1,"label",[["class","form-label"],["for","isPayapal"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Paypal"])),(t()(),i["\u0275eld"](239,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](240,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](241,0,null,null,5,"input",[["class","form-control"],["formControlName","isPayapalInput"],["id","isPayapalInput"],["name","isPayapalInput"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,242)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,242).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,242)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,242)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](242,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](244,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](246,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](247,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](248,0,null,null,0,"input",[["data-switch","success"],["id","isPayapal"],["name","isPayapal"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isPayapal")&&i);return i}),null,null)),(t()(),i["\u0275eld"](249,0,null,null,0,"label",[["for","isPayapal"]],null,null,null,null,null)),(t()(),i["\u0275eld"](250,0,null,null,16,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](251,0,null,null,15,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](252,0,null,null,3,"label",[["class","form-label"],["for","isTransfer"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Transferencia "])),(t()(),i["\u0275and"](16777216,null,null,1,null,ae)),i["\u0275did"](255,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275eld"](256,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](257,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](258,0,null,null,5,"input",[["class","form-control"],["formControlName","numberBank"],["placeholder","Banco"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,259)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,259).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,259)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,259)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](259,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](261,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](263,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](264,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](265,0,null,null,0,"input",[["data-switch","success"],["id","isTransfer"],["name","isTransfer"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isTransfer")&&i);return i}),null,null)),(t()(),i["\u0275eld"](266,0,null,null,0,"label",[["for","isTransfer"]],null,null,null,null,null)),(t()(),i["\u0275eld"](267,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](268,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](269,0,null,null,1,"label",[["class","form-label"],["for","isZelle"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Zelle"])),(t()(),i["\u0275eld"](271,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](272,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](273,0,null,null,5,"input",[["class","form-control"],["formControlName","isZelleInput"],["id","isZelleInput"],["name","isZelleInput"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,274)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,274).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,274)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,274)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](274,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](276,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](278,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](279,0,null,null,2,"div",[["class","row d-flex justify-content-end col mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](280,0,null,null,0,"input",[["data-switch","success"],["id","isZelle"],["name","isZelle"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isZelle")&&i);return i}),null,null)),(t()(),i["\u0275eld"](281,0,null,null,0,"label",[["for","isZelle"]],null,null,null,null,null)),(t()(),i["\u0275eld"](282,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](283,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](284,0,null,null,1,"label",[["class","form-label"],["for","isZencillo"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Zencillo"])),(t()(),i["\u0275eld"](286,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](287,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](288,0,null,null,5,"input",[["class","form-control"],["formControlName","zencillo"],["placeholder","Zencillo"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,289)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,289).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,289)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,289)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](289,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](291,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](293,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](294,0,null,null,2,"div",[["class","row d-flex justify-content-end col col-lg mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](295,0,null,null,0,"input",[["data-switch","success"],["id","isZencillo"],["name","isZencillo"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isZencillo")&&i);return i}),null,null)),(t()(),i["\u0275eld"](296,0,null,null,0,"label",[["for","isZencillo"]],null,null,null,null,null)),(t()(),i["\u0275eld"](297,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](298,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](299,0,null,null,1,"label",[["class","form-label"],["for","isUSDT"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["USDT"])),(t()(),i["\u0275eld"](301,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](302,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](303,0,null,null,5,"input",[["class","form-control"],["formControlName","usdt"],["id","nombre"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,304)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,304).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,304)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,304)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](304,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](306,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](308,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](309,0,null,null,2,"div",[["class","row d-flex justify-content-end col mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](310,0,null,null,0,"input",[["data-switch","success"],["id","isUSDT"],["name","isUSDT"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isUSDT")&&i);return i}),null,null)),(t()(),i["\u0275eld"](311,0,null,null,0,"label",[["for","isUSDT"]],null,null,null,null,null)),(t()(),i["\u0275eld"](312,0,null,null,14,"div",[["class","form-group col-12 col-lg-6 text-lg-left mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](313,0,null,null,13,"div",[["class","form-check form-switch d-flex justify-content-between"]],null,null,null,null,null)),(t()(),i["\u0275eld"](314,0,null,null,1,"label",[["class","form-label"],["for","isBiopago"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Bio Pago"])),(t()(),i["\u0275eld"](316,0,null,null,10,"div",[["class","row d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](317,0,null,null,6,"div",[["class","col-8 col-lg-8"]],null,null,null,null,null)),(t()(),i["\u0275eld"](318,0,null,null,5,"input",[["class","form-control"],["formControlName","biopago"],["id","nombre"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,319)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,319).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,319)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,319)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](319,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](321,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](323,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](324,0,null,null,2,"div",[["class","row d-flex justify-content-end col mt-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](325,0,null,null,0,"input",[["data-switch","success"],["id","isBiopago"],["name","isBiopago"],["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.changeCheckboxPayments(n,"isBiopago")&&i);return i}),null,null)),(t()(),i["\u0275eld"](326,0,null,null,0,"label",[["for","isBiopago"]],null,null,null,null,null)),(t()(),i["\u0275eld"](327,0,null,null,25,"div",[["class","row my-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](328,0,null,null,7,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](329,0,null,null,3,"p",[["class","h4"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,[" Mapa de env\xedo "])),(t()(),i["\u0275eld"](331,0,null,null,1,"label",[["class","text-danger"]],null,[[null,"click"]],(function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.getBackups()&&i);return i}),null,null)),(t()(),i["\u0275ted"](-1,null,["Descargar mapa"])),(t()(),i["\u0275eld"](333,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Cargar archivo de coordenadas de mapa"])),(t()(),i["\u0275eld"](335,0,null,null,0,"input",[["accept","text/xml"],["class","form-control"],["id","fileInput"],["type","file"]],null,[[null,"change"]],(function(t,e,n){var i=!0,r=t.component;"change"===e&&(i=!1!==r.onSelectFile(n)&&i);return i}),null,null)),(t()(),i["\u0275eld"](336,0,null,null,4,"div",[["class","col-12 mt-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](337,0,null,null,1,"p",[["class","h5"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Configure las zonas de env\xedo"])),(t()(),i["\u0275eld"](339,0,null,null,1,"app-map-two",[],null,[[null,"changeLoading"],[null,"updateLocations"],[null,"setLocationLng"]],(function(t,e,n){var i=!0,r=t.component;"changeLoading"===e&&(i=!1!==r.changeLoading(n)&&i);"updateLocations"===e&&(i=!1!==r.updateLocations(n)&&i);"setLocationLng"===e&&(i=!1!==r.setLocationLng(n)&&i);return i}),Vt,jt)),i["\u0275did"](340,114688,null,0,Ft,[i.ChangeDetectorRef,_t.a,Bt.a,vt.a,pt.a,Nt.a],{tempFeature:[0,"tempFeature"],mapConfiguration:[1,"mapConfiguration"],permissionDeleteZone:[2,"permissionDeleteZone"]},{setLocationLng:"setLocationLng",updateLocations:"updateLocations",changeLoading:"changeLoading"}),(t()(),i["\u0275eld"](341,0,null,null,5,"div",[["class","d-flex flex-row text-center"],["formArrayName","coste"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](342,212992,null,0,mt.e,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.e]),i["\u0275did"](344,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275and"](16777216,null,null,1,null,le)),i["\u0275did"](346,278528,null,0,rt.n,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),i["\u0275eld"](347,0,null,null,5,"div",[["class","d-flex flex-row text-center"],["formArrayName","zoneStatus"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i["\u0275did"](348,212992,null,0,mt.e,[[3,mt.c],[8,null],[8,null]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.e]),i["\u0275did"](350,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275and"](16777216,null,null,1,null,se)),i["\u0275did"](352,278528,null,0,rt.n,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),i["\u0275eld"](353,0,null,null,1,"button",[["class","btn btn-success w-100"],["type","submit"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,[" Guardar "])),(t()(),i["\u0275eld"](355,0,null,null,2,"ngx-loading",[],null,null,null,qt.b,qt.a)),i["\u0275did"](356,114688,null,0,Gt.a,[Gt.c,i.ChangeDetectorRef],{show:[0,"show"],config:[1,"config"]},null),i["\u0275pod"](357,{backdropBorderRadius:0})],(function(t,e){var n=e.component;t(e,9,0,"/admin/sucursales"),t(e,22,0,n.createSucursal);t(e,47,0,"name");t(e,56,0,"clienteid");t(e,65,0,"secretid");t(e,74,0,"liWs");t(e,83,0,"address");t(e,92,0,"nameAppExternal");t(e,101,0,"squedule");t(e,110,0,"timeStore");t(e,119,0,"timeDelivery");t(e,128,0,"publicKeyMercadoPago");t(e,137,0,"accessToken");t(e,146,0,"ptoVenta");t(e,156,0,"percentajebills");t(e,222,0,"isBofaInput");t(e,244,0,"isPayapalInput"),t(e,255,0,"+58"==n.parameter50);t(e,261,0,"numberBank");t(e,276,0,"isZelleInput");t(e,291,0,"zencillo");t(e,306,0,"usdt");t(e,321,0,"biopago"),t(e,340,0,n.tempFeatures,n.mapConfiguration,n.parameter29);t(e,342,0,"coste"),t(e,346,0,n.coste.controls);t(e,348,0,"zoneStatus"),t(e,352,0,n.zoneStatus.controls);var i=n.loading,r=t(e,357,0,"3px");t(e,356,0,i,r)}),(function(t,e){var n=e.component;t(e,20,0,i["\u0275nov"](e,24).ngClassUntouched,i["\u0275nov"](e,24).ngClassTouched,i["\u0275nov"](e,24).ngClassPristine,i["\u0275nov"](e,24).ngClassDirty,i["\u0275nov"](e,24).ngClassValid,i["\u0275nov"](e,24).ngClassInvalid,i["\u0275nov"](e,24).ngClassPending),t(e,44,0,i["\u0275nov"](e,49).ngClassUntouched,i["\u0275nov"](e,49).ngClassTouched,i["\u0275nov"](e,49).ngClassPristine,i["\u0275nov"](e,49).ngClassDirty,i["\u0275nov"](e,49).ngClassValid,i["\u0275nov"](e,49).ngClassInvalid,i["\u0275nov"](e,49).ngClassPending),t(e,53,0,i["\u0275nov"](e,58).ngClassUntouched,i["\u0275nov"](e,58).ngClassTouched,i["\u0275nov"](e,58).ngClassPristine,i["\u0275nov"](e,58).ngClassDirty,i["\u0275nov"](e,58).ngClassValid,i["\u0275nov"](e,58).ngClassInvalid,i["\u0275nov"](e,58).ngClassPending),t(e,62,0,i["\u0275nov"](e,67).ngClassUntouched,i["\u0275nov"](e,67).ngClassTouched,i["\u0275nov"](e,67).ngClassPristine,i["\u0275nov"](e,67).ngClassDirty,i["\u0275nov"](e,67).ngClassValid,i["\u0275nov"](e,67).ngClassInvalid,i["\u0275nov"](e,67).ngClassPending),t(e,71,0,i["\u0275nov"](e,76).ngClassUntouched,i["\u0275nov"](e,76).ngClassTouched,i["\u0275nov"](e,76).ngClassPristine,i["\u0275nov"](e,76).ngClassDirty,i["\u0275nov"](e,76).ngClassValid,i["\u0275nov"](e,76).ngClassInvalid,i["\u0275nov"](e,76).ngClassPending),t(e,80,0,i["\u0275nov"](e,85).ngClassUntouched,i["\u0275nov"](e,85).ngClassTouched,i["\u0275nov"](e,85).ngClassPristine,i["\u0275nov"](e,85).ngClassDirty,i["\u0275nov"](e,85).ngClassValid,i["\u0275nov"](e,85).ngClassInvalid,i["\u0275nov"](e,85).ngClassPending),t(e,89,0,i["\u0275nov"](e,94).ngClassUntouched,i["\u0275nov"](e,94).ngClassTouched,i["\u0275nov"](e,94).ngClassPristine,i["\u0275nov"](e,94).ngClassDirty,i["\u0275nov"](e,94).ngClassValid,i["\u0275nov"](e,94).ngClassInvalid,i["\u0275nov"](e,94).ngClassPending),t(e,98,0,i["\u0275nov"](e,103).ngClassUntouched,i["\u0275nov"](e,103).ngClassTouched,i["\u0275nov"](e,103).ngClassPristine,i["\u0275nov"](e,103).ngClassDirty,i["\u0275nov"](e,103).ngClassValid,i["\u0275nov"](e,103).ngClassInvalid,i["\u0275nov"](e,103).ngClassPending),t(e,107,0,i["\u0275nov"](e,112).ngClassUntouched,i["\u0275nov"](e,112).ngClassTouched,i["\u0275nov"](e,112).ngClassPristine,i["\u0275nov"](e,112).ngClassDirty,i["\u0275nov"](e,112).ngClassValid,i["\u0275nov"](e,112).ngClassInvalid,i["\u0275nov"](e,112).ngClassPending),t(e,116,0,i["\u0275nov"](e,121).ngClassUntouched,i["\u0275nov"](e,121).ngClassTouched,i["\u0275nov"](e,121).ngClassPristine,i["\u0275nov"](e,121).ngClassDirty,i["\u0275nov"](e,121).ngClassValid,i["\u0275nov"](e,121).ngClassInvalid,i["\u0275nov"](e,121).ngClassPending),t(e,125,0,i["\u0275nov"](e,130).ngClassUntouched,i["\u0275nov"](e,130).ngClassTouched,i["\u0275nov"](e,130).ngClassPristine,i["\u0275nov"](e,130).ngClassDirty,i["\u0275nov"](e,130).ngClassValid,i["\u0275nov"](e,130).ngClassInvalid,i["\u0275nov"](e,130).ngClassPending),t(e,134,0,i["\u0275nov"](e,139).ngClassUntouched,i["\u0275nov"](e,139).ngClassTouched,i["\u0275nov"](e,139).ngClassPristine,i["\u0275nov"](e,139).ngClassDirty,i["\u0275nov"](e,139).ngClassValid,i["\u0275nov"](e,139).ngClassInvalid,i["\u0275nov"](e,139).ngClassPending),t(e,143,0,i["\u0275nov"](e,148).ngClassUntouched,i["\u0275nov"](e,148).ngClassTouched,i["\u0275nov"](e,148).ngClassPristine,i["\u0275nov"](e,148).ngClassDirty,i["\u0275nov"](e,148).ngClassValid,i["\u0275nov"](e,148).ngClassInvalid,i["\u0275nov"](e,148).ngClassPending),t(e,152,0,i["\u0275nov"](e,158).ngClassUntouched,i["\u0275nov"](e,158).ngClassTouched,i["\u0275nov"](e,158).ngClassPristine,i["\u0275nov"](e,158).ngClassDirty,i["\u0275nov"](e,158).ngClassValid,i["\u0275nov"](e,158).ngClassInvalid,i["\u0275nov"](e,158).ngClassPending),t(e,163,0,"1"===n.f.isOpen.value),t(e,169,0,"1"===n.f.takeAwey.value),t(e,175,0,"1"===n.f.deliveryStore.value),t(e,181,0,"1"===n.f.delieveryExternal.value),t(e,187,0,"1"===n.f.localConsumption.value),t(e,197,0,"1"===n.f.isCash.value),t(e,204,0,"1"===n.f.isMercadoPago.value),t(e,211,0,"1"===n.f.isDedit.value),t(e,219,0,i["\u0275nov"](e,224).ngClassUntouched,i["\u0275nov"](e,224).ngClassTouched,i["\u0275nov"](e,224).ngClassPristine,i["\u0275nov"](e,224).ngClassDirty,i["\u0275nov"](e,224).ngClassValid,i["\u0275nov"](e,224).ngClassInvalid,i["\u0275nov"](e,224).ngClassPending),t(e,226,0,"1"===n.f.isBofa.value),t(e,233,0,"1"===n.f.isCredit.value),t(e,241,0,i["\u0275nov"](e,246).ngClassUntouched,i["\u0275nov"](e,246).ngClassTouched,i["\u0275nov"](e,246).ngClassPristine,i["\u0275nov"](e,246).ngClassDirty,i["\u0275nov"](e,246).ngClassValid,i["\u0275nov"](e,246).ngClassInvalid,i["\u0275nov"](e,246).ngClassPending),t(e,248,0,"1"===n.f.isPayapal.value),t(e,258,0,i["\u0275nov"](e,263).ngClassUntouched,i["\u0275nov"](e,263).ngClassTouched,i["\u0275nov"](e,263).ngClassPristine,i["\u0275nov"](e,263).ngClassDirty,i["\u0275nov"](e,263).ngClassValid,i["\u0275nov"](e,263).ngClassInvalid,i["\u0275nov"](e,263).ngClassPending),t(e,265,0,"1"===n.f.isTransfer.value),t(e,273,0,i["\u0275nov"](e,278).ngClassUntouched,i["\u0275nov"](e,278).ngClassTouched,i["\u0275nov"](e,278).ngClassPristine,i["\u0275nov"](e,278).ngClassDirty,i["\u0275nov"](e,278).ngClassValid,i["\u0275nov"](e,278).ngClassInvalid,i["\u0275nov"](e,278).ngClassPending),t(e,280,0,"1"===n.f.isZelle.value),t(e,288,0,i["\u0275nov"](e,293).ngClassUntouched,i["\u0275nov"](e,293).ngClassTouched,i["\u0275nov"](e,293).ngClassPristine,i["\u0275nov"](e,293).ngClassDirty,i["\u0275nov"](e,293).ngClassValid,i["\u0275nov"](e,293).ngClassInvalid,i["\u0275nov"](e,293).ngClassPending),t(e,295,0,"1"===n.f.isZencillo.value),t(e,303,0,i["\u0275nov"](e,308).ngClassUntouched,i["\u0275nov"](e,308).ngClassTouched,i["\u0275nov"](e,308).ngClassPristine,i["\u0275nov"](e,308).ngClassDirty,i["\u0275nov"](e,308).ngClassValid,i["\u0275nov"](e,308).ngClassInvalid,i["\u0275nov"](e,308).ngClassPending),t(e,310,0,"1"==n.f.isUSDT.value),t(e,318,0,i["\u0275nov"](e,323).ngClassUntouched,i["\u0275nov"](e,323).ngClassTouched,i["\u0275nov"](e,323).ngClassPristine,i["\u0275nov"](e,323).ngClassDirty,i["\u0275nov"](e,323).ngClassValid,i["\u0275nov"](e,323).ngClassInvalid,i["\u0275nov"](e,323).ngClassPending),t(e,325,0,"1"===n.f.isBiopago.value),t(e,341,0,i["\u0275nov"](e,344).ngClassUntouched,i["\u0275nov"](e,344).ngClassTouched,i["\u0275nov"](e,344).ngClassPristine,i["\u0275nov"](e,344).ngClassDirty,i["\u0275nov"](e,344).ngClassValid,i["\u0275nov"](e,344).ngClassInvalid,i["\u0275nov"](e,344).ngClassPending),t(e,347,0,i["\u0275nov"](e,350).ngClassUntouched,i["\u0275nov"](e,350).ngClassTouched,i["\u0275nov"](e,350).ngClassPristine,i["\u0275nov"](e,350).ngClassDirty,i["\u0275nov"](e,350).ngClassValid,i["\u0275nov"](e,350).ngClassInvalid,i["\u0275nov"](e,350).ngClassPending)}))}var ce=i["\u0275ccf"]("app-update",ie,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-update",[],null,null,null,ue,oe)),i["\u0275did"](1,114688,null,0,ie,[vt.a,Ht.a,_t.a,mt.f,pt.a,Nt.a,pt.k],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),pe=n("wd/R");class he{constructor(t,e,n,r,o,a,l){this._formBuilder=t,this._modalService=e,this._ordenService=n,this._adminService=r,this._sweetAlertsService=o,this._router=a,this.calendar=l,this.loading=!1,this.addEvent=new i.EventEmitter,this.updatedEvent=new i.EventEmitter}ngOnInit(){if(this.editar&&(this.title=this.eventToEdit.nombre),this.editar){let t=new Date(this.eventToEdit.Startsat),e=new Date(this.eventToEdit.Endsat);this.fromDate={year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate()},this.toDate={year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate()},this.timeFromDate={hour:t.getHours(),minute:t.getMinutes()},this.timeToDate={hour:e.getHours(),minute:e.getMinutes()}}else this.fromDate=this.calendar.getToday(),this.toDate=this.calendar.getNext(this.calendar.getToday(),"d",1),this.timeFromDate={hour:9,minute:30},this.timeToDate={hour:9,minute:30}}addNewEvent(){this.loading=!0;const t={nombre:this.title,idSucursal:localStorage.getItem("idBranchFk"),Startsat:pe(this.fromDate.year+"-"+this.fromDate.month+"-"+this.fromDate.day+" "+this.timeFromDate.hour+":"+this.timeFromDate.minute).format("YYYY-MM-DD HH:mm"),Endsat:pe(this.toDate.year+"-"+this.toDate.month+"-"+this.toDate.day+" "+this.timeToDate.hour+":"+this.timeToDate.minute).format("YYYY-MM-DD HH:mm")};this.addEvent.emit(t),this.loading=!1,this.paidRef.close()}editEvent(){this.loading=!0;const t={idSucursal_reservation:this.eventToEdit.idSucursal_reservation,nombre:this.title,idSucursal:localStorage.getItem("idBranchFk"),Startsat:pe(this.fromDate.year+"-"+this.fromDate.month+"-"+this.fromDate.day+" "+this.timeFromDate.hour+":"+this.timeFromDate.minute).format("YYYY-MM-DD HH:mm"),Endsat:pe(this.toDate.year+"-"+this.toDate.month+"-"+this.toDate.day+" "+this.timeToDate.hour+":"+this.timeToDate.minute).format("YYYY-MM-DD HH:mm")};this.updatedEvent.emit(t),this.loading=!1,this.paidRef.close()}}var de=n("7b0r"),fe=[["#map[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{height:100%;margin:0;padding:0}.btn-dangerP[_ngcontent-%COMP%]{font-size:13px;background-color:#ff405324;border-radius:28px;color:#f30d0dd6;font-weight:600}"]],me=i["\u0275crt"]({encapsulation:0,styles:fe,data:{}});function ge(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,69,"div",[["class","custom-modal rounded"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,2,"div",[["class","modal-header d-flex justify-content-center bg-azulL py-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,1,"h1",[["class","text-center text-white m-0"]],null,null,null,null,null)),(t()(),i["\u0275ted"](3,null,[" "," "])),(t()(),i["\u0275eld"](4,0,null,null,65,"div",[["class","modal-body bg-white rounded-top"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,64,"form",[["class","row mx-0 w-100 options"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;"submit"===e&&(r=!1!==i["\u0275nov"](t,7).onSubmit(n)&&r);"reset"===e&&(r=!1!==i["\u0275nov"](t,7).onReset()&&r);return r}),null,null)),i["\u0275did"](6,16384,null,0,mt.G,[],null,null),i["\u0275did"](7,4210688,null,0,mt.s,[[8,null],[8,null]],null,null),i["\u0275prd"](2048,null,mt.c,null,[mt.s]),i["\u0275did"](9,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](10,0,null,null,7,"div",[["class","col-12 h-100 complet"]],null,null,null,null,null)),(t()(),i["\u0275eld"](11,0,null,null,6,"div",[["class","input-group w-100 h-100"]],null,null,null,null,null)),(t()(),i["\u0275eld"](12,0,null,null,5,"input",[["class","form-control h-100"],["name","title"],["placeholder","Titulo para reserva"],["style","border: 1px solid #fc004f1c; border-radius: 20px"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,o=t.component;"input"===e&&(r=!1!==i["\u0275nov"](t,13)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,13).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,13)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,13)._compositionEnd(n.target.value)&&r);"ngModelChange"===e&&(r=!1!==(o.title=n)&&r);return r}),null,null)),i["\u0275did"](13,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](15,671744,null,0,mt.t,[[2,mt.c],[8,null],[8,null],[6,mt.o]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),i["\u0275prd"](2048,null,mt.p,null,[mt.t]),i["\u0275did"](17,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](18,0,null,null,18,"div",[["class","col-6 complet"],["style","margin-top: 29px"]],null,null,null,null,null)),(t()(),i["\u0275eld"](19,0,null,null,17,"div",[["class","input-group w-100"]],null,null,null,null,null)),(t()(),i["\u0275eld"](20,16777216,null,null,11,"input",[["class","form-control text-center"],["name","dfrom"],["ngbDatepicker",""],["placeholder","yyyy-mm-dd"],["style","\n              border: 1px solid #fc004f1c;\n              border-radius: 23px;\n              height: 51px;\n              text-align: left !important;\n              padding-left: 60px;\n            "]],[[8,"disabled",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"],[null,"focus"]],(function(t,e,n){var r=!0,o=t.component;"input"===e&&(r=!1!==i["\u0275nov"](t,22)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,22).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,22)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,22)._compositionEnd(n.target.value)&&r);"input"===e&&(r=!1!==i["\u0275nov"](t,23).manualDateChange(n.target.value)&&r);"change"===e&&(r=!1!==i["\u0275nov"](t,23).manualDateChange(n.target.value,!0)&&r);"focus"===e&&(r=!1!==i["\u0275nov"](t,23).onFocus()&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,23).onBlur()&&r);"ngModelChange"===e&&(r=!1!==(o.fromDate=n)&&r);"click"===e&&(r=!1!==i["\u0275nov"](t,23).toggle()&&r);return r}),null,null)),i["\u0275prd"](6144,null,yt.r,null,[yt.F]),i["\u0275did"](22,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275did"](23,671744,[["d1",4]],0,yt.E,[yt.p,i.ElementRef,i.ViewContainerRef,i.Renderer2,i.ComponentFactoryResolver,i.NgZone,yt.i,yt.o,rt.d,i.ChangeDetectorRef,yt.F],null,null),i["\u0275prd"](1024,null,mt.n,(function(t){return[t]}),[yt.E]),i["\u0275prd"](1024,null,mt.o,(function(t,e){return[t,e]}),[mt.d,yt.E]),i["\u0275did"](26,671744,[["c1",4]],0,mt.t,[[2,mt.c],[6,mt.n],[8,null],[6,mt.o]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),i["\u0275prd"](2048,null,mt.p,null,[mt.t]),i["\u0275did"](28,16384,null,0,mt.q,[[4,mt.p]],null,null),i["\u0275prd"](512,null,rt.J,rt.K,[i.IterableDiffers,i.KeyValueDiffers,i.ElementRef,i.Renderer2]),i["\u0275did"](30,278528,null,0,rt.m,[rt.J],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i["\u0275pod"](31,{"is-invalid":0}),(t()(),i["\u0275eld"](32,0,null,null,4,"div",[["class","input-group-append"],["style","float: left"]],null,null,null,null,null)),(t()(),i["\u0275eld"](33,0,null,null,3,"button",[["class","btn btn-dangerP bg-azulL"],["style","margin-left: -39px; z-index: 1000; position: relative"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,23).toggle()&&r);return r}),null,null)),(t()(),i["\u0275eld"](34,0,null,null,2,":svg:svg",[["class","bi bi-calendar-event"],["fill","currentColor"],["height","16"],["viewBox","0 0 16 16"],["width","16"],["xmlns","http://www.w3.org/2000/svg"]],null,null,null,null,null)),(t()(),i["\u0275eld"](35,0,null,null,0,":svg:path",[["d","M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"]],null,null,null,null,null)),(t()(),i["\u0275eld"](36,0,null,null,0,":svg:path",[["d","M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"]],null,null,null,null,null)),(t()(),i["\u0275eld"](37,0,null,null,6,"div",[["class","col-6 complet"]],null,null,null,null,null)),(t()(),i["\u0275eld"](38,0,null,null,5,"ngb-timepicker",[["name","fromDate1"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],(function(t,e,n){var i=!0,r=t.component;"ngModelChange"===e&&(i=!1!==(r.timeFromDate=n)&&i);return i}),ut.d,ut.c)),i["\u0275did"](39,573440,null,0,yt.db,[yt.eb,yt.cb,i.ChangeDetectorRef,yt.fb],{seconds:[0,"seconds"]},null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[yt.db]),i["\u0275did"](41,671744,null,0,mt.t,[[2,mt.c],[8,null],[8,null],[6,mt.o]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),i["\u0275prd"](2048,null,mt.p,null,[mt.t]),i["\u0275did"](43,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](44,0,null,null,18,"div",[["class","col-6 complet"],["style","margin-top: 29px"]],null,null,null,null,null)),(t()(),i["\u0275eld"](45,0,null,null,17,"div",[["class","input-group w-100"]],null,null,null,null,null)),(t()(),i["\u0275eld"](46,16777216,null,null,11,"input",[["class","form-control text-center"],["name","dto"],["ngbDatepicker",""],["placeholder","yyyy-mm-dd"],["style","\n              border: 1px solid #fc004f1c;\n              border-radius: 23px;\n              height: 51px;\n              text-align: left !important;\n              padding-left: 60px;\n            "]],[[8,"disabled",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"],[null,"focus"]],(function(t,e,n){var r=!0,o=t.component;"input"===e&&(r=!1!==i["\u0275nov"](t,48)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,48).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,48)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,48)._compositionEnd(n.target.value)&&r);"input"===e&&(r=!1!==i["\u0275nov"](t,49).manualDateChange(n.target.value)&&r);"change"===e&&(r=!1!==i["\u0275nov"](t,49).manualDateChange(n.target.value,!0)&&r);"focus"===e&&(r=!1!==i["\u0275nov"](t,49).onFocus()&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,49).onBlur()&&r);"ngModelChange"===e&&(r=!1!==(o.toDate=n)&&r);"click"===e&&(r=!1!==i["\u0275nov"](t,23).toggle()&&r);return r}),null,null)),i["\u0275prd"](6144,null,yt.r,null,[yt.F]),i["\u0275did"](48,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275did"](49,671744,[["d2",4]],0,yt.E,[yt.p,i.ElementRef,i.ViewContainerRef,i.Renderer2,i.ComponentFactoryResolver,i.NgZone,yt.i,yt.o,rt.d,i.ChangeDetectorRef,yt.F],null,null),i["\u0275prd"](1024,null,mt.n,(function(t){return[t]}),[yt.E]),i["\u0275prd"](1024,null,mt.o,(function(t,e){return[t,e]}),[mt.d,yt.E]),i["\u0275did"](52,671744,[["c1",4]],0,mt.t,[[2,mt.c],[6,mt.n],[8,null],[6,mt.o]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),i["\u0275prd"](2048,null,mt.p,null,[mt.t]),i["\u0275did"](54,16384,null,0,mt.q,[[4,mt.p]],null,null),i["\u0275prd"](512,null,rt.J,rt.K,[i.IterableDiffers,i.KeyValueDiffers,i.ElementRef,i.Renderer2]),i["\u0275did"](56,278528,null,0,rt.m,[rt.J],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i["\u0275pod"](57,{"is-invalid":0}),(t()(),i["\u0275eld"](58,0,null,null,4,"div",[["class","input-group-append"],["style","float: left"]],null,null,null,null,null)),(t()(),i["\u0275eld"](59,0,null,null,3,"button",[["class","btn btn-dangerP bg-azulL"],["style","margin-left: -39px; z-index: 1000; position: relative"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,49).toggle()&&r);return r}),null,null)),(t()(),i["\u0275eld"](60,0,null,null,2,":svg:svg",[["class","bi bi-calendar-event"],["fill","currentColor"],["height","16"],["viewBox","0 0 16 16"],["width","16"],["xmlns","http://www.w3.org/2000/svg"]],null,null,null,null,null)),(t()(),i["\u0275eld"](61,0,null,null,0,":svg:path",[["d","M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"]],null,null,null,null,null)),(t()(),i["\u0275eld"](62,0,null,null,0,":svg:path",[["d","M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"]],null,null,null,null,null)),(t()(),i["\u0275eld"](63,0,null,null,6,"div",[["class","col-6 complet"]],null,null,null,null,null)),(t()(),i["\u0275eld"](64,0,null,null,5,"ngb-timepicker",[["name","toDate1"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],(function(t,e,n){var i=!0,r=t.component;"ngModelChange"===e&&(i=!1!==(r.timeToDate=n)&&i);return i}),ut.d,ut.c)),i["\u0275did"](65,573440,null,0,yt.db,[yt.eb,yt.cb,i.ChangeDetectorRef,yt.fb],{seconds:[0,"seconds"]},null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[yt.db]),i["\u0275did"](67,671744,null,0,mt.t,[[2,mt.c],[8,null],[8,null],[6,mt.o]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),i["\u0275prd"](2048,null,mt.p,null,[mt.t]),i["\u0275did"](69,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](70,0,null,null,4,"div",[["class","modal-footer justify-content-center bg-white border-top-0"]],null,null,null,null,null)),(t()(),i["\u0275eld"](71,0,null,null,1,"button",[["class","btn bg-success text-white font-weight-bold col- p-2"]],null,[[null,"click"]],(function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==(1==r.editar?r.editEvent():r.addNewEvent())&&i);return i}),null,null)),(t()(),i["\u0275ted"](-1,null,[" GUARDAR "])),(t()(),i["\u0275eld"](73,0,null,null,1,"button",[["class","btn bg-danger text-white font-weight-bold col- p-2"]],null,[[null,"click"]],(function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.paidRef.close()&&i);return i}),null,null)),(t()(),i["\u0275ted"](-1,null,[" CERRAR "])),(t()(),i["\u0275eld"](75,0,null,null,2,"ngx-loading",[],null,null,null,qt.b,qt.a)),i["\u0275did"](76,114688,null,0,Gt.a,[Gt.c,i.ChangeDetectorRef],{show:[0,"show"],config:[1,"config"]},null),i["\u0275pod"](77,{backdropBorderRadius:0})],(function(t,e){var n=e.component;t(e,15,0,"title",n.title);t(e,26,0,"dfrom",n.fromDate);var r=t(e,31,0,!i["\u0275nov"](e,52).valid);t(e,30,0,"form-control text-center",r);t(e,39,0,!1);t(e,41,0,"fromDate1",n.timeFromDate);t(e,52,0,"dto",n.toDate);var o=t(e,57,0,!i["\u0275nov"](e,52).valid);t(e,56,0,"form-control text-center",o);t(e,65,0,!1);t(e,67,0,"toDate1",n.timeToDate);var a=n.loading,l=t(e,77,0,"3px");t(e,76,0,a,l)}),(function(t,e){t(e,3,0,1==e.component.editar?"Editar Reserva":"Nueva Reserva"),t(e,5,0,i["\u0275nov"](e,9).ngClassUntouched,i["\u0275nov"](e,9).ngClassTouched,i["\u0275nov"](e,9).ngClassPristine,i["\u0275nov"](e,9).ngClassDirty,i["\u0275nov"](e,9).ngClassValid,i["\u0275nov"](e,9).ngClassInvalid,i["\u0275nov"](e,9).ngClassPending),t(e,12,0,i["\u0275nov"](e,17).ngClassUntouched,i["\u0275nov"](e,17).ngClassTouched,i["\u0275nov"](e,17).ngClassPristine,i["\u0275nov"](e,17).ngClassDirty,i["\u0275nov"](e,17).ngClassValid,i["\u0275nov"](e,17).ngClassInvalid,i["\u0275nov"](e,17).ngClassPending),t(e,20,0,i["\u0275nov"](e,23).disabled,i["\u0275nov"](e,28).ngClassUntouched,i["\u0275nov"](e,28).ngClassTouched,i["\u0275nov"](e,28).ngClassPristine,i["\u0275nov"](e,28).ngClassDirty,i["\u0275nov"](e,28).ngClassValid,i["\u0275nov"](e,28).ngClassInvalid,i["\u0275nov"](e,28).ngClassPending),t(e,38,0,i["\u0275nov"](e,43).ngClassUntouched,i["\u0275nov"](e,43).ngClassTouched,i["\u0275nov"](e,43).ngClassPristine,i["\u0275nov"](e,43).ngClassDirty,i["\u0275nov"](e,43).ngClassValid,i["\u0275nov"](e,43).ngClassInvalid,i["\u0275nov"](e,43).ngClassPending),t(e,46,0,i["\u0275nov"](e,49).disabled,i["\u0275nov"](e,54).ngClassUntouched,i["\u0275nov"](e,54).ngClassTouched,i["\u0275nov"](e,54).ngClassPristine,i["\u0275nov"](e,54).ngClassDirty,i["\u0275nov"](e,54).ngClassValid,i["\u0275nov"](e,54).ngClassInvalid,i["\u0275nov"](e,54).ngClassPending),t(e,64,0,i["\u0275nov"](e,69).ngClassUntouched,i["\u0275nov"](e,69).ngClassTouched,i["\u0275nov"](e,69).ngClassPristine,i["\u0275nov"](e,69).ngClassDirty,i["\u0275nov"](e,69).ngClassValid,i["\u0275nov"](e,69).ngClassInvalid,i["\u0275nov"](e,69).ngClassPending)}))}i["\u0275ccf"]("app-modal-calendar",he,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-modal-calendar",[],null,null,null,ge,me)),i["\u0275did"](1,114688,null,0,he,[mt.f,yt.G,de.a,Nt.a,_t.a,pt.k,yt.i],null,null)],(function(t,e){t(e,1,0)}),null)}),{paidRef:"paidRef",eventToEdit:"eventToEdit",editar:"editar"},{addEvent:"addEvent",updatedEvent:"updatedEvent"},[]);class ve{constructor(t,e,n,i,r,o,a,l){this._formBuilder=t,this._modalService=e,this._router=n,this._reservas=i,this._sweetAlertsService=r,this.sanitizer=o,this.calendar=a,this.formBuilder=l,this.loading=!0,this.editar=!1,this.text="",this.dateClick=new Date,this.products=[],this.config={itemsPerPage:10,currentPage:1,previousLabel:"Ant.",nextLabel:"Sig.",responsive:!0}}ngOnInit(){this.form=this.getFormBuilder(),this.getList(),this.toDate=this.calendar.getToday()}openModal(t){this.modalRef=this._modalService.open(t),this.editar=!1,this.event=null}openModalEditar(t,e){this.modalRef=this._modalService.open(t),this.editar=!0,this.event=e}getFormBuilder(){return this.formBuilder.group({busqueda:["",[mt.B.required]]})}getList(){this._reservas.list().subscribe(t=>{t&&(this.products=t.response),this.loading=!1},t=>{this._sweetAlertsService.alertoast("Error obteniendo los datos","error")})}pageChanged(t){this.config.currentPage=t}created(t){this.loading=!0,console.log("body",t),this._reservas.add(t).subscribe(e=>{this.getList(),this._sweetAlertsService.alertoast("Creado event para el dia:"+t.Startsat,"success"),this.loading=!1},t=>{this._sweetAlertsService.alertoast("No se pudo crear","error")})}updateEvent(t){this.loading=!0,console.log("body",t),this._reservas.update(t).subscribe(e=>{this.getList(),this._sweetAlertsService.alertoast("Editado event para el dia:"+t.Startsat,"success"),this.loading=!1},t=>{this._sweetAlertsService.alertoast("No se pudo crear","error")})}deleteEvent(t){this.loading=!0,this._reservas.delte(t).subscribe(t=>{this.getList(),this._sweetAlertsService.alertoast("Evento eliminado","success"),this.loading=!1},t=>{this._sweetAlertsService.alertoast("No se pudo eliminar","error")})}daysBetween(){this.loading=!1;let t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][this.toDate.month-1],e=pe(this.toDate.day+"-"+t+"-"+this.toDate.year).format("DD-MMM-YYYY"),n=pe("31-Dec-"+this.toDate.year).format("DD-MMM-YYYY");const i=pe(new Date(e)).startOf("day"),r=pe(new Date(n)).endOf("day"),o=pe.duration(r.diff(i)).asDays();for(let a=0;a<=o;a++)this.createdFullYear(pe(i).add(a,"day").startOf("day").format("YYYY-MM-DD HH:mm"),pe(i).add(a,"day").startOf("day").format("M"),pe(i).add(a,"day").startOf("day").format("DD"));this.loading=!0,this.getList()}createdFullYear(t,e,n){let i=pe(t).add("23","hour").format("YYYY-MM-DD HH:mm"),r=pe(i).add("59","minute").format("YYYY-MM-DD HH:mm");const o={nombre:pe(t).format("YYYY-MM-DD"),idSucursal:localStorage.getItem("idBranchFk"),Startsat:pe(t).format("YYYY-MM-DD HH:mm"),Endsat:pe(r).format("YYYY-MM-DD HH:mm")};this._reservas.add(o).subscribe(t=>{},t=>{this._sweetAlertsService.alertoast("No se pudo crear","error")})}}var ye=n("IheW");class _e{constructor(t){this.http=t,this.token=localStorage.getItem("access_token"),this.totalMitad=0,this.idBranchFk=localStorage.getItem("idBranchFk"),this.platesSelected=[]}get headers(){return{headers:new ye.g({"Access-Control-Allow-Origin":"*",Authorization:"Bearer "+localStorage.getItem("access_token")})}}add(t){return this.http.post(ne.a.production?ne.a.apiHost+"/api/v2/mapas/addReservation":"/api/v2/mapas/addReservation",t,this.headers)}update(t){return this.http.put(ne.a.production?ne.a.apiHost+"/api/v2/mapas/update/reservation/":"/api/v2/mapas/update/reservation/",t,this.headers)}delte(t){return this.http.delete(ne.a.production?`${ne.a.apiHost}/api/v2/mapas/deleteReservation/${t}`:"/api/v2/mapas/deleteReservation/"+t,this.headers)}list(){return this.http.get(ne.a.production?`${ne.a.apiHost}/api/v2/mapas/list/reservation/${localStorage.getItem("idBranchFk")}`:"/api/v2/mapas/list/reservation/"+localStorage.getItem("idBranchFk"),this.headers)}}_e.ngInjectableDef=i["\u0275\u0275defineInjectable"]({factory:function(){return new _e(i["\u0275\u0275inject"](ye.c))},token:_e,providedIn:"root"});var be=n("cUpR"),xe=[[""]],we=i["\u0275crt"]({encapsulation:0,styles:xe,data:{animation:[{type:7,name:"dropIn",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0,transform:"translateY(-100%)"},offset:null},options:void 0},{type:1,expr:":enter",animation:{type:4,styles:{type:6,styles:{opacity:1,transform:"translateY(0)"},offset:null},timings:"600ms linear"},options:null}],options:{}},{type:7,name:"slideIn",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0},offset:null},options:void 0},{type:0,name:"in",styles:{type:6,styles:{transform:"translateX(0)"},offset:null},options:void 0},{type:0,name:"out",styles:{type:6,styles:{transform:"translateX(-100%)"},offset:null},options:void 0},{type:1,expr:":enter",animation:{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"600ms ease-in"},options:null},{type:1,expr:"in => out",animation:{type:4,styles:null,timings:"600ms ease-in"},options:null}],options:{}},{type:7,name:"modalExpand",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0,transform:"scale(1.5)"},offset:null},options:void 0},{type:1,expr:":enter",animation:{type:4,styles:{type:6,styles:{opacity:1,transform:"scale(1)"},offset:null},timings:"800ms ease-in"},options:null},{type:1,expr:"* => void",animation:{type:4,styles:{type:6,styles:{opacity:0,transform:"scale(0.5)"},offset:null},timings:"500ms ease-out"},options:null}],options:{}}]}});function Ce(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,3,"div",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,0,"div",[["class","spinner-border avatar-lg"],["role","status"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["CARGANDO..."]))],null,null)}function Ee(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,2,"div",[["class","text-center mb-2"]],[[24,"@slideIn",0]],null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["NO HAY RESULTADOS"]))],null,(function(t,e){t(e,0,0,void 0)}))}function Se(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,13,"tr",[["class","text-center"]],[[24,"@dropIn",0]],null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](2,null,["",""])),(t()(),i["\u0275eld"](3,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](4,null,["",""])),(t()(),i["\u0275eld"](5,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](6,null,["",""])),(t()(),i["\u0275eld"](7,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](8,null,["",""])),(t()(),i["\u0275eld"](9,0,null,null,4,"td",[["class","table-action"]],null,null,null,null,null)),(t()(),i["\u0275eld"](10,0,null,null,1,"a",[["class","action-icon"]],null,[[null,"click"]],(function(t,e,n){var r=!0,o=t.component;"click"===e&&(r=!1!==o.openModalEditar(i["\u0275nov"](t.parent.parent,45),t.context.$implicit)&&r);return r}),null,null)),(t()(),i["\u0275eld"](11,0,null,null,0,"i",[["class","mdi mdi-square-edit-outline"]],null,null,null,null,null)),(t()(),i["\u0275eld"](12,0,null,null,1,"a",[["class","action-icon"]],null,[[null,"click"]],(function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.deleteEvent(t.context.$implicit.idSucursal_reservation)&&i);return i}),null,null)),(t()(),i["\u0275eld"](13,0,null,null,0,"i",[["class","mdi mdi-delete"]],null,null,null,null,null))],null,(function(t,e){t(e,0,0,void 0),t(e,2,0,e.context.$implicit.idSucursal_reservation),t(e,4,0,e.context.$implicit.nombre),t(e,6,0,e.context.$implicit.Startsat),t(e,8,0,e.context.$implicit.Endsat)}))}function Te(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,21,"div",[["class","table-responsive"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,17,"table",[["class","table table-centered w-100 dt-responsive nowrap"],["id","products-datatable"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,11,"thead",[["class","table-light"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,10,"tr",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Id"])),(t()(),i["\u0275eld"](6,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["T\xedtulo"])),(t()(),i["\u0275eld"](8,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Fecha Inicio"])),(t()(),i["\u0275eld"](10,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Fecha Final"])),(t()(),i["\u0275eld"](12,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Opciones"])),(t()(),i["\u0275eld"](14,0,null,null,4,"tbody",[],null,null,null,null,null)),(t()(),i["\u0275and"](16777216,null,null,3,null,Se)),i["\u0275did"](16,278528,null,0,rt.n,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),i["\u0275ppd"](17,2),i["\u0275pid"](0,ht.b,[ht.e]),(t()(),i["\u0275eld"](19,0,null,null,2,"div",[["class","mt-4 d-flex justify-content-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](20,0,null,null,1,"pagination-controls",[["class","my-pagination"]],null,[[null,"pageChange"]],(function(t,e,n){var i=!0,r=t.component;"pageChange"===e&&(i=!1!==r.pageChanged(n)&&i);return i}),dt.b,dt.a)),i["\u0275did"](21,49152,null,0,ht.c,[],{previousLabel:[0,"previousLabel"],nextLabel:[1,"nextLabel"]},{pageChange:"pageChange"})],(function(t,e){var n=e.component,r=i["\u0275unv"](e,16,0,i["\u0275nov"](e,18).transform(i["\u0275unv"](e,16,0,t(e,17,0,i["\u0275nov"](e.parent,0),n.products,n.form.controls.busqueda.value)),n.config));t(e,16,0,r),t(e,21,0,n.config.previousLabel,n.config.nextLabel)}),null)}function Ie(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-modal-calendar",[],[[24,"@modalExpand",0]],[[null,"addEvent"],[null,"updatedEvent"]],(function(t,e,n){var i=!0,r=t.component;"addEvent"===e&&(i=!1!==r.created(n)&&i);"updatedEvent"===e&&(i=!1!==r.updateEvent(n)&&i);return i}),ge,me)),i["\u0275did"](1,114688,null,0,he,[mt.f,yt.G,de.a,Nt.a,_t.a,pt.k,yt.i],{paidRef:[0,"paidRef"],eventToEdit:[1,"eventToEdit"],editar:[2,"editar"]},{addEvent:"addEvent",updatedEvent:"updatedEvent"})],(function(t,e){var n=e.component;t(e,1,0,n.modalRef,n.event,n.editar)}),(function(t,e){t(e,0,0,void 0)}))}function Pe(t){return i["\u0275vid"](0,[i["\u0275pid"](0,ft.a,[]),(t()(),i["\u0275eld"](1,0,null,null,43,"div",[["class","content-page"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,42,"div",[["class","content"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,41,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,12,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,11,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,10,"div",[["class","page-title-box"]],null,null,null,null,null)),(t()(),i["\u0275eld"](7,0,null,null,7,"div",[["class","page-title-right"]],null,null,null,null,null)),(t()(),i["\u0275eld"](8,0,null,null,6,"ol",[["class","breadcrumb m-0"]],null,null,null,null,null)),(t()(),i["\u0275eld"](9,0,null,null,3,"li",[["class","breadcrumb-item"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,10).onClick()&&r);return r}),null,null)),i["\u0275did"](10,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),i["\u0275pad"](11,1),(t()(),i["\u0275ted"](-1,null,["Sucursales"])),(t()(),i["\u0275eld"](13,0,null,null,1,"li",[["class","breadcrumb-item active"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Lista de reservas"])),(t()(),i["\u0275eld"](15,0,null,null,1,"h4",[["class","page-title"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Lista de reservas"])),(t()(),i["\u0275eld"](17,0,null,null,27,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](18,0,null,null,26,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](19,0,null,null,25,"div",[["class","card"]],null,null,null,null,null)),(t()(),i["\u0275eld"](20,0,null,null,24,"div",[["class","card-body"]],null,null,null,null,null)),(t()(),i["\u0275eld"](21,0,null,null,17,"div",[["class","row mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](22,0,null,null,9,"div",[["class","col-sm-5"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;"submit"===e&&(r=!1!==i["\u0275nov"](t,23).onSubmit(n)&&r);"reset"===e&&(r=!1!==i["\u0275nov"](t,23).onReset()&&r);return r}),null,null)),i["\u0275did"](23,540672,null,0,mt.k,[[8,null],[8,null]],{form:[0,"form"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.k]),i["\u0275did"](25,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](26,0,null,null,5,"input",[["class","form-control customInputRadius"],["formControlName","busqueda"],["name","busqueda"],["placeholder","T\xedtulo"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,27)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,27).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,27)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,27)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](27,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](29,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](31,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](32,0,null,null,6,"div",[["class","col-sm-7"]],null,null,null,null,null)),(t()(),i["\u0275eld"](33,0,null,null,5,"div",[["class","text-sm-end"]],null,null,null,null,null)),(t()(),i["\u0275eld"](34,0,null,null,1,"button",[["class","btn btn-light mb-2 me-1"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.daysBetween()&&i);return i}),null,null)),(t()(),i["\u0275ted"](-1,null,[" Generar d\xedas a\xf1o actual "])),(t()(),i["\u0275eld"](36,0,null,null,2,"button",[["class","btn btn-success mb-2"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0,o=t.component;"click"===e&&(r=!1!==o.openModal(i["\u0275nov"](t,45))&&r);return r}),null,null)),(t()(),i["\u0275eld"](37,0,null,null,0,"i",[["class","mdi mdi-plus-circle me-2"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,[" Nueva "])),(t()(),i["\u0275and"](16777216,null,null,1,null,Ce)),i["\u0275did"](40,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,Ee)),i["\u0275did"](42,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,Te)),i["\u0275did"](44,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](0,[["newBox2",2]],null,0,null,Ie)),(t()(),i["\u0275eld"](46,0,null,null,2,"ngx-loading",[],null,null,null,qt.b,qt.a)),i["\u0275did"](47,114688,null,0,Gt.a,[Gt.c,i.ChangeDetectorRef],{show:[0,"show"],config:[1,"config"]},null),i["\u0275pod"](48,{backdropBorderRadius:0})],(function(t,e){var n=e.component,i=t(e,11,0,"/admin/sucursales");t(e,10,0,i),t(e,23,0,n.form);t(e,29,0,"busqueda"),t(e,40,0,n.loading),t(e,42,0,!n.loading&&0==n.products.length),t(e,44,0,!n.loading&&n.products.length>0);var r=n.loading,o=t(e,48,0,"3px");t(e,47,0,r,o)}),(function(t,e){t(e,22,0,i["\u0275nov"](e,25).ngClassUntouched,i["\u0275nov"](e,25).ngClassTouched,i["\u0275nov"](e,25).ngClassPristine,i["\u0275nov"](e,25).ngClassDirty,i["\u0275nov"](e,25).ngClassValid,i["\u0275nov"](e,25).ngClassInvalid,i["\u0275nov"](e,25).ngClassPending),t(e,26,0,i["\u0275nov"](e,31).ngClassUntouched,i["\u0275nov"](e,31).ngClassTouched,i["\u0275nov"](e,31).ngClassPristine,i["\u0275nov"](e,31).ngClassDirty,i["\u0275nov"](e,31).ngClassValid,i["\u0275nov"](e,31).ngClassInvalid,i["\u0275nov"](e,31).ngClassPending)}))}var Ae=i["\u0275ccf"]("app-calendar",ve,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-calendar",[],null,null,null,Pe,we)),i["\u0275did"](1,114688,null,0,ve,[mt.f,yt.G,pt.k,_e,_t.a,be.b,yt.i,mt.f],null,null)],(function(t,e){t(e,1,0)}),null)}),{url:"url",item:"item",typeDocument:"typeDocument"},{},[]);class Me{constructor(t,e,n,i){this._branchService=t,this._formBuilder=e,this._modalService=n,this._sweetAlertService=i,this.idBranchFk=localStorage.getItem("idBranchFk"),this.deliveries=[],this.loading=!0}ngOnInit(){this.getDeliveries(),this.form=this.getFormBuilder()}getDeliveries(){this._branchService.getDeliveries(this.idBranchFk).subscribe(({response:t})=>{this.deliveries=t,this.loading=!1},()=>{this.loading=!1})}getFormBuilder(){return this._formBuilder.group({busqueda:["",[mt.B.required]]})}}var ke=[[".customForm[_ngcontent-%COMP%]{background-color:#ff981d;border-radius:1em 0 0 1em}.customInput[_ngcontent-%COMP%]{border-radius:.7em;font-size:1.5rem}.customRadius[_ngcontent-%COMP%]{border-radius:0 .7em .7em 0!important}.customTabHeadColor[_ngcontent-%COMP%]{background-color:#d2d2d2}.customImg[_ngcontent-%COMP%]{cursor:pointer;width:2.5em}"]],De=i["\u0275crt"]({encapsulation:0,styles:ke,data:{}});function Le(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,3,"div",[["class","col-12 px-0 complet"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,2,"button",[["class","btn bg-success text-white font-weight-bold h-100 w-100 rounded-0"],["routerLink","../crearDelivey"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,2).onClick()&&r);return r}),null,null)),i["\u0275did"](2,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275ted"](-1,null,[" NUEVO "]))],(function(t,e){t(e,2,0,"../crearDelivey")}),null)}function Oe(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,5,"div",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,2,"div",[["class","spinner-border avatar-lg"],["role","status"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,1,"span",[["class","visually-hidden"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Loading..."])),(t()(),i["\u0275eld"](4,0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["CARGANDO..."]))],null,null)}function Re(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,7,"div",[["class","text-center mb-2"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,6,"div",[["class","row justify-content-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,5,"div",[["class","col-lg-4"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,4,"div",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,0,"i",[["class","mdi mdi-cloud-alert"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,1,"h4",[["class","text-uppercase text-lith mt-3 txtnofount"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,[" NO HAY RESULTADOS. "]))],null,null)}function ze(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,17,"tr",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](2,null,["",""])),(t()(),i["\u0275eld"](3,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](4,null,["",""])),(t()(),i["\u0275eld"](5,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](6,null,["",""])),(t()(),i["\u0275eld"](7,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](8,null,["",""])),(t()(),i["\u0275eld"](9,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](10,null,["",""])),(t()(),i["\u0275eld"](11,0,null,null,1,"td",[],null,null,null,null,null)),(t()(),i["\u0275ted"](12,null,["",""])),(t()(),i["\u0275eld"](13,0,null,null,4,"td",[["class","text-center"]],null,null,null,null,null)),(t()(),i["\u0275eld"](14,0,null,null,2,"img",[["alt","edit"],["class","customImg mb-1"],["src","./assets/biorestaurant/iconos/iconosProductos/editar.png"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,15).onClick()&&r);return r}),null,null)),i["\u0275did"](15,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{queryParams:[0,"queryParams"],routerLink:[1,"routerLink"]},null),i["\u0275pod"](16,{idDelivery:0}),(t()(),i["\u0275eld"](17,0,null,null,0,"br",[],null,null,null,null,null))],(function(t,e){var n=t(e,16,0,e.context.$implicit.idRappy);t(e,15,0,n,"../actualizarDelivery")}),(function(t,e){t(e,2,0,e.context.$implicit.idRappy),t(e,4,0,""!=e.context.$implicit.idRappy?"Rappi":"PEYA"),t(e,6,0,e.context.$implicit.storeName),t(e,8,0,e.context.$implicit.clientId),t(e,10,0,e.context.$implicit.storeId),t(e,12,0,e.context.$implicit.created_at)}))}function Fe(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,21,"div",[["class","table-wrapper-scroll-y my-custom-scrollbar"],["style","height: 52vh"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,20,"table",[["class","table table-bordered table-striped mb-0 width200"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,15,"thead",[],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,14,"tr",[["class","text-center customTabHeadColor"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,1,"th",[["scope","col"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["ID"])),(t()(),i["\u0275eld"](6,0,null,null,1,"th",[["class","text-center"],["scope","col"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Delivery"])),(t()(),i["\u0275eld"](8,0,null,null,1,"th",[["class","text-center"],["scope","col"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store name"])),(t()(),i["\u0275eld"](10,0,null,null,1,"th",[["class","text-center"],["scope","col"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Client ID"])),(t()(),i["\u0275eld"](12,0,null,null,1,"th",[["class","text-center"],["scope","col"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store ID"])),(t()(),i["\u0275eld"](14,0,null,null,1,"th",[["class","text-center"],["scope","col"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Fecha de creaci\xf3n"])),(t()(),i["\u0275eld"](16,0,null,null,1,"th",[["class","text-center"],["scope","col"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Acciones"])),(t()(),i["\u0275eld"](18,0,null,null,3,"tbody",[],null,null,null,null,null)),(t()(),i["\u0275and"](16777216,null,null,2,null,ze)),i["\u0275did"](20,278528,null,0,rt.n,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),i["\u0275ppd"](21,2)],(function(t,e){var n=e.component,r=i["\u0275unv"](e,20,0,t(e,21,0,i["\u0275nov"](e.parent,0),n.deliveries,n.form.controls.busqueda.value));t(e,20,0,r)}),null)}function Be(t){return i["\u0275vid"](0,[i["\u0275pid"](0,ft.a,[]),(t()(),i["\u0275eld"](1,0,null,null,2,"div",[["class","w-100 bg-azulS px-5 text-white"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,1,"p",[["class","text-uppercase font-weight-bold py-2"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Deliveries"])),(t()(),i["\u0275eld"](4,0,null,null,10,"div",[["class","container-fluid px-4"]],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,2,"div",[["class","row mx-0 my-2 options"]],null,null,null,null,null)),(t()(),i["\u0275and"](16777216,null,null,1,null,Le)),i["\u0275did"](7,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275eld"](8,0,null,null,6,"div",[["class","container-fluid mt-3 bg-white py-4 px-5 rounded"]],null,null,null,null,null)),(t()(),i["\u0275and"](16777216,null,null,1,null,Oe)),i["\u0275did"](10,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,Re)),i["\u0275did"](12,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,Fe)),i["\u0275did"](14,16384,null,0,rt.o,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(t,e){var n=e.component;t(e,7,0,0==n.deliveries.length),t(e,10,0,n.loading),t(e,12,0,!n.loading&&0==n.deliveries.length),t(e,14,0,!n.loading&&n.deliveries.length>=1)}),null)}var Ne=i["\u0275ccf"]("app-deliveries-list",Me,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-deliveries-list",[],null,null,null,Be,De)),i["\u0275did"](1,114688,null,0,Me,[vt.a,mt.f,yt.G,_t.a],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]);class Ue{constructor(t,e,n,i,r){this.builder=t,this.router=e,this._sweetAlertsService=n,this._branchService=i,this.activatedRoute=r,this.idBranchFk=localStorage.getItem("idBranchFk")}ngOnInit(){this.activatedRoute.queryParams.subscribe(({idDelivery:t})=>{this.formCreate=this.formBuilder()})}get f(){return this.formCreate.controls}formBuilder(t){return this.builder.group({integrationId:["",[mt.B.required]],storeId:["",[mt.B.required]],storeIntegrationId:["",[mt.B.required]],storeName:["",[mt.B.required]],clientId:["",[mt.B.required]],clientSecret:["",[mt.B.required]],audience:["",[mt.B.required]]})}create(){if(this.formCreate.invalid)return void this._sweetAlertsService.alertoast("Todos los campos son obligatorios","error");const t={integrationId:this.f.integrationId.value,storeId:this.f.storeId.value,storeIntegrationId:this.f.storeIntegrationId.value,storeName:this.f.storeName.value,clientId:this.f.clientId.value,clientSecret:this.f.clientSecret.value,audience:this.f.audience.value,idBranchFk:this.idBranchFk};console.log(t),this._branchService.addRappi(t).subscribe(t=>{this._sweetAlertsService.alertoast("Creado exitosamente.","success"),this.router.navigateByUrl("admin/sucursales/listar")},()=>{this._sweetAlertsService.alertoast("Ha ocurrido un error.","error")})}}var je=[[""]],Ve=i["\u0275crt"]({encapsulation:0,styles:je,data:{}});function qe(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,77,"form",[["novalidate",""],["style","background: white; height: 150%"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;"submit"===e&&(r=!1!==i["\u0275nov"](t,2).onSubmit(n)&&r);"reset"===e&&(r=!1!==i["\u0275nov"](t,2).onReset()&&r);return r}),null,null)),i["\u0275did"](1,16384,null,0,mt.G,[],null,null),i["\u0275did"](2,540672,null,0,mt.k,[[8,null],[8,null]],{form:[0,"form"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.k]),i["\u0275did"](4,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](5,0,null,null,70,"div",[["class","container"],["style","height: 100%"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,2,"div",[["class","px-0 d-flex justify-content-end mr-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](7,0,null,null,1,"i",[["class","ri-arrow-left-circle-fill cursor-pointer mr-4"],["routerLink","../deliveries"],["style","font-size: 3rem; color: #fd3c37 !important"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,8).onClick()&&r);return r}),null,null)),i["\u0275did"](8,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275eld"](9,0,null,null,66,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](10,0,null,null,27,"div",[["class","col-md-6 col-xs-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](11,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](12,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Integration ID"])),(t()(),i["\u0275eld"](14,0,null,null,5,"input",[["class","form-control"],["formControlName","integrationId"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,15)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,15).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,15)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,15)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](15,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](17,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](19,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](20,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](21,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store ID"])),(t()(),i["\u0275eld"](23,0,null,null,5,"input",[["class","form-control"],["formControlName","storeId"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,24)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,24).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,24)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,24)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](24,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](26,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](28,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](29,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](30,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store Integration ID"])),(t()(),i["\u0275eld"](32,0,null,null,5,"input",[["class","form-control"],["formControlName","storeIntegrationId"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,33)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,33).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,33)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,33)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](33,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](35,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](37,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](38,0,null,null,27,"div",[["class","col-md-6 col-xs-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](39,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](40,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store Name"])),(t()(),i["\u0275eld"](42,0,null,null,5,"input",[["class","form-control"],["formControlName","storeName"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,43)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,43).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,43)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,43)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](43,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](45,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](47,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](48,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](49,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Client ID"])),(t()(),i["\u0275eld"](51,0,null,null,5,"input",[["class","form-control"],["formControlName","clientId"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,52)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,52).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,52)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,52)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](52,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](54,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](56,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](57,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](58,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Client Secret"])),(t()(),i["\u0275eld"](60,0,null,null,5,"input",[["class","form-control"],["formControlName","clientSecret"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,61)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,61).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,61)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,61)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](61,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](63,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](65,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](66,0,null,null,9,"div",[["class","col-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](67,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](68,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Audience"])),(t()(),i["\u0275eld"](70,0,null,null,5,"input",[["class","form-control"],["formControlName","audience"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,71)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,71).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,71)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,71)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](71,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](73,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](75,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](76,0,null,null,1,"button",[["class","btn bg-success text-white font-weight-bold fixed-bottom w-100 rounded-0 buttonTop"]],null,[[null,"click"]],(function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.create()&&i);return i}),null,null)),(t()(),i["\u0275ted"](-1,null,[" Guardar "]))],(function(t,e){t(e,2,0,e.component.formCreate);t(e,8,0,"../deliveries");t(e,17,0,"integrationId");t(e,26,0,"storeId");t(e,35,0,"storeIntegrationId");t(e,45,0,"storeName");t(e,54,0,"clientId");t(e,63,0,"clientSecret");t(e,73,0,"audience")}),(function(t,e){t(e,0,0,i["\u0275nov"](e,4).ngClassUntouched,i["\u0275nov"](e,4).ngClassTouched,i["\u0275nov"](e,4).ngClassPristine,i["\u0275nov"](e,4).ngClassDirty,i["\u0275nov"](e,4).ngClassValid,i["\u0275nov"](e,4).ngClassInvalid,i["\u0275nov"](e,4).ngClassPending),t(e,14,0,i["\u0275nov"](e,19).ngClassUntouched,i["\u0275nov"](e,19).ngClassTouched,i["\u0275nov"](e,19).ngClassPristine,i["\u0275nov"](e,19).ngClassDirty,i["\u0275nov"](e,19).ngClassValid,i["\u0275nov"](e,19).ngClassInvalid,i["\u0275nov"](e,19).ngClassPending),t(e,23,0,i["\u0275nov"](e,28).ngClassUntouched,i["\u0275nov"](e,28).ngClassTouched,i["\u0275nov"](e,28).ngClassPristine,i["\u0275nov"](e,28).ngClassDirty,i["\u0275nov"](e,28).ngClassValid,i["\u0275nov"](e,28).ngClassInvalid,i["\u0275nov"](e,28).ngClassPending),t(e,32,0,i["\u0275nov"](e,37).ngClassUntouched,i["\u0275nov"](e,37).ngClassTouched,i["\u0275nov"](e,37).ngClassPristine,i["\u0275nov"](e,37).ngClassDirty,i["\u0275nov"](e,37).ngClassValid,i["\u0275nov"](e,37).ngClassInvalid,i["\u0275nov"](e,37).ngClassPending),t(e,42,0,i["\u0275nov"](e,47).ngClassUntouched,i["\u0275nov"](e,47).ngClassTouched,i["\u0275nov"](e,47).ngClassPristine,i["\u0275nov"](e,47).ngClassDirty,i["\u0275nov"](e,47).ngClassValid,i["\u0275nov"](e,47).ngClassInvalid,i["\u0275nov"](e,47).ngClassPending),t(e,51,0,i["\u0275nov"](e,56).ngClassUntouched,i["\u0275nov"](e,56).ngClassTouched,i["\u0275nov"](e,56).ngClassPristine,i["\u0275nov"](e,56).ngClassDirty,i["\u0275nov"](e,56).ngClassValid,i["\u0275nov"](e,56).ngClassInvalid,i["\u0275nov"](e,56).ngClassPending),t(e,60,0,i["\u0275nov"](e,65).ngClassUntouched,i["\u0275nov"](e,65).ngClassTouched,i["\u0275nov"](e,65).ngClassPristine,i["\u0275nov"](e,65).ngClassDirty,i["\u0275nov"](e,65).ngClassValid,i["\u0275nov"](e,65).ngClassInvalid,i["\u0275nov"](e,65).ngClassPending),t(e,70,0,i["\u0275nov"](e,75).ngClassUntouched,i["\u0275nov"](e,75).ngClassTouched,i["\u0275nov"](e,75).ngClassPristine,i["\u0275nov"](e,75).ngClassDirty,i["\u0275nov"](e,75).ngClassValid,i["\u0275nov"](e,75).ngClassInvalid,i["\u0275nov"](e,75).ngClassPending)}))}var Ge=i["\u0275ccf"]("app-deliveries",Ue,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-deliveries",[],null,null,null,qe,Ve)),i["\u0275did"](1,114688,null,0,Ue,[mt.f,pt.k,_t.a,vt.a,pt.a],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]);class Ze{constructor(t,e,n,i,r){this.builder=t,this.router=e,this._sweetAlertsService=n,this._branchService=i,this.activatedRoute=r,this.idBranchFk=localStorage.getItem("idBranchFk"),this.formCreate="",this.loading=!0}ngOnInit(){this.formCreate=this.formBuilder(),this.getDelivery()}get f(){return this.formCreate.controls}formBuilder(){return this.builder.group({audience:["",[mt.B.required]],clientId:["",[mt.B.required]],clientSecret:["",[mt.B.required]],storeId:["",[mt.B.required]],storeName:["",[mt.B.required]],storeIntegrationId:["",[mt.B.required]]})}getDelivery(){this._branchService.getDeliveries(this.idBranchFk).subscribe(({response:t})=>{this.delivery=t[0],this.loading=!1,this.f.audience.setValue(this.delivery.audience),this.f.clientId.setValue(this.delivery.clientId),this.f.clientSecret.setValue(this.delivery.clientSecret),this.f.storeId.setValue(this.delivery.storeId),this.f.storeName.setValue(this.delivery.storeName),this.f.storeIntegrationId.setValue(this.delivery.storeIntegrationId)},()=>{this.loading=!1})}update(){if(this.formCreate.invalid)return void this._sweetAlertsService.alertoast("Todos los campos son obligatorios","error");const t={audience:this.f.audience.value,clientId:this.f.clientId.value,clientSecret:this.f.clientSecret.value,storeId:this.f.storeId.value,storeName:this.f.storeName.value,storeIntegrationId:this.f.storeIntegrationId.value};this._branchService.updateRappi(t,this.idBranchFk).subscribe(t=>{this._sweetAlertsService.alertoast("Actualizardo exitosamente.","success"),this.router.navigateByUrl("admin/sucursales/deliveries")},()=>{this._sweetAlertsService.alertoast("Ha ocurrido un error.","error")})}}var He=[[""]],Ye=i["\u0275crt"]({encapsulation:0,styles:He,data:{}});function Xe(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,67,"form",[["novalidate",""],["style","background: white; height: 150%"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;"submit"===e&&(r=!1!==i["\u0275nov"](t,2).onSubmit(n)&&r);"reset"===e&&(r=!1!==i["\u0275nov"](t,2).onReset()&&r);return r}),null,null)),i["\u0275did"](1,16384,null,0,mt.G,[],null,null),i["\u0275did"](2,540672,null,0,mt.k,[[8,null],[8,null]],{form:[0,"form"]},null),i["\u0275prd"](2048,null,mt.c,null,[mt.k]),i["\u0275did"](4,16384,null,0,mt.r,[[4,mt.c]],null,null),(t()(),i["\u0275eld"](5,0,null,null,60,"div",[["class","container"],["style","height: 100%"]],null,null,null,null,null)),(t()(),i["\u0275eld"](6,0,null,null,2,"div",[["class","px-0 d-flex justify-content-end mr-1"]],null,null,null,null,null)),(t()(),i["\u0275eld"](7,0,null,null,1,"i",[["class","ri-arrow-left-circle-fill cursor-pointer mr-4"],["routerLink","../deliveries"],["style","font-size: 3rem; color: #fd3c37 !important"]],null,[[null,"click"]],(function(t,e,n){var r=!0;"click"===e&&(r=!1!==i["\u0275nov"](t,8).onClick()&&r);return r}),null,null)),i["\u0275did"](8,16384,null,0,pt.l,[pt.k,pt.a,[8,null],i.Renderer2,i.ElementRef],{routerLink:[0,"routerLink"]},null),(t()(),i["\u0275eld"](9,0,null,null,56,"div",[["class","row"]],null,null,null,null,null)),(t()(),i["\u0275eld"](10,0,null,null,27,"div",[["class","col-md-6 col-xs-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](11,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](12,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store ID"])),(t()(),i["\u0275eld"](14,0,null,null,5,"input",[["class","form-control"],["formControlName","storeId"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,15)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,15).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,15)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,15)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](15,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](17,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](19,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](20,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](21,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store Integration ID"])),(t()(),i["\u0275eld"](23,0,null,null,5,"input",[["class","form-control"],["formControlName","storeIntegrationId"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,24)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,24).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,24)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,24)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](24,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](26,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](28,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](29,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](30,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Store Name"])),(t()(),i["\u0275eld"](32,0,null,null,5,"input",[["class","form-control"],["formControlName","storeName"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,33)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,33).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,33)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,33)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](33,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](35,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](37,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](38,0,null,null,27,"div",[["class","col-md-6 col-xs-12"]],null,null,null,null,null)),(t()(),i["\u0275eld"](39,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](40,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Client ID"])),(t()(),i["\u0275eld"](42,0,null,null,5,"input",[["class","form-control"],["formControlName","clientId"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,43)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,43).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,43)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,43)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](43,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](45,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](47,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](48,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](49,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Client Secret"])),(t()(),i["\u0275eld"](51,0,null,null,5,"input",[["class","form-control"],["formControlName","clientSecret"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,52)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,52).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,52)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,52)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](52,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](54,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](56,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](57,0,null,null,8,"div",[["class","mb-3"]],null,null,null,null,null)),(t()(),i["\u0275eld"](58,0,null,null,1,"label",[["class","form-label"]],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Audience"])),(t()(),i["\u0275eld"](60,0,null,null,5,"input",[["class","form-control"],["formControlName","audience"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0;"input"===e&&(r=!1!==i["\u0275nov"](t,61)._handleInput(n.target.value)&&r);"blur"===e&&(r=!1!==i["\u0275nov"](t,61).onTouched()&&r);"compositionstart"===e&&(r=!1!==i["\u0275nov"](t,61)._compositionStart()&&r);"compositionend"===e&&(r=!1!==i["\u0275nov"](t,61)._compositionEnd(n.target.value)&&r);return r}),null,null)),i["\u0275did"](61,16384,null,0,mt.d,[i.Renderer2,i.ElementRef,[2,mt.a]],null,null),i["\u0275prd"](1024,null,mt.o,(function(t){return[t]}),[mt.d]),i["\u0275did"](63,671744,null,0,mt.i,[[3,mt.c],[8,null],[8,null],[6,mt.o],[2,mt.E]],{name:[0,"name"]},null),i["\u0275prd"](2048,null,mt.p,null,[mt.i]),i["\u0275did"](65,16384,null,0,mt.q,[[4,mt.p]],null,null),(t()(),i["\u0275eld"](66,0,null,null,1,"button",[["class","btn bg-success text-white font-weight-bold fixed-bottom w-100 rounded-0 buttonTop"]],null,[[null,"click"]],(function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.update()&&i);return i}),null,null)),(t()(),i["\u0275ted"](-1,null,[" Actualizar "]))],(function(t,e){t(e,2,0,e.component.formCreate);t(e,8,0,"../deliveries");t(e,17,0,"storeId");t(e,26,0,"storeIntegrationId");t(e,35,0,"storeName");t(e,45,0,"clientId");t(e,54,0,"clientSecret");t(e,63,0,"audience")}),(function(t,e){t(e,0,0,i["\u0275nov"](e,4).ngClassUntouched,i["\u0275nov"](e,4).ngClassTouched,i["\u0275nov"](e,4).ngClassPristine,i["\u0275nov"](e,4).ngClassDirty,i["\u0275nov"](e,4).ngClassValid,i["\u0275nov"](e,4).ngClassInvalid,i["\u0275nov"](e,4).ngClassPending),t(e,14,0,i["\u0275nov"](e,19).ngClassUntouched,i["\u0275nov"](e,19).ngClassTouched,i["\u0275nov"](e,19).ngClassPristine,i["\u0275nov"](e,19).ngClassDirty,i["\u0275nov"](e,19).ngClassValid,i["\u0275nov"](e,19).ngClassInvalid,i["\u0275nov"](e,19).ngClassPending),t(e,23,0,i["\u0275nov"](e,28).ngClassUntouched,i["\u0275nov"](e,28).ngClassTouched,i["\u0275nov"](e,28).ngClassPristine,i["\u0275nov"](e,28).ngClassDirty,i["\u0275nov"](e,28).ngClassValid,i["\u0275nov"](e,28).ngClassInvalid,i["\u0275nov"](e,28).ngClassPending),t(e,32,0,i["\u0275nov"](e,37).ngClassUntouched,i["\u0275nov"](e,37).ngClassTouched,i["\u0275nov"](e,37).ngClassPristine,i["\u0275nov"](e,37).ngClassDirty,i["\u0275nov"](e,37).ngClassValid,i["\u0275nov"](e,37).ngClassInvalid,i["\u0275nov"](e,37).ngClassPending),t(e,42,0,i["\u0275nov"](e,47).ngClassUntouched,i["\u0275nov"](e,47).ngClassTouched,i["\u0275nov"](e,47).ngClassPristine,i["\u0275nov"](e,47).ngClassDirty,i["\u0275nov"](e,47).ngClassValid,i["\u0275nov"](e,47).ngClassInvalid,i["\u0275nov"](e,47).ngClassPending),t(e,51,0,i["\u0275nov"](e,56).ngClassUntouched,i["\u0275nov"](e,56).ngClassTouched,i["\u0275nov"](e,56).ngClassPristine,i["\u0275nov"](e,56).ngClassDirty,i["\u0275nov"](e,56).ngClassValid,i["\u0275nov"](e,56).ngClassInvalid,i["\u0275nov"](e,56).ngClassPending),t(e,60,0,i["\u0275nov"](e,65).ngClassUntouched,i["\u0275nov"](e,65).ngClassTouched,i["\u0275nov"](e,65).ngClassPristine,i["\u0275nov"](e,65).ngClassDirty,i["\u0275nov"](e,65).ngClassValid,i["\u0275nov"](e,65).ngClassInvalid,i["\u0275nov"](e,65).ngClassPending)}))}var We=i["\u0275ccf"]("app-deliveries-update",Ze,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-deliveries-update",[],null,null,null,Xe,Ye)),i["\u0275did"](1,114688,null,0,Ze,[mt.f,pt.k,_t.a,vt.a,pt.a],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),Ke=n("Qm6G"),Je=n("UPO+"),$e=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Qe={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(t){return"undefined"!=typeof console&&console.warn(t)},getWeek:function(t){var e=new Date(t.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var n=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},tn={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(t){var e=t%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},en=tn,nn=function(t,e){return void 0===e&&(e=2),("000"+t).slice(-1*e)},rn=function(t){return!0===t?1:0};function on(t,e){var n;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout((function(){return t.apply(i,r)}),e)}}var an=function(t){return t instanceof Array?t:[t]};function ln(t,e,n){if(!0===n)return t.classList.add(e);t.classList.remove(e)}function sn(t,e,n){var i=window.document.createElement(t);return e=e||"",n=n||"",i.className=e,void 0!==n&&(i.textContent=n),i}function un(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function cn(t,e){var n=sn("div","numInputWrapper"),i=sn("input","numInput "+t),r=sn("span","arrowUp"),o=sn("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?i.type="number":(i.type="text",i.pattern="\\d*"),void 0!==e)for(var a in e)i.setAttribute(a,e[a]);return n.appendChild(i),n.appendChild(r),n.appendChild(o),n}function pn(t){try{return"function"==typeof t.composedPath?t.composedPath()[0]:t.target}catch(e){return t.target}}var hn=function(){},dn=function(t,e,n){return n.months[e?"shorthand":"longhand"][t]},fn={D:hn,F:function(t,e,n){t.setMonth(n.months.longhand.indexOf(e))},G:function(t,e){t.setHours((t.getHours()>=12?12:0)+parseFloat(e))},H:function(t,e){t.setHours(parseFloat(e))},J:function(t,e){t.setDate(parseFloat(e))},K:function(t,e,n){t.setHours(t.getHours()%12+12*rn(new RegExp(n.amPM[1],"i").test(e)))},M:function(t,e,n){t.setMonth(n.months.shorthand.indexOf(e))},S:function(t,e){t.setSeconds(parseFloat(e))},U:function(t,e){return new Date(1e3*parseFloat(e))},W:function(t,e,n){var i=parseInt(e),r=new Date(t.getFullYear(),0,2+7*(i-1),0,0,0,0);return r.setDate(r.getDate()-r.getDay()+n.firstDayOfWeek),r},Y:function(t,e){t.setFullYear(parseFloat(e))},Z:function(t,e){return new Date(e)},d:function(t,e){t.setDate(parseFloat(e))},h:function(t,e){t.setHours((t.getHours()>=12?12:0)+parseFloat(e))},i:function(t,e){t.setMinutes(parseFloat(e))},j:function(t,e){t.setDate(parseFloat(e))},l:hn,m:function(t,e){t.setMonth(parseFloat(e)-1)},n:function(t,e){t.setMonth(parseFloat(e)-1)},s:function(t,e){t.setSeconds(parseFloat(e))},u:function(t,e){return new Date(parseFloat(e))},w:hn,y:function(t,e){t.setFullYear(2e3+parseFloat(e))}},mn={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},gn={Z:function(t){return t.toISOString()},D:function(t,e,n){return e.weekdays.shorthand[gn.w(t,e,n)]},F:function(t,e,n){return dn(gn.n(t,e,n)-1,!1,e)},G:function(t,e,n){return nn(gn.h(t,e,n))},H:function(t){return nn(t.getHours())},J:function(t,e){return void 0!==e.ordinal?t.getDate()+e.ordinal(t.getDate()):t.getDate()},K:function(t,e){return e.amPM[rn(t.getHours()>11)]},M:function(t,e){return dn(t.getMonth(),!0,e)},S:function(t){return nn(t.getSeconds())},U:function(t){return t.getTime()/1e3},W:function(t,e,n){return n.getWeek(t)},Y:function(t){return nn(t.getFullYear(),4)},d:function(t){return nn(t.getDate())},h:function(t){return t.getHours()%12?t.getHours()%12:12},i:function(t){return nn(t.getMinutes())},j:function(t){return t.getDate()},l:function(t,e){return e.weekdays.longhand[t.getDay()]},m:function(t){return nn(t.getMonth()+1)},n:function(t){return t.getMonth()+1},s:function(t){return t.getSeconds()},u:function(t){return t.getTime()},w:function(t){return t.getDay()},y:function(t){return String(t.getFullYear()).substring(2)}},vn=function(t){var e=t.config,n=void 0===e?Qe:e,i=t.l10n,r=void 0===i?tn:i,o=t.isMobile,a=void 0!==o&&o;return function(t,e,i){var o=i||r;return void 0===n.formatDate||a?e.split("").map((function(e,i,r){return gn[e]&&"\\"!==r[i-1]?gn[e](t,o,n):"\\"!==e?e:""})).join(""):n.formatDate(t,e,o)}},yn=function(t){var e=t.config,n=void 0===e?Qe:e,i=t.l10n,r=void 0===i?tn:i;return function(t,e,i,o){if(0===t||t){var a,l=o||r,s=t;if(t instanceof Date)a=new Date(t.getTime());else if("string"!=typeof t&&void 0!==t.toFixed)a=new Date(t);else if("string"==typeof t){var u=e||(n||Qe).dateFormat,c=String(t).trim();if("today"===c)a=new Date,i=!0;else if(n&&n.parseDate)a=n.parseDate(t,u);else if(/Z$/.test(c)||/GMT$/.test(c))a=new Date(t);else{for(var p=void 0,h=[],d=0,f=0,m="";d<u.length;d++){var g=u[d],v="\\"===g,y="\\"===u[d-1]||v;if(mn[g]&&!y){m+=mn[g];var _=new RegExp(m).exec(t);_&&(p=!0)&&h["Y"!==g?"push":"unshift"]({fn:fn[g],val:_[++f]})}else v||(m+=".")}a=n&&n.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0),h.forEach((function(t){var e=t.fn,n=t.val;return a=e(a,n,l)||a})),a=p?a:void 0}}if(a instanceof Date&&!isNaN(a.getTime()))return!0===i&&a.setHours(0,0,0,0),a;n.errorHandler(new Error("Invalid date provided: "+s))}}};function _n(t,e,n){return void 0===n&&(n=!0),!1!==n?new Date(t.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):t.getTime()-e.getTime()}var bn=function(t,e,n){return 3600*t+60*e+n},xn=864e5;function wn(t){var e=t.defaultHour,n=t.defaultMinute,i=t.defaultSeconds;if(void 0!==t.minDate){var r=t.minDate.getHours(),o=t.minDate.getMinutes(),a=t.minDate.getSeconds();e<r&&(e=r),e===r&&n<o&&(n=o),e===r&&n===o&&i<a&&(i=t.minDate.getSeconds())}if(void 0!==t.maxDate){var l=t.maxDate.getHours(),s=t.maxDate.getMinutes();(e=Math.min(e,l))===l&&(n=Math.min(s,n)),e===l&&n===s&&(i=t.maxDate.getSeconds())}return{hours:e,minutes:n,seconds:i}}n("cW3J");var Cn=function(){return(Cn=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},En=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,l=o.length;a<l;a++,r++)i[r]=o[a];return i};function Sn(t,e){var n={config:Cn(Cn({},Qe),In.defaultConfig),l10n:en};function i(){var t;return(null===(t=n.calendarContainer)||void 0===t?void 0:t.getRootNode()).activeElement||document.activeElement}function r(t){return t.bind(n)}function o(){var t=n.config;!1===t.weekNumbers&&1===t.showMonths||!0!==t.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==n.calendarContainer&&(n.calendarContainer.style.visibility="hidden",n.calendarContainer.style.display="block"),void 0!==n.daysContainer){var e=(n.days.offsetWidth+1)*t.showMonths;n.daysContainer.style.width=e+"px",n.calendarContainer.style.width=e+(void 0!==n.weekWrapper?n.weekWrapper.offsetWidth:0)+"px",n.calendarContainer.style.removeProperty("visibility"),n.calendarContainer.style.removeProperty("display")}}))}function a(t){if(0===n.selectedDates.length){var e=void 0===n.config.minDate||_n(new Date,n.config.minDate)>=0?new Date:new Date(n.config.minDate.getTime()),i=wn(n.config);e.setHours(i.hours,i.minutes,i.seconds,e.getMilliseconds()),n.selectedDates=[e],n.latestSelectedDateObj=e}void 0!==t&&"blur"!==t.type&&function(t){t.preventDefault();var e="keydown"===t.type,i=pn(t),r=i;void 0!==n.amPM&&i===n.amPM&&(n.amPM.textContent=n.l10n.amPM[rn(n.amPM.textContent===n.l10n.amPM[0])]);var o=parseFloat(r.getAttribute("min")),a=parseFloat(r.getAttribute("max")),l=parseFloat(r.getAttribute("step")),s=parseInt(r.value,10),u=t.delta||(e?38===t.which?1:-1:0),c=s+l*u;if(void 0!==r.value&&2===r.value.length){var p=r===n.hourElement,h=r===n.minuteElement;c<o?(c=a+c+rn(!p)+(rn(p)&&rn(!n.amPM)),h&&m(void 0,-1,n.hourElement)):c>a&&(c=r===n.hourElement?c-a-rn(!n.amPM):o,h&&m(void 0,1,n.hourElement)),n.amPM&&p&&(1===l?c+s===23:Math.abs(c-s)>l)&&(n.amPM.textContent=n.l10n.amPM[rn(n.amPM.textContent===n.l10n.amPM[0])]),r.value=nn(c)}}(t);var r=n._input.value;l(),Q(),n._input.value!==r&&n._debouncedChange()}function l(){if(void 0!==n.hourElement&&void 0!==n.minuteElement){var t,e,i=(parseInt(n.hourElement.value.slice(-2),10)||0)%24,r=(parseInt(n.minuteElement.value,10)||0)%60,o=void 0!==n.secondElement?(parseInt(n.secondElement.value,10)||0)%60:0;void 0!==n.amPM&&(t=i,e=n.amPM.textContent,i=t%12+12*rn(e===n.l10n.amPM[1]));var a=void 0!==n.config.minTime||n.config.minDate&&n.minDateHasTime&&n.latestSelectedDateObj&&0===_n(n.latestSelectedDateObj,n.config.minDate,!0),l=void 0!==n.config.maxTime||n.config.maxDate&&n.maxDateHasTime&&n.latestSelectedDateObj&&0===_n(n.latestSelectedDateObj,n.config.maxDate,!0);if(void 0!==n.config.maxTime&&void 0!==n.config.minTime&&n.config.minTime>n.config.maxTime){var s=bn(n.config.minTime.getHours(),n.config.minTime.getMinutes(),n.config.minTime.getSeconds()),c=bn(n.config.maxTime.getHours(),n.config.maxTime.getMinutes(),n.config.maxTime.getSeconds()),p=bn(i,r,o);if(p>c&&p<s){var h=function(t){var e=Math.floor(t/3600),n=(t-3600*e)/60;return[e,n,t-3600*e-60*n]}(s);i=h[0],r=h[1],o=h[2]}}else{if(l){var d=void 0!==n.config.maxTime?n.config.maxTime:n.config.maxDate;(i=Math.min(i,d.getHours()))===d.getHours()&&(r=Math.min(r,d.getMinutes())),r===d.getMinutes()&&(o=Math.min(o,d.getSeconds()))}if(a){var f=void 0!==n.config.minTime?n.config.minTime:n.config.minDate;(i=Math.max(i,f.getHours()))===f.getHours()&&r<f.getMinutes()&&(r=f.getMinutes()),r===f.getMinutes()&&(o=Math.max(o,f.getSeconds()))}}u(i,r,o)}}function s(t){var e=t||n.latestSelectedDateObj;e&&e instanceof Date&&u(e.getHours(),e.getMinutes(),e.getSeconds())}function u(t,e,i){void 0!==n.latestSelectedDateObj&&n.latestSelectedDateObj.setHours(t%24,e,i||0,0),n.hourElement&&n.minuteElement&&!n.isMobile&&(n.hourElement.value=nn(n.config.time_24hr?t:(12+t)%12+12*rn(t%12==0)),n.minuteElement.value=nn(e),void 0!==n.amPM&&(n.amPM.textContent=n.l10n.amPM[rn(t>=12)]),void 0!==n.secondElement&&(n.secondElement.value=nn(i)))}function c(t){var e=pn(t),n=parseInt(e.value)+(t.delta||0);(n/1e3>1||"Enter"===t.key&&!/[^\d]/.test(n.toString()))&&M(n)}function p(t,e,i,r){return e instanceof Array?e.forEach((function(e){return p(t,e,i,r)})):t instanceof Array?t.forEach((function(t){return p(t,e,i,r)})):(t.addEventListener(e,i,r),void n._handlers.push({remove:function(){return t.removeEventListener(e,i,r)}}))}function h(){X("onChange")}function d(t,e){var i=void 0!==t?n.parseDate(t):n.latestSelectedDateObj||(n.config.minDate&&n.config.minDate>n.now?n.config.minDate:n.config.maxDate&&n.config.maxDate<n.now?n.config.maxDate:n.now),r=n.currentYear,o=n.currentMonth;try{void 0!==i&&(n.currentYear=i.getFullYear(),n.currentMonth=i.getMonth())}catch(a){a.message="Invalid date supplied: "+i,n.config.errorHandler(a)}e&&n.currentYear!==r&&(X("onYearChange"),w()),!e||n.currentYear===r&&n.currentMonth===o||X("onMonthChange"),n.redraw()}function f(t){var e=pn(t);~e.className.indexOf("arrow")&&m(t,e.classList.contains("arrowUp")?1:-1)}function m(t,e,n){var i=t&&pn(t),r=n||i&&i.parentNode&&i.parentNode.firstChild,o=W("increment");o.delta=e,r&&r.dispatchEvent(o)}function g(t,e,i,r){var o=k(e,!0),a=sn("span",t,e.getDate().toString());return a.dateObj=e,a.$i=r,a.setAttribute("aria-label",n.formatDate(e,n.config.ariaDateFormat)),-1===t.indexOf("hidden")&&0===_n(e,n.now)&&(n.todayDateElem=a,a.classList.add("today"),a.setAttribute("aria-current","date")),o?(a.tabIndex=-1,K(e)&&(a.classList.add("selected"),n.selectedDateElem=a,"range"===n.config.mode&&(ln(a,"startRange",n.selectedDates[0]&&0===_n(e,n.selectedDates[0],!0)),ln(a,"endRange",n.selectedDates[1]&&0===_n(e,n.selectedDates[1],!0)),"nextMonthDay"===t&&a.classList.add("inRange")))):a.classList.add("flatpickr-disabled"),"range"===n.config.mode&&function(t){return!("range"!==n.config.mode||n.selectedDates.length<2)&&(_n(t,n.selectedDates[0])>=0&&_n(t,n.selectedDates[1])<=0)}(e)&&!K(e)&&a.classList.add("inRange"),n.weekNumbers&&1===n.config.showMonths&&"prevMonthDay"!==t&&r%7==6&&n.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+n.config.getWeek(e)+"</span>"),X("onDayCreate",a),a}function v(t){t.focus(),"range"===n.config.mode&&R(t)}function y(t){for(var e=t>0?0:n.config.showMonths-1,i=t>0?n.config.showMonths:-1,r=e;r!=i;r+=t)for(var o=n.daysContainer.children[r],a=t>0?0:o.children.length-1,l=t>0?o.children.length:-1,s=a;s!=l;s+=t){var u=o.children[s];if(-1===u.className.indexOf("hidden")&&k(u.dateObj))return u}}function _(t,e){var r=i(),o=D(r||document.body),a=void 0!==t?t:o?r:void 0!==n.selectedDateElem&&D(n.selectedDateElem)?n.selectedDateElem:void 0!==n.todayDateElem&&D(n.todayDateElem)?n.todayDateElem:y(e>0?1:-1);void 0===a?n._input.focus():o?function(t,e){for(var i=-1===t.className.indexOf("Month")?t.dateObj.getMonth():n.currentMonth,r=e>0?n.config.showMonths:-1,o=e>0?1:-1,a=i-n.currentMonth;a!=r;a+=o)for(var l=n.daysContainer.children[a],s=i-n.currentMonth===a?t.$i+e:e<0?l.children.length-1:0,u=l.children.length,c=s;c>=0&&c<u&&c!=(e>0?u:-1);c+=o){var p=l.children[c];if(-1===p.className.indexOf("hidden")&&k(p.dateObj)&&Math.abs(t.$i-c)>=Math.abs(e))return v(p)}n.changeMonth(o),_(y(o),0)}(a,e):v(a)}function b(t,e){for(var i=(new Date(t,e,1).getDay()-n.l10n.firstDayOfWeek+7)%7,r=n.utils.getDaysInMonth((e-1+12)%12,t),o=n.utils.getDaysInMonth(e,t),a=window.document.createDocumentFragment(),l=n.config.showMonths>1,s=l?"prevMonthDay hidden":"prevMonthDay",u=l?"nextMonthDay hidden":"nextMonthDay",c=r+1-i,p=0;c<=r;c++,p++)a.appendChild(g("flatpickr-day "+s,new Date(t,e-1,c),0,p));for(c=1;c<=o;c++,p++)a.appendChild(g("flatpickr-day",new Date(t,e,c),0,p));for(var h=o+1;h<=42-i&&(1===n.config.showMonths||p%7!=0);h++,p++)a.appendChild(g("flatpickr-day "+u,new Date(t,e+1,h%o),0,p));var d=sn("div","dayContainer");return d.appendChild(a),d}function x(){if(void 0!==n.daysContainer){un(n.daysContainer),n.weekNumbers&&un(n.weekNumbers);for(var t=document.createDocumentFragment(),e=0;e<n.config.showMonths;e++){var i=new Date(n.currentYear,n.currentMonth,1);i.setMonth(n.currentMonth+e),t.appendChild(b(i.getFullYear(),i.getMonth()))}n.daysContainer.appendChild(t),n.days=n.daysContainer.firstChild,"range"===n.config.mode&&1===n.selectedDates.length&&R()}}function w(){if(!(n.config.showMonths>1||"dropdown"!==n.config.monthSelectorType)){var t=function(t){return!(void 0!==n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&t<n.config.minDate.getMonth())&&!(void 0!==n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()&&t>n.config.maxDate.getMonth())};n.monthsDropdownContainer.tabIndex=-1,n.monthsDropdownContainer.innerHTML="";for(var e=0;e<12;e++)if(t(e)){var i=sn("option","flatpickr-monthDropdown-month");i.value=new Date(n.currentYear,e).getMonth().toString(),i.textContent=dn(e,n.config.shorthandCurrentMonth,n.l10n),i.tabIndex=-1,n.currentMonth===e&&(i.selected=!0),n.monthsDropdownContainer.appendChild(i)}}}function C(){var t,e=sn("div","flatpickr-month"),i=window.document.createDocumentFragment();n.config.showMonths>1||"static"===n.config.monthSelectorType?t=sn("span","cur-month"):(n.monthsDropdownContainer=sn("select","flatpickr-monthDropdown-months"),n.monthsDropdownContainer.setAttribute("aria-label",n.l10n.monthAriaLabel),p(n.monthsDropdownContainer,"change",(function(t){var e=pn(t),i=parseInt(e.value,10);n.changeMonth(i-n.currentMonth),X("onMonthChange")})),w(),t=n.monthsDropdownContainer);var r=cn("cur-year",{tabindex:"-1"}),o=r.getElementsByTagName("input")[0];o.setAttribute("aria-label",n.l10n.yearAriaLabel),n.config.minDate&&o.setAttribute("min",n.config.minDate.getFullYear().toString()),n.config.maxDate&&(o.setAttribute("max",n.config.maxDate.getFullYear().toString()),o.disabled=!!n.config.minDate&&n.config.minDate.getFullYear()===n.config.maxDate.getFullYear());var a=sn("div","flatpickr-current-month");return a.appendChild(t),a.appendChild(r),i.appendChild(a),e.appendChild(i),{container:e,yearElement:o,monthElement:t}}function E(){un(n.monthNav),n.monthNav.appendChild(n.prevMonthNav),n.config.showMonths&&(n.yearElements=[],n.monthElements=[]);for(var t=n.config.showMonths;t--;){var e=C();n.yearElements.push(e.yearElement),n.monthElements.push(e.monthElement),n.monthNav.appendChild(e.container)}n.monthNav.appendChild(n.nextMonthNav)}function S(){n.weekdayContainer?un(n.weekdayContainer):n.weekdayContainer=sn("div","flatpickr-weekdays");for(var t=n.config.showMonths;t--;){var e=sn("div","flatpickr-weekdaycontainer");n.weekdayContainer.appendChild(e)}return T(),n.weekdayContainer}function T(){if(n.weekdayContainer){var t=n.l10n.firstDayOfWeek,e=En(n.l10n.weekdays.shorthand);t>0&&t<e.length&&(e=En(e.splice(t,e.length),e.splice(0,t)));for(var i=n.config.showMonths;i--;)n.weekdayContainer.children[i].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+e.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function I(t,e){void 0===e&&(e=!0);var i=e?t:t-n.currentMonth;i<0&&!0===n._hidePrevMonthArrow||i>0&&!0===n._hideNextMonthArrow||(n.currentMonth+=i,(n.currentMonth<0||n.currentMonth>11)&&(n.currentYear+=n.currentMonth>11?1:-1,n.currentMonth=(n.currentMonth+12)%12,X("onYearChange"),w()),x(),X("onMonthChange"),J())}function P(t){return n.calendarContainer.contains(t)}function A(t){if(n.isOpen&&!n.config.inline){var e=pn(t),i=P(e),r=!(e===n.input||e===n.altInput||n.element.contains(e)||t.path&&t.path.indexOf&&(~t.path.indexOf(n.input)||~t.path.indexOf(n.altInput)))&&!i&&!P(t.relatedTarget),o=!n.config.ignoredFocusElements.some((function(t){return t.contains(e)}));r&&o&&(n.config.allowInput&&n.setDate(n._input.value,!1,n.config.altInput?n.config.altFormat:n.config.dateFormat),void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement&&""!==n.input.value&&void 0!==n.input.value&&a(),n.close(),n.config&&"range"===n.config.mode&&1===n.selectedDates.length&&n.clear(!1))}}function M(t){if(!(!t||n.config.minDate&&t<n.config.minDate.getFullYear()||n.config.maxDate&&t>n.config.maxDate.getFullYear())){var e=t,i=n.currentYear!==e;n.currentYear=e||n.currentYear,n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth=Math.min(n.config.maxDate.getMonth(),n.currentMonth):n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&(n.currentMonth=Math.max(n.config.minDate.getMonth(),n.currentMonth)),i&&(n.redraw(),X("onYearChange"),w())}}function k(t,e){var i;void 0===e&&(e=!0);var r=n.parseDate(t,void 0,e);if(n.config.minDate&&r&&_n(r,n.config.minDate,void 0!==e?e:!n.minDateHasTime)<0||n.config.maxDate&&r&&_n(r,n.config.maxDate,void 0!==e?e:!n.maxDateHasTime)>0)return!1;if(!n.config.enable&&0===n.config.disable.length)return!0;if(void 0===r)return!1;for(var o=!!n.config.enable,a=null!==(i=n.config.enable)&&void 0!==i?i:n.config.disable,l=0,s=void 0;l<a.length;l++){if("function"==typeof(s=a[l])&&s(r))return o;if(s instanceof Date&&void 0!==r&&s.getTime()===r.getTime())return o;if("string"==typeof s){var u=n.parseDate(s,void 0,!0);return u&&u.getTime()===r.getTime()?o:!o}if("object"==typeof s&&void 0!==r&&s.from&&s.to&&r.getTime()>=s.from.getTime()&&r.getTime()<=s.to.getTime())return o}return!o}function D(t){return void 0!==n.daysContainer&&(-1===t.className.indexOf("hidden")&&-1===t.className.indexOf("flatpickr-disabled")&&n.daysContainer.contains(t))}function L(t){var e=t.target===n._input,i=n._input.value.trimEnd()!==$();!e||!i||t.relatedTarget&&P(t.relatedTarget)||n.setDate(n._input.value,!0,t.target===n.altInput?n.config.altFormat:n.config.dateFormat)}function O(e){var r=pn(e),o=n.config.wrap?t.contains(r):r===n._input,s=n.config.allowInput,u=n.isOpen&&(!s||!o),c=n.config.inline&&o&&!s;if(13===e.keyCode&&o){if(s)return n.setDate(n._input.value,!0,r===n.altInput?n.config.altFormat:n.config.dateFormat),n.close(),r.blur();n.open()}else if(P(r)||u||c){var p=!!n.timeContainer&&n.timeContainer.contains(r);switch(e.keyCode){case 13:p?(e.preventDefault(),a(),V()):q(e);break;case 27:e.preventDefault(),V();break;case 8:case 46:o&&!n.config.allowInput&&(e.preventDefault(),n.clear());break;case 37:case 39:if(p||o)n.hourElement&&n.hourElement.focus();else{e.preventDefault();var h=i();if(void 0!==n.daysContainer&&(!1===s||h&&D(h))){var d=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),I(d),_(y(1),0)):_(void 0,d)}}break;case 38:case 40:e.preventDefault();var f=40===e.keyCode?1:-1;n.daysContainer&&void 0!==r.$i||r===n.input||r===n.altInput?e.ctrlKey?(e.stopPropagation(),M(n.currentYear-f),_(y(1),0)):p||_(void 0,7*f):r===n.currentYearElement?M(n.currentYear-f):n.config.enableTime&&(!p&&n.hourElement&&n.hourElement.focus(),a(e),n._debouncedChange());break;case 9:if(p){var m=[n.hourElement,n.minuteElement,n.secondElement,n.amPM].concat(n.pluginElements).filter((function(t){return t})),g=m.indexOf(r);if(-1!==g){var v=m[g+(e.shiftKey?-1:1)];e.preventDefault(),(v||n._input).focus()}}else!n.config.noCalendar&&n.daysContainer&&n.daysContainer.contains(r)&&e.shiftKey&&(e.preventDefault(),n._input.focus())}}if(void 0!==n.amPM&&r===n.amPM)switch(e.key){case n.l10n.amPM[0].charAt(0):case n.l10n.amPM[0].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[0],l(),Q();break;case n.l10n.amPM[1].charAt(0):case n.l10n.amPM[1].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[1],l(),Q()}(o||P(r))&&X("onKeyDown",e)}function R(t,e){if(void 0===e&&(e="flatpickr-day"),1===n.selectedDates.length&&(!t||t.classList.contains(e)&&!t.classList.contains("flatpickr-disabled"))){for(var i=t?t.dateObj.getTime():n.days.firstElementChild.dateObj.getTime(),r=n.parseDate(n.selectedDates[0],void 0,!0).getTime(),o=Math.min(i,n.selectedDates[0].getTime()),a=Math.max(i,n.selectedDates[0].getTime()),l=!1,s=0,u=0,c=o;c<a;c+=xn)k(new Date(c),!0)||(l=l||c>o&&c<a,c<r&&(!s||c>s)?s=c:c>r&&(!u||c<u)&&(u=c));Array.from(n.rContainer.querySelectorAll("*:nth-child(-n+"+n.config.showMonths+") > ."+e)).forEach((function(e){var o,a,c,p=e.dateObj.getTime(),h=s>0&&p<s||u>0&&p>u;if(h)return e.classList.add("notAllowed"),void["inRange","startRange","endRange"].forEach((function(t){e.classList.remove(t)}));l&&!h||(["startRange","inRange","endRange","notAllowed"].forEach((function(t){e.classList.remove(t)})),void 0!==t&&(t.classList.add(i<=n.selectedDates[0].getTime()?"startRange":"endRange"),r<i&&p===r?e.classList.add("startRange"):r>i&&p===r&&e.classList.add("endRange"),p>=s&&(0===u||p<=u)&&(a=r,c=i,(o=p)>Math.min(a,c)&&o<Math.max(a,c))&&e.classList.add("inRange")))}))}}function z(){!n.isOpen||n.config.static||n.config.inline||U()}function F(t){return function(e){var i=n.config["_"+t+"Date"]=n.parseDate(e,n.config.dateFormat),r=n.config["_"+("min"===t?"max":"min")+"Date"];void 0!==i&&(n["min"===t?"minDateHasTime":"maxDateHasTime"]=i.getHours()>0||i.getMinutes()>0||i.getSeconds()>0),n.selectedDates&&(n.selectedDates=n.selectedDates.filter((function(t){return k(t)})),n.selectedDates.length||"min"!==t||s(i),Q()),n.daysContainer&&(j(),void 0!==i?n.currentYearElement[t]=i.getFullYear().toString():n.currentYearElement.removeAttribute(t),n.currentYearElement.disabled=!!r&&void 0!==i&&r.getFullYear()===i.getFullYear())}}function B(){return n.config.wrap?t.querySelector("[data-input]"):t}function N(){"object"!=typeof n.config.locale&&void 0===In.l10ns[n.config.locale]&&n.config.errorHandler(new Error("flatpickr: invalid locale "+n.config.locale)),n.l10n=Cn(Cn({},In.l10ns.default),"object"==typeof n.config.locale?n.config.locale:"default"!==n.config.locale?In.l10ns[n.config.locale]:void 0),mn.D="("+n.l10n.weekdays.shorthand.join("|")+")",mn.l="("+n.l10n.weekdays.longhand.join("|")+")",mn.M="("+n.l10n.months.shorthand.join("|")+")",mn.F="("+n.l10n.months.longhand.join("|")+")",mn.K="("+n.l10n.amPM[0]+"|"+n.l10n.amPM[1]+"|"+n.l10n.amPM[0].toLowerCase()+"|"+n.l10n.amPM[1].toLowerCase()+")",void 0===Cn(Cn({},e),JSON.parse(JSON.stringify(t.dataset||{}))).time_24hr&&void 0===In.defaultConfig.time_24hr&&(n.config.time_24hr=n.l10n.time_24hr),n.formatDate=vn(n),n.parseDate=yn({config:n.config,l10n:n.l10n})}function U(t){if("function"!=typeof n.config.position){if(void 0!==n.calendarContainer){X("onPreCalendarPosition");var e=t||n._positionElement,i=Array.prototype.reduce.call(n.calendarContainer.children,(function(t,e){return t+e.offsetHeight}),0),r=n.calendarContainer.offsetWidth,o=n.config.position.split(" "),a=o[0],l=o.length>1?o[1]:null,s=e.getBoundingClientRect(),u=window.innerHeight-s.bottom,c="above"===a||"below"!==a&&u<i&&s.top>i,p=window.pageYOffset+s.top+(c?-i-2:e.offsetHeight+2);if(ln(n.calendarContainer,"arrowTop",!c),ln(n.calendarContainer,"arrowBottom",c),!n.config.inline){var h=window.pageXOffset+s.left,d=!1,f=!1;"center"===l?(h-=(r-s.width)/2,d=!0):"right"===l&&(h-=r-s.width,f=!0),ln(n.calendarContainer,"arrowLeft",!d&&!f),ln(n.calendarContainer,"arrowCenter",d),ln(n.calendarContainer,"arrowRight",f);var m=window.document.body.offsetWidth-(window.pageXOffset+s.right),g=h+r>window.document.body.offsetWidth,v=m+r>window.document.body.offsetWidth;if(ln(n.calendarContainer,"rightMost",g),!n.config.static)if(n.calendarContainer.style.top=p+"px",g)if(v){var y=function(){for(var t=null,e=0;e<document.styleSheets.length;e++){var n=document.styleSheets[e];if(n.cssRules){try{n.cssRules}catch(r){continue}t=n;break}}return null!=t?t:(i=document.createElement("style"),document.head.appendChild(i),i.sheet);var i}();if(void 0===y)return;var _=window.document.body.offsetWidth,b=Math.max(0,_/2-r/2),x=y.cssRules.length,w="{left:"+s.left+"px;right:auto;}";ln(n.calendarContainer,"rightMost",!1),ln(n.calendarContainer,"centerMost",!0),y.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+w,x),n.calendarContainer.style.left=b+"px",n.calendarContainer.style.right="auto"}else n.calendarContainer.style.left="auto",n.calendarContainer.style.right=m+"px";else n.calendarContainer.style.left=h+"px",n.calendarContainer.style.right="auto"}}}else n.config.position(n,t)}function j(){n.config.noCalendar||n.isMobile||(w(),J(),x())}function V(){n._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(n.close,0):n.close()}function q(t){t.preventDefault(),t.stopPropagation();var e=function t(e,n){return n(e)?e:e.parentNode?t(e.parentNode,n):void 0}(pn(t),(function(t){return t.classList&&t.classList.contains("flatpickr-day")&&!t.classList.contains("flatpickr-disabled")&&!t.classList.contains("notAllowed")}));if(void 0!==e){var i=e,r=n.latestSelectedDateObj=new Date(i.dateObj.getTime()),o=(r.getMonth()<n.currentMonth||r.getMonth()>n.currentMonth+n.config.showMonths-1)&&"range"!==n.config.mode;if(n.selectedDateElem=i,"single"===n.config.mode)n.selectedDates=[r];else if("multiple"===n.config.mode){var a=K(r);a?n.selectedDates.splice(parseInt(a),1):n.selectedDates.push(r)}else"range"===n.config.mode&&(2===n.selectedDates.length&&n.clear(!1,!1),n.latestSelectedDateObj=r,n.selectedDates.push(r),0!==_n(r,n.selectedDates[0],!0)&&n.selectedDates.sort((function(t,e){return t.getTime()-e.getTime()})));if(l(),o){var s=n.currentYear!==r.getFullYear();n.currentYear=r.getFullYear(),n.currentMonth=r.getMonth(),s&&(X("onYearChange"),w()),X("onMonthChange")}if(J(),x(),Q(),o||"range"===n.config.mode||1!==n.config.showMonths?void 0!==n.selectedDateElem&&void 0===n.hourElement&&n.selectedDateElem&&n.selectedDateElem.focus():v(i),void 0!==n.hourElement&&void 0!==n.hourElement&&n.hourElement.focus(),n.config.closeOnSelect){var u="single"===n.config.mode&&!n.config.enableTime,c="range"===n.config.mode&&2===n.selectedDates.length&&!n.config.enableTime;(u||c)&&V()}h()}}n.parseDate=yn({config:n.config,l10n:n.l10n}),n._handlers=[],n.pluginElements=[],n.loadedPlugins=[],n._bind=p,n._setHoursFromDate=s,n._positionCalendar=U,n.changeMonth=I,n.changeYear=M,n.clear=function(t,e){void 0===t&&(t=!0);void 0===e&&(e=!0);n.input.value="",void 0!==n.altInput&&(n.altInput.value="");void 0!==n.mobileInput&&(n.mobileInput.value="");n.selectedDates=[],n.latestSelectedDateObj=void 0,!0===e&&(n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth());if(!0===n.config.enableTime){var i=wn(n.config),r=i.hours,o=i.minutes,a=i.seconds;u(r,o,a)}n.redraw(),t&&X("onChange")},n.close=function(){n.isOpen=!1,n.isMobile||(void 0!==n.calendarContainer&&n.calendarContainer.classList.remove("open"),void 0!==n._input&&n._input.classList.remove("active"));X("onClose")},n.onMouseOver=R,n._createElement=sn,n.createDay=g,n.destroy=function(){void 0!==n.config&&X("onDestroy");for(var t=n._handlers.length;t--;)n._handlers[t].remove();if(n._handlers=[],n.mobileInput)n.mobileInput.parentNode&&n.mobileInput.parentNode.removeChild(n.mobileInput),n.mobileInput=void 0;else if(n.calendarContainer&&n.calendarContainer.parentNode)if(n.config.static&&n.calendarContainer.parentNode){var e=n.calendarContainer.parentNode;if(e.lastChild&&e.removeChild(e.lastChild),e.parentNode){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}}else n.calendarContainer.parentNode.removeChild(n.calendarContainer);n.altInput&&(n.input.type="text",n.altInput.parentNode&&n.altInput.parentNode.removeChild(n.altInput),delete n.altInput);n.input&&(n.input.type=n.input._type,n.input.classList.remove("flatpickr-input"),n.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((function(t){try{delete n[t]}catch(e){}}))},n.isEnabled=k,n.jumpToDate=d,n.updateValue=Q,n.open=function(t,e){void 0===e&&(e=n._positionElement);if(!0===n.isMobile){if(t){t.preventDefault();var i=pn(t);i&&i.blur()}return void 0!==n.mobileInput&&(n.mobileInput.focus(),n.mobileInput.click()),void X("onOpen")}if(n._input.disabled||n.config.inline)return;var r=n.isOpen;n.isOpen=!0,r||(n.calendarContainer.classList.add("open"),n._input.classList.add("active"),X("onOpen"),U(e));!0===n.config.enableTime&&!0===n.config.noCalendar&&(!1!==n.config.allowInput||void 0!==t&&n.timeContainer.contains(t.relatedTarget)||setTimeout((function(){return n.hourElement.select()}),50))},n.redraw=j,n.set=function(t,e){if(null!==t&&"object"==typeof t)for(var i in Object.assign(n.config,t),t)void 0!==G[i]&&G[i].forEach((function(t){return t()}));else n.config[t]=e,void 0!==G[t]?G[t].forEach((function(t){return t()})):$e.indexOf(t)>-1&&(n.config[t]=an(e));n.redraw(),Q(!0)},n.setDate=function(t,e,i){void 0===e&&(e=!1);void 0===i&&(i=n.config.dateFormat);if(0!==t&&!t||t instanceof Array&&0===t.length)return n.clear(e);Z(t,i),n.latestSelectedDateObj=n.selectedDates[n.selectedDates.length-1],n.redraw(),d(void 0,e),s(),0===n.selectedDates.length&&n.clear(!1);Q(e),e&&X("onChange")},n.toggle=function(t){if(!0===n.isOpen)return n.close();n.open(t)};var G={locale:[N,T],showMonths:[E,o,S],minDate:[d],maxDate:[d],positionElement:[Y],clickOpens:[function(){!0===n.config.clickOpens?(p(n._input,"focus",n.open),p(n._input,"click",n.open)):(n._input.removeEventListener("focus",n.open),n._input.removeEventListener("click",n.open))}]};function Z(t,e){var i=[];if(t instanceof Array)i=t.map((function(t){return n.parseDate(t,e)}));else if(t instanceof Date||"number"==typeof t)i=[n.parseDate(t,e)];else if("string"==typeof t)switch(n.config.mode){case"single":case"time":i=[n.parseDate(t,e)];break;case"multiple":i=t.split(n.config.conjunction).map((function(t){return n.parseDate(t,e)}));break;case"range":i=t.split(n.l10n.rangeSeparator).map((function(t){return n.parseDate(t,e)}))}else n.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(t)));n.selectedDates=n.config.allowInvalidPreload?i:i.filter((function(t){return t instanceof Date&&k(t,!1)})),"range"===n.config.mode&&n.selectedDates.sort((function(t,e){return t.getTime()-e.getTime()}))}function H(t){return t.slice().map((function(t){return"string"==typeof t||"number"==typeof t||t instanceof Date?n.parseDate(t,void 0,!0):t&&"object"==typeof t&&t.from&&t.to?{from:n.parseDate(t.from,void 0),to:n.parseDate(t.to,void 0)}:t})).filter((function(t){return t}))}function Y(){n._positionElement=n.config.positionElement||n._input}function X(t,e){if(void 0!==n.config){var i=n.config[t];if(void 0!==i&&i.length>0)for(var r=0;i[r]&&r<i.length;r++)i[r](n.selectedDates,n.input.value,n,e);"onChange"===t&&(n.input.dispatchEvent(W("change")),n.input.dispatchEvent(W("input")))}}function W(t){var e=document.createEvent("Event");return e.initEvent(t,!0,!0),e}function K(t){for(var e=0;e<n.selectedDates.length;e++){var i=n.selectedDates[e];if(i instanceof Date&&0===_n(i,t))return""+e}return!1}function J(){n.config.noCalendar||n.isMobile||!n.monthNav||(n.yearElements.forEach((function(t,e){var i=new Date(n.currentYear,n.currentMonth,1);i.setMonth(n.currentMonth+e),n.config.showMonths>1||"static"===n.config.monthSelectorType?n.monthElements[e].textContent=dn(i.getMonth(),n.config.shorthandCurrentMonth,n.l10n)+" ":n.monthsDropdownContainer.value=i.getMonth().toString(),t.value=i.getFullYear().toString()})),n._hidePrevMonthArrow=void 0!==n.config.minDate&&(n.currentYear===n.config.minDate.getFullYear()?n.currentMonth<=n.config.minDate.getMonth():n.currentYear<n.config.minDate.getFullYear()),n._hideNextMonthArrow=void 0!==n.config.maxDate&&(n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth+1>n.config.maxDate.getMonth():n.currentYear>n.config.maxDate.getFullYear()))}function $(t){var e=t||(n.config.altInput?n.config.altFormat:n.config.dateFormat);return n.selectedDates.map((function(t){return n.formatDate(t,e)})).filter((function(t,e,i){return"range"!==n.config.mode||n.config.enableTime||i.indexOf(t)===e})).join("range"!==n.config.mode?n.config.conjunction:n.l10n.rangeSeparator)}function Q(t){void 0===t&&(t=!0),void 0!==n.mobileInput&&n.mobileFormatStr&&(n.mobileInput.value=void 0!==n.latestSelectedDateObj?n.formatDate(n.latestSelectedDateObj,n.mobileFormatStr):""),n.input.value=$(n.config.dateFormat),void 0!==n.altInput&&(n.altInput.value=$(n.config.altFormat)),!1!==t&&X("onValueUpdate")}function tt(t){var e=pn(t),i=n.prevMonthNav.contains(e),r=n.nextMonthNav.contains(e);i||r?I(i?-1:1):n.yearElements.indexOf(e)>=0?e.select():e.classList.contains("arrowUp")?n.changeYear(n.currentYear+1):e.classList.contains("arrowDown")&&n.changeYear(n.currentYear-1)}return function(){n.element=n.input=t,n.isOpen=!1,function(){var i=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],o=Cn(Cn({},JSON.parse(JSON.stringify(t.dataset||{}))),e),a={};n.config.parseDate=o.parseDate,n.config.formatDate=o.formatDate,Object.defineProperty(n.config,"enable",{get:function(){return n.config._enable},set:function(t){n.config._enable=H(t)}}),Object.defineProperty(n.config,"disable",{get:function(){return n.config._disable},set:function(t){n.config._disable=H(t)}});var l="time"===o.mode;if(!o.dateFormat&&(o.enableTime||l)){var s=In.defaultConfig.dateFormat||Qe.dateFormat;a.dateFormat=o.noCalendar||l?"H:i"+(o.enableSeconds?":S":""):s+" H:i"+(o.enableSeconds?":S":"")}if(o.altInput&&(o.enableTime||l)&&!o.altFormat){var u=In.defaultConfig.altFormat||Qe.altFormat;a.altFormat=o.noCalendar||l?"h:i"+(o.enableSeconds?":S K":" K"):u+" h:i"+(o.enableSeconds?":S":"")+" K"}Object.defineProperty(n.config,"minDate",{get:function(){return n.config._minDate},set:F("min")}),Object.defineProperty(n.config,"maxDate",{get:function(){return n.config._maxDate},set:F("max")});var c=function(t){return function(e){n.config["min"===t?"_minTime":"_maxTime"]=n.parseDate(e,"H:i:S")}};Object.defineProperty(n.config,"minTime",{get:function(){return n.config._minTime},set:c("min")}),Object.defineProperty(n.config,"maxTime",{get:function(){return n.config._maxTime},set:c("max")}),"time"===o.mode&&(n.config.noCalendar=!0,n.config.enableTime=!0);Object.assign(n.config,a,o);for(var p=0;p<i.length;p++)n.config[i[p]]=!0===n.config[i[p]]||"true"===n.config[i[p]];$e.filter((function(t){return void 0!==n.config[t]})).forEach((function(t){n.config[t]=an(n.config[t]||[]).map(r)})),n.isMobile=!n.config.disableMobile&&!n.config.inline&&"single"===n.config.mode&&!n.config.disable.length&&!n.config.enable&&!n.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(p=0;p<n.config.plugins.length;p++){var h=n.config.plugins[p](n)||{};for(var d in h)$e.indexOf(d)>-1?n.config[d]=an(h[d]).map(r).concat(n.config[d]):void 0===o[d]&&(n.config[d]=h[d])}o.altInputClass||(n.config.altInputClass=B().className+" "+n.config.altInputClass);X("onParseConfig")}(),N(),function(){if(n.input=B(),!n.input)return void n.config.errorHandler(new Error("Invalid input element specified"));n.input._type=n.input.type,n.input.type="text",n.input.classList.add("flatpickr-input"),n._input=n.input,n.config.altInput&&(n.altInput=sn(n.input.nodeName,n.config.altInputClass),n._input=n.altInput,n.altInput.placeholder=n.input.placeholder,n.altInput.disabled=n.input.disabled,n.altInput.required=n.input.required,n.altInput.tabIndex=n.input.tabIndex,n.altInput.type="text",n.input.setAttribute("type","hidden"),!n.config.static&&n.input.parentNode&&n.input.parentNode.insertBefore(n.altInput,n.input.nextSibling));n.config.allowInput||n._input.setAttribute("readonly","readonly");Y()}(),function(){n.selectedDates=[],n.now=n.parseDate(n.config.now)||new Date;var t=n.config.defaultDate||("INPUT"!==n.input.nodeName&&"TEXTAREA"!==n.input.nodeName||!n.input.placeholder||n.input.value!==n.input.placeholder?n.input.value:null);t&&Z(t,n.config.dateFormat);n._initialDate=n.selectedDates.length>0?n.selectedDates[0]:n.config.minDate&&n.config.minDate.getTime()>n.now.getTime()?n.config.minDate:n.config.maxDate&&n.config.maxDate.getTime()<n.now.getTime()?n.config.maxDate:n.now,n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth(),n.selectedDates.length>0&&(n.latestSelectedDateObj=n.selectedDates[0]);void 0!==n.config.minTime&&(n.config.minTime=n.parseDate(n.config.minTime,"H:i"));void 0!==n.config.maxTime&&(n.config.maxTime=n.parseDate(n.config.maxTime,"H:i"));n.minDateHasTime=!!n.config.minDate&&(n.config.minDate.getHours()>0||n.config.minDate.getMinutes()>0||n.config.minDate.getSeconds()>0),n.maxDateHasTime=!!n.config.maxDate&&(n.config.maxDate.getHours()>0||n.config.maxDate.getMinutes()>0||n.config.maxDate.getSeconds()>0)}(),n.utils={getDaysInMonth:function(t,e){return void 0===t&&(t=n.currentMonth),void 0===e&&(e=n.currentYear),1===t&&(e%4==0&&e%100!=0||e%400==0)?29:n.l10n.daysInMonth[t]}},n.isMobile||function(){var t=window.document.createDocumentFragment();if(n.calendarContainer=sn("div","flatpickr-calendar"),n.calendarContainer.tabIndex=-1,!n.config.noCalendar){if(t.appendChild((n.monthNav=sn("div","flatpickr-months"),n.yearElements=[],n.monthElements=[],n.prevMonthNav=sn("span","flatpickr-prev-month"),n.prevMonthNav.innerHTML=n.config.prevArrow,n.nextMonthNav=sn("span","flatpickr-next-month"),n.nextMonthNav.innerHTML=n.config.nextArrow,E(),Object.defineProperty(n,"_hidePrevMonthArrow",{get:function(){return n.__hidePrevMonthArrow},set:function(t){n.__hidePrevMonthArrow!==t&&(ln(n.prevMonthNav,"flatpickr-disabled",t),n.__hidePrevMonthArrow=t)}}),Object.defineProperty(n,"_hideNextMonthArrow",{get:function(){return n.__hideNextMonthArrow},set:function(t){n.__hideNextMonthArrow!==t&&(ln(n.nextMonthNav,"flatpickr-disabled",t),n.__hideNextMonthArrow=t)}}),n.currentYearElement=n.yearElements[0],J(),n.monthNav)),n.innerContainer=sn("div","flatpickr-innerContainer"),n.config.weekNumbers){var e=function(){n.calendarContainer.classList.add("hasWeeks");var t=sn("div","flatpickr-weekwrapper");t.appendChild(sn("span","flatpickr-weekday",n.l10n.weekAbbreviation));var e=sn("div","flatpickr-weeks");return t.appendChild(e),{weekWrapper:t,weekNumbers:e}}(),i=e.weekWrapper,r=e.weekNumbers;n.innerContainer.appendChild(i),n.weekNumbers=r,n.weekWrapper=i}n.rContainer=sn("div","flatpickr-rContainer"),n.rContainer.appendChild(S()),n.daysContainer||(n.daysContainer=sn("div","flatpickr-days"),n.daysContainer.tabIndex=-1),x(),n.rContainer.appendChild(n.daysContainer),n.innerContainer.appendChild(n.rContainer),t.appendChild(n.innerContainer)}n.config.enableTime&&t.appendChild(function(){n.calendarContainer.classList.add("hasTime"),n.config.noCalendar&&n.calendarContainer.classList.add("noCalendar");var t=wn(n.config);n.timeContainer=sn("div","flatpickr-time"),n.timeContainer.tabIndex=-1;var e=sn("span","flatpickr-time-separator",":"),i=cn("flatpickr-hour",{"aria-label":n.l10n.hourAriaLabel});n.hourElement=i.getElementsByTagName("input")[0];var r=cn("flatpickr-minute",{"aria-label":n.l10n.minuteAriaLabel});n.minuteElement=r.getElementsByTagName("input")[0],n.hourElement.tabIndex=n.minuteElement.tabIndex=-1,n.hourElement.value=nn(n.latestSelectedDateObj?n.latestSelectedDateObj.getHours():n.config.time_24hr?t.hours:function(t){switch(t%24){case 0:case 12:return 12;default:return t%12}}(t.hours)),n.minuteElement.value=nn(n.latestSelectedDateObj?n.latestSelectedDateObj.getMinutes():t.minutes),n.hourElement.setAttribute("step",n.config.hourIncrement.toString()),n.minuteElement.setAttribute("step",n.config.minuteIncrement.toString()),n.hourElement.setAttribute("min",n.config.time_24hr?"0":"1"),n.hourElement.setAttribute("max",n.config.time_24hr?"23":"12"),n.hourElement.setAttribute("maxlength","2"),n.minuteElement.setAttribute("min","0"),n.minuteElement.setAttribute("max","59"),n.minuteElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(i),n.timeContainer.appendChild(e),n.timeContainer.appendChild(r),n.config.time_24hr&&n.timeContainer.classList.add("time24hr");if(n.config.enableSeconds){n.timeContainer.classList.add("hasSeconds");var o=cn("flatpickr-second");n.secondElement=o.getElementsByTagName("input")[0],n.secondElement.value=nn(n.latestSelectedDateObj?n.latestSelectedDateObj.getSeconds():t.seconds),n.secondElement.setAttribute("step",n.minuteElement.getAttribute("step")),n.secondElement.setAttribute("min","0"),n.secondElement.setAttribute("max","59"),n.secondElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(sn("span","flatpickr-time-separator",":")),n.timeContainer.appendChild(o)}n.config.time_24hr||(n.amPM=sn("span","flatpickr-am-pm",n.l10n.amPM[rn((n.latestSelectedDateObj?n.hourElement.value:n.config.defaultHour)>11)]),n.amPM.title=n.l10n.toggleTitle,n.amPM.tabIndex=-1,n.timeContainer.appendChild(n.amPM));return n.timeContainer}());ln(n.calendarContainer,"rangeMode","range"===n.config.mode),ln(n.calendarContainer,"animate",!0===n.config.animate),ln(n.calendarContainer,"multiMonth",n.config.showMonths>1),n.calendarContainer.appendChild(t);var o=void 0!==n.config.appendTo&&void 0!==n.config.appendTo.nodeType;if((n.config.inline||n.config.static)&&(n.calendarContainer.classList.add(n.config.inline?"inline":"static"),n.config.inline&&(!o&&n.element.parentNode?n.element.parentNode.insertBefore(n.calendarContainer,n._input.nextSibling):void 0!==n.config.appendTo&&n.config.appendTo.appendChild(n.calendarContainer)),n.config.static)){var a=sn("div","flatpickr-wrapper");n.element.parentNode&&n.element.parentNode.insertBefore(a,n.element),a.appendChild(n.element),n.altInput&&a.appendChild(n.altInput),a.appendChild(n.calendarContainer)}n.config.static||n.config.inline||(void 0!==n.config.appendTo?n.config.appendTo:window.document.body).appendChild(n.calendarContainer)}(),function(){n.config.wrap&&["open","close","toggle","clear"].forEach((function(t){Array.prototype.forEach.call(n.element.querySelectorAll("[data-"+t+"]"),(function(e){return p(e,"click",n[t])}))}));if(n.isMobile)return void function(){var t=n.config.enableTime?n.config.noCalendar?"time":"datetime-local":"date";n.mobileInput=sn("input",n.input.className+" flatpickr-mobile"),n.mobileInput.tabIndex=1,n.mobileInput.type=t,n.mobileInput.disabled=n.input.disabled,n.mobileInput.required=n.input.required,n.mobileInput.placeholder=n.input.placeholder,n.mobileFormatStr="datetime-local"===t?"Y-m-d\\TH:i:S":"date"===t?"Y-m-d":"H:i:S",n.selectedDates.length>0&&(n.mobileInput.defaultValue=n.mobileInput.value=n.formatDate(n.selectedDates[0],n.mobileFormatStr));n.config.minDate&&(n.mobileInput.min=n.formatDate(n.config.minDate,"Y-m-d"));n.config.maxDate&&(n.mobileInput.max=n.formatDate(n.config.maxDate,"Y-m-d"));n.input.getAttribute("step")&&(n.mobileInput.step=String(n.input.getAttribute("step")));n.input.type="hidden",void 0!==n.altInput&&(n.altInput.type="hidden");try{n.input.parentNode&&n.input.parentNode.insertBefore(n.mobileInput,n.input.nextSibling)}catch(e){}p(n.mobileInput,"change",(function(t){n.setDate(pn(t).value,!1,n.mobileFormatStr),X("onChange"),X("onClose")}))}();var t=on(z,50);n._debouncedChange=on(h,300),n.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&p(n.daysContainer,"mouseover",(function(t){"range"===n.config.mode&&R(pn(t))}));p(n._input,"keydown",O),void 0!==n.calendarContainer&&p(n.calendarContainer,"keydown",O);n.config.inline||n.config.static||p(window,"resize",t);void 0!==window.ontouchstart?p(window.document,"touchstart",A):p(window.document,"mousedown",A);p(window.document,"focus",A,{capture:!0}),!0===n.config.clickOpens&&(p(n._input,"focus",n.open),p(n._input,"click",n.open));void 0!==n.daysContainer&&(p(n.monthNav,"click",tt),p(n.monthNav,["keyup","increment"],c),p(n.daysContainer,"click",q));if(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement){p(n.timeContainer,["increment"],a),p(n.timeContainer,"blur",a,{capture:!0}),p(n.timeContainer,"click",f),p([n.hourElement,n.minuteElement],["focus","click"],(function(t){return pn(t).select()})),void 0!==n.secondElement&&p(n.secondElement,"focus",(function(){return n.secondElement&&n.secondElement.select()})),void 0!==n.amPM&&p(n.amPM,"click",(function(t){a(t)}))}n.config.allowInput&&p(n._input,"blur",L)}(),(n.selectedDates.length||n.config.noCalendar)&&(n.config.enableTime&&s(n.config.noCalendar?n.latestSelectedDateObj:void 0),Q(!1)),o();var i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!n.isMobile&&i&&U(),X("onReady")}(),n}function Tn(t,e){for(var n=Array.prototype.slice.call(t).filter((function(t){return t instanceof HTMLElement})),i=[],r=0;r<n.length;r++){var o=n[r];try{if(null!==o.getAttribute("data-fp-omit"))continue;void 0!==o._flatpickr&&(o._flatpickr.destroy(),o._flatpickr=void 0),o._flatpickr=Sn(o,e||{}),i.push(o._flatpickr)}catch(a){console.error(a)}}return 1===i.length?i[0]:i}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(t){return Tn(this,t)},HTMLElement.prototype.flatpickr=function(t){return Tn([this],t)});var In=function(t,e){return"string"==typeof t?Tn(window.document.querySelectorAll(t),e):t instanceof Node?Tn([t],e):Tn(t,e)};In.defaultConfig={},In.l10ns={en:Cn({},en),default:Cn({},en)},In.localize=function(t){In.l10ns.default=Cn(Cn({},In.l10ns.default),t)},In.setDefaults=function(t){In.defaultConfig=Cn(Cn({},In.defaultConfig),t)},In.parseDate=yn({}),In.formatDate=vn({}),In.compareDates=_n,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(t){return Tn(this,t)}),Date.prototype.fp_incr=function(t){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof t?parseInt(t,10):t))},"undefined"!=typeof window&&(window.flatpickr=In);var Pn=In;class An{constructor(){this.altFormat="F j, Y",this.altInput=!1,this.altInputClass="",this.allowInput=!1,this.appendTo=void 0,this.ariaDateFormat="F j, Y",this.clickOpens=!0,this.dateFormat="Y-m-d",this.defaultHour=12,this.defaultMinute=0,this.defaultSeconds=0,this.disable=[],this.disableMobile=!1,this.enableTime=!1,this.enableSeconds=!1,this.formatDate=void 0,this.hourIncrement=1,this.inline=!1,this.maxDate=void 0,this.minDate=void 0,this.minuteIncrement=5,this.mode="single",this.nextArrow=">",this.noCalendar=!1,this.now=new Date,this.prevArrow="<",this.shorthandCurrentMonth=!1,this.static=!1,this.time24hr=!1,this.utc=!1,this.weekNumbers=!1,this.wrap=!1,this.plugins=[],this.locale="default",this.convertModelValue=!1,this.showMonths=1,this.monthSelectorType="static"}}An.decorators=[{type:i.Injectable}];const Mn={provide:mt.o,useExisting:Object(i.forwardRef)(()=>kn),multi:!0};class kn{constructor(t,e,n){this.elm=t,this.defaults=e,this.renderer=n,this.options={},this.flatpickrReady=new i.EventEmitter,this.flatpickrChange=new i.EventEmitter,this.flatpickrValueUpdate=new i.EventEmitter,this.flatpickrOpen=new i.EventEmitter,this.flatpickrClose=new i.EventEmitter,this.flatpickrMonthChange=new i.EventEmitter,this.flatpickrYearChange=new i.EventEmitter,this.flatpickrDayCreate=new i.EventEmitter,this.isDisabled=!1,this.onChangeFn=()=>{},this.onTouchedFn=()=>{}}ngAfterViewInit(){const t={altFormat:this.altFormat,altInput:this.altInput,altInputClass:this.altInputClass,allowInput:this.allowInput,appendTo:this.appendTo,ariaDateFormat:this.ariaDateFormat,clickOpens:this.clickOpens,dateFormat:this.dateFormat,defaultHour:this.defaultHour,defaultMinute:this.defaultMinute,defaultSeconds:this.defaultSeconds,disable:this.disable,disableMobile:this.disableMobile,enable:this.enable,enableTime:this.enableTime,enableSeconds:this.enableSeconds,formatDate:this.formatDate,hourIncrement:this.hourIncrement,defaultDate:this.initialValue,inline:this.inline,maxDate:this.maxDate,minDate:this.minDate,minuteIncrement:this.minuteIncrement,mode:this.mode,nextArrow:this.nextArrow,noCalendar:this.noCalendar,now:this.now,parseDate:this.parseDate,prevArrow:this.prevArrow,shorthandCurrentMonth:this.shorthandCurrentMonth,showMonths:this.showMonths,monthSelectorType:this.monthSelectorType,static:this.static,time24hr:this.time24hr,weekNumbers:this.weekNumbers,getWeek:this.getWeek,wrap:this.wrap,plugins:this.plugins,locale:this.locale,onChange:(t,e,n)=>{this.flatpickrChange.emit({selectedDates:t,dateString:e,instance:n})},onOpen:(t,e,n)=>{this.flatpickrOpen.emit({selectedDates:t,dateString:e,instance:n})},onClose:(t,e,n)=>{this.flatpickrClose.emit({selectedDates:t,dateString:e,instance:n})},onMonthChange:(t,e,n)=>{this.flatpickrMonthChange.emit({selectedDates:t,dateString:e,instance:n})},onYearChange:(t,e,n)=>{this.flatpickrYearChange.emit({selectedDates:t,dateString:e,instance:n})},onReady:(t,e,n)=>{this.flatpickrReady.emit({selectedDates:t,dateString:e,instance:n})},onValueUpdate:(t,e,n)=>{this.flatpickrValueUpdate.emit({selectedDates:t,dateString:e,instance:n})},onDayCreate:(t,e,n,i)=>{this.flatpickrDayCreate.emit({selectedDates:t,dateString:e,instance:n,dayElement:i})}};Object.keys(t).forEach(e=>{void 0===t[e]&&(void 0!==this.options[e]?t[e]=this.options[e]:t[e]=this.defaults[e])}),t.time_24hr=t.time24hr,t.altInputClass=(t.altInputClass||"")+" "+this.elm.nativeElement.className,t.enable||delete t.enable,this.instance=Pn(this.elm.nativeElement,t),this.setDisabledState(this.isDisabled)}ngOnChanges(t){this.instance&&Object.keys(t).forEach(t=>{this.instance.set(t,this[t])})}ngOnDestroy(){this.instance&&this.instance.destroy()}writeValue(t){let e=t;this.convertModelValue&&"range"===this.mode&&t&&(e=[t.from,t.to]),this.instance?this.instance.setDate(e):this.initialValue=e}registerOnChange(t){this.onChangeFn=t}registerOnTouched(t){this.onTouchedFn=t}setDisabledState(t){this.isDisabled=t,this.instance&&(this.isDisabled?this.renderer.setProperty(this.instance._input,"disabled","disabled"):this.renderer.removeAttribute(this.instance._input,"disabled"))}inputChanged(){const t=this.elm.nativeElement.value;if(this.convertModelValue&&"string"==typeof t)switch(this.mode){case"multiple":const e=t.split("; ").map(t=>this.instance.parseDate(t,this.instance.config.dateFormat,!this.instance.config.enableTime));this.onChangeFn(e);break;case"range":const[n,i]=t.split(this.instance.l10n.rangeSeparator).map(t=>this.instance.parseDate(t,this.instance.config.dateFormat,!this.instance.config.enableTime));this.onChangeFn({from:n,to:i});break;case"single":default:this.onChangeFn(this.instance.parseDate(t,this.instance.config.dateFormat,!this.instance.config.enableTime))}else this.onChangeFn(t)}}kn.decorators=[{type:i.Directive,args:[{selector:"[mwlFlatpickr]",providers:[Mn],host:{"(blur)":"onTouchedFn()"},exportAs:"mwlFlatpickr"}]}],kn.ctorParameters=()=>[{type:i.ElementRef},{type:An},{type:i.Renderer2}],kn.propDecorators={options:[{type:i.Input}],altFormat:[{type:i.Input}],altInput:[{type:i.Input}],altInputClass:[{type:i.Input}],allowInput:[{type:i.Input}],appendTo:[{type:i.Input}],ariaDateFormat:[{type:i.Input}],clickOpens:[{type:i.Input}],dateFormat:[{type:i.Input}],defaultHour:[{type:i.Input}],defaultMinute:[{type:i.Input}],defaultSeconds:[{type:i.Input}],disable:[{type:i.Input}],disableMobile:[{type:i.Input}],enable:[{type:i.Input}],enableTime:[{type:i.Input}],enableSeconds:[{type:i.Input}],formatDate:[{type:i.Input}],hourIncrement:[{type:i.Input}],inline:[{type:i.Input}],maxDate:[{type:i.Input}],minDate:[{type:i.Input}],minuteIncrement:[{type:i.Input}],mode:[{type:i.Input}],nextArrow:[{type:i.Input}],noCalendar:[{type:i.Input}],now:[{type:i.Input}],parseDate:[{type:i.Input}],prevArrow:[{type:i.Input}],shorthandCurrentMonth:[{type:i.Input}],showMonths:[{type:i.Input}],static:[{type:i.Input}],time24hr:[{type:i.Input}],weekNumbers:[{type:i.Input}],getWeek:[{type:i.Input}],wrap:[{type:i.Input}],plugins:[{type:i.Input}],locale:[{type:i.Input}],convertModelValue:[{type:i.Input}],monthSelectorType:[{type:i.Input}],flatpickrReady:[{type:i.Output}],flatpickrChange:[{type:i.Output}],flatpickrValueUpdate:[{type:i.Output}],flatpickrOpen:[{type:i.Output}],flatpickrClose:[{type:i.Output}],flatpickrMonthChange:[{type:i.Output}],flatpickrYearChange:[{type:i.Output}],flatpickrDayCreate:[{type:i.Output}],inputChanged:[{type:i.HostListener,args:["input"]}]};const Dn=new i.InjectionToken("flatpickr defaults");function Ln(t){const e=new An;return Object.assign(e,t),e}class On{static forRoot(t={}){return{ngModule:On,providers:[{provide:Dn,useValue:t},{provide:An,useFactory:Ln,deps:[Dn]}]}}}On.decorators=[{type:i.NgModule,args:[{declarations:[kn],exports:[kn]}]}];var Rn=n("i5S4"),zn=n("Hdkq");class Fn{}var Bn=n("QBGs"),Nn=n("yotz");n.d(e,"SucursalesModuleNgFactory",(function(){return Un}));var Un=i["\u0275cmf"](st,[],(function(t){return i["\u0275mod"]([i["\u0275mpd"](512,i.ComponentFactoryResolver,i["\u0275CodegenComponentFactoryResolver"],[[8,[ut.a,ut.b,ut.h,ut.i,ut.e,ut.f,ut.g,ct.a,It,$t,ce,Ae,Ne,Ge,We,Ke.a]],[3,i.ComponentFactoryResolver],i.NgModuleRef]),i["\u0275mpd"](4608,mt.D,mt.D,[]),i["\u0275mpd"](4608,rt.q,rt.p,[i.LOCALE_ID,[2,rt.O]]),i["\u0275mpd"](4608,yt.G,yt.G,[i.ComponentFactoryResolver,i.Injector,yt.vb,yt.H]),i["\u0275mpd"](4608,ye.i,ye.o,[rt.d,i.PLATFORM_ID,ye.m]),i["\u0275mpd"](4608,ye.p,ye.p,[ye.i,ye.n]),i["\u0275mpd"](5120,ye.a,(function(t){return[t]}),[ye.p]),i["\u0275mpd"](4608,ye.l,ye.l,[]),i["\u0275mpd"](6144,ye.j,null,[ye.l]),i["\u0275mpd"](4608,ye.h,ye.h,[ye.j]),i["\u0275mpd"](6144,ye.b,null,[ye.h]),i["\u0275mpd"](4608,ye.f,ye.k,[ye.b,i.Injector]),i["\u0275mpd"](4608,ye.c,ye.c,[ye.f]),i["\u0275mpd"](4608,mt.f,mt.f,[]),i["\u0275mpd"](4608,Je.c,Je.c,[]),i["\u0275mpd"](4608,ht.e,ht.e,[]),i["\u0275mpd"](4608,rt.i,rt.i,[rt.q]),i["\u0275mpd"](5120,An,Ln,[Dn]),i["\u0275mpd"](5120,Rn.m,lt,[]),i["\u0275mpd"](4608,Rn.f,Rn.f,[]),i["\u0275mpd"](4608,Rn.c,Rn.c,[Rn.m]),i["\u0275mpd"](4608,Rn.j,Rn.j,[Rn.m]),i["\u0275mpd"](4608,Rn.a,Rn.a,[rt.i]),i["\u0275mpd"](1073742336,mt.C,mt.C,[]),i["\u0275mpd"](1073742336,mt.m,mt.m,[]),i["\u0275mpd"](1073742336,rt.c,rt.c,[]),i["\u0275mpd"](1073742336,yt.c,yt.c,[]),i["\u0275mpd"](1073742336,yt.g,yt.g,[]),i["\u0275mpd"](1073742336,yt.h,yt.h,[]),i["\u0275mpd"](1073742336,yt.l,yt.l,[]),i["\u0275mpd"](1073742336,yt.m,yt.m,[]),i["\u0275mpd"](1073742336,yt.u,yt.u,[]),i["\u0275mpd"](1073742336,yt.B,yt.B,[]),i["\u0275mpd"](1073742336,yt.I,yt.I,[]),i["\u0275mpd"](1073742336,yt.K,yt.K,[]),i["\u0275mpd"](1073742336,yt.P,yt.P,[]),i["\u0275mpd"](1073742336,yt.S,yt.S,[]),i["\u0275mpd"](1073742336,yt.V,yt.V,[]),i["\u0275mpd"](1073742336,yt.Y,yt.Y,[]),i["\u0275mpd"](1073742336,yt.bb,yt.bb,[]),i["\u0275mpd"](1073742336,yt.gb,yt.gb,[]),i["\u0275mpd"](1073742336,yt.jb,yt.jb,[]),i["\u0275mpd"](1073742336,yt.kb,yt.kb,[]),i["\u0275mpd"](1073742336,yt.lb,yt.lb,[]),i["\u0275mpd"](1073742336,yt.J,yt.J,[]),i["\u0275mpd"](1073742336,ye.e,ye.e,[]),i["\u0275mpd"](1073742336,ye.d,ye.d,[]),i["\u0275mpd"](1073742336,mt.y,mt.y,[]),i["\u0275mpd"](1073742336,Je.b,Je.b,[]),i["\u0275mpd"](1073742336,zn.a,zn.a,[]),i["\u0275mpd"](1073742336,pt.o,pt.o,[[2,pt.t],[2,pt.k]]),i["\u0275mpd"](1073742336,Fn,Fn,[]),i["\u0275mpd"](1073742336,ht.a,ht.a,[]),i["\u0275mpd"](1073742336,Gt.b,Gt.b,[]),i["\u0275mpd"](1073742336,On,On,[]),i["\u0275mpd"](1073742336,Rn.b,Rn.b,[]),i["\u0275mpd"](1073742336,Bn.a,Bn.a,[]),i["\u0275mpd"](1073742336,Rn.h,Rn.h,[]),i["\u0275mpd"](1073742336,Nn.b,Nn.b,[]),i["\u0275mpd"](1073742336,Rn.k,Rn.k,[]),i["\u0275mpd"](1073742336,Rn.d,Rn.d,[]),i["\u0275mpd"](1073742336,Rn.g,Rn.g,[]),i["\u0275mpd"](1073742336,st,st,[]),i["\u0275mpd"](256,i.LOCALE_ID,"es",[]),i["\u0275mpd"](256,ye.m,"XSRF-TOKEN",[]),i["\u0275mpd"](256,ye.n,"X-XSRF-TOKEN",[]),i["\u0275mpd"](1024,pt.i,(function(){return[[{path:"",children:[{path:"",redirectTo:"listar"},{path:"listar",component:gt},{path:"crear",component:Zt},{path:"actualizar/:id",component:ie},{path:"reservas",component:ve},{path:"deliveries",component:Me},{path:"crearDelivey",component:Ue},{path:"actualizarDelivery",component:Ze}]}]]}),[]),i["\u0275mpd"](256,"loadingConfig",{},[]),i["\u0275mpd"](256,Dn,{},[])])}))},jLWS:function(t,e,n){"use strict";t.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},jzMX:function(t,e){t.exports=function(t){return function t(e){if(Array.isArray(e)&&e.length&&"number"==typeof e[0])return[e];return e.reduce((function(e,n){return Array.isArray(n)&&Array.isArray(n[0])?e.concat(t(n)):(e.push(n),e)}),[])}(t)}},"k+DL":function(t,e,n){"use strict";n.r(e);var i=n("0wsv"),r=n("RwN2");function o(t,e,n,o){void 0===o&&(o={});var a=Object(r.a)(t),l=Object(i.degreesToRadians)(a[0]),s=Object(i.degreesToRadians)(a[1]),u=Object(i.degreesToRadians)(n),c=Object(i.lengthToRadians)(e,o.units),p=Math.asin(Math.sin(s)*Math.cos(c)+Math.cos(s)*Math.sin(c)*Math.cos(u)),h=l+Math.atan2(Math.sin(u)*Math.sin(c)*Math.cos(s),Math.cos(c)-Math.sin(s)*Math.sin(p)),d=Object(i.radiansToDegrees)(h),f=Object(i.radiansToDegrees)(p);return Object(i.point)([d,f],o.properties)}e.default=function(t,e,n){void 0===n&&(n={});for(var r=n.steps||64,a=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},l=[],s=0;s<r;s++)l.push(o(t,e,-360*s/r,n).geometry.coordinates);return l.push(l[0]),Object(i.polygon)([l],a)}},kHz5:function(t,e){t.exports=function(t,e){return t.length===e.length&&JSON.stringify(t.map(t=>t).sort())===JSON.stringify(e.map(t=>t).sort())}},l0gW:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i{transform(t,e,n){if(""===e)return t;const i=[];for(const r of t)(r.fullname?r.fullname.toLowerCase().indexOf(e.toLowerCase()):r.fullNameClient?r.fullNameClient.toLowerCase().indexOf(e.toLowerCase()):r.fechaEntrega?r.fechaEntrega.toLowerCase().indexOf(e.toLowerCase()):r.cabecera?r.cabecera.nombreProveedor.toLowerCase().indexOf(e.toLowerCase()):r.cabecera?r.cabecera.cuitProveedor.toLowerCase().indexOf(e.toLowerCase()):r.nameProduct?r.nameProduct.toLowerCase().indexOf(e.toLowerCase()):r.producto1?r.producto1.toLowerCase().indexOf(e.toLowerCase()):r.sucursal?r.sucursal.toLowerCase().indexOf(e.toLowerCase()):r.fullname?r.fullname.toLowerCase().indexOf(e.toLowerCase()):r.nombre?r.nombre.toLowerCase().indexOf(e.toLowerCase()):r.email?r.email.toLowerCase().indexOf(e.toLowerCase()):r.celular?r.celular.toLowerCase().indexOf(e.toLowerCase()):r.numberInventary?r.numberInventary.toLowerCase().indexOf(e.toLowerCase()):r.nameProduct?r.nameProduct.toLowerCase().indexOf(e.toLowerCase()):r.nameSubFamily?r.nameSubFamily.toLowerCase().indexOf(e.toLowerCase()):r.statusOrder?r.statusOrder.toLowerCase().indexOf(e.toLowerCase()):r.numberTable?r.numberTable.toLowerCase().indexOf(e.toLowerCase()):r.title?r.title.toLowerCase().indexOf(e.toLowerCase()):r.name?r.name.toLowerCase().indexOf(e.toLowerCase()):r.statusName?r.statusName.toLowerCase().indexOf(e.toLowerCase()):r.pathTitle?r.pathTitle.toLowerCase().indexOf(e.toLowerCase()):r.category?r.category.toLowerCase().indexOf(e.toLowerCase()):r.deliveryName?r.deliveryName.toLowerCase().indexOf(e.toLowerCase()):r.nameCategory.toLowerCase().indexOf(e.toLowerCase()))>-1&&i.push(r);return i}}},lJFB:function(t,e){t.exports=function(t){if(!t||!t.type)return null;var e=n[t.type];if(!e)return null;if("geometry"===e)return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if("feature"===e)return{type:"FeatureCollection",features:[t]};if("featurecollection"===e)return t};var n={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},mcvi:function(t,e,n){const i=n("FxjX"),r=n("VKWs"),o=n("/Jvy"),a=n("RXCC"),l=n("uI0s"),s=n("n8Y1"),u=n("GHAK"),c={onSetup:function(t){const e={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:t.featureIds||[]};return this.setSelected(e.initiallySelectedFeatureIds.filter(t=>void 0!==this.getFeature(t))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),e},fireUpdate:function(){this.map.fire(u.events.UPDATE,{action:u.updateActions.MOVE,features:this.getSelected().map(t=>t.toGeoJSON())})},fireActionable:function(){const t=this.getSelected(),e=t.filter(t=>this.isInstanceOf("MultiFeature",t));let n=!1;if(t.length>1){n=!0;const e=t[0].type.replace("Multi","");t.forEach(t=>{t.type.replace("Multi","")!==e&&(n=!1)})}const i=e.length>0,r=t.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:i,trash:r})},getUniqueIds:function(t){if(!t.length)return[];return t.map(t=>t.properties.id).filter(t=>void 0!==t).reduce((t,e)=>(t.add(e),t),new a).values()},stopExtendedInteractions:function(t){t.boxSelectElement&&(t.boxSelectElement.parentNode&&t.boxSelectElement.parentNode.removeChild(t.boxSelectElement),t.boxSelectElement=null),this.map.dragPan.enable(),t.boxSelecting=!1,t.canBoxSelect=!1,t.dragMoving=!1,t.canDragMove=!1},onStop:function(){l.enable(this)},onMouseMove:function(t){return this.stopExtendedInteractions(t)},onMouseOut:function(t){if(t.dragMoving)return this.fireUpdate()}};c.onTap=c.onClick=function(t,e){return i.noTarget(e)?this.clickAnywhere(t,e):i.isOfMetaType(u.meta.VERTEX)(e)?this.clickOnVertex(t,e):i.isFeature(e)?this.clickOnFeature(t,e):void 0},c.clickAnywhere=function(t){const e=this.getSelectedIds();e.length&&(this.clearSelectedFeatures(),e.forEach(t=>this.doRender(t))),l.enable(this),this.stopExtendedInteractions(t)},c.clickOnVertex=function(t,e){this.changeMode(u.modes.DIRECT_SELECT,{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,startPos:e.lngLat}),this.updateUIClasses({mouse:u.cursors.MOVE})},c.startOnActiveFeature=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),this.doRender(e.featureTarget.properties.id),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},c.clickOnFeature=function(t,e){l.disable(this),this.stopExtendedInteractions(t);const n=i.isShiftDown(e),r=this.getSelectedIds(),o=e.featureTarget.properties.id,a=this.isSelected(o);if(!n&&a&&this.getFeature(o).type!==u.geojsonTypes.POINT)return this.changeMode(u.modes.DIRECT_SELECT,{featureId:o});a&&n?(this.deselect(o),this.updateUIClasses({mouse:u.cursors.POINTER}),1===r.length&&l.enable(this)):!a&&n?(this.select(o),this.updateUIClasses({mouse:u.cursors.MOVE})):a||n||(r.forEach(t=>this.doRender(t)),this.setSelected(o),this.updateUIClasses({mouse:u.cursors.MOVE})),this.doRender(o)},c.onMouseDown=function(t,e){return i.isActiveFeature(e)?this.startOnActiveFeature(t,e):this.drawConfig.boxSelect&&i.isShiftMousedown(e)?this.startBoxSelect(t,e):void 0},c.startBoxSelect=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),t.boxSelectStartLocation=r(e.originalEvent,this.map.getContainer()),t.canBoxSelect=!0},c.onTouchStart=function(t,e){if(i.isActiveFeature(e))return this.startOnActiveFeature(t,e)},c.onDrag=function(t,e){return t.canDragMove?this.dragMove(t,e):this.drawConfig.boxSelect&&t.canBoxSelect?this.whileBoxSelect(t,e):void 0},c.whileBoxSelect=function(t,e){t.boxSelecting=!0,this.updateUIClasses({mouse:u.cursors.ADD}),t.boxSelectElement||(t.boxSelectElement=document.createElement("div"),t.boxSelectElement.classList.add(u.classes.BOX_SELECT),this.map.getContainer().appendChild(t.boxSelectElement));const n=r(e.originalEvent,this.map.getContainer()),i=Math.min(t.boxSelectStartLocation.x,n.x),o=Math.max(t.boxSelectStartLocation.x,n.x),a=Math.min(t.boxSelectStartLocation.y,n.y),l=Math.max(t.boxSelectStartLocation.y,n.y),s=`translate(${i}px, ${a}px)`;t.boxSelectElement.style.transform=s,t.boxSelectElement.style.WebkitTransform=s,t.boxSelectElement.style.width=o-i+"px",t.boxSelectElement.style.height=l-a+"px"},c.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();const n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};s(this.getSelected(),n),t.dragMoveLocation=e.lngLat},c.onMouseUp=function(t,e){if(t.dragMoving)this.fireUpdate();else if(t.boxSelecting){const n=[t.boxSelectStartLocation,r(e.originalEvent,this.map.getContainer())],i=this.featuresAt(null,n,"click"),o=this.getUniqueIds(i).filter(t=>!this.isSelected(t));o.length&&(this.select(o),o.forEach(t=>this.doRender(t)),this.updateUIClasses({mouse:u.cursors.MOVE}))}this.stopExtendedInteractions(t)},c.toDisplayFeatures=function(t,e,n){e.properties.active=this.isSelected(e.properties.id)?u.activeStates.ACTIVE:u.activeStates.INACTIVE,n(e),this.fireActionable(),e.properties.active===u.activeStates.ACTIVE&&e.geometry.type!==u.geojsonTypes.POINT&&o(e).forEach(n)},c.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},c.onCombineFeatures=function(){const t=this.getSelected();if(0===t.length||t.length<2)return;const e=[],n=[],i=t[0].type.replace("Multi","");for(let r=0;r<t.length;r++){const o=t[r];if(o.type.replace("Multi","")!==i)return;o.type.includes("Multi")?o.getCoordinates().forEach(t=>{e.push(t)}):e.push(o.getCoordinates()),n.push(o.toGeoJSON())}if(n.length>1){const t=this.newFeature({type:u.geojsonTypes.FEATURE,properties:n[0].properties,geometry:{type:"Multi"+i,coordinates:e}});this.addFeature(t),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([t.id]),this.map.fire(u.events.COMBINE_FEATURES,{createdFeatures:[t.toGeoJSON()],deletedFeatures:n})}this.fireActionable()},c.onUncombineFeatures=function(){const t=this.getSelected();if(0===t.length)return;const e=[],n=[];for(let i=0;i<t.length;i++){const r=t[i];this.isInstanceOf("MultiFeature",r)&&(r.getFeatures().forEach(t=>{this.addFeature(t),t.properties=r.properties,e.push(t.toGeoJSON()),this.select([t.id])}),this.deleteFeature(r.id,{silent:!0}),n.push(r.toGeoJSON()))}e.length>1&&this.map.fire(u.events.UNCOMBINE_FEATURES,{createdFeatures:e,deletedFeatures:n}),this.fireActionable()},t.exports=c},mhV4:function(t,e,n){var i=n("ZK94");function r(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e,n,r,o,l,s,u=0,c=t.length;if(c>2){for(s=0;s<c;s++)s===c-2?(r=c-2,o=c-1,l=0):s===c-1?(r=c-1,o=0,l=1):(r=s,o=s+1,l=s+2),e=t[r],n=t[o],u+=(a(t[l][0])-a(e[0]))*Math.sin(a(n[1]));u=u*i.RADIUS*i.RADIUS/2}return u}function a(t){return t*Math.PI/180}t.exports.geometry=function t(e){var n,i=0;switch(e.type){case"Polygon":return r(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=r(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}},t.exports.ring=o},muZk:function(t,e,n){const i=n("Oh0o"),r=n("Ek1X"),o=n("GHAK"),a=n("RXCC"),l=[o.meta.FEATURE,o.meta.MIDPOINT,o.meta.VERTEX];function s(t,e,n,o){if(null===n.map)return[];const s=t?r(t,o):e,u={};n.options.styles&&(u.layers=n.options.styles.map(t=>t.id));const c=n.map.queryRenderedFeatures(s,u).filter(t=>-1!==l.indexOf(t.properties.meta)),p=new a,h=[];return c.forEach(t=>{const e=t.properties.id;p.has(e)||(p.add(e),h.push(t))}),i(h)}t.exports={click:function(t,e,n){return s(t,e,n,n.options.clickBuffer)},touch:function(t,e,n){return s(t,e,n,n.options.touchBuffer)}}},n8Y1:function(t,e,n){const i=n("2j5T"),r=n("GHAK");t.exports=function(t,e){const n=i(t.map(t=>t.toGeoJSON()),e);t.forEach(t=>{const e=t.getCoordinates(),i=t=>{const e={lng:t[0]+n.lng,lat:t[1]+n.lat};return[e.lng,e.lat]},o=t=>t.map(t=>i(t)),a=t=>t.map(t=>o(t));let l;t.type===r.geojsonTypes.POINT?l=i(e):t.type===r.geojsonTypes.LINE_STRING||t.type===r.geojsonTypes.MULTI_POINT?l=e.map(i):t.type===r.geojsonTypes.POLYGON||t.type===r.geojsonTypes.MULTI_LINE_STRING?l=e.map(o):t.type===r.geojsonTypes.MULTI_POLYGON&&(l=e.map(a)),t.incomingCoords(l)})}},nXLm:function(t,e,n){const i=n("AGgr");t.exports=function(t,e,n={}){const r=null!=n.tolerance?n.tolerance:25,o=null!=n.interval?n.interval:250;t.point=t.point||e.point,t.time=t.time||e.time;return i(t.point,e.point)<r&&e.time-t.time<o}},ncV3:function(t,e,n){"use strict";var i=n("YI60"),r=n("2+Hy"),o=n("jLWS");function a(t){if(!t||!t.accessToken)throw new Error("Cannot create a client without an access token");i(t.accessToken),this.accessToken=t.accessToken,this.origin=t.origin||o.API_ORIGIN}a.prototype.createRequest=function(t){return new r(this,t)},t.exports=a},oGbY:function(t,e,n){"use strict";var i=n("cRm7"),r=n("73jG"),o=n("jLWS"),a=n("cryX"),l={};function s(t){var e=t.total,n=t.loaded;return{total:e,transferred:n,percent:100*n/e}}function u(t,e){return new Promise((function(n,i){e.onprogress=function(e){t.emitter.emit(o.EVENT_PROGRESS_DOWNLOAD,s(e))};var a=t.file;a&&(e.upload.onprogress=function(e){t.emitter.emit(o.EVENT_PROGRESS_UPLOAD,s(e))}),e.onerror=function(t){i(t)},e.onabort=function(){var e=new r({request:t,type:o.ERROR_REQUEST_ABORTED});i(e)},e.onload=function(){if(delete l[t.id],e.status<200||e.status>=400){var o=new r({request:t,body:e.response,statusCode:e.status});i(o)}else n(e)};var u=t.body;"string"==typeof u?e.send(u):u?e.send(JSON.stringify(u)):a?e.send(a):e.send(),l[t.id]=e})).then((function(e){return function(t,e){return new i(t,{body:e.response,headers:a(e.getAllResponseHeaders()),statusCode:e.status})}(t,e)}))}function c(t,e){var n=t.url(e),i=new window.XMLHttpRequest;return i.open(t.method,n),Object.keys(t.headers).forEach((function(e){i.setRequestHeader(e,t.headers[e])})),i}t.exports={browserAbort:function(t){var e=l[t.id];e&&(e.abort(),delete l[t.id])},sendRequestXhr:u,browserSend:function(t){return Promise.resolve().then((function(){var e=c(t,t.client.accessToken);return u(t,e)}))},createRequestXhr:c}},ohRi:function(t,e,n){var i=n("lJFB"),r=n("CI1V"),o=n("jzMX");t.exports=function(t){if(!t)return[];var e=r(i(t)),n=[];return e.features.forEach((function(t){t.geometry&&(n=n.concat(o(t.geometry.coordinates)))})),n}},"pit/":function(t,e,n){"use strict";var i=n("NkL+"),r=n("U6jy"),o={};function a(t){var e=Array.isArray(t);return function(n){var i,r=l(o.plainArray,n);if(r)return r;if(e&&n.length!==t.length)return"an array with "+t.length+" items";for(var a=0;a<n.length;a++)if(r=l((i=a,e?t[i]:t),n[a]))return[a].concat(r)}}function l(t,e){if(null!=e||t.hasOwnProperty("__required")){var n=t(e);return n?Array.isArray(n)?n:[n]:void 0}}function s(t,e){var n=t.length,i=t[n-1],o=t.slice(0,n-1);return 0===o.length&&(o=["value"]),e=r(e,{path:o}),"function"==typeof i?i(e):c(e,function(t){return"must be "+function(t){if(/^an? /.test(t))return t;if(/^[aeiou]/i.test(t))return"an "+t;if(/^[a-z]/i.test(t))return"a "+t;return t}(t)+"."}(i))}function u(t){return t.length<2?t[0]:2===t.length?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t.slice(-1)}function c(t,e){return(p(t.path)?"Item at position ":"")+(t.path.join(".")+" "+e)}function p(t){return"number"==typeof t[t.length-1]||"number"==typeof t[0]}o.assert=function(t,e){return e=e||{},function(n){var i=l(t,n);if(i){var r=s(i,e);throw e.apiName&&(r=e.apiName+": "+r),new Error(r)}}},o.shape=function(t){var e,n=(e=t,Object.keys(e||{}).map((function(t){return{key:t,value:e[t]}})));return function(t){var e,i=l(o.plainObject,t);if(i)return i;for(var r=[],a=0;a<n.length;a++)e=n[a].key,(i=l(n[a].value,t[e]))&&r.push([e].concat(i));return r.length<2?r[0]:function(t){r=r.map((function(e){return"- "+e[0]+": "+s(e,t).split("\n").join("\n  ")}));var e=t.path.join(".");return"The following properties"+("value"===e?"":" of "+e)+" have invalid values:\n  "+r.join("\n  ")}}},o.strictShape=function(t){var e=o.shape(t);return function(n){var i=e(n);if(i)return i;var r=Object.keys(n).reduce((function(e,n){return void 0===t[n]&&e.push(n),e}),[]);return 0!==r.length?function(){return"The following keys are invalid: "+r.join(", ")}:void 0}},o.arrayOf=function(t){return a(t)},o.tuple=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return a(t)},o.required=function(t){function e(e){return null==e?function(t){return c(t,p(t.path)?"cannot be undefined/null.":"is required.")}:t.apply(this,arguments)}return e.__required=!0,e},o.oneOfType=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(e){var n=t.map((function(t){return l(t,e)})).filter(Boolean);if(n.length===t.length)return n.every((function(t){return 1===t.length&&"string"==typeof t[0]}))?u(n.map((function(t){return t[0]}))):n.reduce((function(t,e){return e.length>t.length?e:t}))}},o.equal=function(t){return function(e){if(e!==t)return JSON.stringify(t)}},o.oneOf=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),e=t.map((function(t){return o.equal(t)}));return o.oneOfType.apply(this,e)},o.range=function(t){var e=t[0],n=t[1];return function(t){if(l(o.number,t)||t<e||t>n)return"number between "+e+" & "+n+" (inclusive)"}},o.any=function(){},o.boolean=function(t){if("boolean"!=typeof t)return"boolean"},o.number=function(t){if("number"!=typeof t)return"number"},o.plainArray=function(t){if(!Array.isArray(t))return"array"},o.plainObject=function(t){if(!i(t))return"object"},o.string=function(t){if("string"!=typeof t)return"string"},o.func=function(t){if("function"!=typeof t)return"function"},o.validate=l,o.processMessage=s,t.exports=o},qKyw:function(t,e,n){var i=n("f3+a"),r=n("stJQ");t.exports.hint=function(t,e){var n,o=[];if("object"==typeof t)n=t;else{if("string"!=typeof t)return[{message:"Expected string or object as input",line:0}];try{n=i.parse(t)}catch(l){var a=l.message.match(/line (\d+)/);return[{line:parseInt(a[1],10)-1,message:l.message,error:l}]}}return o=o.concat(r.hint(n,e))}},rGXs:function(t,e,n){const i=n("GHAK"),r=n("muZk"),o=n("EhmD"),a=n("2PSg"),l=n("4Qsb"),s=n("D9nX"),u=t.exports=function(t){this.map=t.map,this.drawConfig=JSON.parse(JSON.stringify(t.options||{})),this._ctx=t};u.prototype.setSelected=function(t){return this._ctx.store.setSelected(t)},u.prototype.setSelectedCoordinates=function(t){this._ctx.store.setSelectedCoordinates(t),t.reduce((t,e)=>(void 0===t[e.feature_id]&&(t[e.feature_id]=!0,this._ctx.store.get(e.feature_id).changed()),t),{})},u.prototype.getSelected=function(){return this._ctx.store.getSelected()},u.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},u.prototype.isSelected=function(t){return this._ctx.store.isSelected(t)},u.prototype.getFeature=function(t){return this._ctx.store.get(t)},u.prototype.select=function(t){return this._ctx.store.select(t)},u.prototype.deselect=function(t){return this._ctx.store.deselect(t)},u.prototype.deleteFeature=function(t,e={}){return this._ctx.store.delete(t,e)},u.prototype.addFeature=function(t){return this._ctx.store.add(t)},u.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},u.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},u.prototype.setActionableState=function(t={}){const e={trash:t.trash||!1,combineFeatures:t.combineFeatures||!1,uncombineFeatures:t.uncombineFeatures||!1};return this._ctx.events.actionable(e)},u.prototype.changeMode=function(t,e={},n={}){return this._ctx.events.changeMode(t,e,n)},u.prototype.updateUIClasses=function(t){return this._ctx.ui.queueMapClasses(t)},u.prototype.activateUIButton=function(t){return this._ctx.ui.setActiveButton(t)},u.prototype.featuresAt=function(t,e,n="click"){if("click"!==n&&"touch"!==n)throw new Error("invalid buffer type");return r[n](t,e,this._ctx)},u.prototype.newFeature=function(t){const e=t.geometry.type;return e===i.geojsonTypes.POINT?new o(this._ctx,t):e===i.geojsonTypes.LINE_STRING?new a(this._ctx,t):e===i.geojsonTypes.POLYGON?new l(this._ctx,t):new s(this._ctx,t)},u.prototype.isInstanceOf=function(t,e){if(t===i.geojsonTypes.POINT)return e instanceof o;if(t===i.geojsonTypes.LINE_STRING)return e instanceof a;if(t===i.geojsonTypes.POLYGON)return e instanceof l;if("MultiFeature"===t)return e instanceof s;throw new Error("Unknown feature class: "+t)},u.prototype.doRender=function(t){return this._ctx.store.featureChanged(t)}},rmaQ:function(t,e,n){const i=n("6JyC"),r=n("AojJ"),o=n("muZk"),a=n("Ki6+"),l=n("nXLm"),s=n("GHAK"),u=n("LXM9");t.exports=function(t){const e=Object.keys(t.options.modes).reduce((e,n)=>(e[n]=u(t.options.modes[n]),e),{});let n={},c={};const p={};let h=null,d=null;p.drag=function(e,n){n({point:e.point,time:(new Date).getTime()})?(t.ui.queueMapClasses({mouse:s.cursors.DRAG}),d.drag(e)):e.originalEvent.stopPropagation()},p.mousedrag=function(t){p.drag(t,t=>!a(n,t))},p.touchdrag=function(t){p.drag(t,t=>!l(c,t))},p.mousemove=function(e){if(1===(void 0!==e.originalEvent.buttons?e.originalEvent.buttons:e.originalEvent.which))return p.mousedrag(e);const n=r(e,t);e.featureTarget=n,d.mousemove(e)},p.mousedown=function(e){n={time:(new Date).getTime(),point:e.point};const i=r(e,t);e.featureTarget=i,d.mousedown(e)},p.mouseup=function(e){const i=r(e,t);e.featureTarget=i,a(n,{point:e.point,time:(new Date).getTime()})?d.click(e):d.mouseup(e)},p.mouseout=function(t){d.mouseout(t)},p.touchstart=function(e){if(e.originalEvent.preventDefault(),!t.options.touchEnabled)return;c={time:(new Date).getTime(),point:e.point};const n=o.touch(e,null,t)[0];e.featureTarget=n,d.touchstart(e)},p.touchmove=function(e){if(e.originalEvent.preventDefault(),t.options.touchEnabled)return d.touchmove(e),p.touchdrag(e)},p.touchend=function(e){if(e.originalEvent.preventDefault(),!t.options.touchEnabled)return;const n=o.touch(e,null,t)[0];e.featureTarget=n,l(c,{time:(new Date).getTime(),point:e.point})?d.tap(e):d.touchend(e)};const f=t=>!(8===t||46===t||t>=48&&t<=57);function m(n,r,o={}){d.stop();const a=e[n];if(void 0===a)throw new Error(n+" is not valid");h=n;const l=a(t,r);d=i(l,t),o.silent||t.map.fire(s.events.MODE_CHANGE,{mode:n}),t.store.setDirty(),t.store.render()}p.keydown=function(e){"mapboxgl-canvas"===(e.srcElement||e.target).classList[0]&&(8!==e.keyCode&&46!==e.keyCode||!t.options.controls.trash?f(e.keyCode)?d.keydown(e):49===e.keyCode&&t.options.controls.point?m(s.modes.DRAW_POINT):50===e.keyCode&&t.options.controls.line_string?m(s.modes.DRAW_LINE_STRING):51===e.keyCode&&t.options.controls.polygon&&m(s.modes.DRAW_POLYGON):(e.preventDefault(),d.trash()))},p.keyup=function(t){f(t.keyCode)&&d.keyup(t)},p.zoomend=function(){t.store.changeZoom()},p.data=function(e){if("style"===e.dataType){const{setup:e,map:n,options:i,store:r}=t;i.styles.some(t=>n.getLayer(t.id))||(e.addLayers(),r.setDirty(),r.render())}};const g={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){h=t.options.defaultMode,d=i(e[h](t),t)},changeMode:m,actionable:function(e){let n=!1;Object.keys(e).forEach(t=>{if(void 0===g[t])throw new Error("Invalid action type");g[t]!==e[t]&&(n=!0),g[t]=e[t]}),n&&t.map.fire(s.events.ACTIONABLE,{actions:g})},currentModeName:function(){return h},currentModeRender:function(t,e){return d.render(t,e)},fire:function(t,e){p[t]&&p[t](e)},addEventListeners:function(){t.map.on("mousemove",p.mousemove),t.map.on("mousedown",p.mousedown),t.map.on("mouseup",p.mouseup),t.map.on("data",p.data),t.map.on("touchmove",p.touchmove),t.map.on("touchstart",p.touchstart),t.map.on("touchend",p.touchend),t.container.addEventListener("mouseout",p.mouseout),t.options.keybindings&&(t.container.addEventListener("keydown",p.keydown),t.container.addEventListener("keyup",p.keyup))},removeEventListeners:function(){t.map.off("mousemove",p.mousemove),t.map.off("mousedown",p.mousedown),t.map.off("mouseup",p.mouseup),t.map.off("data",p.data),t.map.off("touchmove",p.touchmove),t.map.off("touchstart",p.touchstart),t.map.off("touchend",p.touchend),t.container.removeEventListener("mouseout",p.mouseout),t.options.keybindings&&(t.container.removeEventListener("keydown",p.keydown),t.container.removeEventListener("keyup",p.keyup))},trash:function(t){d.trash(t)},combineFeatures:function(){d.combineFeatures()},uncombineFeatures:function(){d.uncombineFeatures()},getMode:function(){return h}}}},rtvZ:function(t,e,n){const i=n("hyT3");t.exports=function(t){const{properties:e,geometry:n}=t;if(!e.user_isCircle)return null;const r=[],o=n.coordinates[0].slice(0,-1);for(let a=0;a<o.length;a+=Math.round(o.length/4))r.push(i(e.id,o[a],"0."+a,!1));return r}},stJQ:function(t,e,n){var i=n("tWm4");t.exports.hint=function(t,e){var n=[],r=0;function o(t){if(e&&!1===e.noDuplicateMembers||!t.__duplicateProperties__||n.push({message:"An object contained duplicate members, making parsing ambigous: "+t.__duplicateProperties__.join(", "),line:t.__line__}),!l(t,"type","string"))if(d[t.type])t&&d[t.type](t);else{var i=f[t.type.toLowerCase()];void 0!==i?n.push({message:"Expected "+i+" but got "+t.type+" (case sensitive)",line:t.__line__}):n.push({message:"The type "+t.type+" is unknown",line:t.__line__})}}function a(t,e){return t.every((function(t){return null!==t&&typeof t===e}))}function l(t,e,i){if(void 0===t[e])return n.push({message:'"'+e+'" member required',line:t.__line__});if("array"===i){if(!Array.isArray(t[e]))return n.push({message:'"'+e+'" member should be an array, but is an '+typeof t[e]+" instead",line:t.__line__})}else{if("object"===i&&t[e]&&t[e].constructor!==Object)return n.push({message:'"'+e+'" member should be '+i+", but is an "+t[e].constructor.name+" instead",line:t.__line__});if(i&&typeof t[e]!==i)return n.push({message:'"'+e+'" member should be '+i+", but is an "+typeof t[e]+" instead",line:t.__line__})}}function s(t,i){if(!Array.isArray(t))return n.push({message:"position should be an array, is a "+typeof t+" instead",line:t.__line__||i});if(t.length<2)return n.push({message:"position must have 2 or more elements",line:t.__line__||i});if(t.length>3)return n.push({message:"position should not have more than 3 elements",level:"message",line:t.__line__||i});if(!a(t,"number"))return n.push({message:"each element in a position must be a number",line:t.__line__||i});if(e&&e.precisionWarning){if(10===r)return r+=1,n.push({message:"truncated warnings: we've encountered coordinate precision warning 10 times, no more warnings will be reported",level:"message",line:t.__line__||i});r<10&&t.forEach((function(e){var o=0,a=String(e).split(".")[1];if(void 0!==a&&(o=a.length),o>6)return r+=1,n.push({message:"precision of coordinates should be reduced",level:"message",line:t.__line__||i})}))}}function u(t,e,i,r){if(void 0===r&&void 0!==t.__line__&&(r=t.__line__),0===i)return s(t,r);if(1===i&&e)if("LinearRing"===e){if(!Array.isArray(t[t.length-1]))return n.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:r}),!0;if(t.length<4&&n.push({message:"a LinearRing of coordinates needs to have four or more positions",line:r}),t.length&&(t[t.length-1].length!==t[0].length||!t[t.length-1].every((function(e,n){return t[0][n]===e}))))return n.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:r}),!0}else if("Line"===e&&t.length<2)return n.push({message:"a line needs to have two or more coordinates to be valid",line:r});if(Array.isArray(t))return t.map((function(t){return u(t,e,i-1,t.__line__||r)})).some((function(t){return t}));n.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:r})}function c(t){if(t.crs){"object"==typeof t.crs&&t.crs.properties&&"urn:ogc:def:crs:OGC:1.3:CRS84"===t.crs.properties.name?n.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:t.__line__}):n.push({message:"old-style crs member is not recommended",line:t.__line__})}}function p(t){if(t.bbox)return Array.isArray(t.bbox)?(a(t.bbox,"number")||n.push({message:"each element in a bbox member must be a number",line:t.bbox.__line__}),4!==t.bbox.length&&6!==t.bbox.length&&n.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:t.bbox.__line__}),n.length):void n.push({message:"bbox member must be an array of numbers, but is a "+typeof t.bbox,line:t.__line__})}function h(t){c(t),p(t),void 0!==t.id&&"string"!=typeof t.id&&"number"!=typeof t.id&&n.push({message:'Feature "id" member must have a string or number value',line:t.__line__}),void 0!==t.features&&n.push({message:'Feature object cannot contain a "features" member',line:t.__line__}),void 0!==t.coordinates&&n.push({message:'Feature object cannot contain a "coordinates" member',line:t.__line__}),"Feature"!==t.type&&n.push({message:"GeoJSON features must have a type=feature member",line:t.__line__}),l(t,"properties","object"),l(t,"geometry","object")||t.geometry&&o(t.geometry)}var d={Point:function(t){var e;c(t),p(t),void 0!==(e=t).properties&&n.push({message:'geometry object cannot contain a "properties" member',line:e.__line__}),void 0!==e.geometry&&n.push({message:'geometry object cannot contain a "geometry" member',line:e.__line__}),void 0!==e.features&&n.push({message:'geometry object cannot contain a "features" member',line:e.__line__}),l(t,"coordinates","array")||s(t.coordinates)},Feature:h,MultiPoint:function(t){c(t),p(t),l(t,"coordinates","array")||u(t.coordinates,"",1)},LineString:function(t){c(t),p(t),l(t,"coordinates","array")||u(t.coordinates,"Line",1)},MultiLineString:function(t){c(t),p(t),l(t,"coordinates","array")||u(t.coordinates,"Line",2)},FeatureCollection:function(t){if(c(t),p(t),void 0!==t.properties&&n.push({message:'FeatureCollection object cannot contain a "properties" member',line:t.__line__}),void 0!==t.coordinates&&n.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:t.__line__}),!l(t,"features","array")){if(!a(t.features,"object"))return n.push({message:"Every feature must be an object",line:t.__line__});t.features.forEach(h)}},GeometryCollection:function(t){c(t),p(t),l(t,"geometries","array")||(a(t.geometries,"object")||n.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:t.__line__}),1===t.geometries.length&&n.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:t.geometries.__line__}),t.geometries.forEach((function(e){e&&("GeometryCollection"===e.type&&n.push({message:"GeometryCollection should avoid nested geometry collections",line:t.geometries.__line__}),o(e))})))},Polygon:function(t){c(t),p(t),l(t,"coordinates","array")||u(t.coordinates,"LinearRing",2)||i(t,n)},MultiPolygon:function(t){c(t),p(t),l(t,"coordinates","array")||u(t.coordinates,"LinearRing",3)||i(t,n)}},f=Object.keys(d).reduce((function(t,e){return t[e.toLowerCase()]=e,t}),{});return"object"!=typeof t||null==t?(n.push({message:"The root of a GeoJSON object must be an object.",line:0}),n):(o(t),n.forEach((function(t){({}).hasOwnProperty.call(t,"line")&&void 0===t.line&&delete t.line})),n)}},tWm4:function(t,e){function n(t){return t*Math.PI/180}function i(t){var e=0;if(t.length>2)for(var i,r,o=0;o<t.length-1;o++)i=t[o],e+=n((r=t[o+1])[0]-i[0])*(2+Math.sin(n(i[1]))+Math.sin(n(r[1])));return e>=0}function r(t){if(t&&t.length>0){if(i(t[0]))return!1;if(!t.slice(1,t.length).every(i))return!1}return!0}t.exports=function(t,e){(function(t){return"Polygon"===t.type?r(t.coordinates):"MultiPolygon"===t.type?t.coordinates.every(r):void 0})(t)||e.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:t.__line__})}},tjOa:function(t,e,n){const i=n("FxjX"),r=n("GRlr"),o=n("uI0s"),a=n("GHAK"),l=n("hyT3"),s={onSetup:function(t){const e=(t=t||{}).featureId;let n,i,r="forward";if(e){if(n=this.getFeature(e),!n)throw new Error("Could not find a feature with the provided featureId");let o=t.from;if(o&&"Feature"===o.type&&o.geometry&&"Point"===o.geometry.type&&(o=o.geometry),o&&"Point"===o.type&&o.coordinates&&2===o.coordinates.length&&(o=o.coordinates),!o||!Array.isArray(o))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=n.coordinates.length-1;if(n.coordinates[a][0]===o[0]&&n.coordinates[a][1]===o[1])i=a+1,n.addCoordinate(i,...n.coordinates[a]);else{if(n.coordinates[0][0]!==o[0]||n.coordinates[0][1]!==o[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");r="backwards",i=0,n.addCoordinate(i,...n.coordinates[0])}}else n=this.newFeature({type:a.geojsonTypes.FEATURE,properties:{},geometry:{type:a.geojsonTypes.LINE_STRING,coordinates:[]}}),i=0,this.addFeature(n);return this.clearSelectedFeatures(),o.disable(this),this.updateUIClasses({mouse:a.cursors.ADD}),this.activateUIButton(a.types.LINE),this.setActionableState({trash:!0}),{line:n,currentVertexPosition:i,direction:r}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&r(e,t.line.coordinates[t.currentVertexPosition-1])||"backwards"===t.direction&&r(e,t.line.coordinates[t.currentVertexPosition+1]))return this.changeMode(a.modes.SIMPLE_SELECT,{featureIds:[t.line.id]});this.updateUIClasses({mouse:a.cursors.ADD}),t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),"forward"===t.direction?(t.currentVertexPosition++,t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)):t.line.addCoordinate(0,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(a.modes.SIMPLE_SELECT,{featureIds:[t.line.id]})},onMouseMove:function(t,e){t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),i.isVertex(e)&&this.updateUIClasses({mouse:a.cursors.POINTER})}};s.onTap=s.onClick=function(t,e){if(i.isVertex(e))return this.clickOnVertex(t,e);this.clickAnywhere(t,e)},s.onKeyUp=function(t,e){i.isEnterKey(e)?this.changeMode(a.modes.SIMPLE_SELECT,{featureIds:[t.line.id]}):i.isEscapeKey(e)&&(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(a.modes.SIMPLE_SELECT))},s.onStop=function(t){o.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.line.id)&&(t.line.removeCoordinate(""+t.currentVertexPosition),t.line.isValid()?this.map.fire(a.events.CREATE,{features:[t.line.toGeoJSON()]}):(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(a.modes.SIMPLE_SELECT,{},{silent:!0})))},s.onTrash=function(t){this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(a.modes.SIMPLE_SELECT)},s.toDisplayFeatures=function(t,e,n){const i=e.properties.id===t.line.id;if(e.properties.active=i?a.activeStates.ACTIVE:a.activeStates.INACTIVE,!i)return n(e);e.geometry.coordinates.length<2||(e.properties.meta=a.meta.FEATURE,n(l(t.line.id,e.geometry.coordinates["forward"===t.direction?e.geometry.coordinates.length-2:1],""+("forward"===t.direction?e.geometry.coordinates.length-2:1),!1)),n(e))},t.exports=s},uI0s:function(t,e){t.exports={enable(t){setTimeout(()=>{t.map&&t.map.doubleClickZoom&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()},0)},disable(t){setTimeout(()=>{t.map&&t.map.doubleClickZoom&&t.map.doubleClickZoom.disable()},0)}}},uhBA:function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r="~";function o(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function l(t,e,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var l=new a(n,i||t,o),s=r?r+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],l]:t._events[s].push(l):(t._events[s]=l,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,i,o,a){var l=r?r+t:t;if(!this._events[l])return!1;var s,u,c=this._events[l],p=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),p){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,i),!0;case 5:return c.fn.call(c.context,e,n,i,o),!0;case 6:return c.fn.call(c.context,e,n,i,o,a),!0}for(u=1,s=new Array(p-1);u<p;u++)s[u-1]=arguments[u];c.fn.apply(c.context,s)}else{var h,d=c.length;for(u=0;u<d;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),p){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,i);break;default:if(!s)for(h=1,s=new Array(p-1);h<p;h++)s[h-1]=arguments[h];c[u].fn.apply(c[u].context,s)}}return!0},u.prototype.on=function(t,e,n){return l(this,t,e,n,!1)},u.prototype.once=function(t,e,n){return l(this,t,e,n,!0)},u.prototype.removeListener=function(t,e,n,i){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var l=0,u=[],c=a.length;l<c;l++)(a[l].fn!==e||i&&!a[l].once||n&&a[l].context!==n)&&u.push(a[l]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&s(this,e)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u},uzB3:function(t,e,n){const i=n("GHAK");t.exports=function(){const t=this;if(!(t.ctx.map&&void 0!==t.ctx.map.getSource(i.sources.HOT)))return s();const e=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:e});let n=[],r=[];t.isDirty?r=t.getAllIds():(n=t.getChangedIds().filter(e=>void 0!==t.get(e)),r=t.sources.hot.filter(e=>e.properties.id&&-1===n.indexOf(e.properties.id)&&void 0!==t.get(e.properties.id)).map(t=>t.properties.id)),t.sources.hot=[];const o=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter(t=>{const e=t.properties.id||t.properties.parent;return-1===n.indexOf(e)});const a=o!==t.sources.cold.length||r.length>0;function l(n,i){const r=t.get(n).internal(e);t.ctx.events.currentModeRender(r,e=>{t.sources[i].push(e)})}if(n.forEach(t=>l(t,"hot")),r.forEach(t=>l(t,"cold")),a&&t.ctx.map.getSource(i.sources.COLD).setData({type:i.geojsonTypes.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(i.sources.HOT).setData({type:i.geojsonTypes.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(i.events.SELECTION_CHANGE,{features:t.getSelected().map(t=>t.toGeoJSON()),points:t.getSelectedCoordinates().map(t=>({type:i.geojsonTypes.FEATURE,properties:{},geometry:{type:i.geojsonTypes.POINT,coordinates:t.coordinates}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){const e=t._deletedFeaturesToEmit.map(t=>t.toGeoJSON());t._deletedFeaturesToEmit=[],t.ctx.map.fire(i.events.DELETE,{features:e})}function s(){t.isDirty=!1,t.clearChangedIds()}s(),t.ctx.map.fire(i.events.RENDER,{})}},vMx6:function(t,e,n){t.exports={simple_select:n("mcvi"),direct_select:n("z4Bq"),draw_point:n("7VZy"),draw_polygon:n("6C0F"),draw_line_string:n("tjOa")}},xnQO:function(t,e,n){"use strict";function i(t,e){this.x=t,this.y=e}t.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.x+n*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},xykm:function(t,e,n){const i=n("bRaG"),r=n("QoH1"),o=n("RXCC"),a=n("uzB3"),l=n("GHAK").interactions,s=t.exports=function(t){this._features={},this._featureIds=new o,this._selectedFeatureIds=new o,this._selectedCoordinates=[],this._changedFeatureIds=new o,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=t,this.sources={hot:[],cold:[]},this.render=i(a,16,this),this.isDirty=!1};function u(t){const e=this._selectedCoordinates.filter(t=>this._selectedFeatureIds.has(t.feature_id));this._selectedCoordinates.length===e.length||t.silent||(this._emitSelectionChange=!0),this._selectedCoordinates=e}s.prototype.createRenderBatch=function(){const t=this.render;let e=0;return this.render=function(){e++},()=>{this.render=t,e>0&&this.render()}},s.prototype.setDirty=function(){return this.isDirty=!0,this},s.prototype.featureChanged=function(t){return this._changedFeatureIds.add(t),this},s.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},s.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},s.prototype.getAllIds=function(){return this._featureIds.values()},s.prototype.add=function(t){return this.featureChanged(t.id),this._features[t.id]=t,this._featureIds.add(t.id),this},s.prototype.delete=function(t,e={}){return r(t).forEach(t=>{this._featureIds.has(t)&&(this._featureIds.delete(t),this._selectedFeatureIds.delete(t),e.silent||-1===this._deletedFeaturesToEmit.indexOf(this._features[t])&&this._deletedFeaturesToEmit.push(this._features[t]),delete this._features[t],this.isDirty=!0)}),u.call(this,e),this},s.prototype.get=function(t){return this._features[t]},s.prototype.getAll=function(){return Object.keys(this._features).map(t=>this._features[t])},s.prototype.select=function(t,e={}){return r(t).forEach(t=>{this._selectedFeatureIds.has(t)||(this._selectedFeatureIds.add(t),this._changedFeatureIds.add(t),e.silent||(this._emitSelectionChange=!0))}),this},s.prototype.deselect=function(t,e={}){return r(t).forEach(t=>{this._selectedFeatureIds.has(t)&&(this._selectedFeatureIds.delete(t),this._changedFeatureIds.add(t),e.silent||(this._emitSelectionChange=!0))}),u.call(this,e),this},s.prototype.clearSelected=function(t={}){return this.deselect(this._selectedFeatureIds.values(),{silent:t.silent}),this},s.prototype.setSelected=function(t,e={}){return t=r(t),this.deselect(this._selectedFeatureIds.values().filter(e=>-1===t.indexOf(e)),{silent:e.silent}),this.select(t.filter(t=>!this._selectedFeatureIds.has(t)),{silent:e.silent}),this},s.prototype.setSelectedCoordinates=function(t){return this._selectedCoordinates=t,this._emitSelectionChange=!0,this},s.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},s.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},s.prototype.getSelected=function(){return this._selectedFeatureIds.values().map(t=>this.get(t))},s.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))},s.prototype.isSelected=function(t){return this._selectedFeatureIds.has(t)},s.prototype.setFeatureProperty=function(t,e,n){this.get(t).setProperty(e,n),this.featureChanged(t)},s.prototype.storeMapConfig=function(){l.forEach(t=>{this.ctx.map[t]&&(this._mapInitialConfig[t]=this.ctx.map[t].isEnabled())})},s.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(t=>{this._mapInitialConfig[t]?this.ctx.map[t].enable():this.ctx.map[t].disable()})},s.prototype.getInitialConfigValue=function(t){return void 0===this._mapInitialConfig[t]||this._mapInitialConfig[t]}},yDy9:function(t,e,n){const i=n("U6jy"),r=n("GHAK"),o={defaultMode:r.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:n("NW+h"),modes:n("vMx6"),controls:{},userProperties:!1},a={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},l={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function s(t,e){return t.map(t=>t.source?t:i(t,{id:`${t.id}.${e}`,source:"hot"===e?r.sources.HOT:r.sources.COLD}))}t.exports=function(t={}){let e=i(t);return t.controls||(e.controls={}),!1===t.displayControlsDefault?e.controls=i(l,t.controls):e.controls=i(a,t.controls),e=i(o,e),e.styles=s(e.styles,"cold").concat(s(e.styles,"hot")),e}},yugo:function(t,e,n){t.exports=function(){"use strict";var t=function(t,e){var n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},i={on:function(t,e,i){if(void 0===n[t])throw new Error("Invalid event type: "+t);n[t].push({selector:e,fn:i})},render:function(t){e.store.featureChanged(t)}},r=function(t,r){for(var o=n[t],a=o.length;a--;){var l=o[a];if(l.selector(r)){l.fn.call(i,r)||e.store.render(),e.ui.updateMapClasses();break}}};return t.start.call(i),{render:t.render,stop:function(){t.stop&&t.stop()},trash:function(){t.trash&&(t.trash(),e.store.render())},combineFeatures:function(){t.combineFeatures&&t.combineFeatures()},uncombineFeatures:function(){t.uncombineFeatures&&t.uncombineFeatures()},drag:function(t){r("drag",t)},click:function(t){r("click",t)},mousemove:function(t){r("mousemove",t)},mousedown:function(t){r("mousedown",t)},mouseup:function(t){r("mouseup",t)},mouseout:function(t){r("mouseout",t)},keydown:function(t){r("keydown",t)},keyup:function(t){r("keyup",t)},touchstart:function(t){r("touchstart",t)},touchmove:function(t){r("touchmove",t)},touchend:function(t){r("touchend",t)},tap:function(t){r("tap",t)}}};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var n={},i={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function r(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e,n,r,o,l,s,u=0,c=t.length;if(c>2){for(s=0;s<c;s++)s===c-2?(r=c-2,o=c-1,l=0):s===c-1?(r=c-1,o=0,l=1):(r=s,o=s+1,l=s+2),e=t[r],n=t[o],u+=(a(t[l][0])-a(e[0]))*Math.sin(a(n[1]));u=u*i.RADIUS*i.RADIUS/2}return u}function a(t){return t*Math.PI/180}n.geometry=function t(e){var n,i=0;switch(e.type){case"Polygon":return r(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=r(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}},n.ring=o;var l={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},s={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},u={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},c={POLYGON:"polygon",LINE:"line_string",POINT:"point"},p={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},h={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},d={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},f={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},m={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},g={ACTIVE:"true",INACTIVE:"false"},v=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],y=Object.freeze({__proto__:null,classes:l,sources:s,cursors:u,types:c,geojsonTypes:p,modes:h,events:d,updateActions:f,meta:m,activeStates:g,interactions:v,LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),_={Point:0,LineString:1,MultiLineString:1,Polygon:2};function b(t,e){var n=_[t.geometry.type]-_[e.geometry.type];return 0===n&&t.geometry.type===p.POLYGON?t.area-e.area:n}function x(t){return t.map((function(t){return t.geometry.type===p.POLYGON&&(t.area=n.geometry({type:p.FEATURE,property:{},geometry:t.geometry})),t})).sort(b).map((function(t){return delete t.area,t}))}function w(t,e){return void 0===e&&(e=0),[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]}function C(t){if(this._items={},this._nums={},this._length=t?t.length:0,t)for(var e=0,n=t.length;e<n;e++)this.add(t[e]),void 0!==t[e]&&("string"==typeof t[e]?this._items[t[e]]=e:this._nums[t[e]]=e)}C.prototype.add=function(t){return this.has(t)||(this._length++,"string"==typeof t?this._items[t]=this._length:this._nums[t]=this._length),this},C.prototype.delete=function(t){return!1===this.has(t)||(this._length--,delete this._items[t],delete this._nums[t]),this},C.prototype.has=function(t){return!("string"!=typeof t&&"number"!=typeof t||void 0===this._items[t]&&void 0===this._nums[t])},C.prototype.values=function(){var t=this,e=[];return Object.keys(this._items).forEach((function(n){e.push({k:n,v:t._items[n]})})),Object.keys(this._nums).forEach((function(n){e.push({k:JSON.parse(n),v:t._nums[n]})})),e.sort((function(t,e){return t.v-e.v})).map((function(t){return t.k}))},C.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var E=[m.FEATURE,m.MIDPOINT,m.VERTEX],S={click:function(t,e,n){return T(t,e,n,n.options.clickBuffer)},touch:function(t,e,n){return T(t,e,n,n.options.touchBuffer)}};function T(t,e,n,i){if(null===n.map)return[];var r=t?w(t,i):e,o={};n.options.styles&&(o.layers=n.options.styles.map((function(t){return t.id})));var a=n.map.queryRenderedFeatures(r,o).filter((function(t){return-1!==E.indexOf(t.properties.meta)})),l=new C,s=[];return a.forEach((function(t){var e=t.properties.id;l.has(e)||(l.add(e),s.push(t))})),x(s)}function I(t,e){var n=S.click(t,null,e),i={mouse:u.NONE};return n[0]&&(i.mouse=n[0].properties.active===g.ACTIVE?u.MOVE:u.POINTER,i.feature=n[0].properties.meta),-1!==e.events.currentModeName().indexOf("draw")&&(i.mouse=u.ADD),e.ui.queueMapClasses(i),e.ui.updateMapClasses(),n[0]}function P(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}function A(t,e,n){void 0===n&&(n={});var i=null!=n.fineTolerance?n.fineTolerance:4,r=null!=n.grossTolerance?n.grossTolerance:12,o=null!=n.interval?n.interval:500;t.point=t.point||e.point,t.time=t.time||e.time;var a=P(t.point,e.point);return a<i||a<r&&e.time-t.time<o}function M(t,e,n){void 0===n&&(n={});var i=null!=n.tolerance?n.tolerance:25,r=null!=n.interval?n.interval:250;return t.point=t.point||e.point,t.time=t.time||e.time,P(t.point,e.point)<i&&e.time-t.time<r}var k={exports:{}},D=k.exports=function(t,e){if(e||(e=16),void 0===t&&(t=128),t<=0)return"0";for(var n=Math.log(Math.pow(2,t))/Math.log(e),i=2;n===1/0;i*=2)n=Math.log(Math.pow(2,t/i))/Math.log(e)*i;var r=n-Math.floor(n),o="";for(i=0;i<Math.floor(n);i++)o=Math.floor(Math.random()*e).toString(e)+o;if(r){var a=Math.pow(e,r);o=Math.floor(Math.random()*a).toString(e)+o}var l=parseInt(o,e);return l!==1/0&&l>=Math.pow(2,t)?D(t,e):o};D.rack=function(t,e,n){var i=function(i){var o=0;do{if(o++>10){if(!n)throw new Error("too many ID collisions, use more bits");t+=n}var a=D(t,e)}while(Object.hasOwnProperty.call(r,a));return r[a]=i,a},r=i.hats={};return i.get=function(t){return i.hats[t]},i.set=function(t,e){return i.hats[t]=e,i},i.bits=t||128,i.base=e||16,i};var L=e(k.exports),O=function(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||L(),this.type=e.geometry.type};O.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},O.prototype.incomingCoords=function(t){this.setCoordinates(t)},O.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},O.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},O.prototype.setProperty=function(t,e){this.properties[t]=e},O.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:p.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},O.prototype.internal=function(t){var e={id:this.id,meta:m.FEATURE,"meta:type":this.type,active:g.INACTIVE,mode:t};if(this.ctx.options.userProperties)for(var n in this.properties)e["user_"+n]=this.properties[n];return{type:p.FEATURE,properties:e,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var R=function(t,e){O.call(this,t,e)};(R.prototype=Object.create(O.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},R.prototype.updateCoordinate=function(t,e,n){this.coordinates=3===arguments.length?[e,n]:[t,e],this.changed()},R.prototype.getCoordinate=function(){return this.getCoordinates()};var z=function(t,e){O.call(this,t,e)};(z.prototype=Object.create(O.prototype)).isValid=function(){return this.coordinates.length>1},z.prototype.addCoordinate=function(t,e,n){this.changed();var i=parseInt(t,10);this.coordinates.splice(i,0,[e,n])},z.prototype.getCoordinate=function(t){var e=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[e]))},z.prototype.removeCoordinate=function(t){this.changed(),this.coordinates.splice(parseInt(t,10),1)},z.prototype.updateCoordinate=function(t,e,n){var i=parseInt(t,10);this.coordinates[i]=[e,n],this.changed()};var F=function(t,e){O.call(this,t,e),this.coordinates=this.coordinates.map((function(t){return t.slice(0,-1)}))};(F.prototype=Object.create(O.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every((function(t){return t.length>2}))},F.prototype.incomingCoords=function(t){this.coordinates=t.map((function(t){return t.slice(0,-1)})),this.changed()},F.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},F.prototype.addCoordinate=function(t,e,n){this.changed();var i=t.split(".").map((function(t){return parseInt(t,10)}));this.coordinates[i[0]].splice(i[1],0,[e,n])},F.prototype.removeCoordinate=function(t){this.changed();var e=t.split(".").map((function(t){return parseInt(t,10)})),n=this.coordinates[e[0]];n&&(n.splice(e[1],1),n.length<3&&this.coordinates.splice(e[0],1))},F.prototype.getCoordinate=function(t){var e=t.split(".").map((function(t){return parseInt(t,10)})),n=this.coordinates[e[0]];return JSON.parse(JSON.stringify(n[e[1]]))},F.prototype.getCoordinates=function(){return this.coordinates.map((function(t){return t.concat([t[0]])}))},F.prototype.updateCoordinate=function(t,e,n){this.changed();var i=t.split("."),r=parseInt(i[0],10),o=parseInt(i[1],10);void 0===this.coordinates[r]&&(this.coordinates[r]=[]),this.coordinates[r][o]=[e,n]};var B={MultiPoint:R,MultiLineString:z,MultiPolygon:F},N=function(t,e,n,i,r){var o=n.split("."),a=parseInt(o[0],10),l=o[1]?o.slice(1).join("."):null;return t[a][e](l,i,r)},U=function(t,e){if(O.call(this,t,e),delete this.coordinates,this.model=B[e.geometry.type],void 0===this.model)throw new TypeError(e.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(e.geometry.coordinates)};function j(t){this.map=t.map,this.drawConfig=JSON.parse(JSON.stringify(t.options||{})),this._ctx=t}(U.prototype=Object.create(O.prototype))._coordinatesToFeatures=function(t){var e=this,n=this.model.bind(this);return t.map((function(t){return new n(e.ctx,{id:L(),type:p.FEATURE,properties:{},geometry:{coordinates:t,type:e.type.replace("Multi","")}})}))},U.prototype.isValid=function(){return this.features.every((function(t){return t.isValid()}))},U.prototype.setCoordinates=function(t){this.features=this._coordinatesToFeatures(t),this.changed()},U.prototype.getCoordinate=function(t){return N(this.features,"getCoordinate",t)},U.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(t){return t.type===p.POLYGON?t.getCoordinates():t.coordinates}))))},U.prototype.updateCoordinate=function(t,e,n){N(this.features,"updateCoordinate",t,e,n),this.changed()},U.prototype.addCoordinate=function(t,e,n){N(this.features,"addCoordinate",t,e,n),this.changed()},U.prototype.removeCoordinate=function(t){N(this.features,"removeCoordinate",t),this.changed()},U.prototype.getFeatures=function(){return this.features},j.prototype.setSelected=function(t){return this._ctx.store.setSelected(t)},j.prototype.setSelectedCoordinates=function(t){var e=this;this._ctx.store.setSelectedCoordinates(t),t.reduce((function(t,n){return void 0===t[n.feature_id]&&(t[n.feature_id]=!0,e._ctx.store.get(n.feature_id).changed()),t}),{})},j.prototype.getSelected=function(){return this._ctx.store.getSelected()},j.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},j.prototype.isSelected=function(t){return this._ctx.store.isSelected(t)},j.prototype.getFeature=function(t){return this._ctx.store.get(t)},j.prototype.select=function(t){return this._ctx.store.select(t)},j.prototype.deselect=function(t){return this._ctx.store.deselect(t)},j.prototype.deleteFeature=function(t,e){return void 0===e&&(e={}),this._ctx.store.delete(t,e)},j.prototype.addFeature=function(t){return this._ctx.store.add(t)},j.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},j.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},j.prototype.setActionableState=function(t){void 0===t&&(t={});var e={trash:t.trash||!1,combineFeatures:t.combineFeatures||!1,uncombineFeatures:t.uncombineFeatures||!1};return this._ctx.events.actionable(e)},j.prototype.changeMode=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),this._ctx.events.changeMode(t,e,n)},j.prototype.updateUIClasses=function(t){return this._ctx.ui.queueMapClasses(t)},j.prototype.activateUIButton=function(t){return this._ctx.ui.setActiveButton(t)},j.prototype.featuresAt=function(t,e,n){if(void 0===n&&(n="click"),"click"!==n&&"touch"!==n)throw new Error("invalid buffer type");return S[n](t,e,this._ctx)},j.prototype.newFeature=function(t){var e=t.geometry.type;return e===p.POINT?new R(this._ctx,t):e===p.LINE_STRING?new z(this._ctx,t):e===p.POLYGON?new F(this._ctx,t):new U(this._ctx,t)},j.prototype.isInstanceOf=function(t,e){if(t===p.POINT)return e instanceof R;if(t===p.LINE_STRING)return e instanceof z;if(t===p.POLYGON)return e instanceof F;if("MultiFeature"===t)return e instanceof U;throw new Error("Unknown feature class: "+t)},j.prototype.doRender=function(t){return this._ctx.store.featureChanged(t)},j.prototype.onSetup=function(){},j.prototype.onDrag=function(){},j.prototype.onClick=function(){},j.prototype.onMouseMove=function(){},j.prototype.onMouseDown=function(){},j.prototype.onMouseUp=function(){},j.prototype.onMouseOut=function(){},j.prototype.onKeyUp=function(){},j.prototype.onKeyDown=function(){},j.prototype.onTouchStart=function(){},j.prototype.onTouchMove=function(){},j.prototype.onTouchEnd=function(){},j.prototype.onTap=function(){},j.prototype.onStop=function(){},j.prototype.onTrash=function(){},j.prototype.onCombineFeature=function(){},j.prototype.onUncombineFeature=function(){},j.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var V={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},q=Object.keys(V);function G(t){return[].concat(t).filter((function(t){return void 0!==t}))}function Z(){var t=this;if(!t.ctx.map||void 0===t.ctx.map.getSource(s.HOT))return u();var e=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:e});var n=[],i=[];t.isDirty?i=t.getAllIds():(n=t.getChangedIds().filter((function(e){return void 0!==t.get(e)})),i=t.sources.hot.filter((function(e){return e.properties.id&&-1===n.indexOf(e.properties.id)&&void 0!==t.get(e.properties.id)})).map((function(t){return t.properties.id}))),t.sources.hot=[];var r=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter((function(t){var e=t.properties.id||t.properties.parent;return-1===n.indexOf(e)}));var o=r!==t.sources.cold.length||i.length>0;function a(n,i){var r=t.get(n).internal(e);t.ctx.events.currentModeRender(r,(function(e){t.sources[i].push(e)}))}if(n.forEach((function(t){return a(t,"hot")})),i.forEach((function(t){return a(t,"cold")})),o&&t.ctx.map.getSource(s.COLD).setData({type:p.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(s.HOT).setData({type:p.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(d.SELECTION_CHANGE,{features:t.getSelected().map((function(t){return t.toGeoJSON()})),points:t.getSelectedCoordinates().map((function(t){return{type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:t.coordinates}}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){var l=t._deletedFeaturesToEmit.map((function(t){return t.toGeoJSON()}));t._deletedFeaturesToEmit=[],t.ctx.map.fire(d.DELETE,{features:l})}function u(){t.isDirty=!1,t.clearChangedIds()}u(),t.ctx.map.fire(d.RENDER,{})}function H(t){var e,n=this;this._features={},this._featureIds=new C,this._selectedFeatureIds=new C,this._selectedCoordinates=[],this._changedFeatureIds=new C,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=t,this.sources={hot:[],cold:[]},this.render=function(){e||(e=requestAnimationFrame((function(){e=null,Z.call(n)})))},this.isDirty=!1}function Y(t,e){var n=t._selectedCoordinates.filter((function(e){return t._selectedFeatureIds.has(e.feature_id)}));t._selectedCoordinates.length===n.length||e.silent||(t._emitSelectionChange=!0),t._selectedCoordinates=n}H.prototype.createRenderBatch=function(){var t=this,e=this.render,n=0;return this.render=function(){n++},function(){t.render=e,n>0&&t.render()}},H.prototype.setDirty=function(){return this.isDirty=!0,this},H.prototype.featureChanged=function(t){return this._changedFeatureIds.add(t),this},H.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},H.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},H.prototype.getAllIds=function(){return this._featureIds.values()},H.prototype.add=function(t){return this.featureChanged(t.id),this._features[t.id]=t,this._featureIds.add(t.id),this},H.prototype.delete=function(t,e){var n=this;return void 0===e&&(e={}),G(t).forEach((function(t){n._featureIds.has(t)&&(n._featureIds.delete(t),n._selectedFeatureIds.delete(t),e.silent||-1===n._deletedFeaturesToEmit.indexOf(n._features[t])&&n._deletedFeaturesToEmit.push(n._features[t]),delete n._features[t],n.isDirty=!0)})),Y(this,e),this},H.prototype.get=function(t){return this._features[t]},H.prototype.getAll=function(){var t=this;return Object.keys(this._features).map((function(e){return t._features[e]}))},H.prototype.select=function(t,e){var n=this;return void 0===e&&(e={}),G(t).forEach((function(t){n._selectedFeatureIds.has(t)||(n._selectedFeatureIds.add(t),n._changedFeatureIds.add(t),e.silent||(n._emitSelectionChange=!0))})),this},H.prototype.deselect=function(t,e){var n=this;return void 0===e&&(e={}),G(t).forEach((function(t){n._selectedFeatureIds.has(t)&&(n._selectedFeatureIds.delete(t),n._changedFeatureIds.add(t),e.silent||(n._emitSelectionChange=!0))})),Y(this,e),this},H.prototype.clearSelected=function(t){return void 0===t&&(t={}),this.deselect(this._selectedFeatureIds.values(),{silent:t.silent}),this},H.prototype.setSelected=function(t,e){var n=this;return void 0===e&&(e={}),t=G(t),this.deselect(this._selectedFeatureIds.values().filter((function(e){return-1===t.indexOf(e)})),{silent:e.silent}),this.select(t.filter((function(t){return!n._selectedFeatureIds.has(t)})),{silent:e.silent}),this},H.prototype.setSelectedCoordinates=function(t){return this._selectedCoordinates=t,this._emitSelectionChange=!0,this},H.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},H.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},H.prototype.getSelected=function(){var t=this;return this._selectedFeatureIds.values().map((function(e){return t.get(e)}))},H.prototype.getSelectedCoordinates=function(){var t=this;return this._selectedCoordinates.map((function(e){return{coordinates:t.get(e.feature_id).getCoordinate(e.coord_path)}}))},H.prototype.isSelected=function(t){return this._selectedFeatureIds.has(t)},H.prototype.setFeatureProperty=function(t,e,n){this.get(t).setProperty(e,n),this.featureChanged(t)},H.prototype.storeMapConfig=function(){var t=this;v.forEach((function(e){t.ctx.map[e]&&(t._mapInitialConfig[e]=t.ctx.map[e].isEnabled())}))},H.prototype.restoreMapConfig=function(){var t=this;Object.keys(this._mapInitialConfig).forEach((function(e){t._mapInitialConfig[e]?t.ctx.map[e].enable():t.ctx.map[e].disable()}))},H.prototype.getInitialConfigValue=function(t){return void 0===this._mapInitialConfig[t]||this._mapInitialConfig[t]};var X=Object.prototype.hasOwnProperty,W=e((function(){for(var t=arguments,e={},n=0;n<arguments.length;n++){var i=t[n];for(var r in i)X.call(i,r)&&(e[r]=i[r])}return e})),K=["mode","feature","mouse"];function J(e){var n=null,i=null,r={onRemove:function(){return e.map.off("load",r.connect),clearInterval(i),r.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,n&&n.parentNode&&n.parentNode.removeChild(n),n=null,this},connect:function(){e.map.off("load",r.connect),clearInterval(i),r.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(o){var a=o.fire;return o.fire=function(t,e){var n=arguments;return 1===a.length&&1!==arguments.length&&(n=[W({},{type:t},e)]),a.apply(o,n)},e.map=o,e.events=function(e){var n=Object.keys(e.options.modes).reduce((function(t,n){return t[n]=function(t){var e=Object.keys(t);return function(n,i){void 0===i&&(i={});var r={},o=e.reduce((function(e,n){return e[n]=t[n],e}),new j(n));return{start:function(){var e=this;r=o.onSetup(i),q.forEach((function(n){var i,a=V[n],l=function(){return!1};t[a]&&(l=function(){return!0}),e.on(n,l,(i=a,function(t){return o[i](r,t)}))}))},stop:function(){o.onStop(r)},trash:function(){o.onTrash(r)},combineFeatures:function(){o.onCombineFeatures(r)},uncombineFeatures:function(){o.onUncombineFeatures(r)},render:function(t,e){o.toDisplayFeatures(r,t,e)}}}}(e.options.modes[n]),t}),{}),i={},r={},o={},a=null,l=null;o.drag=function(t,n){n({point:t.point,time:(new Date).getTime()})?(e.ui.queueMapClasses({mouse:u.DRAG}),l.drag(t)):t.originalEvent.stopPropagation()},o.mousedrag=function(t){o.drag(t,(function(t){return!A(i,t)}))},o.touchdrag=function(t){o.drag(t,(function(t){return!M(r,t)}))},o.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which))return o.mousedrag(t);var n=I(t,e);t.featureTarget=n,l.mousemove(t)},o.mousedown=function(t){i={time:(new Date).getTime(),point:t.point};var n=I(t,e);t.featureTarget=n,l.mousedown(t)},o.mouseup=function(t){var n=I(t,e);t.featureTarget=n,A(i,{point:t.point,time:(new Date).getTime()})?l.click(t):l.mouseup(t)},o.mouseout=function(t){l.mouseout(t)},o.touchstart=function(t){if(t.originalEvent.preventDefault(),e.options.touchEnabled){r={time:(new Date).getTime(),point:t.point};var n=S.touch(t,null,e)[0];t.featureTarget=n,l.touchstart(t)}},o.touchmove=function(t){if(t.originalEvent.preventDefault(),e.options.touchEnabled)return l.touchmove(t),o.touchdrag(t)},o.touchend=function(t){if(t.originalEvent.preventDefault(),e.options.touchEnabled){var n=S.touch(t,null,e)[0];t.featureTarget=n,M(r,{time:(new Date).getTime(),point:t.point})?l.tap(t):l.touchend(t)}};var s=function(t){return!(8===t||46===t||t>=48&&t<=57)};function c(i,r,o){void 0===o&&(o={}),l.stop();var s=n[i];if(void 0===s)throw new Error(i+" is not valid");a=i;var u=s(e,r);l=t(u,e),o.silent||e.map.fire(d.MODE_CHANGE,{mode:i}),e.store.setDirty(),e.store.render()}o.keydown=function(t){(t.srcElement||t.target).classList.contains("mapboxgl-canvas")&&(8!==t.keyCode&&46!==t.keyCode||!e.options.controls.trash?s(t.keyCode)?l.keydown(t):49===t.keyCode&&e.options.controls.point?c(h.DRAW_POINT):50===t.keyCode&&e.options.controls.line_string?c(h.DRAW_LINE_STRING):51===t.keyCode&&e.options.controls.polygon&&c(h.DRAW_POLYGON):(t.preventDefault(),l.trash()))},o.keyup=function(t){s(t.keyCode)&&l.keyup(t)},o.zoomend=function(){e.store.changeZoom()},o.data=function(t){if("style"===t.dataType){var n=e.setup,i=e.map,r=e.options,o=e.store;r.styles.some((function(t){return i.getLayer(t.id)}))||(n.addLayers(),o.setDirty(),o.render())}};var p={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){a=e.options.defaultMode,l=t(n[a](e),e)},changeMode:c,actionable:function(t){var n=!1;Object.keys(t).forEach((function(e){if(void 0===p[e])throw new Error("Invalid action type");p[e]!==t[e]&&(n=!0),p[e]=t[e]})),n&&e.map.fire(d.ACTIONABLE,{actions:p})},currentModeName:function(){return a},currentModeRender:function(t,e){return l.render(t,e)},fire:function(t,e){o[t]&&o[t](e)},addEventListeners:function(){e.map.on("mousemove",o.mousemove),e.map.on("mousedown",o.mousedown),e.map.on("mouseup",o.mouseup),e.map.on("data",o.data),e.map.on("touchmove",o.touchmove),e.map.on("touchstart",o.touchstart),e.map.on("touchend",o.touchend),e.container.addEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",o.keydown),e.container.addEventListener("keyup",o.keyup))},removeEventListeners:function(){e.map.off("mousemove",o.mousemove),e.map.off("mousedown",o.mousedown),e.map.off("mouseup",o.mouseup),e.map.off("data",o.data),e.map.off("touchmove",o.touchmove),e.map.off("touchstart",o.touchstart),e.map.off("touchend",o.touchend),e.container.removeEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",o.keydown),e.container.removeEventListener("keyup",o.keyup))},trash:function(t){l.trash(t)},combineFeatures:function(){l.combineFeatures()},uncombineFeatures:function(){l.uncombineFeatures()},getMode:function(){return a}}}(e),e.ui=function(t){var e={},n=null,i={mode:null,feature:null,mouse:null},r={mode:null,feature:null,mouse:null};function o(t){r=W(r,t)}function a(){var e,n;if(t.container){var o=[],a=[];K.forEach((function(t){r[t]!==i[t]&&(o.push(t+"-"+i[t]),null!==r[t]&&a.push(t+"-"+r[t]))})),o.length>0&&(e=t.container.classList).remove.apply(e,o),a.length>0&&(n=t.container.classList).add.apply(n,a),i=W(i,r)}}function s(t,e){void 0===e&&(e={});var i=document.createElement("button");return i.className=l.CONTROL_BUTTON+" "+e.className,i.setAttribute("title",e.title),e.container.appendChild(i),i.addEventListener("click",(function(i){if(i.preventDefault(),i.stopPropagation(),i.target===n)return u(),void e.onDeactivate();p(t),e.onActivate()}),!0),i}function u(){n&&(n.classList.remove(l.ACTIVE_BUTTON),n=null)}function p(t){u();var i=e[t];i&&i&&"trash"!==t&&(i.classList.add(l.ACTIVE_BUTTON),n=i)}return{setActiveButton:p,queueMapClasses:o,updateMapClasses:a,clearMapClasses:function(){o({mode:null,feature:null,mouse:null}),a()},addButtons:function(){var n=t.options.controls,i=document.createElement("div");return i.className=l.CONTROL_GROUP+" "+l.CONTROL_BASE,n?(n[c.LINE]&&(e[c.LINE]=s(c.LINE,{container:i,className:l.CONTROL_BUTTON_LINE,title:"LineString tool "+(t.options.keybindings?"(l)":""),onActivate:function(){return t.events.changeMode(h.DRAW_LINE_STRING)},onDeactivate:function(){return t.events.trash()}})),n[c.POLYGON]&&(e[c.POLYGON]=s(c.POLYGON,{container:i,className:l.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(t.options.keybindings?"(p)":""),onActivate:function(){return t.events.changeMode(h.DRAW_POLYGON)},onDeactivate:function(){return t.events.trash()}})),n[c.POINT]&&(e[c.POINT]=s(c.POINT,{container:i,className:l.CONTROL_BUTTON_POINT,title:"Marker tool "+(t.options.keybindings?"(m)":""),onActivate:function(){return t.events.changeMode(h.DRAW_POINT)},onDeactivate:function(){return t.events.trash()}})),n.trash&&(e.trash=s("trash",{container:i,className:l.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){t.events.trash()}})),n.combine_features&&(e.combine_features=s("combineFeatures",{container:i,className:l.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){t.events.combineFeatures()}})),n.uncombine_features&&(e.uncombine_features=s("uncombineFeatures",{container:i,className:l.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){t.events.uncombineFeatures()}})),i):i},removeButtons:function(){Object.keys(e).forEach((function(t){var n=e[t];n.parentNode&&n.parentNode.removeChild(n),delete e[t]}))}}}(e),e.container=o.getContainer(),e.store=new H(e),n=e.ui.addButtons(),e.options.boxSelect&&(e.boxZoomInitial=o.boxZoom.isEnabled(),o.boxZoom.disable(),o.dragPan.disable(),o.dragPan.enable()),o.loaded()?r.connect():(o.on("load",r.connect),i=setInterval((function(){o.loaded()&&r.connect()}),16)),e.events.start(),n},addLayers:function(){e.map.addSource(s.COLD,{data:{type:p.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(s.HOT,{data:{type:p.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach((function(t){e.map.addLayer(t)})),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach((function(t){e.map.getLayer(t.id)&&e.map.removeLayer(t.id)})),e.map.getSource(s.COLD)&&e.map.removeSource(s.COLD),e.map.getSource(s.HOT)&&e.map.removeSource(s.HOT)}};return e.setup=r,r}var $=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Q(t){return function(e){var n=e.featureTarget;return!!n&&!!n.properties&&n.properties.meta===t}}function tt(t){return!!t.originalEvent&&!!t.originalEvent.shiftKey&&0===t.originalEvent.button}function et(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===g.ACTIVE&&t.featureTarget.properties.meta===m.FEATURE}function nt(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===g.INACTIVE&&t.featureTarget.properties.meta===m.FEATURE}function it(t){return void 0===t.featureTarget}function rt(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.meta===m.FEATURE}function ot(t){var e=t.featureTarget;return!!e&&!!e.properties&&e.properties.meta===m.VERTEX}function at(t){return!!t.originalEvent&&!0===t.originalEvent.shiftKey}function lt(t){return 27===t.keyCode}function st(t){return 13===t.keyCode}var ut=Object.freeze({__proto__:null,isOfMetaType:Q,isShiftMousedown:tt,isActiveFeature:et,isInactiveFeature:nt,noTarget:it,isFeature:rt,isVertex:ot,isShiftDown:at,isEscapeKey:lt,isEnterKey:st,isTrue:function(){return!0}}),ct=pt;function pt(t,e){this.x=t,this.y=e}pt.prototype={clone:function(){return new pt(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.x+n*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},pt.convert=function(t){return t instanceof pt?t:Array.isArray(t)?new pt(t[0],t[1]):t};var ht=e(ct);function dt(t,e){var n=e.getBoundingClientRect();return new ht(t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0))}function ft(t,e,n,i){return{type:p.FEATURE,properties:{meta:m.VERTEX,parent:t,coord_path:n,active:i?g.ACTIVE:g.INACTIVE},geometry:{type:p.POINT,coordinates:e}}}function mt(t,e,n){var i=e.geometry.coordinates,r=n.geometry.coordinates;if(i[1]>85||i[1]<-85||r[1]>85||r[1]<-85)return null;var o={lng:(i[0]+r[0])/2,lat:(i[1]+r[1])/2};return{type:p.FEATURE,properties:{meta:m.MIDPOINT,parent:t,lng:o.lng,lat:o.lat,coord_path:n.properties.coord_path},geometry:{type:p.POINT,coordinates:[o.lng,o.lat]}}}function gt(t,e,n){void 0===e&&(e={}),void 0===n&&(n=null);var i,r=t.geometry,o=r.type,a=r.coordinates,l=t.properties&&t.properties.id,s=[];function u(t,n){var i="",r=null;t.forEach((function(t,o){var a=null!=n?n+"."+o:String(o),u=ft(l,t,a,c(a));if(e.midpoints&&r){var p=mt(l,r,u);p&&s.push(p)}r=u;var h=JSON.stringify(t);i!==h&&s.push(u),0===o&&(i=h)}))}function c(t){return!!e.selectedPaths&&-1!==e.selectedPaths.indexOf(t)}return o===p.POINT?s.push(ft(l,a,n,c(n))):o===p.POLYGON?a.forEach((function(t,e){u(t,null!==n?n+"."+e:String(e))})):o===p.LINE_STRING?u(a,n):0===o.indexOf(p.MULTI_PREFIX)&&(i=o.replace(p.MULTI_PREFIX,""),a.forEach((function(n,r){var o={type:p.FEATURE,properties:t.properties,geometry:{type:i,coordinates:n}};s=s.concat(gt(o,e,r))}))),s}var vt={enable:function(t){setTimeout((function(){t.map&&t.map.doubleClickZoom&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()}),0)},disable:function(t){setTimeout((function(){t.map&&t.map.doubleClickZoom&&t.map.doubleClickZoom.disable()}),0)}},yt={exports:{}},_t=function(t){if(!t||!t.type)return null;var e=bt[t.type];return e?"geometry"===e?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===e?{type:"FeatureCollection",features:[t]}:"featurecollection"===e?t:void 0:null},bt={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},xt=e(_t),wt=Object.freeze({__proto__:null,default:function t(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce((function(e,n){return e.concat(t(n))}),[]),e;case"Feature":return e.geometry?t(e.geometry).map((function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return void 0!==e.id&&(n.id=e.id),n})):[e];case"MultiPoint":return e.coordinates.map((function(t){return{type:"Point",coordinates:t}}));case"MultiPolygon":return e.coordinates.map((function(t){return{type:"Polygon",coordinates:t}}));case"MultiLineString":return e.coordinates.map((function(t){return{type:"LineString",coordinates:t}}));case"GeometryCollection":return e.geometries.map(t).reduce((function(t,e){return t.concat(e)}),[]);case"Point":case"Polygon":case"LineString":return[e]}}}),Ct=_t,Et=function(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){if(this instanceof t){var n=[null];n.push.apply(n,arguments);var i=Function.bind.apply(e,n);return new i}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),n}(wt);Et instanceof Function||(Et=Et.default);var St={exports:{}},Tt=St.exports=function(t){return new It(t)};function It(t){this.value=t}function Pt(t,e,n){var i=[],r=[],o=!0;return function t(a){var l=n?At(a):a,s={},u=!0,c={node:l,node_:a,path:[].concat(i),parent:r[r.length-1],parents:r,key:i.slice(-1)[0],isRoot:0===i.length,level:i.length,circular:null,update:function(t,e){c.isRoot||(c.parent.node[c.key]=t),c.node=t,e&&(u=!1)},delete:function(t){delete c.parent.node[c.key],t&&(u=!1)},remove:function(t){Dt(c.parent.node)?c.parent.node.splice(c.key,1):delete c.parent.node[c.key],t&&(u=!1)},keys:null,before:function(t){s.before=t},after:function(t){s.after=t},pre:function(t){s.pre=t},post:function(t){s.post=t},stop:function(){o=!1},block:function(){u=!1}};if(!o)return c;function p(){if("object"==typeof c.node&&null!==c.node){c.keys&&c.node_===c.node||(c.keys=Mt(c.node)),c.isLeaf=0==c.keys.length;for(var t=0;t<r.length;t++)if(r[t].node_===a){c.circular=r[t];break}}else c.isLeaf=!0,c.keys=null;c.notLeaf=!c.isLeaf,c.notRoot=!c.isRoot}p();var h=e.call(c,c.node);return void 0!==h&&c.update&&c.update(h),s.before&&s.before.call(c,c.node),u?("object"!=typeof c.node||null===c.node||c.circular||(r.push(c),p(),Lt(c.keys,(function(e,r){i.push(e),s.pre&&s.pre.call(c,c.node[e],e);var o=t(c.node[e]);n&&Ot.call(c.node,e)&&(c.node[e]=o.node),o.isLast=r==c.keys.length-1,o.isFirst=0==r,s.post&&s.post.call(c,o),i.pop()})),r.pop()),s.after&&s.after.call(c,c.node),c):c}(t).node}function At(t){if("object"==typeof t&&null!==t){var e;if(Dt(t))e=[];else if("[object Date]"===kt(t))e=new Date(t.getTime?t.getTime():t);else if(function(t){return"[object RegExp]"===kt(t)}(t))e=new RegExp(t);else if(function(t){return"[object Error]"===kt(t)}(t))e={message:t.message};else if(function(t){return"[object Boolean]"===kt(t)}(t))e=new Boolean(t);else if(function(t){return"[object Number]"===kt(t)}(t))e=new Number(t);else if(function(t){return"[object String]"===kt(t)}(t))e=new String(t);else if(Object.create&&Object.getPrototypeOf)e=Object.create(Object.getPrototypeOf(t));else if(t.constructor===Object)e={};else{var n=t.constructor&&t.constructor.prototype||t.__proto__||{},i=function(){};i.prototype=n,e=new i}return Lt(Mt(t),(function(n){e[n]=t[n]})),e}return t}It.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var i=t[n];if(!e||!Ot.call(e,i)){e=void 0;break}e=e[i]}return e},It.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var i=t[n];if(!e||!Ot.call(e,i))return!1;e=e[i]}return!0},It.prototype.set=function(t,e){for(var n=this.value,i=0;i<t.length-1;i++){var r=t[i];Ot.call(n,r)||(n[r]={}),n=n[r]}return n[t[i]]=e,e},It.prototype.map=function(t){return Pt(this.value,t,!0)},It.prototype.forEach=function(t){return this.value=Pt(this.value,t,!1),this.value},It.prototype.reduce=function(t,e){var n=1===arguments.length,i=n?this.value:e;return this.forEach((function(e){this.isRoot&&n||(i=t.call(this,i,e))})),i},It.prototype.paths=function(){var t=[];return this.forEach((function(e){t.push(this.path)})),t},It.prototype.nodes=function(){var t=[];return this.forEach((function(e){t.push(this.node)})),t},It.prototype.clone=function(){var t=[],e=[];return function n(i){for(var r=0;r<t.length;r++)if(t[r]===i)return e[r];if("object"==typeof i&&null!==i){var o=At(i);return t.push(i),e.push(o),Lt(Mt(i),(function(t){o[t]=n(i[t])})),t.pop(),e.pop(),o}return i}(this.value)};var Mt=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};function kt(t){return Object.prototype.toString.call(t)}var Dt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Lt=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)};Lt(Mt(It.prototype),(function(t){Tt[t]=function(e){var n=[].slice.call(arguments,1),i=new It(e);return i[t].apply(i,n)}}));var Ot=Object.hasOwnProperty||function(t,e){return e in t},Rt=St.exports,zt=Ft;function Ft(t){if(!(this instanceof Ft))return new Ft(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}Ft.prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this},Ft.prototype.equals=function(t){var e;return e=t instanceof Ft?t.bbox():t,this._bbox[0]==e[0]&&this._bbox[1]==e[1]&&this._bbox[2]==e[2]&&this._bbox[3]==e[3]},Ft.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Ft.prototype.union=function(t){var e;return this._valid=!0,e=t instanceof Ft?t.bbox():t,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this},Ft.prototype.bbox=function(){return this._valid?this._bbox:null},Ft.prototype.contains=function(t){if(!t)return this._fastContains();if(!this._valid)return null;var e=t[0],n=t[1];return this._bbox[0]<=e&&this._bbox[1]<=n&&this._bbox[2]>=e&&this._bbox[3]>=n},Ft.prototype.intersect=function(t){return this._valid?(e=t instanceof Ft?t.bbox():t,!(this._bbox[0]>e[2]||this._bbox[2]<e[0]||this._bbox[3]<e[1]||this._bbox[1]>e[3])):null;var e},Ft.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",t)},Ft.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Bt=function(t){if(!t)return[];var e=Et(Ct(t)),n=[];return e.features.forEach((function(t){t.geometry&&(n=n.concat(function(t){return function t(e){return Array.isArray(e)&&e.length&&"number"==typeof e[0]?[e]:e.reduce((function(e,n){return Array.isArray(n)&&Array.isArray(n[0])?e.concat(t(n)):(e.push(n),e)}),[])}(t)}(t.geometry.coordinates)))})),n},Nt=Rt,Ut=zt,jt={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Vt=Object.keys(jt);function qt(t){for(var e=Ut(),n=Bt(t),i=0;i<n.length;i++)e.include(n[i]);return e}yt.exports=function(t){return qt(t).bbox()},yt.exports.polygon=function(t){return qt(t).polygon()},yt.exports.bboxify=function(t){return Nt(t).map((function(t){t&&Vt.some((function(e){return!!t[e]&&-1!==jt[e].indexOf(t.type)}))&&(t.bbox=qt(t).bbox(),this.update(t))}))};var Gt=e(yt.exports);function Zt(t,e){var n=-90,i=90,r=-90,o=90,a=270,l=-270;t.forEach((function(t){var e=Gt(t),s=e[1],u=e[3],c=e[0],p=e[2];s>n&&(n=s),u<i&&(i=u),u>r&&(r=u),s<o&&(o=s),c<a&&(a=c),p>l&&(l=p)}));var s=e;return n+s.lat>85&&(s.lat=85-n),r+s.lat>90&&(s.lat=90-r),i+s.lat<-85&&(s.lat=-85-i),o+s.lat<-90&&(s.lat=-90-o),a+s.lng<=-270&&(s.lng+=360*Math.ceil(Math.abs(s.lng)/360)),l+s.lng>=270&&(s.lng-=360*Math.ceil(Math.abs(s.lng)/360)),s}function Ht(t,e){var n=Zt(t.map((function(t){return t.toGeoJSON()})),e);t.forEach((function(t){var e,i=t.getCoordinates(),r=function(t){var e={lng:t[0]+n.lng,lat:t[1]+n.lat};return[e.lng,e.lat]},o=function(t){return t.map((function(t){return r(t)}))};t.type===p.POINT?e=r(i):t.type===p.LINE_STRING||t.type===p.MULTI_POINT?e=i.map(r):t.type===p.POLYGON||t.type===p.MULTI_LINE_STRING?e=i.map(o):t.type===p.MULTI_POLYGON&&(e=i.map((function(t){return t.map((function(t){return o(t)}))}))),t.incomingCoords(e)}))}var Yt={onSetup:function(t){var e=this,n={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:t.featureIds||[]};return this.setSelected(n.initiallySelectedFeatureIds.filter((function(t){return void 0!==e.getFeature(t)}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),n},fireUpdate:function(){this.map.fire(d.UPDATE,{action:f.MOVE,features:this.getSelected().map((function(t){return t.toGeoJSON()}))})},fireActionable:function(){var t=this,e=this.getSelected(),n=e.filter((function(e){return t.isInstanceOf("MultiFeature",e)})),i=!1;if(e.length>1){i=!0;var r=e[0].type.replace("Multi","");e.forEach((function(t){t.type.replace("Multi","")!==r&&(i=!1)}))}var o=n.length>0,a=e.length>0;this.setActionableState({combineFeatures:i,uncombineFeatures:o,trash:a})},getUniqueIds:function(t){return t.length?t.map((function(t){return t.properties.id})).filter((function(t){return void 0!==t})).reduce((function(t,e){return t.add(e),t}),new C).values():[]},stopExtendedInteractions:function(t){t.boxSelectElement&&(t.boxSelectElement.parentNode&&t.boxSelectElement.parentNode.removeChild(t.boxSelectElement),t.boxSelectElement=null),this.map.dragPan.enable(),t.boxSelecting=!1,t.canBoxSelect=!1,t.dragMoving=!1,t.canDragMove=!1},onStop:function(){vt.enable(this)},onMouseMove:function(t,e){return rt(e)&&t.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(t),!0},onMouseOut:function(t){return!t.dragMoving||this.fireUpdate()}};Yt.onTap=Yt.onClick=function(t,e){return it(e)?this.clickAnywhere(t,e):Q(m.VERTEX)(e)?this.clickOnVertex(t,e):rt(e)?this.clickOnFeature(t,e):void 0},Yt.clickAnywhere=function(t){var e=this,n=this.getSelectedIds();n.length&&(this.clearSelectedFeatures(),n.forEach((function(t){return e.doRender(t)}))),vt.enable(this),this.stopExtendedInteractions(t)},Yt.clickOnVertex=function(t,e){this.changeMode(h.DIRECT_SELECT,{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,startPos:e.lngLat}),this.updateUIClasses({mouse:u.MOVE})},Yt.startOnActiveFeature=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),this.doRender(e.featureTarget.properties.id),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},Yt.clickOnFeature=function(t,e){var n=this;vt.disable(this),this.stopExtendedInteractions(t);var i=at(e),r=this.getSelectedIds(),o=e.featureTarget.properties.id,a=this.isSelected(o);if(!i&&a&&this.getFeature(o).type!==p.POINT)return this.changeMode(h.DIRECT_SELECT,{featureId:o});a&&i?(this.deselect(o),this.updateUIClasses({mouse:u.POINTER}),1===r.length&&vt.enable(this)):!a&&i?(this.select(o),this.updateUIClasses({mouse:u.MOVE})):a||i||(r.forEach((function(t){return n.doRender(t)})),this.setSelected(o),this.updateUIClasses({mouse:u.MOVE})),this.doRender(o)},Yt.onMouseDown=function(t,e){return et(e)?this.startOnActiveFeature(t,e):this.drawConfig.boxSelect&&tt(e)?this.startBoxSelect(t,e):void 0},Yt.startBoxSelect=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),t.boxSelectStartLocation=dt(e.originalEvent,this.map.getContainer()),t.canBoxSelect=!0},Yt.onTouchStart=function(t,e){if(et(e))return this.startOnActiveFeature(t,e)},Yt.onDrag=function(t,e){return t.canDragMove?this.dragMove(t,e):this.drawConfig.boxSelect&&t.canBoxSelect?this.whileBoxSelect(t,e):void 0},Yt.whileBoxSelect=function(t,e){t.boxSelecting=!0,this.updateUIClasses({mouse:u.ADD}),t.boxSelectElement||(t.boxSelectElement=document.createElement("div"),t.boxSelectElement.classList.add(l.BOX_SELECT),this.map.getContainer().appendChild(t.boxSelectElement));var n=dt(e.originalEvent,this.map.getContainer()),i=Math.min(t.boxSelectStartLocation.x,n.x),r=Math.max(t.boxSelectStartLocation.x,n.x),o=Math.min(t.boxSelectStartLocation.y,n.y),a=Math.max(t.boxSelectStartLocation.y,n.y),s="translate("+i+"px, "+o+"px)";t.boxSelectElement.style.transform=s,t.boxSelectElement.style.WebkitTransform=s,t.boxSelectElement.style.width=r-i+"px",t.boxSelectElement.style.height=a-o+"px"},Yt.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};Ht(this.getSelected(),n),t.dragMoveLocation=e.lngLat},Yt.onTouchEnd=Yt.onMouseUp=function(t,e){var n=this;if(t.dragMoving)this.fireUpdate();else if(t.boxSelecting){var i=[t.boxSelectStartLocation,dt(e.originalEvent,this.map.getContainer())],r=this.featuresAt(null,i,"click"),o=this.getUniqueIds(r).filter((function(t){return!n.isSelected(t)}));o.length&&(this.select(o),o.forEach((function(t){return n.doRender(t)})),this.updateUIClasses({mouse:u.MOVE}))}this.stopExtendedInteractions(t)},Yt.toDisplayFeatures=function(t,e,n){e.properties.active=this.isSelected(e.properties.id)?g.ACTIVE:g.INACTIVE,n(e),this.fireActionable(),e.properties.active===g.ACTIVE&&e.geometry.type!==p.POINT&&gt(e).forEach(n)},Yt.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Yt.onCombineFeatures=function(){var t=this.getSelected();if(!(0===t.length||t.length<2)){for(var e=[],n=[],i=t[0].type.replace("Multi",""),r=0;r<t.length;r++){var o=t[r];if(o.type.replace("Multi","")!==i)return;o.type.includes("Multi")?o.getCoordinates().forEach((function(t){e.push(t)})):e.push(o.getCoordinates()),n.push(o.toGeoJSON())}if(n.length>1){var a=this.newFeature({type:p.FEATURE,properties:n[0].properties,geometry:{type:"Multi"+i,coordinates:e}});this.addFeature(a),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([a.id]),this.map.fire(d.COMBINE_FEATURES,{createdFeatures:[a.toGeoJSON()],deletedFeatures:n})}this.fireActionable()}},Yt.onUncombineFeatures=function(){var t=this,e=this.getSelected();if(0!==e.length){for(var n=[],i=[],r=function(r){var o=e[r];t.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach((function(e){t.addFeature(e),e.properties=o.properties,n.push(e.toGeoJSON()),t.select([e.id])})),t.deleteFeature(o.id,{silent:!0}),i.push(o.toGeoJSON()))},o=0;o<e.length;o++)r(o);n.length>1&&this.map.fire(d.UNCOMBINE_FEATURES,{createdFeatures:n,deletedFeatures:i}),this.fireActionable()}};var Xt=Q(m.VERTEX),Wt=Q(m.MIDPOINT),Kt={fireUpdate:function(){this.map.fire(d.UPDATE,{action:f.CHANGE_COORDINATES,features:this.getSelected().map((function(t){return t.toGeoJSON()}))})},fireActionable:function(t){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:t.selectedCoordPaths.length>0})},startDragging:function(t,e){this.map.dragPan.disable(),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},stopDragging:function(t){this.map.dragPan.enable(),t.dragMoving=!1,t.canDragMove=!1,t.dragMoveLocation=null},onVertex:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties,i=t.selectedCoordPaths.indexOf(n.coord_path);at(e)||-1!==i?at(e)&&-1===i&&t.selectedCoordPaths.push(n.coord_path):t.selectedCoordPaths=[n.coord_path];var r=this.pathsToCoordinates(t.featureId,t.selectedCoordPaths);this.setSelectedCoordinates(r)},onMidpoint:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties;t.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),t.selectedCoordPaths=[n.coord_path]},pathsToCoordinates:function(t,e){return e.map((function(e){return{feature_id:t,coord_path:e}}))},onFeature:function(t,e){0===t.selectedCoordPaths.length?this.startDragging(t,e):this.stopDragging(t)},dragFeature:function(t,e,n){Ht(this.getSelected(),n),t.dragMoveLocation=e.lngLat},dragVertex:function(t,e,n){for(var i=t.selectedCoordPaths.map((function(e){return t.feature.getCoordinate(e)})),r=Zt(i.map((function(t){return{type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:t}}})),n),o=0;o<i.length;o++){var a=i[o];t.feature.updateCoordinate(t.selectedCoordPaths[o],a[0]+r.lng,a[1]+r.lat)}},clickNoTarget:function(){this.changeMode(h.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(h.SIMPLE_SELECT)},clickActiveFeature:function(t){t.selectedCoordPaths=[],this.clearSelectedCoordinates(),t.feature.changed()},onSetup:function(t){var e=t.featureId,n=this.getFeature(e);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===p.POINT)throw new TypeError("direct_select mode doesn't handle point features");var i={featureId:e,feature:n,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(e,i.selectedCoordPaths)),this.setSelected(e),vt.disable(this),this.setActionableState({trash:!0}),i},onStop:function(){vt.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(t,e,n){t.featureId===e.properties.id?(e.properties.active=g.ACTIVE,n(e),gt(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths}).forEach(n)):(e.properties.active=g.INACTIVE,n(e)),this.fireActionable(t)},onTrash:function(t){t.selectedCoordPaths.sort((function(t,e){return e.localeCompare(t,"en",{numeric:!0})})).forEach((function(e){return t.feature.removeCoordinate(e)})),this.fireUpdate(),t.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(t),!1===t.feature.isValid()&&(this.deleteFeature([t.featureId]),this.changeMode(h.SIMPLE_SELECT,{}))},onMouseMove:function(t,e){var n=et(e),i=Xt(e),r=Wt(e),o=0===t.selectedCoordPaths.length;return n&&o||i&&!o?this.updateUIClasses({mouse:u.MOVE}):this.updateUIClasses({mouse:u.NONE}),(i||n||r)&&t.dragMoving&&this.fireUpdate(),this.stopDragging(t),!0},onMouseOut:function(t){return t.dragMoving&&this.fireUpdate(),!0}};Kt.onTouchStart=Kt.onMouseDown=function(t,e){return Xt(e)?this.onVertex(t,e):et(e)?this.onFeature(t,e):Wt(e)?this.onMidpoint(t,e):void 0},Kt.onDrag=function(t,e){if(!0===t.canDragMove){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};t.selectedCoordPaths.length>0?this.dragVertex(t,e,n):this.dragFeature(t,e,n),t.dragMoveLocation=e.lngLat}},Kt.onClick=function(t,e){return it(e)?this.clickNoTarget(t,e):et(e)?this.clickActiveFeature(t,e):nt(e)?this.clickInactive(t,e):void this.stopDragging(t)},Kt.onTap=function(t,e){return it(e)?this.clickNoTarget(t,e):et(e)?this.clickActiveFeature(t,e):nt(e)?this.clickInactive(t,e):void 0},Kt.onTouchEnd=Kt.onMouseUp=function(t){t.dragMoving&&this.fireUpdate(),this.stopDragging(t)};var Jt={};function $t(t,e){return!!t.lngLat&&t.lngLat.lng===e[0]&&t.lngLat.lat===e[1]}Jt.onSetup=function(){var t=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:[]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:u.ADD}),this.activateUIButton(c.POINT),this.setActionableState({trash:!0}),{point:t}},Jt.stopDrawingAndRemove=function(t){this.deleteFeature([t.point.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)},Jt.onTap=Jt.onClick=function(t,e){this.updateUIClasses({mouse:u.MOVE}),t.point.updateCoordinate("",e.lngLat.lng,e.lngLat.lat),this.map.fire(d.CREATE,{features:[t.point.toGeoJSON()]}),this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.point.id]})},Jt.onStop=function(t){this.activateUIButton(),t.point.getCoordinate().length||this.deleteFeature([t.point.id],{silent:!0})},Jt.toDisplayFeatures=function(t,e,n){var i=e.properties.id===t.point.id;if(e.properties.active=i?g.ACTIVE:g.INACTIVE,!i)return n(e)},Jt.onTrash=Jt.stopDrawingAndRemove,Jt.onKeyUp=function(t,e){if(lt(e)||st(e))return this.stopDrawingAndRemove(t,e)};var Qt={onSetup:function(){var t=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),vt.disable(this),this.updateUIClasses({mouse:u.ADD}),this.activateUIButton(c.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&$t(e,t.polygon.coordinates[0][t.currentVertexPosition-1]))return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.polygon.id]});this.updateUIClasses({mouse:u.ADD}),t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),t.currentVertexPosition++,t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},onMouseMove:function(t,e){t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),ot(e)&&this.updateUIClasses({mouse:u.POINTER})}};Qt.onTap=Qt.onClick=function(t,e){return ot(e)?this.clickOnVertex(t,e):this.clickAnywhere(t,e)},Qt.onKeyUp=function(t,e){lt(e)?(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)):st(e)&&this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},Qt.onStop=function(t){this.updateUIClasses({mouse:u.NONE}),vt.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.polygon.id)&&(t.polygon.removeCoordinate("0."+t.currentVertexPosition),t.polygon.isValid()?this.map.fire(d.CREATE,{features:[t.polygon.toGeoJSON()]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT,{},{silent:!0})))},Qt.toDisplayFeatures=function(t,e,n){var i=e.properties.id===t.polygon.id;if(e.properties.active=i?g.ACTIVE:g.INACTIVE,!i)return n(e);if(0!==e.geometry.coordinates.length){var r=e.geometry.coordinates[0].length;if(!(r<3)){if(e.properties.meta=m.FEATURE,n(ft(t.polygon.id,e.geometry.coordinates[0][0],"0.0",!1)),r>3){var o=e.geometry.coordinates[0].length-3;n(ft(t.polygon.id,e.geometry.coordinates[0][o],"0."+o,!1))}if(r<=4){var a=[[e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][1]],[e.geometry.coordinates[0][1][0],e.geometry.coordinates[0][1][1]]];if(n({type:p.FEATURE,properties:e.properties,geometry:{coordinates:a,type:p.LINE_STRING}}),3===r)return}return n(e)}}},Qt.onTrash=function(t){this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)};var te={onSetup:function(t){var e,n,i=(t=t||{}).featureId,r="forward";if(i){if(!(e=this.getFeature(i)))throw new Error("Could not find a feature with the provided featureId");var o=t.from;if(o&&"Feature"===o.type&&o.geometry&&"Point"===o.geometry.type&&(o=o.geometry),o&&"Point"===o.type&&o.coordinates&&2===o.coordinates.length&&(o=o.coordinates),!o||!Array.isArray(o))throw new Error("Please use the `from` property to indicate which point to continue the line from");var a=e.coordinates.length-1;if(e.coordinates[a][0]===o[0]&&e.coordinates[a][1]===o[1])n=a+1,e.addCoordinate.apply(e,[n].concat(e.coordinates[a]));else{if(e.coordinates[0][0]!==o[0]||e.coordinates[0][1]!==o[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");r="backwards",n=0,e.addCoordinate.apply(e,[n].concat(e.coordinates[0]))}}else e=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(e);return this.clearSelectedFeatures(),vt.disable(this),this.updateUIClasses({mouse:u.ADD}),this.activateUIButton(c.LINE),this.setActionableState({trash:!0}),{line:e,currentVertexPosition:n,direction:r}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&$t(e,t.line.coordinates[t.currentVertexPosition-1])||"backwards"===t.direction&&$t(e,t.line.coordinates[t.currentVertexPosition+1]))return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.line.id]});this.updateUIClasses({mouse:u.ADD}),t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),"forward"===t.direction?(t.currentVertexPosition++,t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)):t.line.addCoordinate(0,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.line.id]})},onMouseMove:function(t,e){t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),ot(e)&&this.updateUIClasses({mouse:u.POINTER})}};te.onTap=te.onClick=function(t,e){if(ot(e))return this.clickOnVertex(t,e);this.clickAnywhere(t,e)},te.onKeyUp=function(t,e){st(e)?this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.line.id]}):lt(e)&&(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT))},te.onStop=function(t){vt.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.line.id)&&(t.line.removeCoordinate(""+t.currentVertexPosition),t.line.isValid()?this.map.fire(d.CREATE,{features:[t.line.toGeoJSON()]}):(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT,{},{silent:!0})))},te.onTrash=function(t){this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)},te.toDisplayFeatures=function(t,e,n){var i=e.properties.id===t.line.id;if(e.properties.active=i?g.ACTIVE:g.INACTIVE,!i)return n(e);e.geometry.coordinates.length<2||(e.properties.meta=m.FEATURE,n(ft(t.line.id,e.geometry.coordinates["forward"===t.direction?e.geometry.coordinates.length-2:1],""+("forward"===t.direction?e.geometry.coordinates.length-2:1),!1)),n(e))};var ee={simple_select:Yt,direct_select:Kt,draw_point:Jt,draw_polygon:Qt,draw_line_string:te},ne={defaultMode:h.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:$,modes:ee,controls:{},userProperties:!1},ie={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},re={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function oe(t,e){return t.map((function(t){return t.source?t:W(t,{id:t.id+"."+e,source:"hot"===e?s.HOT:s.COLD})}))}var ae={exports:{}};!function(t,e){var n="__lodash_hash_undefined__",i=9007199254740991,r="[object Arguments]",o="[object Array]",a="[object Boolean]",l="[object Date]",s="[object Error]",u="[object Function]",c="[object Map]",p="[object Number]",h="[object Object]",d="[object Promise]",f="[object RegExp]",m="[object Set]",g="[object String]",v="[object WeakMap]",y="[object ArrayBuffer]",_="[object DataView]",b=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w[r]=w[o]=w[y]=w[a]=w[_]=w[l]=w[s]=w[u]=w[c]=w[p]=w[h]=w[f]=w[m]=w[g]=w[v]=!1;var C="object"==typeof global&&global&&global.Object===Object&&global,E="object"==typeof self&&self&&self.Object===Object&&self,S=C||E||Function("return this")(),T=e&&!e.nodeType&&e,I=T&&t&&!t.nodeType&&t,P=I&&I.exports===T,A=P&&C.process,M=function(){try{return A&&A.binding&&A.binding("util")}catch(t){}}(),k=M&&M.isTypedArray;function D(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function L(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function O(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var R,z,F,B=Array.prototype,N=Function.prototype,U=Object.prototype,j=S["__core-js_shared__"],V=N.toString,q=U.hasOwnProperty,G=(R=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+R:"",Z=U.toString,H=RegExp("^"+V.call(q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Y=P?S.Buffer:void 0,X=S.Symbol,W=S.Uint8Array,K=U.propertyIsEnumerable,J=B.splice,$=X?X.toStringTag:void 0,Q=Object.getOwnPropertySymbols,tt=Y?Y.isBuffer:void 0,et=(z=Object.keys,F=Object,function(t){return z(F(t))}),nt=It(S,"DataView"),it=It(S,"Map"),rt=It(S,"Promise"),ot=It(S,"Set"),at=It(S,"WeakMap"),lt=It(Object,"create"),st=kt(nt),ut=kt(it),ct=kt(rt),pt=kt(ot),ht=kt(at),dt=X?X.prototype:void 0,ft=dt?dt.valueOf:void 0;function mt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function gt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function vt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function yt(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new vt;++e<n;)this.add(t[e])}function _t(t){var e=this.__data__=new gt(t);this.size=e.size}function bt(t,e){for(var n=t.length;n--;)if(Dt(t[n][0],e))return n;return-1}function xt(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":$&&$ in Object(t)?function(t){var e=q.call(t,$),n=t[$];try{t[$]=void 0;var i=!0}catch(t){}var r=Z.call(t);return i&&(e?t[$]=n:delete t[$]),r}(t):function(t){return Z.call(t)}(t)}function wt(t){return Nt(t)&&xt(t)==r}function Ct(t,e,n,i,u){return t===e||(null==t||null==e||!Nt(t)&&!Nt(e)?t!=t&&e!=e:function(t,e,n,i,u,d){var v=Ot(t),b=Ot(e),x=v?o:At(t),w=b?o:At(e),C=(x=x==r?h:x)==h,E=(w=w==r?h:w)==h,S=x==w;if(S&&Rt(t)){if(!Rt(e))return!1;v=!0,C=!1}if(S&&!C)return d||(d=new _t),v||Ut(t)?Et(t,e,n,i,u,d):function(t,e,n,i,r,o,u){switch(n){case _:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case y:return!(t.byteLength!=e.byteLength||!o(new W(t),new W(e)));case a:case l:case p:return Dt(+t,+e);case s:return t.name==e.name&&t.message==e.message;case f:case g:return t==e+"";case c:var h=L;case m:var d=1&i;if(h||(h=O),t.size!=e.size&&!d)return!1;var v=u.get(t);if(v)return v==e;i|=2,u.set(t,e);var b=Et(h(t),h(e),i,r,o,u);return u.delete(t),b;case"[object Symbol]":if(ft)return ft.call(t)==ft.call(e)}return!1}(t,e,x,n,i,u,d);if(!(1&n)){var T=C&&q.call(t,"__wrapped__"),I=E&&q.call(e,"__wrapped__");if(T||I){var P=T?t.value():t,A=I?e.value():e;return d||(d=new _t),u(P,A,n,i,d)}}return!!S&&(d||(d=new _t),function(t,e,n,i,r,o){var a=1&n,l=St(t),s=l.length;if(s!=St(e).length&&!a)return!1;for(var u=s;u--;){var c=l[u];if(!(a?c in e:q.call(e,c)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var h=!0;o.set(t,e),o.set(e,t);for(var d=a;++u<s;){var f=t[c=l[u]],m=e[c];if(i)var g=a?i(m,f,c,e,t,o):i(f,m,c,t,e,o);if(!(void 0===g?f===m||r(f,m,n,i,o):g)){h=!1;break}d||(d="constructor"==c)}if(h&&!d){var v=t.constructor,y=e.constructor;v==y||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(h=!1)}return o.delete(t),o.delete(e),h}(t,e,n,i,u,d))}(t,e,n,i,Ct,u))}function Et(t,e,n,i,r,o){var a=1&n,l=t.length,s=e.length;if(l!=s&&!(a&&s>l))return!1;var u=o.get(t);if(u&&o.get(e))return u==e;var c=-1,p=!0,h=2&n?new yt:void 0;for(o.set(t,e),o.set(e,t);++c<l;){var d=t[c],f=e[c];if(i)var m=a?i(f,d,c,e,t,o):i(d,f,c,t,e,o);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!D(e,(function(t,e){if(a=e,!h.has(a)&&(d===t||r(d,t,n,i,o)))return h.push(e);var a}))){p=!1;break}}else if(d!==f&&!r(d,f,n,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function St(t){return function(t,e,n){var i=e(t);return Ot(t)?i:function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}(i,n(t))}(t,jt,Pt)}function Tt(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function It(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Bt(t)||function(t){return!!G&&G in t}(t))&&(zt(t)?H:b).test(kt(t))}(n)?n:void 0}mt.prototype.clear=function(){this.__data__=lt?lt(null):{},this.size=0},mt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},mt.prototype.get=function(t){var e=this.__data__;if(lt){var i=e[t];return i===n?void 0:i}return q.call(e,t)?e[t]:void 0},mt.prototype.has=function(t){var e=this.__data__;return lt?void 0!==e[t]:q.call(e,t)},mt.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=lt&&void 0===e?n:e,this},gt.prototype.clear=function(){this.__data__=[],this.size=0},gt.prototype.delete=function(t){var e=this.__data__,n=bt(e,t);return!(n<0||(n==e.length-1?e.pop():J.call(e,n,1),--this.size,0))},gt.prototype.get=function(t){var e=this.__data__,n=bt(e,t);return n<0?void 0:e[n][1]},gt.prototype.has=function(t){return bt(this.__data__,t)>-1},gt.prototype.set=function(t,e){var n=this.__data__,i=bt(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},vt.prototype.clear=function(){this.size=0,this.__data__={hash:new mt,map:new(it||gt),string:new mt}},vt.prototype.delete=function(t){var e=Tt(this,t).delete(t);return this.size-=e?1:0,e},vt.prototype.get=function(t){return Tt(this,t).get(t)},vt.prototype.has=function(t){return Tt(this,t).has(t)},vt.prototype.set=function(t,e){var n=Tt(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},yt.prototype.add=yt.prototype.push=function(t){return this.__data__.set(t,n),this},yt.prototype.has=function(t){return this.__data__.has(t)},_t.prototype.clear=function(){this.__data__=new gt,this.size=0},_t.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},_t.prototype.get=function(t){return this.__data__.get(t)},_t.prototype.has=function(t){return this.__data__.has(t)},_t.prototype.set=function(t,e){var n=this.__data__;if(n instanceof gt){var i=n.__data__;if(!it||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new vt(i)}return n.set(t,e),this.size=n.size,this};var Pt=Q?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var a=t[n];e(a)&&(o[r++]=a)}return o}(Q(t),(function(e){return K.call(t,e)})))}:function(){return[]},At=xt;function Mt(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||x.test(t))&&t>-1&&t%1==0&&t<e}function kt(t){if(null!=t){try{return V.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Dt(t,e){return t===e||t!=t&&e!=e}(nt&&At(new nt(new ArrayBuffer(1)))!=_||it&&At(new it)!=c||rt&&At(rt.resolve())!=d||ot&&At(new ot)!=m||at&&At(new at)!=v)&&(At=function(t){var e=xt(t),n=e==h?t.constructor:void 0,i=n?kt(n):"";if(i)switch(i){case st:return _;case ut:return c;case ct:return d;case pt:return m;case ht:return v}return e});var Lt=wt(function(){return arguments}())?wt:function(t){return Nt(t)&&q.call(t,"callee")&&!K.call(t,"callee")},Ot=Array.isArray,Rt=tt||function(){return!1};function zt(t){if(!Bt(t))return!1;var e=xt(t);return e==u||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ft(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}function Bt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Nt(t){return null!=t&&"object"==typeof t}var Ut=k?function(t){return function(e){return t(e)}}(k):function(t){return Nt(t)&&Ft(t.length)&&!!w[xt(t)]};function jt(t){return null!=(e=t)&&Ft(e.length)&&!zt(e)?function(t,e){var n=Ot(t),i=!n&&Lt(t),r=!n&&!i&&Rt(t),o=!n&&!i&&!r&&Ut(t),a=n||i||r||o,l=a?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],s=l.length;for(var u in t)!e&&!q.call(t,u)||a&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Mt(u,s))||l.push(u);return l}(t):function(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||U))return et(t);var e,n,i=[];for(var r in Object(t))q.call(t,r)&&"constructor"!=r&&i.push(r);return i}(t);var e}t.exports=function(t,e){return Ct(t,e)}}(ae,ae.exports);var le=e(ae.exports);function se(t,e){return t.length===e.length&&JSON.stringify(t.map((function(t){return t})).sort())===JSON.stringify(e.map((function(t){return t})).sort())}var ue={Polygon:F,LineString:z,Point:R,MultiPolygon:U,MultiLineString:U,MultiPoint:U},ce=Object.freeze({__proto__:null,CommonSelectors:ut,constrainFeatureMovement:Zt,createMidPoint:mt,createSupplementaryPoints:gt,createVertex:ft,doubleClickZoom:vt,euclideanDistance:P,featuresAt:S,getFeatureAtAndSetCursors:I,isClick:A,isEventAtCoordinates:$t,isTap:M,mapEventToBoundingBox:w,ModeHandler:t,moveFeatures:Ht,sortFeatures:x,stringSetsAreEqual:se,StringSet:C,theme:$,toDenseArray:G});function pe(t){!function(t,e){var n={options:t=function(t){void 0===t&&(t={});var e=W(t);return t.controls||(e.controls={}),!1===t.displayControlsDefault?e.controls=W(re,t.controls):e.controls=W(ie,t.controls),(e=W(ne,e)).styles=oe(e.styles,"cold").concat(oe(e.styles,"hot")),e}(t)};e=function(t,e){return e.modes=h,e.getFeatureIdsAt=function(e){return S.click({point:e},null,t).map((function(t){return t.properties.id}))},e.getSelectedIds=function(){return t.store.getSelectedIds()},e.getSelected=function(){return{type:p.FEATURE_COLLECTION,features:t.store.getSelectedIds().map((function(e){return t.store.get(e)})).map((function(t){return t.toGeoJSON()}))}},e.getSelectedPoints=function(){return{type:p.FEATURE_COLLECTION,features:t.store.getSelectedCoordinates().map((function(t){return{type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:t.coordinates}}}))}},e.set=function(n){if(void 0===n.type||n.type!==p.FEATURE_COLLECTION||!Array.isArray(n.features))throw new Error("Invalid FeatureCollection");var i=t.store.createRenderBatch(),r=t.store.getAllIds().slice(),o=e.add(n),a=new C(o);return(r=r.filter((function(t){return!a.has(t)}))).length&&e.delete(r),i(),o},e.add=function(e){var n=JSON.parse(JSON.stringify(xt(e))).features.map((function(e){if(e.id=e.id||L(),null===e.geometry)throw new Error("Invalid geometry: null");if(void 0===t.store.get(e.id)||t.store.get(e.id).type!==e.geometry.type){var n=ue[e.geometry.type];if(void 0===n)throw new Error("Invalid geometry type: "+e.geometry.type+".");var i=new n(t,e);t.store.add(i)}else{var r=t.store.get(e.id);r.properties=e.properties,le(r.getCoordinates(),e.geometry.coordinates)||r.incomingCoords(e.geometry.coordinates)}return e.id}));return t.store.render(),n},e.get=function(e){var n=t.store.get(e);if(n)return n.toGeoJSON()},e.getAll=function(){return{type:p.FEATURE_COLLECTION,features:t.store.getAll().map((function(t){return t.toGeoJSON()}))}},e.delete=function(n){return t.store.delete(n,{silent:!0}),e.getMode()!==h.DIRECT_SELECT||t.store.getSelectedIds().length?t.store.render():t.events.changeMode(h.SIMPLE_SELECT,void 0,{silent:!0}),e},e.deleteAll=function(){return t.store.delete(t.store.getAllIds(),{silent:!0}),e.getMode()===h.DIRECT_SELECT?t.events.changeMode(h.SIMPLE_SELECT,void 0,{silent:!0}):t.store.render(),e},e.changeMode=function(n,i){return void 0===i&&(i={}),n===h.SIMPLE_SELECT&&e.getMode()===h.SIMPLE_SELECT?(se(i.featureIds||[],t.store.getSelectedIds())||(t.store.setSelected(i.featureIds,{silent:!0}),t.store.render()),e):(n===h.DIRECT_SELECT&&e.getMode()===h.DIRECT_SELECT&&i.featureId===t.store.getSelectedIds()[0]||t.events.changeMode(n,i,{silent:!0}),e)},e.getMode=function(){return t.events.getMode()},e.trash=function(){return t.events.trash({silent:!0}),e},e.combineFeatures=function(){return t.events.combineFeatures({silent:!0}),e},e.uncombineFeatures=function(){return t.events.uncombineFeatures({silent:!0}),e},e.setFeatureProperty=function(n,i,r){return t.store.setFeatureProperty(n,i,r),e},e}(n,e),n.api=e;var i=J(n);e.onAdd=i.onAdd,e.onRemove=i.onRemove,e.types=c,e.options=t}(t,this)}return pe.modes=ee,pe.constants=y,pe.lib=ce,pe}()},z4Bq:function(t,e,n){const{noTarget:i,isOfMetaType:r,isInactiveFeature:o,isShiftDown:a}=n("FxjX"),l=n("/Jvy"),s=n("2j5T"),u=n("uI0s"),c=n("GHAK"),p=n("FxjX"),h=n("n8Y1"),d=r(c.meta.VERTEX),f=r(c.meta.MIDPOINT),m={fireUpdate:function(){this.map.fire(c.events.UPDATE,{action:c.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(t=>t.toGeoJSON())})},fireActionable:function(t){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:t.selectedCoordPaths.length>0})},startDragging:function(t,e){this.map.dragPan.disable(),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},stopDragging:function(t){this.map.dragPan.enable(),t.dragMoving=!1,t.canDragMove=!1,t.dragMoveLocation=null},onVertex:function(t,e){this.startDragging(t,e);const n=e.featureTarget.properties,i=t.selectedCoordPaths.indexOf(n.coord_path);a(e)||-1!==i?a(e)&&-1===i&&t.selectedCoordPaths.push(n.coord_path):t.selectedCoordPaths=[n.coord_path];const r=this.pathsToCoordinates(t.featureId,t.selectedCoordPaths);this.setSelectedCoordinates(r)},onMidpoint:function(t,e){this.startDragging(t,e);const n=e.featureTarget.properties;t.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),t.selectedCoordPaths=[n.coord_path]},pathsToCoordinates:function(t,e){return e.map(e=>({feature_id:t,coord_path:e}))},onFeature:function(t,e){0===t.selectedCoordPaths.length?this.startDragging(t,e):this.stopDragging(t)},dragFeature:function(t,e,n){h(this.getSelected(),n),t.dragMoveLocation=e.lngLat},dragVertex:function(t,e,n){const i=t.selectedCoordPaths.map(e=>t.feature.getCoordinate(e)),r=i.map(t=>({type:c.geojsonTypes.FEATURE,properties:{},geometry:{type:c.geojsonTypes.POINT,coordinates:t}})),o=s(r,n);for(let a=0;a<i.length;a++){const e=i[a];t.feature.updateCoordinate(t.selectedCoordPaths[a],e[0]+o.lng,e[1]+o.lat)}},clickNoTarget:function(){this.changeMode(c.modes.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(c.modes.SIMPLE_SELECT)},clickActiveFeature:function(t){t.selectedCoordPaths=[],this.clearSelectedCoordinates(),t.feature.changed()},onSetup:function(t){const e=t.featureId,n=this.getFeature(e);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===c.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const i={featureId:e,feature:n,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(e,i.selectedCoordPaths)),this.setSelected(e),u.disable(this),this.setActionableState({trash:!0}),i},onStop:function(){u.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(t,e,n){t.featureId===e.properties.id?(e.properties.active=c.activeStates.ACTIVE,n(e),l(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths}).forEach(n)):(e.properties.active=c.activeStates.INACTIVE,n(e)),this.fireActionable(t)},onTrash:function(t){t.selectedCoordPaths.sort().reverse().forEach(e=>t.feature.removeCoordinate(e)),this.fireUpdate(),t.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(t),!1===t.feature.isValid()&&(this.deleteFeature([t.featureId]),this.changeMode(c.modes.SIMPLE_SELECT,{}))},onMouseMove:function(t,e){const n=p.isActiveFeature(e),i=d(e),r=0===t.selectedCoordPaths.length;n&&r||i&&!r?this.updateUIClasses({mouse:c.cursors.MOVE}):this.updateUIClasses({mouse:c.cursors.NONE}),this.stopDragging(t)},onMouseOut:function(t){t.dragMoving&&this.fireUpdate()}};m.onTouchStart=m.onMouseDown=function(t,e){return d(e)?this.onVertex(t,e):p.isActiveFeature(e)?this.onFeature(t,e):f(e)?this.onMidpoint(t,e):void 0},m.onDrag=function(t,e){if(!0!==t.canDragMove)return;t.dragMoving=!0,e.originalEvent.stopPropagation();const n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};t.selectedCoordPaths.length>0?this.dragVertex(t,e,n):this.dragFeature(t,e,n),t.dragMoveLocation=e.lngLat},m.onClick=function(t,e){return i(e)?this.clickNoTarget(t,e):p.isActiveFeature(e)?this.clickActiveFeature(t,e):o(e)?this.clickInactive(t,e):void this.stopDragging(t)},m.onTap=function(t,e){return i(e)?this.clickNoTarget(t,e):p.isActiveFeature(e)?this.clickActiveFeature(t,e):o(e)?this.clickInactive(t,e):void 0},m.onTouchEnd=m.onMouseUp=function(t){t.dragMoving&&this.fireUpdate(),this.stopDragging(t)},t.exports=m}}]);